[0m08:49:31.046469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a66f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bb33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ac74d0>]}


============================== 08:49:31.063606 | 7aabb3b8-498f-4dfc-a4ef-036d50537e90 ==============================
[0m08:49:31.063606 [info ] [MainThread]: Running with dbt=1.10.2
[0m08:49:31.079401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:49:36.632454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff703c8cb0>]}
[0m08:49:36.686203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7560fb60>]}
[0m08:49:36.687736 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:49:37.011672 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m08:49:37.017171 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:49:37.018412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7053b1a0>]}
[0m08:49:38.309348 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_pollution' in the 'models' section of file 'models/schema.yml'
[0m08:49:38.311946 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_pollution' in the 'models' section of file 'models/schema.yml'
[0m08:49:38.467778 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m08:49:38.572209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff2cf80>]}
[0m08:49:38.824453 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:49:38.835988 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:49:38.894610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f54e600>]}
[0m08:49:38.895934 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 494 macros
[0m08:49:38.897376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f3eb860>]}
[0m08:49:38.902902 [info ] [MainThread]: 
[0m08:49:38.907898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:49:38.909471 [info ] [MainThread]: 
[0m08:49:38.911489 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:49:38.918757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:49:38.921271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:39.415591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:49:39.418124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:39.770991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f3f4890>]}
[0m08:49:39.780087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:49:39.797436 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:49:39.797992 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:49:39.800331 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m08:49:39.798924 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:49:39.801801 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:49:39.803224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:49:39.806439 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:49:39.808425 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:49:39.820067 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:49:39.826641 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:49:39.844738 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:49:40.040910 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:49:40.074435 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:49:40.090712 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      


WITH pollution AS (
    SELECT *,
    ROW_NUMBER() OVER(PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)
select 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
from 
    pollution

AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)


-- dbt build --m <model.sql> --var 'is_test_run: false'

    );
  
[0m08:49:40.126584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:40.462853 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:49:40.485672 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m08:49:40.546915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28041e77-0bd3-4d46-8f0c-2dd8b1a0042c&page=queryresults
[0m08:49:40.548767 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28041e77-0bd3-4d46-8f0c-2dd8b1a0042c&page=queryresults
[0m08:49:40.582181 [debug] [Thread-1 (]: Database Error in model staging_air_pollution (models/staging/staging_air_pollution.sql)
  Syntax error: Expected ")" but got keyword AND at [66:1]
[0m08:49:40.589787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f4b34a0>]}
[0m08:49:40.594078 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model development.staging_air_pollution .. [[31mERROR[0m in 0.78s]
[0m08:49:40.598696 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:49:40.600582 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.staging_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model staging_air_pollution (models/staging/staging_air_pollution.sql)
  Syntax error: Expected ")" but got keyword AND at [66:1].
[0m08:49:41.142664 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:07c41aa3-6e3e-43b2-87fd-b0783f69228c&page=queryresults
[0m08:49:42.959153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aabb3b8-498f-4dfc-a4ef-036d50537e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74f5cb90>]}
[0m08:49:42.964286 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 3.16s]
[0m08:49:42.966865 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:49:42.974482 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:49:42.975962 [info ] [Thread-4 (]: 3 of 4 SKIP relation development.fact_air_pollution ............................ [[33mSKIP[0m]
[0m08:49:42.978244 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:49:42.984297 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:49:42.991216 [info ] [Thread-1 (]: 4 of 4 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m08:49:42.994745 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:49:43.001585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:49:43.012393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:43.013409 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:49:43.014441 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m08:49:43.015810 [info ] [MainThread]: 
[0m08:49:43.016787 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m08:49:43.018688 [debug] [MainThread]: Command end result
[0m08:49:43.135210 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:49:43.144673 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:49:43.153177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:49:43.154368 [info ] [MainThread]: 
[0m08:49:43.155675 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:49:43.156799 [info ] [MainThread]: 
[0m08:49:43.158009 [error] [MainThread]: [31mFailure in model staging_air_pollution (models/staging/staging_air_pollution.sql)[0m
[0m08:49:43.159148 [error] [MainThread]:   Database Error in model staging_air_pollution (models/staging/staging_air_pollution.sql)
  Syntax error: Expected ")" but got keyword AND at [66:1]
[0m08:49:43.160083 [info ] [MainThread]: 
[0m08:49:43.161016 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/staging/staging_air_pollution.sql
[0m08:49:43.162384 [info ] [MainThread]: 
[0m08:49:43.163647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m08:49:43.171699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.211963, "process_in_blocks": "14432", "process_kernel_time": 3.482144, "process_mem_max_rss": "378188", "process_out_blocks": "0", "process_user_time": 6.709845}
[0m08:49:43.175749 [debug] [MainThread]: Command `dbt run` failed at 08:49:43.175530 after 12.22 seconds
[0m08:49:43.177174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3fd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5454c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff32db0>]}
[0m08:49:43.178452 [debug] [MainThread]: Flushing usage events
[0m08:49:43.671322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:03.391057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8052b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808b1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820460f0>]}


============================== 08:56:03.395662 | 579940a8-7d43-4c3f-a5d3-6c191a8709c3 ==============================
[0m08:56:03.395662 [info ] [MainThread]: Running with dbt=1.10.2
[0m08:56:03.396847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:56:05.876087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66475010>]}
[0m08:56:05.911055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6685aa80>]}
[0m08:56:05.912379 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:56:06.091081 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m08:56:06.189488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:56:06.190880 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_air_pollution.sql
[0m08:56:06.487958 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m08:56:06.621753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f27050>]}
[0m08:56:06.734319 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:56:06.738205 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:56:06.754266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6611d550>]}
[0m08:56:06.755222 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 494 macros
[0m08:56:06.756087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65e07140>]}
[0m08:56:06.757921 [info ] [MainThread]: 
[0m08:56:06.758737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:06.759417 [info ] [MainThread]: 
[0m08:56:06.760262 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:56:06.764370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:56:06.765274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:07.158863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:56:07.161632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:07.462819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f27590>]}
[0m08:56:07.465451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:07.477682 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:56:07.478284 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:56:07.479515 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:56:07.481149 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m08:56:07.484698 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:56:07.483183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:56:07.485894 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:56:07.493894 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:56:07.516202 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:56:07.516722 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:56:07.519737 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:56:07.537307 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:56:07.557208 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:56:07.573946 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      


WITH pollution AS (
    SELECT *,
    ROW_NUMBER() OVER(PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)
select 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
from 
    pollution
-- 
-- AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)
-- 

-- dbt build --m <model.sql> --var 'is_test_run: false'
-- 
    );
  
[0m08:56:07.607324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:07.883627 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:56:07.889093 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m08:56:08.314898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c377bf0f-9915-41e6-a48b-b88715135cd5&page=queryresults
[0m08:56:08.419198 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:53a87d8e-b421-4792-9853-12fcaa822fb0&page=queryresults
[0m08:56:10.353514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80578a40>]}
[0m08:56:10.355404 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.87s]
[0m08:56:10.356784 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:56:16.826557 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:56:16.857541 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:56:16.861988 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m08:56:17.216489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:366fcf5a-ec88-4c7d-aea8-d6efbd549ec2&page=queryresults
[0m08:56:22.232135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64350620>]}
[0m08:56:22.252693 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (3.9m rows, 322.9 MiB processed)[0m in 14.75s]
[0m08:56:22.255894 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:56:22.260220 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:56:22.262659 [info ] [Thread-4 (]: 3 of 4 START sql table model development.fact_air_pollution .................... [RUN]
[0m08:56:22.264465 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m08:56:22.266912 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:56:22.292855 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:56:22.300088 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:56:22.303423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:56:22.551147 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:56:22.558553 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m08:56:23.010784 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:560e86d0-38f1-4546-a718-cad2b3e4c2dd&page=queryresults
[0m08:56:31.997670 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640cfef0>]}
[0m08:56:32.003534 [info ] [Thread-4 (]: 3 of 4 OK created sql table model development.fact_air_pollution ............... [[32mCREATE TABLE (7.8m rows, 645.7 MiB processed)[0m in 9.73s]
[0m08:56:32.006297 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:56:32.011274 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:56:32.015115 [info ] [Thread-2 (]: 4 of 4 START sql table model development.agg_pollution_by_day .................. [RUN]
[0m08:56:32.017027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:56:32.018125 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:56:32.034180 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:56:32.041170 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:56:32.045109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:32.361323 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:56:32.372283 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2
ORDER BY 
  date ASC





[1,2,3,4,5,6], k =6
    );
  
[0m08:56:32.524887 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9689bd8a-1223-4bd8-b3da-eb04173ceadd&page=queryresults
[0m08:56:32.526228 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9689bd8a-1223-4bd8-b3da-eb04173ceadd&page=queryresults
[0m08:56:32.539171 [debug] [Thread-2 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "[" at [52:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:56:32.543397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '579940a8-7d43-4c3f-a5d3-6c191a8709c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65db4350>]}
[0m08:56:32.545559 [error] [Thread-2 (]: 4 of 4 ERROR creating sql table model development.agg_pollution_by_day ......... [[31mERROR[0m in 0.53s]
[0m08:56:32.548886 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:56:32.551003 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "[" at [52:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql.
[0m08:56:32.556782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:56:32.560391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:32.561108 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:56:32.561952 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:56:32.562669 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:56:32.564956 [info ] [MainThread]: 
[0m08:56:32.567061 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 25.80 seconds (25.80s).
[0m08:56:32.569080 [debug] [MainThread]: Command end result
[0m08:56:32.665419 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:56:32.671792 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:56:32.684002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:56:32.684947 [info ] [MainThread]: 
[0m08:56:32.686197 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:56:32.687039 [info ] [MainThread]: 
[0m08:56:32.688124 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m08:56:32.689246 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "[" at [52:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:56:32.690438 [info ] [MainThread]: 
[0m08:56:32.691380 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:56:32.692125 [info ] [MainThread]: 
[0m08:56:32.692995 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m08:56:32.698364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 29.342785, "process_in_blocks": "24", "process_kernel_time": 1.580947, "process_mem_max_rss": "378336", "process_out_blocks": "0", "process_user_time": 4.224332}
[0m08:56:32.700984 [debug] [MainThread]: Command `dbt run` failed at 08:56:32.700724 after 29.35 seconds
[0m08:56:32.702438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6abc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6631a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f0ac90>]}
[0m08:56:32.703221 [debug] [MainThread]: Flushing usage events
[0m08:56:33.146289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:14.788664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbc39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c22e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c22eed0>]}


============================== 08:57:14.792645 | bbdac473-d9a6-4eb3-bab0-9971aa9e3d28 ==============================
[0m08:57:14.792645 [info ] [MainThread]: Running with dbt=1.10.2
[0m08:57:14.794043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:57:17.431160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff675dfb90>]}
[0m08:57:17.464305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6326fbc0>]}
[0m08:57:17.465523 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:57:17.640862 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m08:57:17.739292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:17.740492 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m08:57:18.014342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7baf8fe0>]}
[0m08:57:18.126256 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:57:18.131624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:57:18.151052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62353ce0>]}
[0m08:57:18.152367 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 494 macros
[0m08:57:18.153358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bab7560>]}
[0m08:57:18.155528 [info ] [MainThread]: 
[0m08:57:18.156424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:18.157252 [info ] [MainThread]: 
[0m08:57:18.158504 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:57:18.162015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:57:18.163045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:18.628755 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m08:57:18.630967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:18.913536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff627b96a0>]}
[0m08:57:18.915145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:57:18.923640 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:57:18.924179 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:57:18.925047 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:57:18.926451 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m08:57:18.927706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:57:18.928855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now model.france_air_pollution.staging_cities)
[0m08:57:18.930160 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:57:18.931150 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:57:18.947236 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:57:18.953367 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:57:18.956352 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:57:18.967018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:57:18.967373 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:57:19.040264 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      


WITH pollution AS (
    SELECT *,
    ROW_NUMBER() OVER(PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)
select 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
from 
    pollution
-- 
-- AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)
-- 

-- dbt build --m <model.sql> --var 'is_test_run: false'
-- 
    );
  
[0m08:57:19.042019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:57:19.286234 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:57:19.293669 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m08:57:19.614157 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eb2d3a27-d2f4-49c7-8f0c-6d593b2ce2da&page=queryresults
[0m08:57:19.716310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:df795f2d-9092-4684-ba25-1e708e3795e6&page=queryresults
[0m08:57:21.686120 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9c4980>]}
[0m08:57:21.689445 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.76s]
[0m08:57:21.692162 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:57:30.538032 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:57:30.578727 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:57:30.583523 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m08:57:30.978320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eb07b01d-c291-43d4-ab3b-191eda33cf03&page=queryresults
[0m08:57:34.852791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff41ea24e0>]}
[0m08:57:34.886931 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (3.9m rows, 322.9 MiB processed)[0m in 15.92s]
[0m08:57:34.889963 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:57:34.896572 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:57:34.901393 [info ] [Thread-4 (]: 3 of 4 START sql table model development.fact_air_pollution .................... [RUN]
[0m08:57:34.904765 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m08:57:34.906599 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:57:34.928129 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:57:34.932906 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:57:34.936712 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:57:35.277436 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:57:35.292812 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m08:57:35.750253 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:37fe06d5-bbc5-4d4b-a5e8-1f2834549600&page=queryresults
[0m08:57:45.777742 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff619f3bc0>]}
[0m08:57:45.783269 [info ] [Thread-4 (]: 3 of 4 OK created sql table model development.fact_air_pollution ............... [[32mCREATE TABLE (11.7m rows, 968.6 MiB processed)[0m in 10.86s]
[0m08:57:45.787239 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:57:45.935806 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:57:45.941305 [info ] [Thread-2 (]: 4 of 4 START sql table model development.agg_pollution_by_day .................. [RUN]
[0m08:57:45.953280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:57:45.960779 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:57:45.983538 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:57:45.987795 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:57:45.990794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:57:46.271253 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:57:46.278449 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m08:57:46.722779 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:441b5bcd-9fd7-402e-8e94-95f569cae58b&page=queryresults
[0m08:57:55.271011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdac473-d9a6-4eb3-bab0-9971aa9e3d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff41ea3230>]}
[0m08:57:55.277440 [info ] [Thread-2 (]: 4 of 4 OK created sql table model development.agg_pollution_by_day ............. [[32mCREATE TABLE (164.2k rows, 1004.9 MiB processed)[0m in 9.32s]
[0m08:57:55.280885 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:57:55.295502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:57:55.302661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:55.304809 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:57:55.306541 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:57:55.308008 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:57:55.309800 [info ] [MainThread]: 
[0m08:57:55.311049 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 37.15 seconds (37.15s).
[0m08:57:55.313179 [debug] [MainThread]: Command end result
[0m08:57:55.402906 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:57:55.410419 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:57:55.422611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:57:55.423508 [info ] [MainThread]: 
[0m08:57:55.424434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:55.425335 [info ] [MainThread]: 
[0m08:57:55.426243 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m08:57:55.431871 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.680916, "process_in_blocks": "0", "process_kernel_time": 1.860757, "process_mem_max_rss": "375448", "process_out_blocks": "0", "process_user_time": 4.476329}
[0m08:57:55.433620 [debug] [MainThread]: Command `dbt run` succeeded at 08:57:55.433431 after 40.68 seconds
[0m08:57:55.435229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bafbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bab77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff41d36ea0>]}
[0m08:57:55.436088 [debug] [MainThread]: Flushing usage events
[0m08:57:55.903339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:04:05.924648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe3d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7f21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc57470>]}


============================== 09:04:05.929543 | 5d03c05f-0a10-485e-bbad-3f1b160fb7ef ==============================
[0m09:04:05.929543 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:04:05.930556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:04:08.292078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e20380>]}
[0m09:04:08.324201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab77fe00>]}
[0m09:04:08.325226 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:04:08.504179 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m09:04:08.601955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:08.602999 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_air_pollution.sql
[0m09:04:08.990451 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:04:09.048176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915ca510>]}
[0m09:04:09.162548 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:04:09.167530 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:04:09.189045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91405850>]}
[0m09:04:09.190027 [info ] [MainThread]: Found 4 models, 6 data tests, 2 sources, 494 macros
[0m09:04:09.190775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91717890>]}
[0m09:04:09.192695 [info ] [MainThread]: 
[0m09:04:09.193616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:04:09.195005 [info ] [MainThread]: 
[0m09:04:09.196538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:04:09.206881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m09:04:09.208882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:09.623776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m09:04:09.625408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:04:09.954620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a91490>]}
[0m09:04:09.956090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:04:09.964677 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m09:04:09.965185 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m09:04:09.966004 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m09:04:09.967523 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m09:04:09.968710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m09:04:09.969876 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m09:04:09.970869 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m09:04:09.972023 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m09:04:09.983870 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m09:04:09.988319 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m09:04:09.991708 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m09:04:10.003549 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m09:04:10.037952 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:04:10.067659 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m09:04:10.102544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:10.399950 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m09:04:10.403039 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m09:04:10.724593 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ed3741b3-4d7f-4c6d-aeb9-a3f73587a560&page=queryresults
[0m09:04:10.725517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:65810c74-506d-4589-a4b6-751c17357574&page=queryresults
[0m09:04:13.073486 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:04:13.134368 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m09:04:13.146840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96734aa0>]}
[0m09:04:13.148109 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m09:04:13.150044 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 3.17s]
[0m09:04:13.163157 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m09:04:13.693232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1003c8f0-f4c9-45ea-bbb6-7e0c38153ec5&page=queryresults
[0m09:04:16.063233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b0a10>]}
[0m09:04:16.065829 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 6.09s]
[0m09:04:16.067900 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m09:04:16.076726 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m09:04:16.078549 [info ] [Thread-4 (]: 3 of 4 START sql table model development.fact_air_pollution .................... [RUN]
[0m09:04:16.080539 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m09:04:16.082237 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m09:04:16.125606 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m09:04:16.132106 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m09:04:16.136173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:04:16.516398 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m09:04:16.520589 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m09:04:16.885644 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:af853c42-a5d2-4584-a7ac-42fe53b4fb55&page=queryresults
[0m09:04:26.018353 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914a1850>]}
[0m09:04:26.028583 [info ] [Thread-4 (]: 3 of 4 OK created sql table model development.fact_air_pollution ............... [[32mCREATE TABLE (11.7m rows, 968.6 MiB processed)[0m in 9.93s]
[0m09:04:26.032662 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m09:04:26.045123 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m09:04:26.062319 [info ] [Thread-2 (]: 4 of 4 START sql table model development.agg_pollution_by_day .................. [RUN]
[0m09:04:26.066605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m09:04:26.067851 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m09:04:26.090662 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:04:26.095198 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m09:04:26.100928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:04:26.394701 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:04:26.402553 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m09:04:26.904685 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0a751548-e7c8-47b7-82af-fe091d9909df&page=queryresults
[0m09:04:33.571881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d03c05f-0a10-485e-bbad-3f1b160fb7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913d9790>]}
[0m09:04:33.573539 [info ] [Thread-2 (]: 4 of 4 OK created sql table model development.agg_pollution_by_day ............. [[32mCREATE TABLE (164.2k rows, 1004.9 MiB processed)[0m in 7.51s]
[0m09:04:33.580099 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m09:04:33.584580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:04:33.590519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:33.592017 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m09:04:33.593406 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m09:04:33.595448 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m09:04:33.600202 [info ] [MainThread]: 
[0m09:04:33.602044 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 24.40 seconds (24.40s).
[0m09:04:33.605430 [debug] [MainThread]: Command end result
[0m09:04:33.758260 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:04:33.777009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:04:33.797685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:04:33.799459 [info ] [MainThread]: 
[0m09:04:33.802647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:04:33.804204 [info ] [MainThread]: 
[0m09:04:33.805725 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m09:04:33.822492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.935642, "process_in_blocks": "0", "process_kernel_time": 1.517625, "process_mem_max_rss": "377000", "process_out_blocks": "0", "process_user_time": 4.361623}
[0m09:04:33.825851 [debug] [MainThread]: Command `dbt run` succeeded at 09:04:33.825568 after 27.94 seconds
[0m09:04:33.831487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab610050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91716a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9160c350>]}
[0m09:04:33.833078 [debug] [MainThread]: Flushing usage events
[0m09:04:34.305231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:24.156820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab572e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3fdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8ceb10>]}


============================== 17:42:24.166609 | ef6c5ff2-3573-400b-a5f8-02f14fc83328 ==============================
[0m17:42:24.166609 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:42:24.167861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir . --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:42:28.970350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad8ea80>]}
[0m17:42:29.010731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e289b0>]}
[0m17:42:29.012201 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:42:29.304555 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m17:42:29.437490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:29.439068 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/sources.yml
[0m17:42:30.058225 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:42:30.265012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90afcd70>]}
[0m17:42:30.375400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:42:30.379585 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:42:30.424119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90abc560>]}
[0m17:42:30.425154 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 494 macros
[0m17:42:30.426024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91564200>]}
[0m17:42:30.428300 [info ] [MainThread]: 
[0m17:42:30.429299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:42:30.430055 [info ] [MainThread]: 
[0m17:42:30.431204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:42:30.434695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m17:42:30.435494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:30.841505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef6c5ff2-3573-400b-a5f8-02f14fc83328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91afaa20>]}
[0m17:42:30.843262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:30.856737 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:42:30.857343 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:42:30.857764 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m17:42:30.858034 [debug] [Thread-4 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m17:42:30.858394 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m17:42:30.859538 [info ] [Thread-2 (]: 2 of 4 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m17:42:30.860600 [info ] [Thread-3 (]: 3 of 4 START test not_null_staging_cities_id ................................... [RUN]
[0m17:42:30.861811 [info ] [Thread-4 (]: 4 of 4 START test unique_staging_cities_id ..................................... [RUN]
[0m17:42:30.862830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m17:42:30.863921 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m17:42:30.865036 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2'
[0m17:42:30.866100 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477'
[0m17:42:30.867117 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:42:30.868367 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:42:30.869027 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m17:42:30.869787 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m17:42:30.881734 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m17:42:30.889065 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m17:42:30.892128 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m17:42:30.897046 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m17:42:30.909360 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:42:30.919057 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m17:42:30.928458 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m17:42:30.929241 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m17:42:30.929571 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:42:30.931662 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m17:42:30.936532 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m17:42:30.943706 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m17:42:30.947611 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m17:42:30.950349 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:42:30.949201 [debug] [Thread-4 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:42:30.954912 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m17:42:30.956385 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:42:30.997148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:31.001168 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m17:42:31.036683 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:42:31.916569 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:51bd0514-ddda-4a36-af44-1c75d1b4617a&page=queryresults
[0m17:42:31.918511 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2028c39d-f84b-4230-8c1b-a4c06ffe36a5&page=queryresults
[0m17:42:31.955928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bd648a81-0cc3-400b-9de0-43424d6e3ece&page=queryresults
[0m17:42:32.044697 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:382b1a29-3393-4b1e-9e23-ac5cd92cd713&page=queryresults
[0m17:42:32.498017 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.63s]
[0m17:42:32.499901 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:42:32.501646 [info ] [Thread-4 (]: 4 of 4 PASS unique_staging_cities_id ........................................... [[32mPASS[0m in 1.64s]
[0m17:42:32.503071 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m17:42:32.503779 [info ] [Thread-2 (]: 2 of 4 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.64s]
[0m17:42:32.505158 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:42:32.516544 [info ] [Thread-3 (]: 3 of 4 PASS not_null_staging_cities_id ......................................... [[32mPASS[0m in 1.65s]
[0m17:42:32.518218 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m17:42:32.521849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:32.525162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:32.526225 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m17:42:32.526856 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m17:42:32.527533 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2' was properly closed.
[0m17:42:32.528345 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m17:42:32.529190 [info ] [MainThread]: 
[0m17:42:32.530708 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m17:42:32.532444 [debug] [MainThread]: Command end result
[0m17:42:32.603392 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:42:32.606994 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:42:32.613455 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:42:32.614031 [info ] [MainThread]: 
[0m17:42:32.614839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:32.615570 [info ] [MainThread]: 
[0m17:42:32.616420 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:42:32.620777 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.517256, "process_in_blocks": "57200", "process_kernel_time": 4.48483, "process_mem_max_rss": "379392", "process_out_blocks": "0", "process_user_time": 4.796792}
[0m17:42:32.622145 [debug] [MainThread]: Command `dbt test` succeeded at 17:42:32.622002 after 8.52 seconds
[0m17:42:32.623187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc24800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cad040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c0fd10>]}
[0m17:42:32.623870 [debug] [MainThread]: Flushing usage events
[0m17:42:33.153704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:48.329631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cbdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29aad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e914c0>]}


============================== 17:53:48.335983 | 5a86ea71-18ca-49e7-b6df-adc2b00bce99 ==============================
[0m17:53:48.335983 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:53:48.337223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select staging_air_pollution --profile france_air_pollution --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:52.136177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992a9dc0>]}
[0m17:53:52.172471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99218080>]}
[0m17:53:52.174140 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:53:52.442775 [debug] [MainThread]: checksum: 3218b0113750aa8e0392e4ae8857be23140f2fee3123882dc6d6c128a4f80a22, vars: {}, profile: france_air_pollution, target: dev, version: 1.10.2
[0m17:53:52.516349 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:53:52.517753 [debug] [MainThread]: previous checksum: 3218b0113750aa8e0392e4ae8857be23140f2fee3123882dc6d6c128a4f80a22, current checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265
[0m17:53:52.518654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e291f0>]}
[0m17:53:53.212606 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_pollution' in the 'models' section of file 'models/schema.yml'
[0m17:53:53.214503 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_pollution' in the 'models' section of file 'models/schema.yml'
[0m17:53:53.417599 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:53:53.480057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb253b140>]}
[0m17:53:53.581261 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:53:53.585814 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:53:53.617883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9924e3c0>]}
[0m17:53:53.618949 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 494 macros
[0m17:53:53.619865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d5bda0>]}
[0m17:53:53.621739 [info ] [MainThread]: 
[0m17:53:53.622431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:53.623252 [info ] [MainThread]: 
[0m17:53:53.624661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:53.628451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m17:53:53.629522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:54.030611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a86ea71-18ca-49e7-b6df-adc2b00bce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982db9b0>]}
[0m17:53:54.034861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:54.050196 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:53:54.050946 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:53:54.054729 [info ] [Thread-2 (]: 2 of 2 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m17:53:54.051986 [info ] [Thread-1 (]: 1 of 2 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m17:53:54.057150 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m17:53:54.058659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m17:53:54.060716 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:53:54.062172 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:53:54.082216 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m17:53:54.086761 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m17:53:54.096746 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:53:54.124828 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m17:53:54.125683 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:53:54.130127 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m17:53:54.132229 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m17:53:54.139463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:54.145475 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m17:53:54.179671 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:53:54.711870 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ccc8a489-ff08-43fe-9d5d-1dfd302d34b5&page=queryresults
[0m17:53:54.813877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:23ddfafc-b981-4d6e-916a-ae40cf851b3d&page=queryresults
[0m17:53:55.240441 [info ] [Thread-1 (]: 1 of 2 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.18s]
[0m17:53:55.243048 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m17:53:55.256540 [info ] [Thread-2 (]: 2 of 2 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.20s]
[0m17:53:55.258782 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m17:53:55.272243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:55.282453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:55.286373 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m17:53:55.287516 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m17:53:55.288730 [info ] [MainThread]: 
[0m17:53:55.289995 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m17:53:55.291926 [debug] [MainThread]: Command end result
[0m17:53:55.472703 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:53:55.479389 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:53:55.486650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:53:55.487323 [info ] [MainThread]: 
[0m17:53:55.488206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:55.488933 [info ] [MainThread]: 
[0m17:53:55.489805 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:53:55.492644 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.214435, "process_in_blocks": "0", "process_kernel_time": 2.661093, "process_mem_max_rss": "378336", "process_out_blocks": "0", "process_user_time": 4.941428}
[0m17:53:55.494023 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:55.493826 after 7.22 seconds
[0m17:53:55.495211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25166f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992a8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980a6fc0>]}
[0m17:53:55.496095 [debug] [MainThread]: Flushing usage events
[0m17:53:58.045972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:30.172725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc59460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc58c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c390980>]}


============================== 18:39:30.178375 | fcfdecb8-2548-4293-aa99-aa4eec64694a ==============================
[0m18:39:30.178375 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:39:30.179641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:30.194698 [info ] [MainThread]: dbt version: 1.10.2
[0m18:39:30.195832 [info ] [MainThread]: python version: 3.12.10
[0m18:39:30.196814 [info ] [MainThread]: python path: /usr/local/airflow/dbt_venv/bin/python
[0m18:39:30.197751 [info ] [MainThread]: os info: Linux-5.15.49-linuxkit-aarch64-with-glibc2.36
[0m18:39:33.110489 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/france_air_pollution
[0m18:39:33.112911 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/france_air_pollution/profiles.yml
[0m18:39:33.114101 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/france_air_pollution/dbt_project.yml
[0m18:39:33.115368 [info ] [MainThread]: adapter type: bigquery
[0m18:39:33.116078 [info ] [MainThread]: adapter version: 1.9.2
[0m18:39:33.240771 [info ] [MainThread]: Configuration:
[0m18:39:33.242164 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:39:33.243212 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:39:33.244111 [info ] [MainThread]: Required dependencies:
[0m18:39:33.245182 [debug] [MainThread]: Executing "git --help"
[0m18:39:33.249460 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:39:33.250448 [info ] [MainThread]: Connection:
[0m18:39:33.251380 [info ] [MainThread]:   method: service-account
[0m18:39:33.252278 [info ] [MainThread]:   database: paris-air-pollution-quangnc
[0m18:39:33.253179 [info ] [MainThread]:   execution_project: paris-air-pollution-quangnc
[0m18:39:33.254001 [info ] [MainThread]:   schema: production
[0m18:39:33.255025 [info ] [MainThread]:   location: europe-west2
[0m18:39:33.256026 [info ] [MainThread]:   priority: interactive
[0m18:39:33.258575 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:39:33.265608 [info ] [MainThread]:   impersonate_service_account: None
[0m18:39:33.277405 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:39:33.279844 [info ] [MainThread]:   job_retries: 1
[0m18:39:33.280927 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:39:33.282155 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:39:33.283218 [info ] [MainThread]:   timeout_seconds: 300
[0m18:39:33.283917 [info ] [MainThread]:   client_id: None
[0m18:39:33.285717 [info ] [MainThread]:   token_uri: None
[0m18:39:33.286737 [info ] [MainThread]:   compute_region: None
[0m18:39:33.287669 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:39:33.288561 [info ] [MainThread]:   gcs_bucket: None
[0m18:39:33.289304 [info ] [MainThread]:   dataproc_batch: None
[0m18:39:33.290504 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:39:33.513642 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:39:33.514828 [debug] [MainThread]: On debug: select 1 as id
[0m18:39:33.515664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:34.043149 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7d9afd8f-0b2a-466b-a8a9-7e68cfc25c3b&page=queryresults
[0m18:39:34.516421 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:39:34.518210 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:39:34.519394 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m18:39:34.522330 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 4.396352, "process_in_blocks": "96", "process_kernel_time": 2.136486, "process_mem_max_rss": "364880", "process_out_blocks": "0", "process_user_time": 3.22417}
[0m18:39:34.524266 [debug] [MainThread]: Command `dbt debug` failed at 18:39:34.523721 after 4.40 seconds
[0m18:39:34.526131 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:39:34.527147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca9d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72e4fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73013f20>]}
[0m18:39:34.528300 [debug] [MainThread]: Flushing usage events
[0m18:39:35.016117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:32.283064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5eeb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb632c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb680a1b0>]}


============================== 21:22:32.288708 | 2db1e8f6-a106-4060-9c54-e38c424c0a32 ==============================
[0m21:22:32.288708 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:22:32.289806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/local/airflow/dags/dbt --profile france_air_pollution', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:32.305669 [info ] [MainThread]: dbt version: 1.10.2
[0m21:22:32.307054 [info ] [MainThread]: python version: 3.12.10
[0m21:22:32.308180 [info ] [MainThread]: python path: /usr/local/airflow/dbt_venv/bin/python
[0m21:22:32.309243 [info ] [MainThread]: os info: Linux-5.15.49-linuxkit-aarch64-with-glibc2.36
[0m21:22:32.311081 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt
[0m21:22:32.312253 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/profiles.yml
[0m21:22:32.313191 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/france_air_pollution/dbt_project.yml
[0m21:22:32.381866 [info ] [MainThread]: Configuration:
[0m21:22:32.383339 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m21:22:32.384349 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:22:32.385374 [info ] [MainThread]: Required dependencies:
[0m21:22:32.386219 [debug] [MainThread]: Executing "git --help"
[0m21:22:32.388497 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:22:32.389665 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:22:32.390551 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:22:32.391514 [info ] [MainThread]: dbt looked for a profiles.yml file in /usr/local/airflow/dags/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m21:22:32.392551 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:22:32.399914 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16192262, "process_in_blocks": "0", "process_kernel_time": 0.842726, "process_mem_max_rss": "101552", "process_out_blocks": "0", "process_user_time": 1.121562}
[0m21:22:32.401308 [debug] [MainThread]: Command `dbt debug` failed at 21:22:32.401204 after 0.16 seconds
[0m21:22:32.402079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb66c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63af440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65cb320>]}
[0m21:22:32.403255 [debug] [MainThread]: Flushing usage events
[0m21:22:32.866753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:42.916204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2e3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf653230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2e3110>]}


============================== 21:45:42.925605 | e2072083-8a00-480d-b559-d9928cfa022d ==============================
[0m21:45:42.925605 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:45:43.004788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /usr/local/airflow/dags/dbt/france_air_pollution --project-dir /usr/local/airflow/dags/dbt/france_air_pollution --profile france_air_pollution', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:45:43.064430 [info ] [MainThread]: dbt version: 1.10.2
[0m21:45:43.066174 [info ] [MainThread]: python version: 3.12.10
[0m21:45:43.067384 [info ] [MainThread]: python path: /usr/local/airflow/dbt_venv/bin/python
[0m21:45:43.068355 [info ] [MainThread]: os info: Linux-5.15.49-linuxkit-aarch64-with-glibc2.36
[0m21:45:45.524718 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/france_air_pollution
[0m21:45:45.528457 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/france_air_pollution/profiles.yml
[0m21:45:45.529823 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/france_air_pollution/dbt_project.yml
[0m21:45:45.531098 [info ] [MainThread]: adapter type: bigquery
[0m21:45:45.532147 [info ] [MainThread]: adapter version: 1.9.2
[0m21:45:45.599398 [info ] [MainThread]: Configuration:
[0m21:45:45.601120 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:45:45.601952 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:45:45.603955 [info ] [MainThread]: Required dependencies:
[0m21:45:45.605038 [debug] [MainThread]: Executing "git --help"
[0m21:45:45.608249 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:45:45.609582 [info ] [MainThread]: Connection:
[0m21:45:45.610936 [info ] [MainThread]:   method: service-account
[0m21:45:45.611730 [info ] [MainThread]:   database: paris-air-pollution-quangnc
[0m21:45:45.616070 [info ] [MainThread]:   execution_project: paris-air-pollution-quangnc
[0m21:45:45.620511 [info ] [MainThread]:   schema: production
[0m21:45:45.622806 [info ] [MainThread]:   location: europe-west2
[0m21:45:45.627703 [info ] [MainThread]:   priority: interactive
[0m21:45:45.632903 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:45:45.636361 [info ] [MainThread]:   impersonate_service_account: None
[0m21:45:45.638208 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:45:45.641375 [info ] [MainThread]:   job_retries: 1
[0m21:45:45.642505 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:45:45.644079 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m21:45:45.646148 [info ] [MainThread]:   timeout_seconds: 300
[0m21:45:45.647278 [info ] [MainThread]:   client_id: None
[0m21:45:45.648321 [info ] [MainThread]:   token_uri: None
[0m21:45:45.649855 [info ] [MainThread]:   compute_region: None
[0m21:45:45.655561 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:45:45.656760 [info ] [MainThread]:   gcs_bucket: None
[0m21:45:45.658088 [info ] [MainThread]:   dataproc_batch: None
[0m21:45:45.659682 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:45:45.872575 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:45:45.874102 [debug] [MainThread]: On debug: select 1 as id
[0m21:45:45.875099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:46.282616 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:efeb76cf-e374-44d8-8551-cb7d5b05181b&page=queryresults
[0m21:45:46.642453 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:45:46.644384 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:45:46.645731 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:45:46.655907 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 4.0003734, "process_in_blocks": "0", "process_kernel_time": 1.443174, "process_mem_max_rss": "364864", "process_out_blocks": "0", "process_user_time": 3.240048}
[0m21:45:46.657860 [debug] [MainThread]: Command `dbt debug` failed at 21:45:46.657703 after 4.00 seconds
[0m21:45:46.659169 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:45:46.660462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959d0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaead5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2a3f80>]}
[0m21:45:46.661764 [debug] [MainThread]: Flushing usage events
[0m21:45:47.064455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:10.029377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6792240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8170500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66dacc0>]}


============================== 22:47:10.034938 | 08dda112-b0ff-41f3-8a11-28af92717582 ==============================
[0m22:47:10.034938 [info ] [MainThread]: Running with dbt=1.10.2
[0m22:47:10.035867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:47:10.126654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08dda112-b0ff-41f3-8a11-28af92717582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ee7680>]}
[0m22:47:10.178651 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18889141, "process_in_blocks": "3480", "process_kernel_time": 0.484052, "process_mem_max_rss": "101332", "process_out_blocks": "0", "process_user_time": 1.006504}
[0m22:47:10.179707 [debug] [MainThread]: Command `dbt clean` succeeded at 22:47:10.179592 after 0.19 seconds
[0m22:47:10.180445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa946fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ee7080>]}
[0m22:47:10.181275 [debug] [MainThread]: Flushing usage events
[0m22:47:10.609015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:16.306508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0919eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e701700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e701760>]}


============================== 21:28:16.311395 | 84ca4860-36b5-45a9-8cf5-d6f1b0215a35 ==============================
[0m21:28:16.311395 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:28:16.312430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:20.189799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ca4860-36b5-45a9-8cf5-d6f1b0215a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df81430>]}
[0m21:28:20.231511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ca4860-36b5-45a9-8cf5-d6f1b0215a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecd79b0>]}
[0m21:28:20.233362 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:28:20.513398 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:28:20.516210 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:28:20.517391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84ca4860-36b5-45a9-8cf5-d6f1b0215a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bd2120>]}
[0m21:28:21.760117 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/sources.yml:
  	test definition dictionary must have exactly one key, got [('test_is_float', None), ('model_name', 'airpollution'), ('column_name', 'Carbon_Monoxide_CO'), ('expected_data_type', 'float64')] instead (4 keys)
  	@: UnpatchedSourceDefinition(name='source_airpo...ne)
[0m21:28:21.767019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.4949903, "process_in_blocks": "0", "process_kernel_time": 2.153105, "process_mem_max_rss": "366964", "process_out_blocks": "0", "process_user_time": 4.934965}
[0m21:28:21.769717 [debug] [MainThread]: Command `dbt test` failed at 21:28:21.769513 after 5.50 seconds
[0m21:28:21.770973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e29e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849f3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb6e9c0>]}
[0m21:28:21.772314 [debug] [MainThread]: Flushing usage events
[0m21:28:22.218009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:16.902162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf789ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea18c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad713ce0>]}


============================== 21:31:16.907889 | 90f5fb78-3805-4d8d-9ed2-9b3affa64c9d ==============================
[0m21:31:16.907889 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:31:16.909091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:31:19.400513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadcdd580>]}
[0m21:31:19.436866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c9ef60>]}
[0m21:31:19.438389 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:31:19.590135 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:31:19.592284 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:31:19.593004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dc3f80>]}
[0m21:31:20.494791 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m21:31:20.565588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93671880>]}
[0m21:31:20.684190 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:31:20.688422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:31:20.819426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b52cf0>]}
[0m21:31:20.820634 [info ] [MainThread]: Found 4 models, 8 data tests, 2 sources, 494 macros
[0m21:31:20.821659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a37320>]}
[0m21:31:20.824312 [info ] [MainThread]: 
[0m21:31:20.825238 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m21:31:20.825876 [info ] [MainThread]: 
[0m21:31:20.826888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:31:20.831734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m21:31:20.832613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:21.177712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f5fb78-3805-4d8d-9ed2-9b3affa64c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf685040>]}
[0m21:31:21.179036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:21.188016 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:31:21.188463 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:31:21.188880 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:31:21.189467 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:31:21.192586 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_source_airpollution_City_Index ............... [RUN]
[0m21:31:21.190534 [info ] [Thread-2 (]: 2 of 8 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m21:31:21.191673 [info ] [Thread-3 (]: 3 of 8 START test not_null_staging_cities_id ................................... [RUN]
[0m21:31:21.189265 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m21:31:21.193667 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc'
[0m21:31:21.194852 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m21:31:21.196076 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2'
[0m21:31:21.197220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m21:31:21.197959 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:31:21.198845 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:31:21.199408 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:31:21.200223 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:31:21.223602 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m21:31:21.214832 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m21:31:21.219765 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m21:31:21.211117 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:31:21.237229 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:31:21.254153 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m21:31:21.257522 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:31:21.259076 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:31:21.264569 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m21:31:21.264957 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:31:21.271688 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m21:31:21.267965 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:31:21.281746 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m21:31:21.282743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:21.283220 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`production`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m21:31:21.323371 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:31:21.324139 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m21:31:21.325033 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:31:21.328250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:31:21.363152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:31:21.827932 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bbc522ee-7f2d-4ce9-b03e-a2cff576543d&page=queryresults
[0m21:31:21.829680 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bbc522ee-7f2d-4ce9-b03e-a2cff576543d&page=queryresults
[0m21:31:21.840525 [debug] [Thread-2 (]: Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:31:21.840996 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:34e34d9c-d7e6-45bf-a9ff-8fde333f79aa&page=queryresults
[0m21:31:21.841790 [error] [Thread-2 (]: 2 of 8 ERROR not_null_staging_air_pollution_city_id ............................ [[31mERROR[0m in 0.65s]
[0m21:31:21.842606 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:34e34d9c-d7e6-45bf-a9ff-8fde333f79aa&page=queryresults
[0m21:31:21.843849 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:31:21.846491 [debug] [Thread-3 (]: Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:31:21.847505 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:31:21.848433 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql.
[0m21:31:21.849565 [error] [Thread-3 (]: 3 of 8 ERROR not_null_staging_cities_id ........................................ [[31mERROR[0m in 0.65s]
[0m21:31:21.850584 [info ] [Thread-2 (]: 5 of 8 START test source_not_null_source_cities_city_index ..................... [RUN]
[0m21:31:21.852754 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:31:21.855318 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:31:21.854421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m21:31:21.856412 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql.
[0m21:31:21.857342 [info ] [Thread-3 (]: 6 of 8 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:31:21.858662 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:31:21.869865 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:31:21.860702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52)
[0m21:31:21.872571 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:31:21.878972 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:31:21.883247 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:31:21.880205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:31:21.888975 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m21:31:21.889884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:31:21.890916 [debug] [Thread-3 (]: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:31:21.892459 [error] [Thread-3 (]: 6 of 8 ERROR source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[31mERROR[0m in 0.03s]
[0m21:31:21.894909 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:31:21.932584 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float
[0m21:31:21.934497 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:31:21.934804 [info ] [Thread-3 (]: 7 of 8 START test test_is_float ................................................ [RUN]
[0m21:31:21.938202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52, now test.france_air_pollution.test_is_float)
[0m21:31:21.939070 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float
[0m21:31:21.943407 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float"
[0m21:31:21.944025 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6231f569-f6fe-4420-9366-7692741333f1&page=queryresults
[0m21:31:21.944444 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float
[0m21:31:21.948240 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float"
[0m21:31:21.953428 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.test_is_float"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
  
  
      
    ) dbt_internal_test
[0m21:31:21.954482 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:31:22.180843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bf94b45e-438a-485f-ae1c-87db714753f0&page=queryresults
[0m21:31:22.182155 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bf94b45e-438a-485f-ae1c-87db714753f0&page=queryresults
[0m21:31:22.185209 [debug] [Thread-1 (]: Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:31:22.186206 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[31mERROR[0m in 0.99s]
[0m21:31:22.187051 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:31:22.187836 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:31:22.188343 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql.
[0m21:31:22.188791 [info ] [Thread-1 (]: 8 of 8 START test unique_staging_cities_id ..................................... [RUN]
[0m21:31:22.190932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m21:31:22.192898 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:31:22.197889 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m21:31:22.202264 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:31:22.204881 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m21:31:22.208626 [debug] [Thread-1 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`production`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:31:22.210144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:22.262644 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:85f1dc5c-2878-4707-8459-cf2cd4adad4a&page=queryresults
[0m21:31:22.263707 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:85f1dc5c-2878-4707-8459-cf2cd4adad4a&page=queryresults
[0m21:31:22.267318 [debug] [Thread-3 (]: Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql
[0m21:31:22.269117 [error] [Thread-3 (]: 7 of 8 ERROR test_is_float ..................................................... [[31mERROR[0m in 0.33s]
[0m21:31:22.271576 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float
[0m21:31:22.273510 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_is_float' to be skipped because of status 'error'.  Reason: Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql.
[0m21:31:22.413582 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_source_airpollution_City_Index ..................... [[32mPASS[0m in 1.22s]
[0m21:31:22.414847 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:31:22.474804 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5e0f3ea2-54bb-47fb-91e7-d4e538faf109&page=queryresults
[0m21:31:22.645558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1517bd17-98e1-47ad-9231-963b1ba104ef&page=queryresults
[0m21:31:22.646763 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1517bd17-98e1-47ad-9231-963b1ba104ef&page=queryresults
[0m21:31:22.649497 [debug] [Thread-1 (]: Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:31:22.650337 [error] [Thread-1 (]: 8 of 8 ERROR unique_staging_cities_id .......................................... [[31mERROR[0m in 0.46s]
[0m21:31:22.651372 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:31:22.652247 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' to be skipped because of status 'error'.  Reason: Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql.
[0m21:31:22.808564 [info ] [Thread-2 (]: 5 of 8 PASS source_not_null_source_cities_city_index ........................... [[32mPASS[0m in 0.95s]
[0m21:31:22.809727 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:31:22.812372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:22.880214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:22.904889 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m21:31:22.907392 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc' was properly closed.
[0m21:31:22.916988 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103' was properly closed.
[0m21:31:22.919902 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float' was properly closed.
[0m21:31:22.921605 [info ] [MainThread]: 
[0m21:31:22.923033 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m21:31:22.925242 [debug] [MainThread]: Command end result
[0m21:31:23.001637 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:31:23.007996 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:31:23.015266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:31:23.016156 [info ] [MainThread]: 
[0m21:31:23.017025 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m21:31:23.017645 [info ] [MainThread]: 
[0m21:31:23.018471 [error] [MainThread]: [31mFailure in test not_null_staging_air_pollution_city_id (models/schema.yml)[0m
[0m21:31:23.019444 [error] [MainThread]:   Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:31:23.020149 [info ] [MainThread]: 
[0m21:31:23.020883 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:31:23.021755 [info ] [MainThread]: 
[0m21:31:23.022415 [error] [MainThread]: [31mFailure in test not_null_staging_cities_id (models/schema.yml)[0m
[0m21:31:23.023612 [error] [MainThread]:   Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:31:23.024410 [info ] [MainThread]: 
[0m21:31:23.025158 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:31:23.025871 [info ] [MainThread]: 
[0m21:31:23.026504 [error] [MainThread]: [31mFailure in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)[0m
[0m21:31:23.027237 [error] [MainThread]:   Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:31:23.028886 [info ] [MainThread]: 
[0m21:31:23.029676 [error] [MainThread]: [31mFailure in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)[0m
[0m21:31:23.030344 [error] [MainThread]:   Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:31:23.031688 [info ] [MainThread]: 
[0m21:31:23.032892 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:31:23.034280 [info ] [MainThread]: 
[0m21:31:23.035419 [error] [MainThread]: [31mFailure in test test_is_float (tests/test_is_float.sql)[0m
[0m21:31:23.036293 [error] [MainThread]:   Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql
[0m21:31:23.037318 [info ] [MainThread]: 
[0m21:31:23.038243 [error] [MainThread]: [31mFailure in test unique_staging_cities_id (models/schema.yml)[0m
[0m21:31:23.039356 [error] [MainThread]:   Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:31:23.040737 [info ] [MainThread]: 
[0m21:31:23.041626 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:31:23.042398 [info ] [MainThread]: 
[0m21:31:23.043310 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=8
[0m21:31:23.046693 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.186548, "process_in_blocks": "4464", "process_kernel_time": 1.570739, "process_mem_max_rss": "378524", "process_out_blocks": "0", "process_user_time": 4.406539}
[0m21:31:23.048191 [debug] [MainThread]: Command `dbt test` failed at 21:31:23.048016 after 6.19 seconds
[0m21:31:23.049442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacddfa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9298e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad9fb90>]}
[0m21:31:23.050421 [debug] [MainThread]: Flushing usage events
[0m21:31:23.545813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:46.230770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8340b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838aa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835b7230>]}


============================== 21:35:46.236584 | ae736478-aa3d-44da-a355-c41c21984807 ==============================
[0m21:35:46.236584 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:35:46.237890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:48.722242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff698b3920>]}
[0m21:35:48.756479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f5b0b0>]}
[0m21:35:48.757914 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:35:48.913547 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:35:49.015044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:49.016058 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://tests/test_is_float.sql
[0m21:35:49.334568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69360230>]}
[0m21:35:49.448797 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:35:49.452696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:35:49.482511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff696268d0>]}
[0m21:35:49.483691 [info ] [MainThread]: Found 4 models, 8 data tests, 2 sources, 494 macros
[0m21:35:49.484683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691fe360>]}
[0m21:35:49.486967 [info ] [MainThread]: 
[0m21:35:49.487789 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m21:35:49.488454 [info ] [MainThread]: 
[0m21:35:49.489724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:49.493159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m21:35:49.494065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:49.809406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae736478-aa3d-44da-a355-c41c21984807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6966d400>]}
[0m21:35:49.810458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:49.815773 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:35:49.816307 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:35:49.816632 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:35:49.817004 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m21:35:49.817589 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:35:49.818144 [info ] [Thread-2 (]: 2 of 8 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m21:35:49.822484 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m21:35:49.820022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m21:35:49.821069 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_source_airpollution_City_Index ............... [RUN]
[0m21:35:49.819136 [info ] [Thread-3 (]: 3 of 8 START test not_null_staging_cities_id ................................... [RUN]
[0m21:35:49.823618 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:35:49.824373 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:35:49.825344 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc'
[0m21:35:49.826005 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2'
[0m21:35:49.842130 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m21:35:49.850744 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m21:35:49.851083 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:35:49.852031 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:35:49.868591 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:35:49.872478 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m21:35:49.884568 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:35:49.885733 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:35:49.920074 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m21:35:49.921032 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m21:35:49.921956 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:35:49.922467 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:35:49.929379 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:35:49.930068 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m21:35:49.932375 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m21:35:49.933041 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m21:35:49.936808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:49.936500 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:35:49.934467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:49.938832 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:49.939387 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`production`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m21:35:50.050324 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:35:50.437789 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3d801e32-5947-4dbf-b64c-69b06c82b41b&page=queryresults
[0m21:35:50.439244 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3d801e32-5947-4dbf-b64c-69b06c82b41b&page=queryresults
[0m21:35:50.444719 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f10ea7a4-8e9a-4fff-9f04-70823751b8ee&page=queryresults
[0m21:35:50.446080 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f10ea7a4-8e9a-4fff-9f04-70823751b8ee&page=queryresults
[0m21:35:50.455848 [debug] [Thread-2 (]: Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:35:50.457832 [debug] [Thread-3 (]: Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:35:50.459608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c4a0d71b-5c6c-4125-8c1d-7b2e9a98ad75&page=queryresults
[0m21:35:50.463150 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c4a0d71b-5c6c-4125-8c1d-7b2e9a98ad75&page=queryresults
[0m21:35:50.462119 [error] [Thread-3 (]: 3 of 8 ERROR not_null_staging_cities_id ........................................ [[31mERROR[0m in 0.64s]
[0m21:35:50.460414 [error] [Thread-2 (]: 2 of 8 ERROR not_null_staging_air_pollution_city_id ............................ [[31mERROR[0m in 0.64s]
[0m21:35:50.465864 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m21:35:50.469184 [debug] [Thread-1 (]: Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:35:50.471084 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m21:35:50.472477 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:35:50.473231 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.not_null_staging_cities_id.c4626abdf2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql.
[0m21:35:50.473874 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[31mERROR[0m in 0.65s]
[0m21:35:50.475851 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:35:50.476925 [info ] [Thread-3 (]: 5 of 8 START test source_not_null_source_cities_city_index ..................... [RUN]
[0m21:35:50.478998 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql.
[0m21:35:50.480031 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m21:35:50.480774 [info ] [Thread-2 (]: 6 of 8 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:35:50.482830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m21:35:50.484467 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float
[0m21:35:50.484916 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql.
[0m21:35:50.485708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52)
[0m21:35:50.486517 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:35:50.487283 [info ] [Thread-1 (]: 7 of 8 START test test_is_float ................................................ [RUN]
[0m21:35:50.489397 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:35:50.494094 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:35:50.495677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.test_is_float)
[0m21:35:50.500832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:50.501741 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float
[0m21:35:50.505384 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float"
[0m21:35:50.507339 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float
[0m21:35:50.509463 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float"
[0m21:35:50.507696 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:35:50.512010 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:35:50.513309 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.test_is_float"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
  
  
      
    ) dbt_internal_test
[0m21:35:50.514352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:50.514087 [debug] [Thread-2 (]: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:35:50.519632 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m21:35:50.561877 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:50.525433 [error] [Thread-2 (]: 6 of 8 ERROR source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[31mERROR[0m in 0.04s]
[0m21:35:50.567505 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:35:50.569592 [debug] [Thread-2 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:35:50.570247 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ed1fa169-8751-4e06-9ef9-dc09813039a5&page=queryresults
[0m21:35:50.570616 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:35:50.607411 [info ] [Thread-2 (]: 8 of 8 START test unique_staging_cities_id ..................................... [RUN]
[0m21:35:50.610653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m21:35:50.612934 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:35:50.620804 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m21:35:50.624232 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:35:50.627048 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m21:35:50.630080 [debug] [Thread-2 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`production`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:35:50.631727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:50.947495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb4b7f4c-5c40-4127-9bbb-91d806518d3a&page=queryresults
[0m21:35:50.948928 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb4b7f4c-5c40-4127-9bbb-91d806518d3a&page=queryresults
[0m21:35:50.951750 [debug] [Thread-1 (]: Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql
[0m21:35:50.952673 [error] [Thread-1 (]: 7 of 8 ERROR test_is_float ..................................................... [[31mERROR[0m in 0.46s]
[0m21:35:50.953706 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float
[0m21:35:50.954528 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_is_float' to be skipped because of status 'error'.  Reason: Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql.
[0m21:35:51.002215 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3b457f5-ef89-4c9b-9971-b2ce24304029&page=queryresults
[0m21:35:51.003754 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3b457f5-ef89-4c9b-9971-b2ce24304029&page=queryresults
[0m21:35:51.008243 [debug] [Thread-2 (]: Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:35:51.009311 [error] [Thread-2 (]: 8 of 8 ERROR unique_staging_cities_id .......................................... [[31mERROR[0m in 0.40s]
[0m21:35:51.010334 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m21:35:51.011237 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' to be skipped because of status 'error'.  Reason: Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql.
[0m21:35:51.060512 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_source_airpollution_City_Index ..................... [[32mPASS[0m in 1.24s]
[0m21:35:51.062067 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:35:51.106939 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70528b9b-ba49-49f3-823e-20e595103661&page=queryresults
[0m21:35:51.464505 [info ] [Thread-3 (]: 5 of 8 PASS source_not_null_source_cities_city_index ........................... [[32mPASS[0m in 0.98s]
[0m21:35:51.466212 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:35:51.468796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:51.471733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:51.472732 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float' was properly closed.
[0m21:35:51.473464 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m21:35:51.474620 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc' was properly closed.
[0m21:35:51.475324 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103' was properly closed.
[0m21:35:51.476177 [info ] [MainThread]: 
[0m21:35:51.477140 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m21:35:51.479003 [debug] [MainThread]: Command end result
[0m21:35:51.557759 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:35:51.561760 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:35:51.569921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:35:51.570721 [info ] [MainThread]: 
[0m21:35:51.571704 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m21:35:51.572374 [info ] [MainThread]: 
[0m21:35:51.573290 [error] [MainThread]: [31mFailure in test not_null_staging_cities_id (models/schema.yml)[0m
[0m21:35:51.574375 [error] [MainThread]:   Database Error in test not_null_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:35:51.575380 [info ] [MainThread]: 
[0m21:35:51.576025 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/not_null_staging_cities_id.sql
[0m21:35:51.576860 [info ] [MainThread]: 
[0m21:35:51.578335 [error] [MainThread]: [31mFailure in test not_null_staging_air_pollution_city_id (models/schema.yml)[0m
[0m21:35:51.579323 [error] [MainThread]:   Database Error in test not_null_staging_air_pollution_city_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:35:51.580031 [info ] [MainThread]: 
[0m21:35:51.580734 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/not_null_staging_air_pollution_city_id.sql
[0m21:35:51.581816 [info ] [MainThread]: 
[0m21:35:51.583017 [error] [MainThread]: [31mFailure in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)[0m
[0m21:35:51.584320 [error] [MainThread]:   Database Error in test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_air_pollution was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:35:51.585477 [info ] [MainThread]: 
[0m21:35:51.586293 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_staging_air_po_5e9403d28ae0fefa935f2291a523dc40.sql
[0m21:35:51.587189 [info ] [MainThread]: 
[0m21:35:51.588205 [error] [MainThread]: [31mFailure in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)[0m
[0m21:35:51.589008 [error] [MainThread]:   Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:35:51.590058 [info ] [MainThread]: 
[0m21:35:51.590912 [error] [MainThread]: [31mFailure in test test_is_float (tests/test_is_float.sql)[0m
[0m21:35:51.591587 [error] [MainThread]:   Database Error in test test_is_float (tests/test_is_float.sql)
  Syntax error: Unexpected ")" at [14:5]
  compiled code at target/run/france_air_pollution/tests/test_is_float.sql
[0m21:35:51.592440 [info ] [MainThread]: 
[0m21:35:51.593409 [error] [MainThread]: [31mFailure in test unique_staging_cities_id (models/schema.yml)[0m
[0m21:35:51.594096 [error] [MainThread]:   Database Error in test unique_staging_cities_id (models/schema.yml)
  Not found: Table paris-air-pollution-quangnc:production.staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:35:51.595032 [info ] [MainThread]: 
[0m21:35:51.595806 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/unique_staging_cities_id.sql
[0m21:35:51.596538 [info ] [MainThread]: 
[0m21:35:51.597242 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=8
[0m21:35:51.599809 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.4184303, "process_in_blocks": "0", "process_kernel_time": 1.564372, "process_mem_max_rss": "372376", "process_out_blocks": "0", "process_user_time": 3.883201}
[0m21:35:51.601429 [debug] [MainThread]: Command `dbt test` failed at 21:35:51.601273 after 5.42 seconds
[0m21:35:51.602573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a1fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69182840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838eac00>]}
[0m21:35:51.603890 [debug] [MainThread]: Flushing usage events
[0m21:35:52.058680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:06.184422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df3ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e15ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e159820>]}


============================== 21:37:06.190859 | 3cbf3494-7cd5-4419-abfe-21ae716ac15b ==============================
[0m21:37:06.190859 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:37:06.192167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select airpollution --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:08.896874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645c87a0>]}
[0m21:37:08.932783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65ceadb0>]}
[0m21:37:08.933982 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:37:09.091367 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m21:37:09.168137 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:37:09.169275 [debug] [MainThread]: previous checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, current checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b
[0m21:37:09.169942 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:37:09.170830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7def1160>]}
[0m21:37:10.173636 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m21:37:10.271926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6355eea0>]}
[0m21:37:10.452573 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:37:10.457592 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:37:10.501087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6331b770>]}
[0m21:37:10.502445 [info ] [MainThread]: Found 4 models, 8 data tests, 2 sources, 494 macros
[0m21:37:10.503356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbf3494-7cd5-4419-abfe-21ae716ac15b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63580b00>]}
[0m21:37:10.504501 [warn ] [MainThread]: The selection criterion 'airpollution' does not match any enabled nodes
[0m21:37:10.506094 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:37:10.507248 [debug] [MainThread]: Command end result
[0m21:37:10.588178 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:37:10.592027 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:37:10.597674 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:37:10.601621 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.454966, "process_in_blocks": "0", "process_kernel_time": 1.71741, "process_mem_max_rss": "372280", "process_out_blocks": "0", "process_user_time": 4.162764}
[0m21:37:10.603781 [debug] [MainThread]: Command `dbt test` succeeded at 21:37:10.603501 after 4.46 seconds
[0m21:37:10.604749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5fb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63638f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff632ff2f0>]}
[0m21:37:10.605656 [debug] [MainThread]: Flushing usage events
[0m21:37:11.090357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:17.022854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1661820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6e4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6e75f0>]}


============================== 21:38:17.028682 | 25c30be9-d305-4e30-b0df-52dda19aecab ==============================
[0m21:38:17.028682 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:38:17.029743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select source:source.airpollution --target dev', 'send_anonymous_usage_stats': 'True'}
[0m21:38:19.642366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84733680>]}
[0m21:38:19.677460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00d4e60>]}
[0m21:38:19.679719 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:38:19.858310 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m21:38:20.053556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:38:20.054813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:38:20.088871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ff6180>]}
[0m21:38:20.206968 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:38:20.211346 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:38:20.239275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f09010>]}
[0m21:38:20.240217 [info ] [MainThread]: Found 4 models, 8 data tests, 2 sources, 494 macros
[0m21:38:20.241162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84486d80>]}
[0m21:38:20.243329 [info ] [MainThread]: 
[0m21:38:20.244096 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:38:20.244852 [info ] [MainThread]: 
[0m21:38:20.246375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:38:20.249746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m21:38:20.250385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:20.586082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c30be9-d305-4e30-b0df-52dda19aecab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83edce90>]}
[0m21:38:20.587121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:20.592286 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:38:20.592621 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:38:20.594282 [info ] [Thread-2 (]: 2 of 2 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:38:20.593162 [info ] [Thread-1 (]: 1 of 2 START test source_not_null_source_airpollution_City_Index ............... [RUN]
[0m21:38:20.596939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc)
[0m21:38:20.596102 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52'
[0m21:38:20.597661 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:38:20.598428 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:38:20.735929 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:38:20.736582 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:38:20.741307 [debug] [Thread-2 (]: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:38:20.742644 [error] [Thread-2 (]: 2 of 2 ERROR source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[31mERROR[0m in 0.15s]
[0m21:38:20.745415 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:38:20.746063 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:38:20.759579 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:38:20.764369 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:38:20.768163 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:38:20.768992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:21.363358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:00e03168-2038-4284-a593-2a5dc06cb2a3&page=queryresults
[0m21:38:21.806563 [info ] [Thread-1 (]: 1 of 2 PASS source_not_null_source_airpollution_City_Index ..................... [[32mPASS[0m in 1.21s]
[0m21:38:21.808028 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:38:21.810115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:21.813366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:21.814759 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc' was properly closed.
[0m21:38:21.815676 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52' was properly closed.
[0m21:38:21.816655 [info ] [MainThread]: 
[0m21:38:21.817522 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m21:38:21.819073 [debug] [MainThread]: Command end result
[0m21:38:21.905901 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:38:21.909108 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:38:21.915141 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:38:21.915753 [info ] [MainThread]: 
[0m21:38:21.916624 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:21.917940 [info ] [MainThread]: 
[0m21:38:21.918778 [error] [MainThread]: [31mFailure in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)[0m
[0m21:38:21.920245 [error] [MainThread]:   Compilation Error in test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64 (models/sources.yml)
  'test_test_is_float' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:38:21.921264 [info ] [MainThread]: 
[0m21:38:21.922177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m21:38:21.924688 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.9387856, "process_in_blocks": "0", "process_kernel_time": 1.575337, "process_mem_max_rss": "371004", "process_out_blocks": "0", "process_user_time": 3.265149}
[0m21:38:21.925650 [debug] [MainThread]: Command `dbt test` failed at 21:38:21.925549 after 4.94 seconds
[0m21:38:21.926587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8487d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e227d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d83c200>]}
[0m21:38:21.927397 [debug] [MainThread]: Flushing usage events
[0m21:38:22.451354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:57.984867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fce6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d77ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4bbf80>]}


============================== 21:40:57.990917 | 4702ae33-1391-471f-a08d-6d7a785f7969 ==============================
[0m21:40:57.990917 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:40:57.991970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select source:source.airpollution --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:41:00.751842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e2dac0>]}
[0m21:41:00.788357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd112e0>]}
[0m21:41:00.789616 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:41:01.040287 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m21:41:01.154882 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:41:01.156167 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_is_float.sql
[0m21:41:01.156942 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://tests/test_is_float.sql
[0m21:41:01.220500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845092e0>]}
[0m21:41:01.351109 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:41:01.358094 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:41:01.612082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a66690>]}
[0m21:41:01.617548 [info ] [MainThread]: Found 4 models, 7 data tests, 2 sources, 495 macros
[0m21:41:01.620776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd10a70>]}
[0m21:41:01.624668 [info ] [MainThread]: 
[0m21:41:01.628229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:01.630885 [info ] [MainThread]: 
[0m21:41:01.633711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:41:01.644428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m21:41:01.646331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:02.127525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4702ae33-1391-471f-a08d-6d7a785f7969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f008f0>]}
[0m21:41:02.130506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:02.159931 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:41:02.160684 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:41:02.161766 [info ] [Thread-1 (]: 1 of 2 START test source_not_null_source_airpollution_City_Index ............... [RUN]
[0m21:41:02.164196 [info ] [Thread-2 (]: 2 of 2 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:41:02.167431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc)
[0m21:41:02.177533 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:41:02.172983 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52'
[0m21:41:02.196799 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:41:02.204177 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:41:02.209384 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:41:02.215592 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:41:02.216230 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:41:02.231784 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:41:02.233435 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:41:02.237778 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:41:02.238913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:02.241338 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Carbon_Monoxide_CO')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:41:02.243667 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:02.747332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3c70885d-ff04-4b06-aa24-0783bb355235&page=queryresults
[0m21:41:03.276264 [info ] [Thread-1 (]: 1 of 2 PASS source_not_null_source_airpollution_City_Index ..................... [[32mPASS[0m in 1.11s]
[0m21:41:03.278877 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:41:03.404482 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4f503dd4-8f59-4c35-9628-1b0e76a36510&page=queryresults
[0m21:41:03.829941 [info ] [Thread-2 (]: 2 of 2 PASS source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[32mPASS[0m in 1.66s]
[0m21:41:03.832823 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:41:03.844868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:03.850766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:03.851867 [debug] [MainThread]: Connection 'test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc' was properly closed.
[0m21:41:03.853149 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52' was properly closed.
[0m21:41:03.854559 [info ] [MainThread]: 
[0m21:41:03.855873 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m21:41:03.858119 [debug] [MainThread]: Command end result
[0m21:41:03.953128 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:41:03.958136 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:41:03.968434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:41:03.972918 [info ] [MainThread]: 
[0m21:41:03.975830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:03.978760 [info ] [MainThread]: 
[0m21:41:03.980441 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:41:03.985000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.0383973, "process_in_blocks": "0", "process_kernel_time": 1.850089, "process_mem_max_rss": "370636", "process_out_blocks": "0", "process_user_time": 3.611534}
[0m21:41:03.987445 [debug] [MainThread]: Command `dbt test` succeeded at 21:41:03.986533 after 6.04 seconds
[0m21:41:03.989356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5a0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f00710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84063c80>]}
[0m21:41:03.994069 [debug] [MainThread]: Flushing usage events
[0m21:41:04.515008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:36.185353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6f59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0e8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb7fc20>]}


============================== 21:46:36.190176 | d3b0eb60-0046-482a-ba2e-005548017077 ==============================
[0m21:46:36.190176 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:46:36.191354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select source:source.airpollution --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:46:39.014379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b1df40>]}
[0m21:46:39.051865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ceb230>]}
[0m21:46:39.053183 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:46:39.215565 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m21:46:39.326266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:39.327556 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/sources.yml
[0m21:46:39.750839 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m21:46:39.893000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bd3200>]}
[0m21:46:40.006202 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:46:40.010126 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:46:40.043157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ba42f0>]}
[0m21:46:40.044162 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 495 macros
[0m21:46:40.045131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70df2930>]}
[0m21:46:40.047445 [info ] [MainThread]: 
[0m21:46:40.048308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:46:40.049186 [info ] [MainThread]: 
[0m21:46:40.050430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:40.053535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m21:46:40.054294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:40.371426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b0eb60-0046-482a-ba2e-005548017077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d7d4c0>]}
[0m21:46:40.372539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:40.377382 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:46:40.377778 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:46:40.378208 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:46:40.378870 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:46:40.378550 [info ] [Thread-1 (]: 1 of 9 START test source_not_null_source_airpollution_City_Index ............... [RUN]
[0m21:46:40.380340 [info ] [Thread-2 (]: 2 of 9 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:46:40.381208 [info ] [Thread-3 (]: 3 of 9 START test source_test_is_float_source_airpollution_NH3__float64 ........ [RUN]
[0m21:46:40.382270 [info ] [Thread-4 (]: 4 of 9 START test source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64  [RUN]
[0m21:46:40.385952 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450'
[0m21:46:40.384247 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52'
[0m21:46:40.385079 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d'
[0m21:46:40.383177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc)
[0m21:46:40.386785 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:46:40.387445 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:46:40.388222 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:46:40.388884 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:46:40.395621 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"
[0m21:46:40.398653 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:46:40.403067 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"
[0m21:46:40.409186 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:46:40.414253 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:46:40.432700 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:46:40.433337 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"
[0m21:46:40.435541 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"
[0m21:46:40.435953 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:46:40.440130 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:46:40.436530 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:46:40.445317 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Nitric_Oxide_NO')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:40.447850 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:46:40.453457 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('NH3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:40.458048 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:46:40.456400 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:46:40.459759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:40.453839 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:46:40.494418 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Carbon_Monoxide_CO')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:40.529837 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:46:41.011087 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5ef2b1be-1741-4448-8b37-b73fd72099e3&page=queryresults
[0m21:46:41.121335 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d3d71cd2-cfe0-49bf-afdd-9ecc20759020&page=queryresults
[0m21:46:41.145317 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d3a38435-7b4d-416c-88f6-3d03a06d5c6b&page=queryresults
[0m21:46:41.171729 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1718757c-f577-42f6-bc9d-205e79bd20de&page=queryresults
[0m21:46:41.477444 [info ] [Thread-4 (]: 4 of 9 PASS source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64 .. [[32mPASS[0m in 1.09s]
[0m21:46:41.478777 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:46:41.479674 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:46:41.480455 [info ] [Thread-4 (]: 5 of 9 START test source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64  [RUN]
[0m21:46:41.481583 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450, now test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca)
[0m21:46:41.482339 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:46:41.486561 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"
[0m21:46:41.490899 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:46:41.493736 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"
[0m21:46:41.496597 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Nitrogen_Dioxide_NO2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:41.497544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:46:41.534093 [info ] [Thread-3 (]: 3 of 9 PASS source_test_is_float_source_airpollution_NH3__float64 .............. [[32mPASS[0m in 1.15s]
[0m21:46:41.535303 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:46:41.537335 [info ] [Thread-1 (]: 1 of 9 PASS source_not_null_source_airpollution_City_Index ..................... [[32mPASS[0m in 1.15s]
[0m21:46:41.537969 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:46:41.539416 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:46:41.540238 [info ] [Thread-3 (]: 6 of 9 START test source_test_is_float_source_airpollution_Ozone_O3__float64 ... [RUN]
[0m21:46:41.541309 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:46:41.542208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d, now test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107)
[0m21:46:41.544003 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:46:41.548296 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"
[0m21:46:41.543032 [info ] [Thread-1 (]: 7 of 9 START test source_test_is_float_source_airpollution_PM10__float64 ....... [RUN]
[0m21:46:41.551071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc, now test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d)
[0m21:46:41.551938 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:46:41.555062 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"
[0m21:46:41.555746 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:46:41.561414 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"
[0m21:46:41.563558 [info ] [Thread-2 (]: 2 of 9 PASS source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[32mPASS[0m in 1.18s]
[0m21:46:41.576528 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:46:41.578229 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:46:41.579200 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Ozone_O3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:41.583599 [info ] [Thread-2 (]: 8 of 9 START test source_test_is_float_source_airpollution_PM2_5__float64 ...... [RUN]
[0m21:46:41.591161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52, now test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247)
[0m21:46:41.593315 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:46:41.584703 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:46:41.589827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:41.599761 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"
[0m21:46:41.601796 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"
[0m21:46:41.639942 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:46:41.644014 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"
[0m21:46:41.645794 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('PM10')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:41.646875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:41.647426 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('PM2_5')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:41.649437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:42.284861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d716465d-554b-40e5-b3ed-b702f90ddc9e&page=queryresults
[0m21:46:42.286516 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c3f82194-f6a7-4f5f-b1d3-dacd0b772714&page=queryresults
[0m21:46:42.287051 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7bd5f775-f81d-4549-87d4-e63b09ae1ed1&page=queryresults
[0m21:46:42.287523 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4abb9366-940b-4819-9055-b50357ce392a&page=queryresults
[0m21:46:42.624783 [info ] [Thread-4 (]: 5 of 9 PASS source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64  [[32mPASS[0m in 1.14s]
[0m21:46:42.625927 [info ] [Thread-2 (]: 8 of 9 PASS source_test_is_float_source_airpollution_PM2_5__float64 ............ [[32mPASS[0m in 1.03s]
[0m21:46:42.636847 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:46:42.635143 [info ] [Thread-1 (]: 7 of 9 PASS source_test_is_float_source_airpollution_PM10__float64 ............. [[32mPASS[0m in 1.08s]
[0m21:46:42.641130 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:46:42.638215 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:46:42.629942 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:46:42.645096 [info ] [Thread-2 (]: 9 of 9 START test source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64  [RUN]
[0m21:46:42.666706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247, now test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185)
[0m21:46:42.671798 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:46:42.674454 [info ] [Thread-3 (]: 6 of 9 PASS source_test_is_float_source_airpollution_Ozone_O3__float64 ......... [[32mPASS[0m in 1.13s]
[0m21:46:42.693976 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:46:42.699847 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"
[0m21:46:42.707390 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:46:42.711690 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"
[0m21:46:42.716847 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Sulfur_Dioxide_SO2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:46:42.718036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:44.097547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b5523503-1422-42f2-898a-922e482b9957&page=queryresults
[0m21:46:44.481167 [info ] [Thread-2 (]: 9 of 9 PASS source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64  [[32mPASS[0m in 1.81s]
[0m21:46:44.483970 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:46:44.490295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:44.497949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:44.499541 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d' was properly closed.
[0m21:46:44.501067 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185' was properly closed.
[0m21:46:44.502195 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107' was properly closed.
[0m21:46:44.503204 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca' was properly closed.
[0m21:46:44.504536 [info ] [MainThread]: 
[0m21:46:44.505811 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m21:46:44.508736 [debug] [MainThread]: Command end result
[0m21:46:44.641534 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:46:44.648373 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:46:44.660375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:46:44.661125 [info ] [MainThread]: 
[0m21:46:44.662311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:46:44.663583 [info ] [MainThread]: 
[0m21:46:44.664607 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m21:46:44.670872 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.533492, "process_in_blocks": "0", "process_kernel_time": 1.935444, "process_mem_max_rss": "377412", "process_out_blocks": "0", "process_user_time": 4.365547}
[0m21:46:44.672721 [debug] [MainThread]: Command `dbt test` succeeded at 21:46:44.672547 after 8.54 seconds
[0m21:46:44.674808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bcd6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b1f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716106e0>]}
[0m21:46:44.678438 [debug] [MainThread]: Flushing usage events
[0m21:46:45.152726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:17.097353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b4be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1746150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d59ee0>]}


============================== 21:49:17.103243 | 2f145163-e38f-4964-8a5d-7cb30ad3b38d ==============================
[0m21:49:17.103243 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:49:17.104400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select source:source --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:49:19.849337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20f4650>]}
[0m21:49:19.898176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981f2060>]}
[0m21:49:19.900075 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:49:20.193022 [debug] [MainThread]: checksum: 8d17e20b047c2e6e611598fc0572c4ee349b7557100a95ba6d82c97dad848265, vars: {}, profile: , target: dev, version: 1.10.2
[0m21:49:20.300300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:20.301476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:20.335760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980045f0>]}
[0m21:49:20.591847 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:49:20.594965 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:49:20.620270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980e3cb0>]}
[0m21:49:20.621133 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 495 macros
[0m21:49:20.622334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981bfa10>]}
[0m21:49:20.623993 [info ] [MainThread]: 
[0m21:49:20.624812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:49:20.625701 [info ] [MainThread]: 
[0m21:49:20.627055 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:49:20.632876 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m21:49:20.634172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:20.910337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f145163-e38f-4964-8a5d-7cb30ad3b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97da4470>]}
[0m21:49:20.911478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:20.918340 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:49:20.918712 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m21:49:20.919060 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:49:20.919424 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m21:49:20.919832 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_source_airpollution_City_Index .............. [RUN]
[0m21:49:20.920780 [info ] [Thread-2 (]: 2 of 13 START test source_not_null_source_cities_city .......................... [RUN]
[0m21:49:20.924539 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a'
[0m21:49:20.922506 [info ] [Thread-4 (]: 4 of 13 START test source_not_null_source_cities_latitude ...................... [RUN]
[0m21:49:20.926111 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5'
[0m21:49:20.921712 [info ] [Thread-3 (]: 3 of 13 START test source_not_null_source_cities_city_index .................... [RUN]
[0m21:49:20.925288 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m21:49:20.923579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc)
[0m21:49:20.926832 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m21:49:20.951950 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m21:49:20.940792 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m21:49:20.945597 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:49:20.927595 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103'
[0m21:49:20.958330 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:49:20.959376 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:49:20.959937 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m21:49:20.961257 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m21:49:20.966126 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:49:20.977920 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:49:20.989228 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m21:49:20.992884 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m21:49:20.995299 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"
[0m21:49:20.995707 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:49:21.002055 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m21:49:21.018516 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m21:49:21.023064 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:49:21.027703 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m21:49:21.030507 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:49:21.065890 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m21:49:21.072983 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select City_Index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where City_Index is null



  
  
      
    ) dbt_internal_test
[0m21:49:21.119868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:49:21.122236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:21.545498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c099472e-b010-49cc-961c-c9ca53f0250c&page=queryresults
[0m21:49:21.652670 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:23ce148b-8776-43b0-a7f2-ef0249068662&page=queryresults
[0m21:49:21.696799 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0eb775ac-3ae7-4f65-842f-778c7c3218b7&page=queryresults
[0m21:49:21.888998 [info ] [Thread-1 (]: 1 of 13 PASS source_not_null_source_airpollution_City_Index .................... [[32mPASS[0m in 0.97s]
[0m21:49:21.890378 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc
[0m21:49:21.891355 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m21:49:21.892121 [info ] [Thread-1 (]: 5 of 13 START test source_not_null_source_cities_longitude ..................... [RUN]
[0m21:49:21.893008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_City_Index.def7f44bdc, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m21:49:21.893771 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m21:49:21.898453 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m21:49:21.901031 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m21:49:21.905994 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m21:49:21.909773 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m21:49:21.910500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:21.984523 [info ] [Thread-2 (]: 2 of 13 PASS source_not_null_source_cities_city ................................ [[32mPASS[0m in 1.06s]
[0m21:49:21.985879 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m21:49:21.992528 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:49:21.995318 [info ] [Thread-2 (]: 6 of 13 START test source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [RUN]
[0m21:49:21.996989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52)
[0m21:49:21.999125 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:49:22.005639 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:49:22.022417 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:49:22.025346 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"
[0m21:49:22.029127 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Carbon_Monoxide_CO')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:22.030725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:49:22.066850 [info ] [Thread-3 (]: 3 of 13 PASS source_not_null_source_cities_city_index .......................... [[32mPASS[0m in 1.14s]
[0m21:49:22.120547 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m21:49:22.153702 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:beaeaa09-def6-4017-b3b2-cb94945c1345&page=queryresults
[0m21:49:22.155943 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:49:22.175843 [info ] [Thread-3 (]: 7 of 13 START test source_test_is_float_source_airpollution_NH3__float64 ....... [RUN]
[0m21:49:22.178693 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d)
[0m21:49:22.180051 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:49:22.185162 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"
[0m21:49:22.189946 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:49:22.192355 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"
[0m21:49:22.195041 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('NH3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:22.195803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:49:22.483150 [info ] [Thread-4 (]: 4 of 13 PASS source_not_null_source_cities_latitude ............................ [[32mPASS[0m in 1.56s]
[0m21:49:22.484415 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m21:49:22.487557 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:49:22.488435 [info ] [Thread-4 (]: 8 of 13 START test source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64  [RUN]
[0m21:49:22.489554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450)
[0m21:49:22.490703 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:49:22.494933 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"
[0m21:49:22.497786 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:49:22.500167 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"
[0m21:49:22.502317 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Nitric_Oxide_NO')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:22.502903 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:49:22.601536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:09b27847-3dc6-42ab-9362-b93f790a0d76&page=queryresults
[0m21:49:22.667855 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3e72376a-d516-40b0-8952-c918047bf807&page=queryresults
[0m21:49:22.765895 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:753758d1-1060-481b-9e60-28b33d166011&page=queryresults
[0m21:49:22.913599 [info ] [Thread-1 (]: 5 of 13 PASS source_not_null_source_cities_longitude ........................... [[32mPASS[0m in 1.02s]
[0m21:49:22.914986 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m21:49:22.915830 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:49:22.916596 [info ] [Thread-1 (]: 9 of 13 START test source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64  [RUN]
[0m21:49:22.917315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca)
[0m21:49:22.918142 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:49:22.921538 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"
[0m21:49:22.925828 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:49:22.928259 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"
[0m21:49:22.930796 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Nitrogen_Dioxide_NO2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:22.931785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:22.971674 [info ] [Thread-2 (]: 6 of 13 PASS source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64  [[32mPASS[0m in 0.97s]
[0m21:49:22.972953 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52
[0m21:49:22.974214 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:49:22.975079 [info ] [Thread-2 (]: 10 of 13 START test source_test_is_float_source_airpollution_Ozone_O3__float64 . [RUN]
[0m21:49:22.976168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Carbon_Monoxide_CO__float64.c03c734f52, now test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107)
[0m21:49:22.976969 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:49:22.982411 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"
[0m21:49:22.986848 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:49:22.989147 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"
[0m21:49:22.991812 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Ozone_O3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:22.992637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:49:23.029800 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d45a3cc-b74c-4646-9b8c-caf4134ac677&page=queryresults
[0m21:49:23.098051 [info ] [Thread-3 (]: 7 of 13 PASS source_test_is_float_source_airpollution_NH3__float64 ............. [[32mPASS[0m in 0.92s]
[0m21:49:23.099410 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d
[0m21:49:23.100708 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:49:23.101445 [info ] [Thread-3 (]: 11 of 13 START test source_test_is_float_source_airpollution_PM10__float64 ..... [RUN]
[0m21:49:23.102235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_NH3__float64.f62ed7e30d, now test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d)
[0m21:49:23.103039 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:49:23.106916 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"
[0m21:49:23.110690 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:49:23.112947 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"
[0m21:49:23.115669 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('PM10')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:23.116752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:49:23.350065 [info ] [Thread-4 (]: 8 of 13 PASS source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64 . [[32mPASS[0m in 0.86s]
[0m21:49:23.351348 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450
[0m21:49:23.352193 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:49:23.352977 [info ] [Thread-4 (]: 12 of 13 START test source_test_is_float_source_airpollution_PM2_5__float64 .... [RUN]
[0m21:49:23.353940 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Nitric_Oxide_NO__float64.a85e219450, now test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247)
[0m21:49:23.354702 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:49:23.357990 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"
[0m21:49:23.360567 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:49:23.363182 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"
[0m21:49:23.369078 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('PM2_5')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:23.370368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:49:23.491743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b0d6b657-d5af-4174-ad33-62d59b71d4fd&page=queryresults
[0m21:49:23.535677 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f2f80690-862c-4991-98a2-8e146d710d02&page=queryresults
[0m21:49:23.616325 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:54cc10bf-e661-45a7-8804-c956096f41c3&page=queryresults
[0m21:49:23.780543 [info ] [Thread-1 (]: 9 of 13 PASS source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64  [[32mPASS[0m in 0.86s]
[0m21:49:23.781708 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca
[0m21:49:23.782451 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:49:23.783045 [info ] [Thread-1 (]: 13 of 13 START test source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64  [RUN]
[0m21:49:23.783883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_Nitrogen_Dioxide_NO2__float64.6250180cca, now test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185)
[0m21:49:23.784734 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:49:23.787971 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"
[0m21:49:23.791251 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:49:23.795132 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"
[0m21:49:23.798662 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('Sulfur_Dioxide_SO2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m21:49:23.799506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:23.837544 [info ] [Thread-2 (]: 10 of 13 PASS source_test_is_float_source_airpollution_Ozone_O3__float64 ....... [[32mPASS[0m in 0.86s]
[0m21:49:23.839656 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107
[0m21:49:23.901971 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:933b4e51-e2a0-4701-ab7b-c1bd2a5be64e&page=queryresults
[0m21:49:23.938439 [info ] [Thread-3 (]: 11 of 13 PASS source_test_is_float_source_airpollution_PM10__float64 ........... [[32mPASS[0m in 0.84s]
[0m21:49:23.939839 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d
[0m21:49:24.260289 [info ] [Thread-4 (]: 12 of 13 PASS source_test_is_float_source_airpollution_PM2_5__float64 .......... [[32mPASS[0m in 0.91s]
[0m21:49:24.265689 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247
[0m21:49:24.361687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8043d482-95d3-4fd6-b989-45118f127b6e&page=queryresults
[0m21:49:24.666985 [info ] [Thread-1 (]: 13 of 13 PASS source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64  [[32mPASS[0m in 0.88s]
[0m21:49:24.669209 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185
[0m21:49:24.672352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:24.675087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:24.675993 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Sulfur_Dioxide_SO2__float64.b384f74185' was properly closed.
[0m21:49:24.676666 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_Ozone_O3__float64.ef3f536107' was properly closed.
[0m21:49:24.677465 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_PM2_5__float64.44ad669247' was properly closed.
[0m21:49:24.678238 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_PM10__float64.960a0e603d' was properly closed.
[0m21:49:24.679115 [info ] [MainThread]: 
[0m21:49:24.679950 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m21:49:24.682152 [debug] [MainThread]: Command end result
[0m21:49:24.764197 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m21:49:24.768462 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m21:49:24.777802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m21:49:24.778550 [info ] [MainThread]: 
[0m21:49:24.779329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:24.780065 [info ] [MainThread]: 
[0m21:49:24.780878 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m21:49:24.783592 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.7355022, "process_in_blocks": "0", "process_kernel_time": 1.705022, "process_mem_max_rss": "371752", "process_out_blocks": "0", "process_user_time": 4.050983}
[0m21:49:24.784557 [debug] [MainThread]: Command `dbt test` succeeded at 21:49:24.784411 after 7.74 seconds
[0m21:49:24.785359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb226b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb226abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77dd6e70>]}
[0m21:49:24.786376 [debug] [MainThread]: Flushing usage events
[0m21:49:25.268724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:04.504872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24a3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa244be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ba5d30>]}


============================== 22:53:04.511479 | 4e7be08e-fb9f-48ea-bb08-7f2652594dcf ==============================
[0m22:53:04.511479 [info ] [MainThread]: Running with dbt=1.10.3
[0m22:53:04.512382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select source:source --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:08.658370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b53f20>]}
[0m22:53:08.696035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891c5880>]}
[0m22:53:08.697716 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:53:08.962189 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m22:53:09.049269 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:53:09.050342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8862abd0>]}
[0m22:53:10.147525 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m22:53:10.220299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83939040>]}
[0m22:53:10.331384 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m22:53:10.335709 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m22:53:10.373476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838ee420>]}
[0m22:53:10.374642 [info ] [MainThread]: Found 4 models, 26 data tests, 2 sources, 495 macros
[0m22:53:10.375849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83832630>]}
[0m22:53:10.379140 [info ] [MainThread]: 
[0m22:53:10.380392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:10.381674 [info ] [MainThread]: 
[0m22:53:10.383490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:53:10.388702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m22:53:10.389691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:10.732914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7be08e-fb9f-48ea-bb08-7f2652594dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8397fe90>]}
[0m22:53:10.734706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:10.746889 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m22:53:10.747522 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m22:53:10.748099 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m22:53:10.749031 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m22:53:10.752236 [info ] [Thread-4 (]: 4 of 22 START test source_not_null_source_airpollution_nitric_oxide_no ......... [RUN]
[0m22:53:10.750472 [info ] [Thread-2 (]: 2 of 22 START test source_not_null_source_airpollution_city_index .............. [RUN]
[0m22:53:10.751385 [info ] [Thread-3 (]: 3 of 22 START test source_not_null_source_airpollution_nh3 ..................... [RUN]
[0m22:53:10.755673 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb'
[0m22:53:10.753373 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20'
[0m22:53:10.754618 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6'
[0m22:53:10.749408 [info ] [Thread-1 (]: 1 of 22 START test source_not_null_source_airpollution_carbon_monoxide_co ...... [RUN]
[0m22:53:10.756465 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m22:53:10.757264 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m22:53:10.758098 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m22:53:10.783497 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m22:53:10.777434 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m22:53:10.778752 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m22:53:10.758949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m22:53:10.788091 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m22:53:10.792851 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m22:53:10.793321 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m22:53:10.793708 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m22:53:10.824173 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m22:53:10.806288 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m22:53:10.822252 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m22:53:10.824585 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m22:53:10.828103 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m22:53:10.834045 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m22:53:10.835904 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m22:53:10.837122 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:53:10.840044 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m22:53:10.875481 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:53:10.877099 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m22:53:10.879742 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:10.880297 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m22:53:10.918009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:11.479989 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6c47fc80-ef02-42ae-a697-b0eb29af5b25&page=queryresults
[0m22:53:11.482087 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f9504da6-9cf2-4216-ad58-124e30b78aaf&page=queryresults
[0m22:53:11.502200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:91c5ec33-f900-4cb7-8dcd-ecf5037ede68&page=queryresults
[0m22:53:11.546733 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dfe0d6b3-d625-426b-adb5-7c64c6e2957f&page=queryresults
[0m22:53:11.990830 [info ] [Thread-2 (]: 2 of 22 PASS source_not_null_source_airpollution_city_index .................... [[32mPASS[0m in 1.24s]
[0m22:53:11.992260 [info ] [Thread-3 (]: 3 of 22 PASS source_not_null_source_airpollution_nh3 ........................... [[32mPASS[0m in 1.24s]
[0m22:53:12.005776 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m22:53:11.996687 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m22:53:12.008144 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m22:53:11.993702 [info ] [Thread-4 (]: 4 of 22 PASS source_not_null_source_airpollution_nitric_oxide_no ............... [[32mPASS[0m in 1.24s]
[0m22:53:12.010096 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m22:53:12.000121 [info ] [Thread-1 (]: 1 of 22 PASS source_not_null_source_airpollution_carbon_monoxide_co ............ [[32mPASS[0m in 1.24s]
[0m22:53:12.012844 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m22:53:12.007068 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m22:53:12.011824 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m22:53:12.009020 [info ] [Thread-2 (]: 6 of 22 START test source_not_null_source_airpollution_ozone_o3 ................ [RUN]
[0m22:53:12.013598 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m22:53:12.014546 [info ] [Thread-3 (]: 5 of 22 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 .... [RUN]
[0m22:53:12.015734 [info ] [Thread-4 (]: 7 of 22 START test source_not_null_source_airpollution_pm10 .................... [RUN]
[0m22:53:12.017128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m22:53:12.017956 [info ] [Thread-1 (]: 8 of 22 START test source_not_null_source_airpollution_pm2_5 ................... [RUN]
[0m22:53:12.021562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m22:53:12.019564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m22:53:12.020300 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m22:53:12.018821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m22:53:12.022393 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m22:53:12.023221 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m22:53:12.028085 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m22:53:12.029458 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m22:53:12.042090 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m22:53:12.036661 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m22:53:12.033165 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m22:53:12.043461 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m22:53:12.047117 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m22:53:12.048207 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m22:53:12.051652 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m22:53:12.049337 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m22:53:12.054550 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m22:53:12.062923 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m22:53:12.059692 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m22:53:12.056230 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m22:53:12.064845 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m22:53:12.065340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:12.067399 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:12.139222 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m22:53:12.141510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:12.140721 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m22:53:12.151377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:53:12.710744 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be391498-8f39-4103-9fbb-02f5f351b543&page=queryresults
[0m22:53:12.711515 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0273ead2-1960-4e80-b5f0-2f82cead0bc9&page=queryresults
[0m22:53:12.725066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e094223b-43bd-42c3-b699-ebcf201cd875&page=queryresults
[0m22:53:12.727385 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b1bb5db3-d1c1-448d-808c-fe4f99c0146f&page=queryresults
[0m22:53:13.039345 [info ] [Thread-2 (]: 6 of 22 PASS source_not_null_source_airpollution_ozone_o3 ...................... [[32mPASS[0m in 1.02s]
[0m22:53:13.044334 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m22:53:13.046100 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m22:53:13.049287 [info ] [Thread-2 (]: 9 of 22 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ...... [RUN]
[0m22:53:13.051125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m22:53:13.052259 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m22:53:13.058186 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m22:53:13.060450 [info ] [Thread-1 (]: 8 of 22 PASS source_not_null_source_airpollution_pm2_5 ......................... [[32mPASS[0m in 1.04s]
[0m22:53:13.061434 [info ] [Thread-4 (]: 7 of 22 PASS source_not_null_source_airpollution_pm10 .......................... [[32mPASS[0m in 1.04s]
[0m22:53:13.063417 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m22:53:13.064212 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m22:53:13.062246 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m22:53:13.065119 [info ] [Thread-4 (]: 10 of 22 START test source_not_null_source_cities_city ......................... [RUN]
[0m22:53:13.064749 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m22:53:13.066683 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m22:53:13.071277 [info ] [Thread-1 (]: 11 of 22 START test source_not_null_source_cities_city_index ................... [RUN]
[0m22:53:13.070487 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m22:53:13.068047 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m22:53:13.072116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m22:53:13.074242 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m22:53:13.073482 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m22:53:13.077315 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m22:53:13.077675 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m22:53:13.081842 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m22:53:13.083642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:13.086261 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m22:53:13.089448 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m22:53:13.124133 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m22:53:13.125808 [info ] [Thread-3 (]: 5 of 22 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 .......... [[32mPASS[0m in 1.11s]
[0m22:53:13.130521 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m22:53:13.132836 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m22:53:13.134678 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m22:53:13.133352 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m22:53:13.135705 [info ] [Thread-3 (]: 12 of 22 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m22:53:13.138163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m22:53:13.137698 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m22:53:13.139753 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:13.138769 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m22:53:13.136809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:13.144260 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m22:53:13.216898 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m22:53:13.221423 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m22:53:13.224263 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m22:53:13.225116 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:53:13.674912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:08e346c4-783f-4320-9267-b6a4b08a997a&page=queryresults
[0m22:53:13.681940 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3c2c7e40-e0dd-4df9-85f3-1764d5b19d45&page=queryresults
[0m22:53:13.684083 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6a22e63d-3d83-424b-a4a3-e6acd41f9f9a&page=queryresults
[0m22:53:13.702533 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4a314048-2fa3-4826-b76a-3aa4b41cee43&page=queryresults
[0m22:53:13.989113 [info ] [Thread-2 (]: 9 of 22 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ............ [[32mPASS[0m in 0.94s]
[0m22:53:13.991470 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m22:53:13.990750 [info ] [Thread-3 (]: 12 of 22 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.85s]
[0m22:53:13.992268 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m22:53:13.993903 [info ] [Thread-2 (]: 13 of 22 START test source_not_null_source_cities_longitude .................... [RUN]
[0m22:53:13.993216 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m22:53:13.994942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m22:53:13.996951 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m22:53:13.996239 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m22:53:14.002320 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m22:53:14.014314 [info ] [Thread-1 (]: 11 of 22 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.93s]
[0m22:53:14.101667 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m22:53:14.095728 [info ] [Thread-4 (]: 10 of 22 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 1.03s]
[0m22:53:14.045078 [info ] [Thread-3 (]: 14 of 22 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m22:53:14.104984 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m22:53:14.112625 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m22:53:14.117473 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m22:53:14.118070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m22:53:14.119916 [info ] [Thread-1 (]: 15 of 22 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m22:53:14.122652 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m22:53:14.126440 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m22:53:14.127213 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m22:53:14.128083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m22:53:14.128833 [info ] [Thread-4 (]: 16 of 22 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m22:53:14.133947 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m22:53:14.135534 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m22:53:14.136019 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m22:53:14.141734 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m22:53:14.138153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:14.136936 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m22:53:14.143637 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m22:53:14.148786 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m22:53:14.144770 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m22:53:14.186177 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m22:53:14.186676 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m22:53:14.188741 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('carbon_monoxide_co')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:14.193842 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m22:53:14.195134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:53:14.195838 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m22:53:14.199274 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m22:53:14.233866 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('nh3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:14.234833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:14.270486 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('nitric_oxide_no')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:14.273666 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:14.644096 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3a4c620e-408c-4901-b069-fa47babb26ff&page=queryresults
[0m22:53:14.790495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:010f6511-1602-4281-ad50-23f9fb26997b&page=queryresults
[0m22:53:14.810577 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:faace49c-542e-44a4-afba-6ef8ed814d32&page=queryresults
[0m22:53:14.937113 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c2660682-904b-47b9-ae47-9b3d99d6d1f4&page=queryresults
[0m22:53:14.963719 [info ] [Thread-2 (]: 13 of 22 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.97s]
[0m22:53:14.964953 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m22:53:14.965968 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m22:53:14.967084 [info ] [Thread-2 (]: 17 of 22 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m22:53:14.967880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m22:53:14.968689 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m22:53:14.974737 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m22:53:14.979482 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m22:53:14.981684 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m22:53:14.984825 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('nitrogen_dioxide_no2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:14.986156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:15.126670 [info ] [Thread-1 (]: 15 of 22 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 1.00s]
[0m22:53:15.128046 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m22:53:15.128916 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m22:53:15.129712 [info ] [Thread-1 (]: 18 of 22 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m22:53:15.130571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m22:53:15.131340 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m22:53:15.134552 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m22:53:15.140222 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m22:53:15.142293 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m22:53:15.147896 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('ozone_o3')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:15.148743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:15.183863 [info ] [Thread-4 (]: 16 of 22 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 1.05s]
[0m22:53:15.185432 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m22:53:15.186301 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m22:53:15.187594 [info ] [Thread-4 (]: 19 of 22 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m22:53:15.189377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m22:53:15.190116 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m22:53:15.194236 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m22:53:15.197822 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m22:53:15.200544 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m22:53:15.203848 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('pm10')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:15.204555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:15.239745 [info ] [Thread-3 (]: 14 of 22 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.12s]
[0m22:53:15.240881 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m22:53:15.242451 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m22:53:15.243585 [info ] [Thread-3 (]: 20 of 22 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m22:53:15.244536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m22:53:15.245357 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m22:53:15.249178 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m22:53:15.254760 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m22:53:15.257443 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m22:53:15.261799 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('pm2_5')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:15.262629 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:53:15.562151 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bda97568-8d58-430c-818a-bad9fe926a5f&page=queryresults
[0m22:53:15.711536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4100b3a9-22a7-488a-952b-986743e41078&page=queryresults
[0m22:53:15.783259 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:355a308e-33f5-4896-b6bf-cce409dde118&page=queryresults
[0m22:53:15.827644 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ea0a7f65-da8b-450b-b4ee-0f4a58b9dd0d&page=queryresults
[0m22:53:15.875529 [info ] [Thread-2 (]: 17 of 22 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.91s]
[0m22:53:15.877077 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m22:53:15.878088 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m22:53:15.879125 [info ] [Thread-2 (]: 21 of 22 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m22:53:15.880289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m22:53:15.881066 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m22:53:15.886199 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m22:53:15.889074 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m22:53:15.891325 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m22:53:15.895787 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with actual_column as (
    select
        column_name,
        data_type
    from `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    where
        table_name = lower('airpollution')
        and column_name = lower('sulfur_dioxide_so2')
),

validation_errors as (
    select *
    from actual_column
    where lower(data_type) != lower('float64')
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m22:53:15.896642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:16.038745 [info ] [Thread-1 (]: 18 of 22 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 0.91s]
[0m22:53:16.041030 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m22:53:16.041890 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m22:53:16.042781 [info ] [Thread-1 (]: 22 of 22 START test source_unique_source_cities_city_index ..................... [RUN]
[0m22:53:16.043752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m22:53:16.044896 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m22:53:16.051248 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m22:53:16.054755 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m22:53:16.057140 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m22:53:16.060819 [debug] [Thread-1 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:53:16.061702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:16.101481 [info ] [Thread-4 (]: 19 of 22 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.91s]
[0m22:53:16.103552 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m22:53:16.212541 [info ] [Thread-3 (]: 20 of 22 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 0.97s]
[0m22:53:16.219505 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m22:53:16.503992 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2e5b18ec-8ed8-4867-bf04-79813d220607&page=queryresults
[0m22:53:16.589059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7d334fc3-a3f5-4555-8192-7aaa057571d3&page=queryresults
[0m22:53:16.804554 [info ] [Thread-2 (]: 21 of 22 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.92s]
[0m22:53:16.806229 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m22:53:16.895561 [info ] [Thread-1 (]: 22 of 22 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.85s]
[0m22:53:16.897026 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m22:53:16.900796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:16.905732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:16.906400 [debug] [MainThread]: Connection 'test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd' was properly closed.
[0m22:53:16.907127 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea' was properly closed.
[0m22:53:16.907839 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7' was properly closed.
[0m22:53:16.908818 [debug] [MainThread]: Connection 'test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0' was properly closed.
[0m22:53:16.909940 [info ] [MainThread]: 
[0m22:53:16.910867 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m22:53:16.914171 [debug] [MainThread]: Command end result
[0m22:53:17.003044 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m22:53:17.008739 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m22:53:17.018459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m22:53:17.019258 [info ] [MainThread]: 
[0m22:53:17.020104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:17.020866 [info ] [MainThread]: 
[0m22:53:17.022000 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m22:53:17.026335 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.567351, "process_in_blocks": "401008", "process_kernel_time": 2.837054, "process_mem_max_rss": "381808", "process_out_blocks": "0", "process_user_time": 5.749151}
[0m22:53:17.028101 [debug] [MainThread]: Command `dbt test` succeeded at 22:53:17.027940 after 12.57 seconds
[0m22:53:17.029389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1da43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b32c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88576300>]}
[0m22:53:17.030555 [debug] [MainThread]: Flushing usage events
[0m22:53:17.491467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:24.447079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81c2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba658500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81c1df0>]}


============================== 09:44:24.453220 | 540f71ae-6d5e-46d0-8c9d-bda4233d5bb9 ==============================
[0m09:44:24.453220 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:44:24.455412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select staging_air_pollution', 'send_anonymous_usage_stats': 'True'}
[0m09:44:27.267153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7f9fd0>]}
[0m09:44:27.318620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba25b530>]}
[0m09:44:27.320742 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:44:27.627470 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:44:27.713511 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:44:27.715194 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m09:44:27.716779 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:44:27.717772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8214f50>]}
[0m09:44:28.638459 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:44:28.728651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8308f0>]}
[0m09:44:28.857517 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:44:28.864768 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:44:28.898123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d76c890>]}
[0m09:44:28.899031 [info ] [MainThread]: Found 4 models, 28 data tests, 2 sources, 495 macros
[0m09:44:28.899925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5389e0>]}
[0m09:44:28.902038 [info ] [MainThread]: 
[0m09:44:28.902956 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:44:28.903660 [info ] [MainThread]: 
[0m09:44:28.904825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:44:28.908452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m09:44:28.909914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:29.269453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540f71ae-6d5e-46d0-8c9d-bda4233d5bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4dbb90>]}
[0m09:44:29.270584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:29.276467 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:44:29.276810 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:44:29.277155 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert
[0m09:44:29.279660 [info ] [Thread-3 (]: 3 of 4 START test test_last_datetime_insert .................................... [RUN]
[0m09:44:29.277870 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:44:29.278863 [info ] [Thread-2 (]: 2 of 4 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:44:29.282970 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:44:29.281391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:44:29.277475 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:44:29.280570 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert'
[0m09:44:29.284173 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:44:29.285030 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:44:29.286536 [info ] [Thread-4 (]: 4 of 4 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:44:29.308236 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:44:29.303882 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:44:29.307071 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:44:29.287466 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert
[0m09:44:29.309518 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:44:29.314027 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_last_datetime_insert"
[0m09:44:29.319347 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:44:29.319772 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:44:29.320791 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:29.337310 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:44:29.339245 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:44:29.341290 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_last_datetime_insert
[0m09:44:29.353913 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_last_datetime_insert"
[0m09:44:29.357181 [debug] [Thread-4 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:29.368595 [error] [Thread-4 (]: 4 of 4 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.06s]
[0m09:44:29.371093 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:44:29.357895 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:44:29.365967 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:44:29.372202 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:44:29.372604 [debug] [Thread-3 (]: On test.france_air_pollution.test_last_datetime_insert: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.test_last_datetime_insert"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)
  
  
      
    ) dbt_internal_test
[0m09:44:29.387289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:29.383263 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:29.379307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:29.947229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1a37094-32b4-472e-9fa2-2a57c164277c&page=queryresults
[0m09:44:30.097584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fc5fe29a-3ffd-4a2f-9898-d6adcc2c4e9b&page=queryresults
[0m09:44:30.249478 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:66b5afce-40a7-46b7-9a26-76062e37f644&page=queryresults
[0m09:44:30.523524 [info ] [Thread-2 (]: 2 of 4 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.24s]
[0m09:44:30.528854 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.25s]
[0m09:44:30.533189 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:44:30.529493 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:44:30.687457 [info ] [Thread-3 (]: 3 of 4 PASS test_last_datetime_insert .......................................... [[32mPASS[0m in 1.41s]
[0m09:44:30.689981 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert
[0m09:44:30.696559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:30.699883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:30.700588 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:44:30.702312 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert' was properly closed.
[0m09:44:30.703249 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:44:30.704085 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:44:30.704979 [info ] [MainThread]: 
[0m09:44:30.705989 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m09:44:30.707757 [debug] [MainThread]: Command end result
[0m09:44:30.822425 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:44:30.826873 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:44:30.837571 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:44:30.838433 [info ] [MainThread]: 
[0m09:44:30.840012 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:44:30.841188 [info ] [MainThread]: 
[0m09:44:30.842928 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:44:30.844564 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:44:30.845715 [info ] [MainThread]: 
[0m09:44:30.846510 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m09:44:30.851612 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.4544773, "process_in_blocks": "192", "process_kernel_time": 1.947319, "process_mem_max_rss": "382952", "process_out_blocks": "0", "process_user_time": 4.390413}
[0m09:44:30.853068 [debug] [MainThread]: Command `dbt test` failed at 09:44:30.852796 after 6.46 seconds
[0m09:44:30.854168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f47e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb895f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb895e750>]}
[0m09:44:30.854958 [debug] [MainThread]: Flushing usage events
[0m09:44:31.365088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:30.494906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f97740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c3e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bd6150>]}


============================== 09:45:30.500580 | bf89635a-77fe-464d-a328-5e31fb77d8e3 ==============================
[0m09:45:30.500580 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:45:30.501789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select model:staging_air_pollution', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:33.264796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf89635a-77fe-464d-a328-5e31fb77d8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff690730e0>]}
[0m09:45:33.305471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf89635a-77fe-464d-a328-5e31fb77d8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff693165a0>]}
[0m09:45:33.307005 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:45:33.469061 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:45:33.585574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:45:33.586524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:45:33.614275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf89635a-77fe-464d-a328-5e31fb77d8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ed4f50>]}
[0m09:45:33.841703 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:45:33.845318 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:45:33.869703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf89635a-77fe-464d-a328-5e31fb77d8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68f2d370>]}
[0m09:45:33.870499 [info ] [MainThread]: Found 4 models, 28 data tests, 2 sources, 495 macros
[0m09:45:33.871176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf89635a-77fe-464d-a328-5e31fb77d8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ed4560>]}
[0m09:45:33.872133 [error] [MainThread]: Encountered an error:
Runtime Error
  'model' is not a valid method name
[0m09:45:33.873559 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.426286, "process_in_blocks": "0", "process_kernel_time": 1.573102, "process_mem_max_rss": "366640", "process_out_blocks": "0", "process_user_time": 3.117805}
[0m09:45:33.874437 [debug] [MainThread]: Command `dbt test` failed at 09:45:33.874341 after 3.43 seconds
[0m09:45:33.875185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ae7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69315d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68fccda0>]}
[0m09:45:33.875886 [debug] [MainThread]: Flushing usage events
[0m09:45:34.350316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:46.788153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f532ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f428d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed8cc50>]}


============================== 09:46:46.793440 | 30c956b2-636a-4e14-9df3-8607b0f1af13 ==============================
[0m09:46:46.793440 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:46:46.794519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select staging_air_pollution', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:49.501935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8576eff0>]}
[0m09:46:49.539195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8561a1e0>]}
[0m09:46:49.540601 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:46:49.723511 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:46:49.840055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:49.841077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:49.872305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8adcd0>]}
[0m09:46:50.140384 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:46:50.147597 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:46:50.193179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855a55e0>]}
[0m09:46:50.194227 [info ] [MainThread]: Found 4 models, 28 data tests, 2 sources, 495 macros
[0m09:46:50.195254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858c2f00>]}
[0m09:46:50.197284 [info ] [MainThread]: 
[0m09:46:50.198388 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:46:50.201290 [info ] [MainThread]: 
[0m09:46:50.202871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:46:50.209009 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m09:46:50.210967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:50.557366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c956b2-636a-4e14-9df3-8607b0f1af13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8552b230>]}
[0m09:46:50.559423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:50.584502 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:46:50.584929 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:46:50.585646 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert
[0m09:46:50.602646 [info ] [Thread-3 (]: 3 of 4 START test test_last_datetime_insert .................................... [RUN]
[0m09:46:50.590538 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:46:50.599521 [info ] [Thread-2 (]: 2 of 4 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:46:50.587390 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:46:50.603961 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert'
[0m09:46:50.610079 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert
[0m09:46:50.606243 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:46:50.608885 [info ] [Thread-4 (]: 4 of 4 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:46:50.630664 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:46:50.627940 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_last_datetime_insert"
[0m09:46:50.628765 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:46:50.604696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:46:50.631566 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:46:50.644783 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:46:50.644325 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:46:50.645085 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_last_datetime_insert
[0m09:46:50.649698 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:50.657887 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:46:50.691275 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:46:50.694617 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:46:50.689015 [debug] [Thread-4 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:46:50.696857 [error] [Thread-4 (]: 4 of 4 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.07s]
[0m09:46:50.695812 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:46:50.698530 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:46:50.690739 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_last_datetime_insert"
[0m09:46:50.699408 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:46:50.701882 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:46:50.703353 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:46:50.705639 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:46:50.707545 [debug] [Thread-3 (]: On test.france_air_pollution.test_last_datetime_insert: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.test_last_datetime_insert"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)
  
  
      
    ) dbt_internal_test
[0m09:46:50.748454 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:50.749905 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:46:50.751369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:51.497717 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ab0e4b79-61c5-4906-b31b-b37ed532a22b&page=queryresults
[0m09:46:51.498539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a1a8e868-e29b-4264-84be-c641ca66ff60&page=queryresults
[0m09:46:51.610763 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6796bb44-8660-46d8-89d2-12024a335f89&page=queryresults
[0m09:46:51.907804 [info ] [Thread-2 (]: 2 of 4 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.30s]
[0m09:46:51.909228 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:46:52.004667 [info ] [Thread-3 (]: 3 of 4 PASS test_last_datetime_insert .......................................... [[32mPASS[0m in 1.40s]
[0m09:46:52.006126 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert
[0m09:46:52.031089 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.43s]
[0m09:46:52.032373 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:46:52.034658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:52.036957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:52.037743 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:46:52.038503 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert' was properly closed.
[0m09:46:52.039327 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:46:52.040095 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:46:52.041570 [info ] [MainThread]: 
[0m09:46:52.042903 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m09:46:52.044507 [debug] [MainThread]: Command end result
[0m09:46:52.136294 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:46:52.141101 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:46:52.148577 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:46:52.149443 [info ] [MainThread]: 
[0m09:46:52.150229 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:46:52.151141 [info ] [MainThread]: 
[0m09:46:52.151991 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:46:52.152769 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:46:52.153557 [info ] [MainThread]: 
[0m09:46:52.154264 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m09:46:52.157349 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.411742, "process_in_blocks": "0", "process_kernel_time": 1.527147, "process_mem_max_rss": "374784", "process_out_blocks": "0", "process_user_time": 3.632525}
[0m09:46:52.158628 [debug] [MainThread]: Command `dbt test` failed at 09:46:52.158528 after 5.41 seconds
[0m09:46:52.159625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebce480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f783560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f782600>]}
[0m09:46:52.160775 [debug] [MainThread]: Flushing usage events
[0m09:46:52.678276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:13.750110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866936b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a1eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86693f20>]}


============================== 09:51:13.755656 | b53c4307-2b74-4aef-beb3-c1a215ac8fe0 ==============================
[0m09:51:13.755656 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:51:13.756896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select staging_air_pollution', 'send_anonymous_usage_stats': 'True'}
[0m09:51:16.233244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cbf7620>]}
[0m09:51:16.271147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f2e8d0>]}
[0m09:51:16.272546 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:51:16.439250 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:51:16.549456 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:51:16.555030 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/test_last_datetime_insert.sql
[0m09:51:16.556941 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m09:51:16.557646 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://tests/test_last_datetime_insert.sql
[0m09:51:16.970069 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:51:17.036238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c621b50>]}
[0m09:51:17.167154 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:51:17.171381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:51:17.205125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c653410>]}
[0m09:51:17.206118 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 495 macros
[0m09:51:17.207439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c54ecc0>]}
[0m09:51:17.209615 [info ] [MainThread]: 
[0m09:51:17.210549 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:51:17.211194 [info ] [MainThread]: 
[0m09:51:17.212466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:51:17.217034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m09:51:17.218000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:17.579409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53c4307-2b74-4aef-beb3-c1a215ac8fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c81b7a0>]}
[0m09:51:17.580543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:17.585979 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:51:17.586300 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:51:17.586629 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:51:17.588665 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:51:17.587787 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:51:17.586861 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:51:17.589554 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:51:17.591214 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:51:17.592819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:51:17.599803 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:51:17.598401 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:51:17.597358 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:51:17.625342 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:51:17.627871 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:51:17.632622 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:51:17.652233 [debug] [Thread-3 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:17.652862 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:51:17.653523 [error] [Thread-3 (]: 3 of 3 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.06s]
[0m09:51:17.655976 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:51:17.675631 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:51:17.688470 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:51:17.690525 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:51:17.691915 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:51:17.706333 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:51:17.707995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:51:17.707291 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:51:17.765153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:18.350154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:90296d51-ed84-4a85-bb04-50baf93ef726&page=queryresults
[0m09:51:18.350956 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:46be175b-1eb7-46a0-83a1-440f8514e33b&page=queryresults
[0m09:51:18.791723 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.20s]
[0m09:51:18.793576 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:51:18.795856 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.20s]
[0m09:51:18.796916 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:51:18.798687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:18.800806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:18.801499 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:51:18.802317 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:51:18.803818 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:51:18.804823 [info ] [MainThread]: 
[0m09:51:18.805530 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m09:51:18.807696 [debug] [MainThread]: Command end result
[0m09:51:18.886721 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:51:18.890296 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:51:18.896183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:51:18.896892 [info ] [MainThread]: 
[0m09:51:18.897632 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:51:18.898430 [info ] [MainThread]: 
[0m09:51:18.899200 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:51:18.899932 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:18.900569 [info ] [MainThread]: 
[0m09:51:18.901297 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:51:18.903064 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.189372, "process_in_blocks": "0", "process_kernel_time": 1.270578, "process_mem_max_rss": "379076", "process_out_blocks": "0", "process_user_time": 3.774088}
[0m09:51:18.903730 [debug] [MainThread]: Command `dbt test` failed at 09:51:18.903662 after 5.19 seconds
[0m09:51:18.904520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86303410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cae5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c600b30>]}
[0m09:51:18.905336 [debug] [MainThread]: Flushing usage events
[0m09:51:19.372615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:23.475630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccfaf60>]}


============================== 09:52:23.482907 | 88d8ab55-a2d5-48c7-838f-ff5bba662edc ==============================
[0m09:52:23.482907 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:52:23.484142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select staging_air_pollution', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:26.173672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7283fd40>]}
[0m09:52:26.210841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2d5040>]}
[0m09:52:26.212241 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:52:26.370607 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:52:26.484976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:26.486975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:26.541697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e165cd0>]}
[0m09:52:26.864915 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:52:26.870385 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:52:26.900564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba1f200>]}
[0m09:52:26.902044 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 495 macros
[0m09:52:26.903667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff726bbad0>]}
[0m09:52:26.906348 [info ] [MainThread]: 
[0m09:52:26.907685 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:52:26.909933 [info ] [MainThread]: 
[0m09:52:26.911933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:26.917967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m09:52:26.919832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:27.309367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d8ab55-a2d5-48c7-838f-ff5bba662edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72764c20>]}
[0m09:52:27.311344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:27.333444 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:52:27.334583 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:52:27.335297 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:52:27.336015 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:52:27.337383 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:52:27.340440 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:52:27.341984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:52:27.343939 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:52:27.347487 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:52:27.346387 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:52:27.345563 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:52:27.374524 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:52:27.370544 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:52:27.374989 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:52:27.382607 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:27.383111 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:52:27.392927 [debug] [Thread-3 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:52:27.406609 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:52:27.418936 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:52:27.412828 [error] [Thread-3 (]: 3 of 3 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.07s]
[0m09:52:27.416179 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:52:27.420479 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:52:27.422164 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:52:27.426937 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:52:27.427579 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:52:27.430788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:27.429414 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:28.045850 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aac46822-f13b-4da7-8b6c-0d9ac5556222&page=queryresults
[0m09:52:28.051936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:16bb7b5b-1790-4410-9421-51efb3e62f4d&page=queryresults
[0m09:52:28.473918 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.13s]
[0m09:52:28.475667 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:52:28.568172 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.22s]
[0m09:52:28.569812 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:52:28.572458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:28.574757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:28.575583 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:52:28.576577 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:52:28.577385 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:52:28.579047 [info ] [MainThread]: 
[0m09:52:28.580569 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m09:52:28.582571 [debug] [MainThread]: Command end result
[0m09:52:28.704107 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:52:28.708475 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:52:28.719531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:52:28.720845 [info ] [MainThread]: 
[0m09:52:28.722833 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:28.724558 [info ] [MainThread]: 
[0m09:52:28.725897 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:52:28.727664 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:52:28.728926 [info ] [MainThread]: 
[0m09:52:28.730260 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:52:28.733825 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.3039694, "process_in_blocks": "0", "process_kernel_time": 1.719676, "process_mem_max_rss": "374304", "process_out_blocks": "0", "process_user_time": 3.482116}
[0m09:52:28.736663 [debug] [MainThread]: Command `dbt test` failed at 09:52:28.736543 after 5.31 seconds
[0m09:52:28.738782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c26d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff726ba9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c913560>]}
[0m09:52:28.739712 [debug] [MainThread]: Flushing usage events
[0m09:52:29.212910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:11.381112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42667e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb499eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2bebb30>]}


============================== 09:53:11.389080 | da056fd7-1eb2-4293-a4c3-efe52ea3e0c7 ==============================
[0m09:53:11.389080 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:53:11.391332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select staging_air_pollution', 'send_anonymous_usage_stats': 'True'}
[0m09:53:14.625635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bac590>]}
[0m09:53:14.686147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b7c770>]}
[0m09:53:14.688304 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:53:14.877049 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:53:14.977196 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m09:53:14.978952 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_last_datetime_insert.sql
[0m09:53:14.979999 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/test_last_datetime_insert.sql
[0m09:53:15.331744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b25cd0>]}
[0m09:53:15.608275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:53:15.617102 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:53:15.667515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9857a4b0>]}
[0m09:53:15.668956 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 495 macros
[0m09:53:15.670399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ae95e0>]}
[0m09:53:15.674227 [info ] [MainThread]: 
[0m09:53:15.676320 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:53:15.678189 [info ] [MainThread]: 
[0m09:53:15.685218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:15.699987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_production'
[0m09:53:15.704111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:16.068832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da056fd7-1eb2-4293-a4c3-efe52ea3e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e9f0e0>]}
[0m09:53:16.070254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:16.076674 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:16.077070 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:16.077589 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:16.081091 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:53:16.083160 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:53:16.085143 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:53:16.090761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:53:16.092175 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:53:16.093488 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:53:16.094295 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:16.095214 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:16.096696 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:16.119411 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:53:16.122490 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:53:16.126042 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:16.133679 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:16.134162 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:16.154901 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:53:16.156127 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:53:16.160122 [debug] [Thread-3 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:16.173236 [error] [Thread-3 (]: 3 of 3 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.08s]
[0m09:53:16.174131 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:53:16.181127 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:16.185724 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:53:16.196629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:16.197918 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:53:16.199119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:16.720462 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:266dbe60-5752-4f69-8e65-886962eceb45&page=queryresults
[0m09:53:16.725088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9a550fa1-10de-49bb-86b0-80cb0fcbc9a3&page=queryresults
[0m09:53:17.159069 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.07s]
[0m09:53:17.160694 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:17.273015 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.18s]
[0m09:53:17.274718 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:17.277476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:17.281647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:17.283267 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:53:17.285269 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:53:17.286786 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:53:17.287800 [info ] [MainThread]: 
[0m09:53:17.289226 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m09:53:17.290712 [debug] [MainThread]: Command end result
[0m09:53:17.388553 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:53:17.474799 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:53:17.487675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:53:17.488739 [info ] [MainThread]: 
[0m09:53:17.490191 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:17.491552 [info ] [MainThread]: 
[0m09:53:17.493258 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:53:17.494690 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:17.496798 [info ] [MainThread]: 
[0m09:53:17.497951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:53:17.505922 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.1795373, "process_in_blocks": "0", "process_kernel_time": 1.874974, "process_mem_max_rss": "374124", "process_out_blocks": "0", "process_user_time": 4.247413}
[0m09:53:17.509344 [debug] [MainThread]: Command `dbt test` failed at 09:53:17.509099 after 6.19 seconds
[0m09:53:17.510977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d99460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98605a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986f6f60>]}
[0m09:53:17.512078 [debug] [MainThread]: Flushing usage events
[0m09:53:17.989354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:48.584709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0058320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04375f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa240eab0>]}


============================== 09:53:48.590887 | 44dcf0fb-1764-48b5-bece-675a11ad9df4 ==============================
[0m09:53:48.590887 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:53:48.592147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select staging_air_pollution --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:53:50.906479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864d1c10>]}
[0m09:53:50.943722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbf7980>]}
[0m09:53:50.945685 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:53:51.109843 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m09:53:51.181422 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:53:51.182516 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m09:53:51.183192 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:53:51.183960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0081460>]}
[0m09:53:51.996363 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:53:52.065573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85585ee0>]}
[0m09:53:52.192490 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:53:52.195569 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:53:52.221676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8547d0a0>]}
[0m09:53:52.223413 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 495 macros
[0m09:53:52.224881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8617afc0>]}
[0m09:53:52.227092 [info ] [MainThread]: 
[0m09:53:52.228484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:52.229679 [info ] [MainThread]: 
[0m09:53:52.231747 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:52.235864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m09:53:52.236987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:52.562346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dcf0fb-1764-48b5-bece-675a11ad9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86116870>]}
[0m09:53:52.563606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:52.568955 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:52.569286 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:52.569799 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:52.570329 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:53:52.571216 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:53:52.572496 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:53:52.576426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:53:52.577560 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:53:52.578530 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:53:52.579432 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:52.580113 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:52.582015 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:52.589646 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:53:52.594587 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:53:52.598627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:52.602623 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:52.615519 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:52.624654 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:53:52.626189 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:53:52.629197 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:53:52.630461 [debug] [Thread-3 (]: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:52.633561 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:53:52.634545 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:52.635690 [error] [Thread-3 (]: 3 of 3 ERROR test_last_datetime_insert_staging_air_pollution_ .................. [[31mERROR[0m in 0.06s]
[0m09:53:52.638920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:52.733204 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:53:52.819244 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' to be skipped because of status 'error'.  Reason: Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:53:53.383249 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:112793d0-e189-4a1f-b073-83c0a5831064&page=queryresults
[0m09:53:53.441107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:94029ab7-5cc0-458a-b41f-4480317bb6be&page=queryresults
[0m09:53:53.803048 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.23s]
[0m09:53:53.805377 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:53:53.821676 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.24s]
[0m09:53:53.823893 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:53:53.826080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:53.828601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:53.829547 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:53:53.830809 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:53:53.831665 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:53:53.833298 [info ] [MainThread]: 
[0m09:53:53.834665 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m09:53:53.836430 [debug] [MainThread]: Command end result
[0m09:53:53.924704 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:53:53.929397 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:53:53.936100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:53:53.937119 [info ] [MainThread]: 
[0m09:53:53.938434 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:53.939220 [info ] [MainThread]: 
[0m09:53:53.940154 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:53:53.940977 [error] [MainThread]:   Compilation Error in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)
  'test_test_last_datetime_insert' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:53:53.941767 [info ] [MainThread]: 
[0m09:53:53.942614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:53:53.944765 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.404949, "process_in_blocks": "0", "process_kernel_time": 1.208395, "process_mem_max_rss": "381892", "process_out_blocks": "0", "process_user_time": 4.038613}
[0m09:53:53.945823 [debug] [MainThread]: Command `dbt test` failed at 09:53:53.945645 after 5.41 seconds
[0m09:53:53.946843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc852e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f44d0>]}
[0m09:53:53.947667 [debug] [MainThread]: Flushing usage events
[0m09:53:54.445211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:50.140511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd08c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaded5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd08980>]}


============================== 09:55:50.146908 | 064307cb-2ffa-4ec1-8228-744371463312 ==============================
[0m09:55:50.146908 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:55:50.148261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select staging_air_pollution --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:52.745793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92347b90>]}
[0m09:55:52.778831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924312b0>]}
[0m09:55:52.780094 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:55:52.978446 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m09:55:53.089165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:53.090942 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://macros/tests/test_last_datetime_insert.sql
[0m09:55:53.270166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920ff680>]}
[0m09:55:53.390469 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:55:53.394598 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:55:53.418436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bff4d0>]}
[0m09:55:53.419339 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 496 macros
[0m09:55:53.420361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bdc1a0>]}
[0m09:55:53.422508 [info ] [MainThread]: 
[0m09:55:53.423564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:53.424224 [info ] [MainThread]: 
[0m09:55:53.425706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:55:53.428877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m09:55:53.429698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:53.744582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '064307cb-2ffa-4ec1-8228-744371463312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bff830>]}
[0m09:55:53.746754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:53.754057 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:55:53.754478 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:55:53.755176 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:55:53.755974 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:55:53.757327 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:55:53.761085 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:55:53.760031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:55:53.758772 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:55:53.762068 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:55:53.762852 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:55:53.763725 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:55:53.776728 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:55:53.784640 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:55:53.785432 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:55:53.792373 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m09:55:53.798403 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:55:53.799009 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:55:53.828192 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:55:53.829146 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:55:53.830505 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:55:53.835824 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m09:55:53.838486 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:55:53.840059 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:55:53.840585 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:55:53.841749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:53.842275 [debug] [Thread-3 (]: On test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)


  
  
      
    ) dbt_internal_test
[0m09:55:53.844410 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:55:54.523523 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:813504dc-ea89-42b4-8ab9-1208c3980f93&page=queryresults
[0m09:55:54.526752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0929ae60-67f9-4a02-9ba6-fc4249e577bc&page=queryresults
[0m09:55:54.690618 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:95829a3b-783c-4847-a025-bebf9e5b9e9a&page=queryresults
[0m09:55:54.982929 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.22s]
[0m09:55:54.987451 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.23s]
[0m09:55:54.996641 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:55:54.988647 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:55:55.081663 [error] [Thread-3 (]: 3 of 3 FAIL 105 test_last_datetime_insert_staging_air_pollution_ ............... [[31mFAIL 105[0m in 1.32s]
[0m09:55:55.084927 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:55:55.091357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:55.097545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:55.099982 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:55:55.101363 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:55:55.102269 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:55:55.103812 [info ] [MainThread]: 
[0m09:55:55.106272 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m09:55:55.112796 [debug] [MainThread]: Command end result
[0m09:55:55.270499 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:55:55.292473 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:55:55.308972 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:55:55.309763 [info ] [MainThread]: 
[0m09:55:55.311055 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:55.311767 [info ] [MainThread]: 
[0m09:55:55.312895 [error] [MainThread]: [31mFailure in test test_last_datetime_insert_staging_air_pollution_ (models/schema.yml)[0m
[0m09:55:55.314494 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m09:55:55.315937 [info ] [MainThread]: 
[0m09:55:55.319532 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_last_datetime_insert_staging_air_pollution_.sql
[0m09:55:55.321191 [info ] [MainThread]: 
[0m09:55:55.323172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:55:55.327542 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.2280903, "process_in_blocks": "0", "process_kernel_time": 1.715998, "process_mem_max_rss": "373300", "process_out_blocks": "0", "process_user_time": 3.523816}
[0m09:55:55.331746 [debug] [MainThread]: Command `dbt test` failed at 09:55:55.331534 after 5.23 seconds
[0m09:55:55.333446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae04eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90254ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c547a0>]}
[0m09:55:55.334485 [debug] [MainThread]: Flushing usage events
[0m09:55:55.803379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:27.969553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9135a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932ae840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91670440>]}


============================== 09:56:27.974378 | 76c1c5ea-c28b-4f58-be56-2d672ed6751c ==============================
[0m09:56:27.974378 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:56:27.977319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:30.083535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775a7950>]}
[0m09:56:30.124916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff795b8890>]}
[0m09:56:30.126658 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:56:30.431747 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:56:30.508470 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:56:30.510084 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m09:56:30.511072 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:56:30.512623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff770a7770>]}
[0m09:56:31.443451 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:56:31.524922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76fe1130>]}
[0m09:56:31.649568 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:56:31.653819 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:56:31.672485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765faa50>]}
[0m09:56:31.673466 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 496 macros
[0m09:56:31.674454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76609f70>]}
[0m09:56:31.676679 [info ] [MainThread]: 
[0m09:56:31.677499 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:56:31.678325 [info ] [MainThread]: 
[0m09:56:31.679267 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:56:31.685067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m09:56:31.689158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:32.142600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_production)
[0m09:56:32.144230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:32.429171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff766ea570>]}
[0m09:56:32.447162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:32.472851 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m09:56:32.474287 [info ] [Thread-1 (]: 1 of 4 START sql incremental model production.staging_air_pollution ............ [RUN]
[0m09:56:32.473413 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m09:56:32.477297 [info ] [Thread-2 (]: 2 of 4 START sql table model production.staging_cities ......................... [RUN]
[0m09:56:32.476281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_production, now model.france_air_pollution.staging_air_pollution)
[0m09:56:32.478194 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m09:56:32.479469 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m09:56:32.480187 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m09:56:32.492618 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m09:56:32.495732 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m09:56:32.502199 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m09:56:32.514171 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:56:32.515510 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m09:56:32.578487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:32.855193 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m09:56:32.861695 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`production`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m09:56:32.873938 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m09:56:32.877625 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m09:56:33.232481 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:67428af1-960b-4011-beaa-946f7405104b&page=queryresults
[0m09:56:33.233770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d4437481-9470-401c-9c12-dbfd17b8e33a&page=queryresults
[0m09:56:34.933368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916707a0>]}
[0m09:56:34.935768 [info ] [Thread-2 (]: 2 of 4 OK created sql table model production.staging_cities .................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.45s]
[0m09:56:34.937152 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m09:56:39.549851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907523f0>]}
[0m09:56:39.551574 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model production.staging_air_pollution ....... [[32mCREATE TABLE (3.9m rows, 298.2 MiB processed)[0m in 7.07s]
[0m09:56:39.552900 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m09:56:39.555641 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m09:56:39.556563 [info ] [Thread-4 (]: 3 of 4 START sql table model production.fact_air_pollution ..................... [RUN]
[0m09:56:39.559955 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m09:56:39.561190 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m09:56:39.570229 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m09:56:39.580797 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m09:56:39.583572 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:56:39.860387 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m09:56:39.866828 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`production`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`production`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`production`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m09:56:40.296406 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47d90ee2-d45a-4766-b985-458568c53612&page=queryresults
[0m09:56:47.836132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74215760>]}
[0m09:56:47.841914 [info ] [Thread-4 (]: 3 of 4 OK created sql table model production.fact_air_pollution ................ [[32mCREATE TABLE (3.9m rows, 323.2 MiB processed)[0m in 8.27s]
[0m09:56:47.844150 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m09:56:47.849504 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m09:56:47.852040 [info ] [Thread-2 (]: 4 of 4 START sql table model production.agg_pollution_by_day ................... [RUN]
[0m09:56:47.858015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m09:56:47.859375 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m09:56:47.892172 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:56:47.901103 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m09:56:47.923473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:48.280669 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:56:48.289151 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "prod", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`production`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`production`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m09:56:48.588528 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5ff18adb-86c2-4652-8712-22fb6d19cf80&page=queryresults
[0m09:56:54.919405 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c1c5ea-c28b-4f58-be56-2d672ed6751c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74262ff0>]}
[0m09:56:54.926855 [info ] [Thread-2 (]: 4 of 4 OK created sql table model production.agg_pollution_by_day .............. [[32mCREATE TABLE (164.5k rows, 335.3 MiB processed)[0m in 7.06s]
[0m09:56:54.931849 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m09:56:54.983971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:54.991936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:54.992991 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m09:56:54.994109 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m09:56:54.995115 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m09:56:54.997019 [info ] [MainThread]: 
[0m09:56:54.998725 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 23.32 seconds (23.32s).
[0m09:56:55.001895 [debug] [MainThread]: Command end result
[0m09:56:55.127355 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:56:55.149190 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:56:55.166159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:56:55.167141 [info ] [MainThread]: 
[0m09:56:55.168709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:55.169988 [info ] [MainThread]: 
[0m09:56:55.171208 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m09:56:55.191205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.258743, "process_in_blocks": "0", "process_kernel_time": 1.342077, "process_mem_max_rss": "381240", "process_out_blocks": "0", "process_user_time": 5.076419}
[0m09:56:55.193885 [debug] [MainThread]: Command `dbt run` succeeded at 09:56:55.193686 after 27.26 seconds
[0m09:56:55.196241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f21730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765a01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76fc0200>]}
[0m09:56:55.197261 [debug] [MainThread]: Flushing usage events
[0m09:56:55.691336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:50.766607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b68c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b6b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0674590>]}


============================== 09:58:50.777760 | 5721f563-8d38-4bb1-a787-bf4a63c9e13f ==============================
[0m09:58:50.777760 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:58:50.779002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:53.567771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873fb590>]}
[0m09:58:53.606500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e2420>]}
[0m09:58:53.608581 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:58:53.788094 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m09:58:53.863189 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:58:53.864666 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m09:58:53.865653 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:58:53.866791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f7e390>]}
[0m09:58:54.794747 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m09:58:54.865126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8620dee0>]}
[0m09:58:54.979153 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:58:54.983294 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:58:55.003042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862418b0>]}
[0m09:58:55.003958 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 496 macros
[0m09:58:55.004787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8628b200>]}
[0m09:58:55.007981 [info ] [MainThread]: 
[0m09:58:55.009164 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:55.010356 [info ] [MainThread]: 
[0m09:58:55.011534 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:58:55.014876 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m09:58:55.015934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:55.447994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m09:58:55.449246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:55.731537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862431d0>]}
[0m09:58:55.732725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:55.738424 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m09:58:55.738895 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m09:58:55.739535 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m09:58:55.740486 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m09:58:55.741583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m09:58:55.742465 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m09:58:55.743405 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m09:58:55.744277 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m09:58:55.751790 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m09:58:55.755369 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m09:58:55.760364 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m09:58:55.760722 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m09:58:55.791553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:58:55.792964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:56.145329 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m09:58:56.146584 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m09:58:56.167866 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m09:58:56.169389 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m09:58:56.545965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4c11e20a-e9db-44a3-9757-3744eda9eb21&page=queryresults
[0m09:58:56.517546 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:658778d0-f21b-47a0-aee1-d4e14b4bff7f&page=queryresults
[0m09:58:58.521122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bcb1670>]}
[0m09:58:58.523057 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.78s]
[0m09:58:58.524548 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m09:59:04.852948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8629c920>]}
[0m09:59:04.856713 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.2 MiB processed)[0m in 9.11s]
[0m09:59:04.860818 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m09:59:04.867618 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m09:59:04.868838 [info ] [Thread-4 (]: 3 of 4 START sql table model development.fact_air_pollution .................... [RUN]
[0m09:59:04.873378 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m09:59:04.874389 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m09:59:04.902946 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m09:59:04.907188 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m09:59:04.910960 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:59:05.369005 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m09:59:05.374379 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m09:59:05.635028 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7f14bf12-7879-4d71-8851-01f42cbfc226&page=queryresults
[0m09:59:12.244149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e490da0>]}
[0m09:59:12.252917 [info ] [Thread-4 (]: 3 of 4 OK created sql table model development.fact_air_pollution ............... [[32mCREATE TABLE (3.9m rows, 323.2 MiB processed)[0m in 7.37s]
[0m09:59:12.257256 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m09:59:12.284210 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m09:59:12.302037 [info ] [Thread-2 (]: 4 of 4 START sql table model development.agg_pollution_by_day .................. [RUN]
[0m09:59:12.316254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m09:59:12.322740 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m09:59:12.355902 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:59:12.362683 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m09:59:12.367326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:59:12.793214 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m09:59:12.799554 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m09:59:13.096484 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:733f70d2-229d-46d8-a83f-f2901d309d42&page=queryresults
[0m09:59:18.623010 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5721f563-8d38-4bb1-a787-bf4a63c9e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e490da0>]}
[0m09:59:18.628714 [info ] [Thread-2 (]: 4 of 4 OK created sql table model development.agg_pollution_by_day ............. [[32mCREATE TABLE (164.5k rows, 335.3 MiB processed)[0m in 6.32s]
[0m09:59:18.630955 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m09:59:18.650785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:18.691457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:18.695687 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m09:59:18.697421 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m09:59:18.698651 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m09:59:18.701445 [info ] [MainThread]: 
[0m09:59:18.703075 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 23.69 seconds (23.69s).
[0m09:59:18.706009 [debug] [MainThread]: Command end result
[0m09:59:18.867814 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:59:18.880243 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:59:18.894370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:59:18.895791 [info ] [MainThread]: 
[0m09:59:18.897483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:18.914219 [info ] [MainThread]: 
[0m09:59:18.919837 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m09:59:18.932514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.209719, "process_in_blocks": "0", "process_kernel_time": 2.111166, "process_mem_max_rss": "381684", "process_out_blocks": "0", "process_user_time": 4.852251}
[0m09:59:18.937983 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:18.937736 after 28.22 seconds
[0m09:59:18.940375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa039fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862e70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e38a5a0>]}
[0m09:59:18.941236 [debug] [MainThread]: Flushing usage events
[0m09:59:19.431724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:48.413530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a67f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af0cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a67f3e0>]}


============================== 09:59:48.420411 | 0ee324b6-ea4d-43dd-b3cd-316e629f9a21 ==============================
[0m09:59:48.420411 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:59:48.421834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select staging_air_pollution --target dev', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:51.132090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e45580>]}
[0m09:59:51.166850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7417e300>]}
[0m09:59:51.168153 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:59:51.331590 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m09:59:51.449768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:51.451041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:51.477790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70a7e300>]}
[0m09:59:51.734498 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:59:51.738919 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:59:51.764548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f7fec0>]}
[0m09:59:51.765419 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 496 macros
[0m09:59:51.766400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f49e50>]}
[0m09:59:51.768178 [info ] [MainThread]: 
[0m09:59:51.768968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:51.769790 [info ] [MainThread]: 
[0m09:59:51.770605 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:59:51.774537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m09:59:51.775169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:52.242840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee324b6-ea4d-43dd-b3cd-316e629f9a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ecae10>]}
[0m09:59:52.244367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:52.251105 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:59:52.251507 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:59:52.251777 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:59:52.252391 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m09:59:52.253609 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m09:59:52.255293 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m09:59:52.256529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m09:59:52.257644 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m09:59:52.258547 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m09:59:52.259700 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:59:52.260564 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:59:52.261301 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:59:52.285163 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:59:52.284918 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:59:52.289282 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m09:59:52.293153 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:59:52.300486 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:59:52.300984 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:59:52.314664 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m09:59:52.314991 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m09:59:52.317046 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m09:59:52.323499 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m09:59:52.324018 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m09:59:52.325601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:52.331492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:59:52.331932 [debug] [Thread-3 (]: On test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)


  
  
      
    ) dbt_internal_test
[0m09:59:52.371339 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:59:53.013029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cf3076f1-7229-4d32-b80b-cb167c56c76d&page=queryresults
[0m09:59:53.033229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ee7e8460-be5c-44bf-8367-f9bf88cae2b5&page=queryresults
[0m09:59:53.164861 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2737b380-69e7-4b3b-8afa-ef6e95e18ae3&page=queryresults
[0m09:59:53.389580 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.13s]
[0m09:59:53.391067 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m09:59:53.409097 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.15s]
[0m09:59:53.414387 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m09:59:53.611351 [info ] [Thread-3 (]: 3 of 3 PASS test_last_datetime_insert_staging_air_pollution_ ................... [[32mPASS[0m in 1.35s]
[0m09:59:53.612859 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m09:59:53.615320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:53.617757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:53.618906 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m09:59:53.619794 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m09:59:53.620527 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m09:59:53.622305 [info ] [MainThread]: 
[0m09:59:53.623732 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m09:59:53.626017 [debug] [MainThread]: Command end result
[0m09:59:53.753832 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:59:53.766709 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:59:53.779542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:59:53.781621 [info ] [MainThread]: 
[0m09:59:53.782773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:53.783659 [info ] [MainThread]: 
[0m09:59:53.784420 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m09:59:53.787601 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.4189506, "process_in_blocks": "0", "process_kernel_time": 1.759582, "process_mem_max_rss": "373920", "process_out_blocks": "0", "process_user_time": 3.577229}
[0m09:59:53.794205 [debug] [MainThread]: Command `dbt test` succeeded at 09:59:53.793057 after 5.43 seconds
[0m09:59:53.798991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b67fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715da330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f7cb90>]}
[0m09:59:53.801201 [debug] [MainThread]: Flushing usage events
[0m09:59:54.368028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:34.806172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db198e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfd0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc8b500>]}


============================== 10:01:34.811974 | b9a75266-19ac-4f67-8cc1-1eac50ea3150 ==============================
[0m10:01:34.811974 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:01:34.812866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select staging_air_pollution', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:37.595931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fe8bc0>]}
[0m10:01:37.633892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64177950>]}
[0m10:01:37.637673 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:01:37.789003 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:01:37.861153 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:01:37.862492 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m10:01:37.863708 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:01:37.864504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8b0fe0>]}
[0m10:01:38.767125 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m10:01:38.858307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62db45c0>]}
[0m10:01:39.088302 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:01:39.096060 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:01:39.139315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62d25220>]}
[0m10:01:39.140591 [info ] [MainThread]: Found 4 models, 27 data tests, 2 sources, 496 macros
[0m10:01:39.141275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62cb3080>]}
[0m10:01:39.143840 [info ] [MainThread]: 
[0m10:01:39.144639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:01:39.145424 [info ] [MainThread]: 
[0m10:01:39.146284 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:39.149917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:01:39.150721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:39.500610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a75266-19ac-4f67-8cc1-1eac50ea3150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2bab40>]}
[0m10:01:39.501820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:39.508271 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:01:39.508878 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:01:39.509352 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m10:01:39.511314 [info ] [Thread-3 (]: 3 of 3 START test test_last_datetime_insert_staging_air_pollution_ ............. [RUN]
[0m10:01:39.510467 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m10:01:39.509699 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m10:01:39.512357 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82'
[0m10:01:39.513274 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m10:01:39.514081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m10:01:39.514828 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m10:01:39.517516 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:01:39.547458 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:01:39.586544 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m10:01:39.593781 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:01:39.598604 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:01:39.605896 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m10:01:39.623443 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:01:39.623984 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:01:39.679988 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"
[0m10:01:39.681252 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:01:39.681625 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:01:39.685287 [debug] [Thread-3 (]: On test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)


  
  
      
    ) dbt_internal_test
[0m10:01:39.685859 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m10:01:39.687307 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:01:39.687770 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m10:01:39.688299 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:01:39.727620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:40.327849 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d48757ff-b771-4e20-939c-26a728aa78d9&page=queryresults
[0m10:01:40.328834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4adeb909-6722-421d-8081-f8c50e43b5c0&page=queryresults
[0m10:01:40.607427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04365147-8750-4e53-9844-aa5582ac1e5d&page=queryresults
[0m10:01:40.822846 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.31s]
[0m10:01:40.825647 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:01:40.969835 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.46s]
[0m10:01:40.980610 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:01:41.008754 [info ] [Thread-3 (]: 3 of 3 PASS test_last_datetime_insert_staging_air_pollution_ ................... [[32mPASS[0m in 1.50s]
[0m10:01:41.014049 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82
[0m10:01:41.026175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:01:41.033123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:41.034840 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m10:01:41.036394 [debug] [MainThread]: Connection 'test.france_air_pollution.test_last_datetime_insert_staging_air_pollution_.313c041d82' was properly closed.
[0m10:01:41.037671 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m10:01:41.038560 [info ] [MainThread]: 
[0m10:01:41.040043 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m10:01:41.041756 [debug] [MainThread]: Command end result
[0m10:01:41.230797 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:01:41.236516 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:01:41.245690 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:01:41.246581 [info ] [MainThread]: 
[0m10:01:41.248898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:01:41.250874 [info ] [MainThread]: 
[0m10:01:41.252214 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m10:01:41.256820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.495471, "process_in_blocks": "0", "process_kernel_time": 1.959006, "process_mem_max_rss": "381816", "process_out_blocks": "0", "process_user_time": 4.274659}
[0m10:01:41.259400 [debug] [MainThread]: Command `dbt test` succeeded at 10:01:41.259213 after 6.50 seconds
[0m10:01:41.261044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fc3ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff638f1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62ca8770>]}
[0m10:01:41.262123 [debug] [MainThread]: Flushing usage events
[0m10:01:41.795588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:07.195379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952c0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979deab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959903b0>]}


============================== 10:09:07.201980 | b8864f6a-a6f7-440a-9fcb-d74712740254 ==============================
[0m10:09:07.201980 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:09:07.203343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select staging_air_pollution', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:09:10.233050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc555b0>]}
[0m10:09:10.299360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97764fb0>]}
[0m10:09:10.301388 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:09:10.670806 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:09:10.788948 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:09:10.790214 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_is_last_datetime_inserted.sql
[0m10:09:10.791752 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m10:09:10.792994 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/tests/test_last_datetime_insert.sql
[0m10:09:11.671149 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m10:09:11.737182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5dd730>]}
[0m10:09:11.872403 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:09:11.877391 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:09:11.903692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa31010>]}
[0m10:09:11.904547 [info ] [MainThread]: Found 4 models, 30 data tests, 2 sources, 496 macros
[0m10:09:11.905531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5f9370>]}
[0m10:09:11.907625 [info ] [MainThread]: 
[0m10:09:11.908464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:09:11.909225 [info ] [MainThread]: 
[0m10:09:11.910209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:11.914733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:09:11.915828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:12.245197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8864f6a-a6f7-440a-9fcb-d74712740254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab16ab0>]}
[0m10:09:12.246645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:09:12.271163 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:09:12.271566 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:09:12.271858 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4
[0m10:09:12.272409 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m10:09:12.274033 [info ] [Thread-2 (]: 2 of 3 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m10:09:12.275168 [info ] [Thread-3 (]: 3 of 3 START test test_is_last_datetime_inserted_staging_air_pollution_ ........ [RUN]
[0m10:09:12.279272 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4'
[0m10:09:12.277714 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m10:09:12.276524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m10:09:12.283056 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:09:12.282355 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:09:12.281268 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4
[0m10:09:12.291552 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:09:12.297892 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:09:12.305216 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4"
[0m10:09:12.319108 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:09:12.321951 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:09:12.332388 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4
[0m10:09:12.388319 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4"
[0m10:09:12.383677 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:09:12.382299 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:09:12.395455 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with
    max_date_time_cte as (
        select city_id, max(dt) as max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
        group by city_id
    )

select city_id, max_date_time
from max_date_time_cte
where
    date(max_date_time, "Europe/Paris")
    < date_sub(current_date("Europe/Paris"), interval 1 day)


  
  
      
    ) dbt_internal_test
[0m10:09:12.398217 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:09:12.399902 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m10:09:12.410878 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:09:12.449874 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m10:09:12.486901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:13.056728 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e8c46fb6-b146-4e27-806a-a6194c0be6cd&page=queryresults
[0m10:09:13.093076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2ceaddcc-502a-4be0-98b7-71fc6f4eb695&page=queryresults
[0m10:09:13.128288 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74c4c0f7-5465-4bb3-8115-f6dda0f9505c&page=queryresults
[0m10:09:13.485931 [info ] [Thread-2 (]: 2 of 3 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.21s]
[0m10:09:13.487644 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:09:13.510743 [info ] [Thread-3 (]: 3 of 3 PASS test_is_last_datetime_inserted_staging_air_pollution_ .............. [[32mPASS[0m in 1.23s]
[0m10:09:13.513992 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4
[0m10:09:13.513449 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.24s]
[0m10:09:13.515780 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:09:13.518788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:09:13.521975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:13.523001 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m10:09:13.525317 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m10:09:13.525972 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_datetime_inserted_staging_air_pollution_.f201551dd4' was properly closed.
[0m10:09:13.528701 [info ] [MainThread]: 
[0m10:09:13.530580 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m10:09:13.535249 [debug] [MainThread]: Command end result
[0m10:09:13.717711 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:09:13.724254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:09:13.739965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:09:13.741275 [info ] [MainThread]: 
[0m10:09:13.742958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:09:13.746538 [info ] [MainThread]: 
[0m10:09:13.748539 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m10:09:13.753158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.6215024, "process_in_blocks": "0", "process_kernel_time": 1.615668, "process_mem_max_rss": "379136", "process_out_blocks": "0", "process_user_time": 4.959555}
[0m10:09:13.755417 [debug] [MainThread]: Command `dbt test` succeeded at 10:09:13.755228 after 6.62 seconds
[0m10:09:13.759353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dd9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807e15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5a1880>]}
[0m10:09:13.766530 [debug] [MainThread]: Flushing usage events
[0m10:09:14.312672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:30.231806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d866ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b133800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b131640>]}


============================== 10:48:30.237547 | 6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb ==============================
[0m10:48:30.237547 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:48:30.239401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select staging_air_pollution', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:48:33.346234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b109100>]}
[0m10:48:33.398114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7171ea50>]}
[0m10:48:33.400475 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:48:33.768792 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:48:33.900709 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m10:48:33.903437 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_is_last_date_inserted.sql
[0m10:48:33.905982 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m10:48:33.906989 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/tests/test_is_last_datetime_inserted.sql
[0m10:48:33.908011 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://macros/tests/test_is_float.sql
[0m10:48:34.616320 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m10:48:34.687480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70773080>]}
[0m10:48:35.052012 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:48:35.060194 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:48:35.109554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70508e60>]}
[0m10:48:35.110904 [info ] [MainThread]: Found 4 models, 52 data tests, 2 sources, 496 macros
[0m10:48:35.112250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7064a9f0>]}
[0m10:48:35.114832 [info ] [MainThread]: 
[0m10:48:35.115961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:35.116880 [info ] [MainThread]: 
[0m10:48:35.120145 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:35.126977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:48:35.128572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:35.511282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6746b4f4-4ccc-4dc8-b2a0-eded42f0bebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70680770>]}
[0m10:48:35.512631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:35.518537 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:48:35.518891 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:48:35.519472 [info ] [Thread-1 (]: 1 of 2 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m10:48:35.520452 [info ] [Thread-2 (]: 2 of 2 START test not_null_staging_air_pollution_city_id ....................... [RUN]
[0m10:48:35.522406 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e'
[0m10:48:35.521579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6)
[0m10:48:35.524725 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:48:35.525737 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:48:35.540446 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:48:35.537939 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:48:35.544115 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:48:35.545125 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:48:35.563214 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m10:48:35.564616 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m10:48:35.567155 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m10:48:35.567798 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m10:48:35.568380 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:48:35.569653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:36.174724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a1e8f232-186c-46e7-a04b-c1a481da8a49&page=queryresults
[0m10:48:36.229015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:852261be-a174-494a-8f28-0f3d1baa9145&page=queryresults
[0m10:48:36.689211 [info ] [Thread-2 (]: 2 of 2 PASS not_null_staging_air_pollution_city_id ............................. [[32mPASS[0m in 1.17s]
[0m10:48:36.690909 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m10:48:36.822645 [info ] [Thread-1 (]: 1 of 2 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.30s]
[0m10:48:36.824214 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m10:48:36.826694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:36.830090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:36.831126 [debug] [MainThread]: Connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6' was properly closed.
[0m10:48:36.831980 [debug] [MainThread]: Connection 'test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e' was properly closed.
[0m10:48:36.832776 [info ] [MainThread]: 
[0m10:48:36.834303 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m10:48:36.835873 [debug] [MainThread]: Command end result
[0m10:48:36.941253 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:48:36.945976 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:48:36.954374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:48:36.955189 [info ] [MainThread]: 
[0m10:48:36.956071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:36.957232 [info ] [MainThread]: 
[0m10:48:36.958080 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:48:36.961127 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.7923403, "process_in_blocks": "0", "process_kernel_time": 1.502976, "process_mem_max_rss": "380344", "process_out_blocks": "0", "process_user_time": 4.877236}
[0m10:48:36.962337 [debug] [MainThread]: Command `dbt test` succeeded at 10:48:36.962193 after 6.79 seconds
[0m10:48:36.963273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d866ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7074e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70792870>]}
[0m10:48:36.964980 [debug] [MainThread]: Flushing usage events
[0m10:48:37.490463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:50.726562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba22720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bebd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cac0740>]}


============================== 10:50:50.733074 | 9274b1b4-3a5c-4701-b6c5-1d27023cfbce ==============================
[0m10:50:50.733074 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:50:50.734445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select agg_pollution_by_day', 'send_anonymous_usage_stats': 'True'}
[0m10:50:53.441898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b247ad0>]}
[0m10:50:53.500527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7211d2b0>]}
[0m10:50:53.503416 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:50:53.733729 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:50:53.922786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:50:53.924098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:50:53.958986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71c29b50>]}
[0m10:50:54.277043 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:50:54.282840 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:50:54.319911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71644fe0>]}
[0m10:50:54.321156 [info ] [MainThread]: Found 4 models, 52 data tests, 2 sources, 496 macros
[0m10:50:54.322820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af62330>]}
[0m10:50:54.326296 [info ] [MainThread]: 
[0m10:50:54.327780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:54.329105 [info ] [MainThread]: 
[0m10:50:54.330874 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:50:54.336048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:50:54.337536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:54.672893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9274b1b4-3a5c-4701-b6c5-1d27023cfbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71c45790>]}
[0m10:50:54.674964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:54.681701 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:50:54.682205 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:50:54.682628 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:50:54.683466 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:50:54.688374 [info ] [Thread-4 (]: 4 of 19 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m10:50:54.685712 [info ] [Thread-2 (]: 2 of 19 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m10:50:54.687299 [info ] [Thread-3 (]: 3 of 19 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m10:50:54.683201 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_agg_pollution_by_day_count_days__1 .......... [RUN]
[0m10:50:54.692556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68)
[0m10:50:54.690793 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m10:50:54.691500 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m10:50:54.689779 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9'
[0m10:50:54.693574 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:50:54.694739 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:50:54.695682 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:50:54.728822 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:50:54.718462 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"
[0m10:50:54.726211 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:50:54.696430 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:50:54.736232 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:50:54.743982 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:50:54.745055 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:50:54.763903 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:50:54.771621 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:50:54.772235 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:50:54.773527 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"
[0m10:50:54.774190 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:50:54.779151 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m10:50:54.782849 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:50:54.784091 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m10:50:54.785999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:50:54.791475 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:50:54.792205 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    '1'
)



  
  
      
    ) dbt_internal_test
[0m10:50:54.830319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:54.844287 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m10:50:54.881822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:50:55.538532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:adbabf43-60f4-4889-82eb-3d4e848ed3eb&page=queryresults
[0m10:50:55.540854 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:adbabf43-60f4-4889-82eb-3d4e848ed3eb&page=queryresults
[0m10:50:55.555175 [debug] [Thread-1 (]: Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:50:55.557219 [error] [Thread-1 (]: 1 of 19 ERROR accepted_values_agg_pollution_by_day_count_days__1 ............... [[31mERROR[0m in 0.86s]
[0m10:50:55.559065 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:50:55.559959 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:50:55.560444 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql.
[0m10:50:55.561328 [info ] [Thread-1 (]: 5 of 19 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m10:50:55.564179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m10:50:55.565174 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:50:55.569208 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:50:55.572247 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:55381ccd-e368-4469-aef2-3ecaf950746c&page=queryresults
[0m10:50:55.573378 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:50:55.576872 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:50:55.579653 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m10:50:55.580561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:55.582185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7efe5949-97a3-4ffb-a2a4-3879b976a9e4&page=queryresults
[0m10:50:55.630996 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ff8660ec-3e1f-414a-a397-ed630454eb4c&page=queryresults
[0m10:50:56.075345 [info ] [Thread-2 (]: 2 of 19 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.38s]
[0m10:50:56.077061 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:50:56.078449 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:50:56.080756 [info ] [Thread-2 (]: 6 of 19 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m10:50:56.084256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m10:50:56.083642 [info ] [Thread-4 (]: 4 of 19 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.39s]
[0m10:50:56.087304 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:50:56.087996 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:50:56.090037 [info ] [Thread-3 (]: 3 of 19 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.40s]
[0m10:50:56.092293 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:50:56.093319 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:50:56.094279 [info ] [Thread-3 (]: 8 of 19 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m10:50:56.095509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m10:50:56.096911 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:50:56.101845 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:50:56.090611 [info ] [Thread-4 (]: 7 of 19 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m10:50:56.103927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m10:50:56.086264 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:50:56.105225 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:50:56.109505 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:50:56.110142 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:50:56.115778 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:50:56.112912 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:50:56.118803 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:50:56.121737 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:50:56.122212 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m10:50:56.123603 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:50:56.127803 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:50:56.124834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:50:56.129925 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m10:50:56.174779 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m10:50:56.177994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:50:56.175711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:50:56.248223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:de94a772-8ead-482f-a5ad-5d568d09ce50&page=queryresults
[0m10:50:56.650763 [info ] [Thread-1 (]: 5 of 19 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.09s]
[0m10:50:56.653840 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:50:56.654985 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:50:56.656350 [info ] [Thread-1 (]: 9 of 19 START test not_null_agg_pollution_by_day_avg_SO2 ....................... [RUN]
[0m10:50:56.658932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m10:50:56.659981 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:50:56.666497 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:50:56.670811 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:50:56.673445 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:50:56.677673 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m10:50:56.678722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:56.752906 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f2e9f314-47e1-44a0-91c2-3fea8a9114f9&page=queryresults
[0m10:50:56.754820 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d2bbcbd2-ba6a-4e59-982b-a74ef8ecb817&page=queryresults
[0m10:50:56.769953 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:371519f0-ea81-4a6e-860d-75da714a33b4&page=queryresults
[0m10:50:57.199684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c14c10dd-030c-4007-9680-28615a35bff9&page=queryresults
[0m10:50:57.197061 [info ] [Thread-4 (]: 7 of 19 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 1.09s]
[0m10:50:57.207101 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:50:57.202405 [info ] [Thread-3 (]: 8 of 19 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 1.11s]
[0m10:50:57.201370 [info ] [Thread-2 (]: 6 of 19 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 1.12s]
[0m10:50:57.209324 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:50:57.210550 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:50:57.215149 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:50:57.217145 [info ] [Thread-3 (]: 11 of 19 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m10:50:57.218726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m10:50:57.219651 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:50:57.212037 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:50:57.212984 [info ] [Thread-4 (]: 10 of 19 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m10:50:57.229142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m10:50:57.229917 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:50:57.227732 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:50:57.228307 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:50:57.235980 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:50:57.237595 [info ] [Thread-2 (]: 12 of 19 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m10:50:57.241262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m10:50:57.244583 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:50:57.243969 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:50:57.242949 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:50:57.250015 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:50:57.253256 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:50:57.256025 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:50:57.273460 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m10:50:57.274567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:50:57.275383 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m10:50:57.278295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:50:57.276838 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:50:57.314545 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:50:57.362525 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:57.364060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:50:57.595705 [info ] [Thread-1 (]: 9 of 19 PASS not_null_agg_pollution_by_day_avg_SO2 ............................. [[32mPASS[0m in 0.94s]
[0m10:50:57.598436 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:50:57.600163 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:50:57.601117 [info ] [Thread-1 (]: 13 of 19 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m10:50:57.602493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m10:50:57.605346 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:50:57.624315 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:50:57.630236 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:50:57.633068 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:50:57.636881 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:57.637843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:57.958875 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:254dbd4d-5ca7-431d-97fb-091c459ef925&page=queryresults
[0m10:50:57.961768 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0b3e8c72-4612-412d-bd21-4bd5ff0e1eac&page=queryresults
[0m10:50:57.992698 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7936945a-9962-4ee7-b188-f1e25e1b832b&page=queryresults
[0m10:50:58.272540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3c6f01c9-9e44-44bb-915e-bcab647d6f64&page=queryresults
[0m10:50:58.285591 [info ] [Thread-4 (]: 10 of 19 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 1.06s]
[0m10:50:58.287211 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:50:58.288064 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:50:58.288923 [info ] [Thread-4 (]: 14 of 19 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m10:50:58.290414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m10:50:58.291474 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:50:58.295702 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:50:58.301355 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:50:58.305635 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:50:58.313551 [info ] [Thread-3 (]: 11 of 19 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 1.09s]
[0m10:50:58.315923 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:50:58.317082 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:58.317837 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:50:58.319584 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:50:58.320609 [info ] [Thread-3 (]: 15 of 19 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m10:50:58.323282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m10:50:58.327950 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:50:58.367411 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:50:58.368031 [info ] [Thread-2 (]: 12 of 19 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.13s]
[0m10:50:58.369498 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:50:58.371392 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:50:58.372508 [info ] [Thread-2 (]: 16 of 19 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m10:50:58.373300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m10:50:58.374002 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:50:58.374502 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:50:58.383446 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:50:58.377861 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:50:58.387918 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:58.388732 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:50:58.389176 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:50:58.396053 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:50:58.440110 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:58.441030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:50:58.603924 [info ] [Thread-1 (]: 13 of 19 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 1.00s]
[0m10:50:58.605229 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:50:58.606358 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:50:58.607241 [info ] [Thread-1 (]: 17 of 19 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m10:50:58.608247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m10:50:58.608959 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:50:58.612687 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:50:58.616823 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:50:58.619216 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:50:58.623220 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:58.624174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:58.931960 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47c54db6-408f-4784-9221-9c7c76938134&page=queryresults
[0m10:50:58.978259 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:82b67669-4734-4b8d-af0c-994dac647acc&page=queryresults
[0m10:50:59.017885 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:60bf5d9f-6ffd-4c7e-acaa-0aa978d8f29e&page=queryresults
[0m10:50:59.292541 [info ] [Thread-4 (]: 14 of 19 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 1.00s]
[0m10:50:59.313377 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:50:59.315806 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:50:59.318940 [info ] [Thread-4 (]: 18 of 19 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m10:50:59.296323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c9948ac3-e197-4b44-8bd3-f2e46010bbb4&page=queryresults
[0m10:50:59.320576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m10:50:59.322532 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:50:59.325765 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:50:59.329337 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:50:59.331874 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:50:59.336345 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:59.337702 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:50:59.416535 [info ] [Thread-3 (]: 15 of 19 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 1.09s]
[0m10:50:59.418449 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:50:59.419872 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:50:59.420883 [info ] [Thread-3 (]: 19 of 19 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m10:50:59.422584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m10:50:59.425211 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:50:59.425889 [info ] [Thread-2 (]: 16 of 19 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.05s]
[0m10:50:59.432268 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:50:59.430364 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:50:59.437794 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:50:59.441235 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:50:59.444966 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:50:59.445748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:50:59.656076 [info ] [Thread-1 (]: 17 of 19 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 1.05s]
[0m10:50:59.657822 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:50:59.930643 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d3e47eb3-8d1b-4677-85b5-2b2a61c62cfd&page=queryresults
[0m10:51:00.026719 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9a54bc41-ea3f-4d46-80a6-2daa5f35f906&page=queryresults
[0m10:51:00.272040 [info ] [Thread-4 (]: 18 of 19 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.95s]
[0m10:51:00.273798 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:51:00.375789 [info ] [Thread-3 (]: 19 of 19 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.95s]
[0m10:51:00.380131 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:51:00.391970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:00.395192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:00.395781 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db' was properly closed.
[0m10:51:00.396592 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m10:51:00.397309 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650' was properly closed.
[0m10:51:00.399813 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m10:51:00.401348 [info ] [MainThread]: 
[0m10:51:00.402565 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m10:51:00.406534 [debug] [MainThread]: Command end result
[0m10:51:00.530823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:51:00.542320 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:51:00.559751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:51:00.560893 [info ] [MainThread]: 
[0m10:51:00.562652 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:00.563870 [info ] [MainThread]: 
[0m10:51:00.565533 [error] [MainThread]: [31mFailure in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)[0m
[0m10:51:00.566566 [error] [MainThread]:   Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:51:00.568214 [info ] [MainThread]: 
[0m10:51:00.569747 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:51:00.570918 [info ] [MainThread]: 
[0m10:51:00.572096 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m10:51:00.592710 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.904929, "process_in_blocks": "136", "process_kernel_time": 1.822828, "process_mem_max_rss": "375444", "process_out_blocks": "0", "process_user_time": 4.666892}
[0m10:51:00.595374 [debug] [MainThread]: Command `dbt test` failed at 10:51:00.595204 after 9.91 seconds
[0m10:51:00.597976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be02930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be824b0>]}
[0m10:51:00.600014 [debug] [MainThread]: Flushing usage events
[0m10:51:01.071317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:20.320422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e53080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e503b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e533b0>]}


============================== 10:53:20.326606 | a167dcec-0f59-4c61-808e-8cba0d3ca060 ==============================
[0m10:53:20.326606 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:53:20.329120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select agg_pollution_by_day', 'send_anonymous_usage_stats': 'True'}
[0m10:53:22.867523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809512b0>]}
[0m10:53:22.903899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a13f80>]}
[0m10:53:22.905261 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:53:23.085235 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:53:23.198883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:23.200498 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m10:53:23.645157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e833ad0>]}
[0m10:53:23.812228 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:53:23.815730 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:53:23.850710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e84bf20>]}
[0m10:53:23.851701 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m10:53:23.852836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1691f0>]}
[0m10:53:23.855218 [info ] [MainThread]: 
[0m10:53:23.856591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:23.858385 [info ] [MainThread]: 
[0m10:53:23.864576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:53:23.872858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:53:23.873876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:24.196066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a167dcec-0f59-4c61-808e-8cba0d3ca060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f615a00>]}
[0m10:53:24.197666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:24.202817 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:53:24.203162 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:53:24.203513 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:53:24.204116 [info ] [Thread-1 (]: 1 of 21 START test accepted_values_agg_pollution_by_day_count_days__1 .......... [RUN]
[0m10:53:24.204598 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:53:24.205159 [info ] [Thread-2 (]: 2 of 21 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m10:53:24.206238 [info ] [Thread-3 (]: 3 of 21 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m10:53:24.207814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68)
[0m10:53:24.209591 [info ] [Thread-4 (]: 4 of 21 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m10:53:24.212347 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m10:53:24.213955 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m10:53:24.215613 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:53:24.216875 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9'
[0m10:53:24.218009 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:53:24.218863 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:53:24.226177 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"
[0m10:53:24.226509 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:53:24.233371 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:53:24.237835 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:53:24.242931 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:53:24.243938 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:53:24.268310 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:53:24.287866 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:53:24.290832 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"
[0m10:53:24.292518 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:53:24.295920 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:53:24.296213 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:53:24.303203 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:53:24.304440 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    '1'
)



  
  
      
    ) dbt_internal_test
[0m10:53:24.311155 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m10:53:24.327136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:24.327952 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m10:53:24.328811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:53:24.329291 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m10:53:24.330936 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:24.474779 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:24.889101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a50475ee-7467-4424-904c-bf813f90f439&page=queryresults
[0m10:53:24.890866 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a50475ee-7467-4424-904c-bf813f90f439&page=queryresults
[0m10:53:24.898388 [debug] [Thread-1 (]: Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:53:24.899666 [error] [Thread-1 (]: 1 of 21 ERROR accepted_values_agg_pollution_by_day_count_days__1 ............... [[31mERROR[0m in 0.69s]
[0m10:53:24.900892 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68
[0m10:53:24.902398 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:53:24.903051 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql.
[0m10:53:24.903506 [info ] [Thread-1 (]: 5 of 21 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m10:53:24.906671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__1.7c9fbcea68, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m10:53:24.908098 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:53:24.912945 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:53:24.916830 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:53:24.919174 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:53:24.920168 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb5d9efa-c463-47be-ba6a-4c337c37bad8&page=queryresults
[0m10:53:24.931121 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m10:53:24.932758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:24.978353 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:84c23322-38cb-4a58-902d-aa230f170b81&page=queryresults
[0m10:53:24.993386 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bc0aaf05-dabd-4b41-9cab-803be087f8c1&page=queryresults
[0m10:53:25.310787 [info ] [Thread-2 (]: 2 of 21 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.10s]
[0m10:53:25.312272 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:53:25.313071 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:53:25.313755 [info ] [Thread-2 (]: 6 of 21 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m10:53:25.315193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m10:53:25.317977 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:53:25.324253 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:53:25.326537 [info ] [Thread-3 (]: 3 of 21 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.11s]
[0m10:53:25.329055 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:53:25.330887 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:53:25.332581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eb9d2e34-168f-4e61-9296-89c0b1d78ba4&page=queryresults
[0m10:53:25.331944 [info ] [Thread-3 (]: 7 of 21 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m10:53:25.333677 [info ] [Thread-4 (]: 4 of 21 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.12s]
[0m10:53:25.334168 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:53:25.336060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m10:53:25.337092 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:53:25.339902 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:53:25.340697 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:53:25.341470 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:53:25.347512 [info ] [Thread-4 (]: 8 of 21 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m10:53:25.350842 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m10:53:25.348448 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m10:53:25.353324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:25.352141 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:53:25.360214 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:53:25.346477 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:53:25.400484 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:53:25.405014 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:53:25.405687 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:53:25.411742 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:53:25.419772 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m10:53:25.420823 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:25.421279 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m10:53:25.423679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:25.711434 [info ] [Thread-1 (]: 5 of 21 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.80s]
[0m10:53:25.713004 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:53:25.713838 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:53:25.714612 [info ] [Thread-1 (]: 9 of 21 START test not_null_agg_pollution_by_day_avg_SO2 ....................... [RUN]
[0m10:53:25.715588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m10:53:25.716848 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:53:25.721134 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:53:25.725231 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:53:25.728713 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:53:25.731681 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m10:53:25.732564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:25.828633 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:77920736-f088-491e-84dd-394d95e70758&page=queryresults
[0m10:53:25.831691 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b0a78c17-78b1-4a51-8bb3-d1a5c37fcbb6&page=queryresults
[0m10:53:25.835555 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fcf09226-ff61-44df-b115-f4615b4ef8dc&page=queryresults
[0m10:53:26.146268 [info ] [Thread-2 (]: 6 of 21 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.83s]
[0m10:53:26.147455 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:53:26.148245 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:53:26.149119 [info ] [Thread-2 (]: 10 of 21 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m10:53:26.149882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m10:53:26.150508 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:53:26.154845 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:53:26.158198 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:53:26.161068 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:53:26.166296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a5e4f37-a00b-4052-9266-b52677dac80a&page=queryresults
[0m10:53:26.167631 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m10:53:26.169369 [info ] [Thread-3 (]: 7 of 21 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.83s]
[0m10:53:26.170310 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:26.171287 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:53:26.208483 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:53:26.210004 [info ] [Thread-4 (]: 8 of 21 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.86s]
[0m10:53:26.212086 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:53:26.210542 [info ] [Thread-3 (]: 11 of 21 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m10:53:26.213465 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:53:26.214376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m10:53:26.215257 [info ] [Thread-4 (]: 12 of 21 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m10:53:26.216386 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:53:26.217290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m10:53:26.222251 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:53:26.221473 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:53:26.225643 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m10:53:26.228670 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:53:26.229131 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:53:26.231065 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:53:26.233645 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m10:53:26.245819 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m10:53:26.246648 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m10:53:26.248069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:26.248960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:26.574737 [info ] [Thread-1 (]: 9 of 21 PASS not_null_agg_pollution_by_day_avg_SO2 ............................. [[32mPASS[0m in 0.86s]
[0m10:53:26.581352 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:53:26.593486 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:53:26.597956 [info ] [Thread-1 (]: 13 of 21 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m10:53:26.601271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m10:53:26.602378 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:53:26.608891 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:53:26.612714 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:53:26.615299 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:53:26.618452 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:26.619193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:26.668981 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1335737e-c1ce-4290-9d74-0d57fcc7ee5a&page=queryresults
[0m10:53:26.802596 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7cc68429-5307-447a-92ad-70f23caf67dc&page=queryresults
[0m10:53:26.921242 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64308f7e-96a7-41fb-97c6-848ee9d89c15&page=queryresults
[0m10:53:26.987369 [info ] [Thread-2 (]: 10 of 21 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.84s]
[0m10:53:26.988982 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:53:26.989857 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:53:26.990711 [info ] [Thread-2 (]: 14 of 21 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m10:53:26.991514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m10:53:26.992248 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:53:26.996833 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:53:26.999448 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:53:27.001809 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:53:27.004613 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:27.005433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:27.143928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9b81f17a-a4a1-4a20-a6ca-663d6b5bebe0&page=queryresults
[0m10:53:27.193679 [info ] [Thread-3 (]: 11 of 21 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.98s]
[0m10:53:27.195011 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:53:27.195979 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:53:27.196735 [info ] [Thread-3 (]: 15 of 21 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m10:53:27.197533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m10:53:27.198441 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:53:27.202203 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:53:27.206250 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:53:27.208720 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:53:27.212627 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:27.213783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:27.255597 [info ] [Thread-4 (]: 12 of 21 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 1.04s]
[0m10:53:27.257052 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:53:27.258101 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:53:27.258857 [info ] [Thread-4 (]: 16 of 21 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m10:53:27.259622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m10:53:27.260395 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:53:27.263560 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:53:27.267300 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:53:27.269809 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:53:27.274633 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:27.275851 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:27.467006 [info ] [Thread-1 (]: 13 of 21 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.87s]
[0m10:53:27.468263 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:53:27.469728 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:53:27.470621 [info ] [Thread-1 (]: 17 of 21 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m10:53:27.471379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m10:53:27.472144 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:53:27.475371 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:53:27.478075 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:53:27.480322 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:53:27.483256 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:27.484564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:27.657549 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d9ab1e30-12f3-4ca1-a091-ec2aa19a2a4e&page=queryresults
[0m10:53:27.783856 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1885f409-4055-44d3-bc45-4cd985a79386&page=queryresults
[0m10:53:27.820070 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a1a9280a-0729-4a30-9123-28084a9ac9c8&page=queryresults
[0m10:53:27.943265 [info ] [Thread-2 (]: 14 of 21 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.95s]
[0m10:53:27.944637 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:53:27.945498 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:53:27.946480 [info ] [Thread-2 (]: 18 of 21 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m10:53:27.947360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m10:53:27.948047 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:53:27.951291 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:53:27.953799 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:53:27.956438 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:53:27.959108 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:27.959967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.019685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e049ef59-7eb3-4ba4-8700-3ce2cecd3495&page=queryresults
[0m10:53:28.080233 [info ] [Thread-3 (]: 15 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.88s]
[0m10:53:28.081879 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:53:28.082744 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:53:28.083640 [info ] [Thread-3 (]: 19 of 21 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m10:53:28.084695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m10:53:28.085571 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:53:28.089752 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:53:28.091996 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:53:28.094664 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:53:28.097260 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:28.098521 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.136324 [info ] [Thread-4 (]: 16 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.88s]
[0m10:53:28.140096 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:53:28.140906 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:53:28.142056 [info ] [Thread-4 (]: 20 of 21 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m10:53:28.143276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m10:53:28.144457 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:53:28.148923 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:53:28.151955 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:53:28.156207 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:53:28.161831 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:53:28.162726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:28.335226 [info ] [Thread-1 (]: 17 of 21 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.86s]
[0m10:53:28.336466 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:53:28.337376 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:53:28.338147 [info ] [Thread-1 (]: 21 of 21 START test test_is_last_date_inserted_agg_pollution_by_day_date__date . [RUN]
[0m10:53:28.339049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067)
[0m10:53:28.339693 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:53:28.342933 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"
[0m10:53:28.346062 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:53:28.347988 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"
[0m10:53:28.351272 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT city_id, MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city_id
)

SELECT city_id, max_date_time
FROM max_date_time_cte
WHERE
    
      max_date_time  -- assume already date type
    
    < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m10:53:28.352443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.509062 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:01bbd1ad-0f3e-4fc8-80f4-2d16e2852a02&page=queryresults
[0m10:53:28.674039 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:10dacbad-9a06-4420-8d49-09a7a4854643&page=queryresults
[0m10:53:28.694821 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aef4b3ae-60af-4a0c-a984-015a8b8ed185&page=queryresults
[0m10:53:28.731884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc295ee2-023e-4850-9115-69ae298dfdaa&page=queryresults
[0m10:53:28.733344 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc295ee2-023e-4850-9115-69ae298dfdaa&page=queryresults
[0m10:53:28.737929 [debug] [Thread-1 (]: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:53:28.739197 [error] [Thread-1 (]: 21 of 21 ERROR test_is_last_date_inserted_agg_pollution_by_day_date__date ...... [[31mERROR[0m in 0.40s]
[0m10:53:28.740712 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:53:28.742121 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067' to be skipped because of status 'error'.  Reason: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql.
[0m10:53:28.921933 [info ] [Thread-2 (]: 18 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.97s]
[0m10:53:28.923406 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:53:28.968300 [info ] [Thread-3 (]: 19 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.88s]
[0m10:53:28.970571 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:53:29.005974 [info ] [Thread-4 (]: 20 of 21 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.86s]
[0m10:53:29.007460 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:53:29.011572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:29.014591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:29.015975 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067' was properly closed.
[0m10:53:29.016867 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db' was properly closed.
[0m10:53:29.017577 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m10:53:29.018382 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m10:53:29.019302 [info ] [MainThread]: 
[0m10:53:29.020240 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m10:53:29.023936 [debug] [MainThread]: Command end result
[0m10:53:29.132337 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:53:29.138651 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:53:29.150275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:53:29.151209 [info ] [MainThread]: 
[0m10:53:29.152193 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:53:29.152999 [info ] [MainThread]: 
[0m10:53:29.154005 [error] [MainThread]: [31mFailure in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)[0m
[0m10:53:29.154837 [error] [MainThread]:   Database Error in test accepted_values_agg_pollution_by_day_count_days__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:53:29.155810 [info ] [MainThread]: 
[0m10:53:29.156984 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__1.sql
[0m10:53:29.157809 [info ] [MainThread]: 
[0m10:53:29.158604 [error] [MainThread]: [31mFailure in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)[0m
[0m10:53:29.159398 [error] [MainThread]:   Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:53:29.160162 [info ] [MainThread]: 
[0m10:53:29.160821 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:53:29.161781 [info ] [MainThread]: 
[0m10:53:29.163085 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=21
[0m10:53:29.168087 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.907855, "process_in_blocks": "0", "process_kernel_time": 1.674523, "process_mem_max_rss": "382104", "process_out_blocks": "0", "process_user_time": 5.26624}
[0m10:53:29.170067 [debug] [MainThread]: Command `dbt test` failed at 10:53:29.169880 after 8.91 seconds
[0m10:53:29.171603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b56e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5b2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6ebfb0>]}
[0m10:53:29.172820 [debug] [MainThread]: Flushing usage events
[0m10:53:29.637516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:51.906518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878fcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dbd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c9eb10>]}


============================== 10:56:51.911816 | 54be9ef3-c999-40e6-bd53-3789d128118d ==============================
[0m10:56:51.911816 [info ] [MainThread]: Running with dbt=1.10.3
[0m10:56:51.912929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select agg_pollution_by_day', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:54.676132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878ff800>]}
[0m10:56:54.713032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a24d70>]}
[0m10:56:54.715486 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:56:54.869396 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m10:56:54.973000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:56:54.974449 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m10:56:55.392592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d17d0d0>]}
[0m10:56:55.518306 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:56:55.523104 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:56:55.563834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d1700b0>]}
[0m10:56:55.566413 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m10:56:55.570211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d003a10>]}
[0m10:56:55.573789 [info ] [MainThread]: 
[0m10:56:55.575392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:56:55.576313 [info ] [MainThread]: 
[0m10:56:55.577678 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:56:55.592138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m10:56:55.596525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:56.053684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54be9ef3-c999-40e6-bd53-3789d128118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d066fc0>]}
[0m10:56:56.056060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:56.066136 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m10:56:56.066626 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:56:56.067094 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:56:56.067460 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:56:56.071217 [info ] [Thread-4 (]: 4 of 21 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m10:56:56.069022 [info ] [Thread-2 (]: 2 of 21 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m10:56:56.069903 [info ] [Thread-3 (]: 3 of 21 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m10:56:56.067900 [info ] [Thread-1 (]: 1 of 21 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m10:56:56.075967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m10:56:56.073759 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m10:56:56.075068 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m10:56:56.072839 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9'
[0m10:56:56.077166 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m10:56:56.078353 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:56:56.079333 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:56:56.080411 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:56:56.090009 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m10:56:56.100022 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:56:56.102763 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:56:56.107140 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:56:56.112778 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m10:56:56.137089 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:56:56.137563 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:56:56.146746 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m10:56:56.141986 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m10:56:56.143840 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m10:56:56.137859 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:56:56.154181 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m10:56:56.157754 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:56:56.156940 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m10:56:56.166197 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m10:56:56.167052 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m10:56:56.207785 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:56:56.206214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:56.213106 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m10:56:56.254100 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:56:56.785207 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:277984d3-a3e6-476b-8c0f-670e0bf1bec5&page=queryresults
[0m10:56:56.786370 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2c6c64ab-7b67-4662-a332-e37d3ab316e2&page=queryresults
[0m10:56:56.930934 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cfa6adfb-1933-49ff-9d1c-6bb97372a6a2&page=queryresults
[0m10:56:56.948503 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4d58045b-05bb-414d-8cde-d2019386f0f1&page=queryresults
[0m10:56:57.212326 [info ] [Thread-4 (]: 4 of 21 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.14s]
[0m10:56:57.213915 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m10:56:57.214629 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:56:57.215310 [info ] [Thread-4 (]: 5 of 21 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m10:56:57.216280 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m10:56:57.217308 [info ] [Thread-3 (]: 3 of 21 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.14s]
[0m10:56:57.217607 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:56:57.218441 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m10:56:57.221999 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:56:57.222784 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:56:57.224797 [info ] [Thread-3 (]: 6 of 21 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m10:56:57.228471 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m10:56:57.229764 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:56:57.234125 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:56:57.230072 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:56:57.238189 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m10:56:57.239305 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:56:57.242712 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m10:56:57.245178 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m10:56:57.246933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:57.248045 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m10:56:57.283899 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:57.287887 [info ] [Thread-2 (]: 2 of 21 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.21s]
[0m10:56:57.289930 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m10:56:57.291531 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:56:57.328697 [info ] [Thread-2 (]: 7 of 21 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m10:56:57.330488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m10:56:57.331435 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:56:57.334968 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:56:57.341139 [info ] [Thread-1 (]: 1 of 21 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.27s]
[0m10:56:57.342637 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m10:56:57.343980 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:56:57.344671 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:56:57.346920 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m10:56:57.347792 [info ] [Thread-1 (]: 8 of 21 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m10:56:57.349329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m10:56:57.350769 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:56:57.354880 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:56:57.351926 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m10:56:57.356632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:57.407937 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:56:57.413961 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m10:56:57.416965 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m10:56:57.418150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:57.680897 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e453b3df-dba0-4eef-9524-760c191540df&page=queryresults
[0m10:56:57.758196 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8dfc83f3-63e7-4098-a3b7-9507c763e2ba&page=queryresults
[0m10:56:57.839058 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7917ad40-8577-4129-8f00-33f5adf1028c&page=queryresults
[0m10:56:57.847795 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1ebc9a6b-8ec5-4a58-af17-861b08f54557&page=queryresults
[0m10:56:58.005614 [info ] [Thread-4 (]: 5 of 21 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.79s]
[0m10:56:58.007132 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m10:56:58.008185 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:56:58.009301 [info ] [Thread-4 (]: 9 of 21 START test not_null_agg_pollution_by_day_avg_SO2 ....................... [RUN]
[0m10:56:58.011333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m10:56:58.012089 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:56:58.015932 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:56:58.019160 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:56:58.022160 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m10:56:58.024994 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m10:56:58.025734 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:58.112801 [info ] [Thread-3 (]: 6 of 21 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.88s]
[0m10:56:58.115094 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m10:56:58.116025 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:56:58.116906 [info ] [Thread-3 (]: 10 of 21 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m10:56:58.118329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m10:56:58.119781 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:56:58.125010 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:56:58.127895 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:56:58.133712 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m10:56:58.138942 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m10:56:58.141800 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:58.188377 [info ] [Thread-2 (]: 7 of 21 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.86s]
[0m10:56:58.189111 [info ] [Thread-1 (]: 8 of 21 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.84s]
[0m10:56:58.192066 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m10:56:58.190587 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m10:56:58.193105 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:56:58.194042 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:56:58.194914 [info ] [Thread-1 (]: 11 of 21 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m10:56:58.195824 [info ] [Thread-2 (]: 12 of 21 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m10:56:58.197935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m10:56:58.198678 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:56:58.197096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m10:56:58.204671 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:56:58.208104 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:56:58.203511 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m10:56:58.212034 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:56:58.214288 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m10:56:58.214827 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:56:58.216975 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m10:56:58.218608 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m10:56:58.220787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:58.221838 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m10:56:58.255518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:58.520143 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:40be98d7-ea32-40c3-9c10-a5fcec027e05&page=queryresults
[0m10:56:58.648955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1100d951-8c2b-4b79-8e4e-2bde760d0cf1&page=queryresults
[0m10:56:58.649788 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74f6b8d9-559a-465d-b722-99f9a0568adb&page=queryresults
[0m10:56:58.725296 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:37699d3f-fa8c-4789-8fc4-f1e2ba78efcc&page=queryresults
[0m10:56:58.909642 [info ] [Thread-4 (]: 9 of 21 PASS not_null_agg_pollution_by_day_avg_SO2 ............................. [[32mPASS[0m in 0.90s]
[0m10:56:58.921305 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m10:56:58.929117 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:56:58.930775 [info ] [Thread-4 (]: 13 of 21 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m10:56:58.932059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m10:56:58.932812 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:56:58.937129 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:56:58.940986 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:56:58.943099 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m10:56:58.946086 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:58.947282 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:58.991420 [info ] [Thread-1 (]: 11 of 21 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.79s]
[0m10:56:58.994453 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m10:56:58.995603 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:56:58.996522 [info ] [Thread-1 (]: 14 of 21 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m10:56:58.998079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m10:56:58.999172 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:56:58.997359 [info ] [Thread-2 (]: 12 of 21 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 0.80s]
[0m10:56:59.002454 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:56:59.004245 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m10:56:59.006279 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:56:59.007048 [info ] [Thread-2 (]: 15 of 21 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m10:56:59.008162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m10:56:59.008891 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:56:59.010816 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:56:59.013509 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m10:56:59.016850 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:56:59.020705 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:59.021409 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:56:59.021878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:59.024088 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m10:56:59.061922 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:59.064985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:59.145925 [info ] [Thread-3 (]: 10 of 21 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 1.03s]
[0m10:56:59.147279 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m10:56:59.148862 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:56:59.149768 [info ] [Thread-3 (]: 16 of 21 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m10:56:59.150817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m10:56:59.152717 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:56:59.161132 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:56:59.165158 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:56:59.167440 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m10:56:59.170214 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:59.170947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:59.669625 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f3a69e0a-3bfc-49be-a4af-8b8650d40291&page=queryresults
[0m10:56:59.670167 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0d62c9e8-4921-47b8-a329-cbc3dcc3f33f&page=queryresults
[0m10:56:59.670717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:af486a39-0ddc-4ad1-8549-1cd4e5340ebd&page=queryresults
[0m10:56:59.758972 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7b67d6b-4e08-49e4-82aa-5a98a0a530d9&page=queryresults
[0m10:56:59.958975 [info ] [Thread-1 (]: 14 of 21 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.96s]
[0m10:56:59.960574 [info ] [Thread-2 (]: 15 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.95s]
[0m10:56:59.961171 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m10:56:59.962426 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m10:56:59.963355 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:56:59.964473 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:56:59.965373 [info ] [Thread-1 (]: 17 of 21 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m10:56:59.967233 [info ] [Thread-2 (]: 18 of 21 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m10:56:59.968876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m10:56:59.970509 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:56:59.969766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m10:56:59.974529 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:56:59.975547 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:56:59.980977 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:56:59.982098 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:56:59.985735 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m10:56:59.986748 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:56:59.988777 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m10:56:59.989884 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:59.991667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:59.992950 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:56:59.994542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:00.030625 [info ] [Thread-4 (]: 13 of 21 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.10s]
[0m10:57:00.069219 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m10:57:00.071033 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:57:00.072808 [info ] [Thread-4 (]: 19 of 21 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m10:57:00.075192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m10:57:00.075997 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:57:00.079141 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:57:00.080715 [info ] [Thread-3 (]: 16 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.93s]
[0m10:57:00.081735 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m10:57:00.082569 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:57:00.083085 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:57:00.083596 [info ] [Thread-3 (]: 20 of 21 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m10:57:00.085823 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m10:57:00.086490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m10:57:00.087671 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:57:00.095785 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:57:00.097134 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:57:00.098344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:00.099763 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:57:00.103687 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m10:57:00.140572 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m10:57:00.142016 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:00.693638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0432f9cb-6b80-49d1-a05f-4528c80086eb&page=queryresults
[0m10:57:00.696032 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9cef7603-f3c1-4682-837a-82cd6218a05f&page=queryresults
[0m10:57:00.696993 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:44ad6da9-f707-4858-afcf-903807d9386c&page=queryresults
[0m10:57:00.703967 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:20034bbc-a41a-4b22-8d72-6d9f129d6ed8&page=queryresults
[0m10:57:01.009050 [info ] [Thread-2 (]: 18 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 1.04s]
[0m10:57:01.012348 [info ] [Thread-3 (]: 20 of 21 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.93s]
[0m10:57:01.024574 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m10:57:01.027257 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:57:01.016416 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m10:57:01.029794 [info ] [Thread-3 (]: 21 of 21 START test test_is_last_date_inserted_agg_pollution_by_day_date__date . [RUN]
[0m10:57:01.031192 [info ] [Thread-4 (]: 19 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.96s]
[0m10:57:01.033088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067)
[0m10:57:01.035136 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:57:01.041089 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"
[0m10:57:01.033976 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m10:57:01.044251 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:57:01.046849 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"
[0m10:57:01.049686 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT city_id, MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city_id
)

SELECT city_id, max_date_time
FROM max_date_time_cte
WHERE
    
      max_date_time  -- assume already date type
    
    < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m10:57:01.050419 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:01.111338 [info ] [Thread-1 (]: 17 of 21 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.14s]
[0m10:57:01.112766 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m10:57:01.409102 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d11c1861-8e76-46cd-b194-1a7a5626e09a&page=queryresults
[0m10:57:01.410627 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d11c1861-8e76-46cd-b194-1a7a5626e09a&page=queryresults
[0m10:57:01.419687 [debug] [Thread-3 (]: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:57:01.421009 [error] [Thread-3 (]: 21 of 21 ERROR test_is_last_date_inserted_agg_pollution_by_day_date__date ...... [[31mERROR[0m in 0.39s]
[0m10:57:01.421993 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067
[0m10:57:01.423711 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067' to be skipped because of status 'error'.  Reason: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql.
[0m10:57:01.430228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:01.433129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:01.433923 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650' was properly closed.
[0m10:57:01.434790 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m10:57:01.435594 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db' was properly closed.
[0m10:57:01.436509 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date__date.f9d1c50067' was properly closed.
[0m10:57:01.437644 [info ] [MainThread]: 
[0m10:57:01.438649 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m10:57:01.441548 [debug] [MainThread]: Command end result
[0m10:57:01.565625 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m10:57:01.572212 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m10:57:01.583201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m10:57:01.583949 [info ] [MainThread]: 
[0m10:57:01.584743 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:57:01.585706 [info ] [MainThread]: 
[0m10:57:01.586701 [error] [MainThread]: [31mFailure in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)[0m
[0m10:57:01.587439 [error] [MainThread]:   Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date__date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [13:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:57:01.588131 [info ] [MainThread]: 
[0m10:57:01.588929 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date__date.sql
[0m10:57:01.589784 [info ] [MainThread]: 
[0m10:57:01.590712 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m10:57:01.595177 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.732779, "process_in_blocks": "0", "process_kernel_time": 1.874202, "process_mem_max_rss": "382000", "process_out_blocks": "0", "process_user_time": 4.752148}
[0m10:57:01.597513 [debug] [MainThread]: Command `dbt test` failed at 10:57:01.597377 after 9.74 seconds
[0m10:57:01.598863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbc7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872782c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6deef260>]}
[0m10:57:01.599749 [debug] [MainThread]: Flushing usage events
[0m10:57:02.064690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:27.871228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf36db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de68ce0>]}


============================== 11:04:27.877370 | 3374f3af-8255-4fbb-a470-18f791ee4e57 ==============================
[0m11:04:27.877370 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:04:27.878678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select agg_pollution_by_day', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:04:30.553193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739e0bc0>]}
[0m11:04:30.590668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f445130>]}
[0m11:04:30.591977 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:04:30.752859 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m11:04:30.862860 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:04:30.865529 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/tes_is_last_date_inserted.sql
[0m11:04:30.866359 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_is_last_datetime_inserted.sql
[0m11:04:30.867630 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m11:04:30.868296 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/tests/test_is_last_date_inserted.sql
[0m11:04:31.306801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bb12b0>]}
[0m11:04:31.437440 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:04:31.441770 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:04:31.466852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7292d370>]}
[0m11:04:31.467675 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 497 macros
[0m11:04:31.468514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f444950>]}
[0m11:04:31.470451 [info ] [MainThread]: 
[0m11:04:31.471080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:31.471600 [info ] [MainThread]: 
[0m11:04:31.472412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:04:31.475339 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m11:04:31.475926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:31.827731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3374f3af-8255-4fbb-a470-18f791ee4e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b56150>]}
[0m11:04:31.830282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:31.837135 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:04:31.837634 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:04:31.838103 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:04:31.840541 [info ] [Thread-3 (]: 3 of 21 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m11:04:31.839114 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:04:31.839625 [info ] [Thread-2 (]: 2 of 21 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m11:04:31.843103 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m11:04:31.841329 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m11:04:31.842277 [info ] [Thread-4 (]: 4 of 21 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m11:04:31.838538 [info ] [Thread-1 (]: 1 of 21 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m11:04:31.843786 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:04:31.844465 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:04:31.845241 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9'
[0m11:04:31.845951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m11:04:31.854071 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:04:31.857310 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:04:31.858048 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:04:31.858850 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:04:31.864349 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:04:31.868641 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:04:31.869335 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:04:31.869713 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:04:31.896478 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:04:31.894603 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:04:31.896959 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:04:31.897255 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:04:31.900158 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m11:04:31.912206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:04:31.905519 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m11:04:31.909241 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:04:31.904883 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:04:31.918362 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:04:31.957823 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m11:04:31.959541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:32.026221 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m11:04:32.027535 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:04:32.475659 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:39676369-fa42-448c-8a6d-8dcb8db04f80&page=queryresults
[0m11:04:32.476717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f600ad3e-7822-4747-9afd-9ef52cb69c7b&page=queryresults
[0m11:04:32.484987 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:88232e0e-c0e5-4bf5-addf-8f6f56e41b85&page=queryresults
[0m11:04:32.520286 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:516636f3-9dfc-4388-a240-fe769f9ffa1f&page=queryresults
[0m11:04:32.890537 [info ] [Thread-2 (]: 2 of 21 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.05s]
[0m11:04:32.892180 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:04:32.893484 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:04:32.894606 [info ] [Thread-2 (]: 5 of 21 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m11:04:32.895675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m11:04:32.896797 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:04:32.905466 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:04:32.909126 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:04:32.911423 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:04:32.913802 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m11:04:32.914686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:32.956812 [info ] [Thread-3 (]: 3 of 21 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.12s]
[0m11:04:32.958324 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:04:32.959266 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:04:32.960292 [info ] [Thread-3 (]: 6 of 21 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m11:04:32.962341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m11:04:32.964253 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:04:32.969241 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:04:32.972438 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:04:32.975779 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:04:32.978407 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m11:04:32.979890 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:33.019742 [info ] [Thread-4 (]: 4 of 21 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.17s]
[0m11:04:33.021687 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:04:33.025910 [info ] [Thread-1 (]: 1 of 21 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.18s]
[0m11:04:33.029801 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:04:33.031379 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:04:33.027050 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:04:33.033398 [info ] [Thread-4 (]: 7 of 21 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m11:04:33.032215 [info ] [Thread-1 (]: 8 of 21 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m11:04:33.035619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m11:04:33.037441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m11:04:33.038640 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:04:33.039591 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:04:33.056670 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:04:33.060026 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:04:33.064470 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:04:33.065261 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:04:33.067861 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:04:33.070349 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:04:33.074538 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m11:04:33.075375 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:04:33.081456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:33.077804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:33.483785 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aa5d2eb2-a602-4d3a-9316-4e354ea04383&page=queryresults
[0m11:04:33.551455 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:857fc60b-0feb-442e-8b1d-44fc52a48f99&page=queryresults
[0m11:04:33.562947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:db419a8d-7d56-4192-9814-2409e7626f1a&page=queryresults
[0m11:04:33.635873 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13f865eb-a514-4748-9d5f-07e6f532bfa9&page=queryresults
[0m11:04:33.834568 [info ] [Thread-2 (]: 5 of 21 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.94s]
[0m11:04:33.836160 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:04:33.837101 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:04:33.837900 [info ] [Thread-2 (]: 9 of 21 START test not_null_agg_pollution_by_day_avg_SO2 ....................... [RUN]
[0m11:04:33.838606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m11:04:33.839472 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:04:33.843597 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:04:33.848554 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:04:33.850891 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:04:33.854740 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m11:04:33.856272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:33.902807 [info ] [Thread-1 (]: 8 of 21 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.87s]
[0m11:04:33.903690 [info ] [Thread-3 (]: 6 of 21 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.94s]
[0m11:04:33.904785 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:04:33.905842 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:04:33.906641 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:04:33.907554 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:04:33.908418 [info ] [Thread-1 (]: 10 of 21 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m11:04:33.909632 [info ] [Thread-3 (]: 11 of 21 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m11:04:33.911859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m11:04:33.910560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m11:04:33.912940 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:04:33.913940 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:04:33.925004 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:04:33.919938 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:04:33.929438 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:04:33.932686 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:04:33.933195 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:04:33.937039 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:04:33.938218 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:04:33.939819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:33.942070 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m11:04:33.943766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:33.979415 [info ] [Thread-4 (]: 7 of 21 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.94s]
[0m11:04:33.988350 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:04:33.989663 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:04:34.029977 [info ] [Thread-4 (]: 12 of 21 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m11:04:34.032022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m11:04:34.033339 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:04:34.036760 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:04:34.040162 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:04:34.043018 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:04:34.045559 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:04:34.046291 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:34.395195 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:00776d90-f546-4335-9d3f-ae55287302f9&page=queryresults
[0m11:04:34.425726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15d30434-cb8d-41b4-8551-677d06faf291&page=queryresults
[0m11:04:34.445989 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f6b15c08-68f0-4c1d-843d-2ec23c228843&page=queryresults
[0m11:04:34.462751 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bf2c3724-8d23-468c-9263-3ab1f518da86&page=queryresults
[0m11:04:34.730252 [info ] [Thread-2 (]: 9 of 21 PASS not_null_agg_pollution_by_day_avg_SO2 ............................. [[32mPASS[0m in 0.89s]
[0m11:04:34.731730 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:04:34.732478 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:04:34.733342 [info ] [Thread-2 (]: 13 of 21 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m11:04:34.734364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m11:04:34.735106 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:04:34.741357 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:04:34.744654 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:04:34.747085 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:04:34.752316 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:34.754156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:34.756817 [info ] [Thread-1 (]: 10 of 21 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.85s]
[0m11:04:34.791330 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:04:34.792104 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:04:34.792878 [info ] [Thread-1 (]: 14 of 21 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m11:04:34.794481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m11:04:34.795356 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:04:34.798822 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:04:34.801091 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:04:34.804256 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:04:34.806461 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:34.807207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:34.843657 [info ] [Thread-4 (]: 12 of 21 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 0.81s]
[0m11:04:34.845111 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:04:34.846336 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:04:34.847164 [info ] [Thread-4 (]: 15 of 21 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m11:04:34.848300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m11:04:34.849156 [info ] [Thread-3 (]: 11 of 21 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.94s]
[0m11:04:34.853155 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:04:34.854411 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:04:34.858888 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:04:34.860146 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:04:34.862094 [info ] [Thread-3 (]: 16 of 21 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m11:04:34.863143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m11:04:34.863850 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:04:34.867595 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:04:34.864546 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:04:34.870763 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:04:34.872196 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:04:34.874538 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:04:34.875543 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:34.882101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:34.883323 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:34.916631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:35.446589 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9a4762b6-51d0-4f47-a5f9-7536f5af3d03&page=queryresults
[0m11:04:35.454758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3bfd591c-752e-4752-a155-4cdef0b173b7&page=queryresults
[0m11:04:35.459494 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:48d77e3b-f289-4ef1-a43b-d3ef2107f5de&page=queryresults
[0m11:04:35.737571 [info ] [Thread-1 (]: 14 of 21 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.94s]
[0m11:04:35.738845 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:04:35.739592 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:04:35.740423 [info ] [Thread-1 (]: 17 of 21 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m11:04:35.741277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m11:04:35.742147 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:04:35.745463 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:04:35.748199 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:04:35.750633 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:04:35.753401 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:35.754271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:35.796254 [info ] [Thread-4 (]: 15 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.95s]
[0m11:04:35.797866 [info ] [Thread-3 (]: 16 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.93s]
[0m11:04:35.800955 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:04:35.801927 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:04:35.802694 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:04:35.803712 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:04:35.804455 [info ] [Thread-4 (]: 18 of 21 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m11:04:35.805351 [info ] [Thread-3 (]: 19 of 21 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m11:04:35.806665 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m11:04:35.807621 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:04:35.806002 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m11:04:35.811946 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:04:35.813240 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:04:35.818285 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:04:35.819809 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:de525eb4-72d3-4f9f-881e-4a96705f0b85&page=queryresults
[0m11:04:35.823169 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:04:35.825731 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:04:35.823582 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:04:35.829718 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:04:35.830701 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:35.831446 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:35.832447 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:35.833826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:36.125704 [info ] [Thread-2 (]: 13 of 21 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.39s]
[0m11:04:36.127224 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:04:36.128012 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:04:36.128615 [info ] [Thread-2 (]: 20 of 21 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m11:04:36.129364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m11:04:36.129969 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:04:36.133095 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:04:36.135382 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:04:36.137356 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:04:36.140189 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:04:36.140975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:36.353892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d623b3c-6c32-4397-9d54-06a8a986fce5&page=queryresults
[0m11:04:36.420496 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:93399200-c2bc-46cc-a285-4fe3ad0b3aa8&page=queryresults
[0m11:04:36.487362 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1abebd81-03e1-4634-bda3-5917fdf449db&page=queryresults
[0m11:04:36.640326 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:45a0ca3b-ae9a-4136-9e14-848c9292aba0&page=queryresults
[0m11:04:36.714849 [info ] [Thread-1 (]: 17 of 21 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.97s]
[0m11:04:36.716696 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:04:36.717663 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:04:36.718704 [info ] [Thread-1 (]: 21 of 21 START test test_is_last_date_inserted_agg_pollution_by_day_date ....... [RUN]
[0m11:04:36.719872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d)
[0m11:04:36.721655 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:04:36.728128 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:04:36.732289 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:04:36.734913 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:04:36.738722 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    last_date_cte AS (
        SELECT city_id, MAX(date) AS last_date
        FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
        GROUP BY city
    )

SELECT city_id, last_date
FROM last_date_cte
WHERE
    last_date < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:04:36.739888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:36.777082 [info ] [Thread-4 (]: 18 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.97s]
[0m11:04:36.779388 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:04:36.837518 [info ] [Thread-3 (]: 19 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.03s]
[0m11:04:36.838997 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:04:36.970841 [info ] [Thread-2 (]: 20 of 21 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.84s]
[0m11:04:36.972572 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:04:37.121137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b5ccaf1a-f5c2-4aff-b02d-56f00c2e4e81&page=queryresults
[0m11:04:37.122587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b5ccaf1a-f5c2-4aff-b02d-56f00c2e4e81&page=queryresults
[0m11:04:37.129465 [debug] [Thread-1 (]: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [14:16]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date.sql
[0m11:04:37.130635 [error] [Thread-1 (]: 21 of 21 ERROR test_is_last_date_inserted_agg_pollution_by_day_date ............ [[31mERROR[0m in 0.41s]
[0m11:04:37.131766 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:04:37.132917 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d' to be skipped because of status 'error'.  Reason: Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [14:16]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date.sql.
[0m11:04:37.139387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:37.142508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:37.143548 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d' was properly closed.
[0m11:04:37.144405 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m11:04:37.145255 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m11:04:37.146073 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db' was properly closed.
[0m11:04:37.146984 [info ] [MainThread]: 
[0m11:04:37.148619 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m11:04:37.151433 [debug] [MainThread]: Command end result
[0m11:04:37.244206 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:04:37.249669 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:04:37.262267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m11:04:37.263253 [info ] [MainThread]: 
[0m11:04:37.264114 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:04:37.265034 [info ] [MainThread]: 
[0m11:04:37.265950 [error] [MainThread]: [31mFailure in test test_is_last_date_inserted_agg_pollution_by_day_date (models/schema.yml)[0m
[0m11:04:37.266682 [error] [MainThread]:   Database Error in test test_is_last_date_inserted_agg_pollution_by_day_date (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [14:16]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date.sql
[0m11:04:37.267403 [info ] [MainThread]: 
[0m11:04:37.268421 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_is_last_date_inserted_agg_pollution_by_day_date.sql
[0m11:04:37.269075 [info ] [MainThread]: 
[0m11:04:37.269950 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m11:04:37.274147 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.450192, "process_in_blocks": "0", "process_kernel_time": 1.720073, "process_mem_max_rss": "381788", "process_out_blocks": "0", "process_user_time": 4.630025}
[0m11:04:37.275955 [debug] [MainThread]: Command `dbt test` failed at 11:04:37.275845 after 9.45 seconds
[0m11:04:37.277412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915e7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73525f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9084bda0>]}
[0m11:04:37.278321 [debug] [MainThread]: Flushing usage events
[0m11:04:37.789069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:27.545971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dcc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8066aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808927b0>]}


============================== 11:05:27.552338 | df9a5fcf-740d-4a61-a55a-16e0e5544ab2 ==============================
[0m11:05:27.552338 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:05:27.554266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select agg_pollution_by_day', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:05:30.087895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb9b0e0>]}
[0m11:05:30.123402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff671231a0>]}
[0m11:05:30.128111 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:05:30.342842 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m11:05:30.464076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:05:30.465558 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://macros/tests/tes_is_last_date_inserted.sql
[0m11:05:30.926692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f04f80>]}
[0m11:05:31.064323 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:05:31.069621 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:05:31.097608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d9fbf0>]}
[0m11:05:31.098538 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 497 macros
[0m11:05:31.099202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d6af60>]}
[0m11:05:31.101819 [info ] [MainThread]: 
[0m11:05:31.102566 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:05:31.103442 [info ] [MainThread]: 
[0m11:05:31.104751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:05:31.108579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m11:05:31.109430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:31.419975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9a5fcf-740d-4a61-a55a-16e0e5544ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65ef5070>]}
[0m11:05:31.421980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:31.430090 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:05:31.430592 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:05:31.431087 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:05:31.431620 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:05:31.437695 [info ] [Thread-4 (]: 4 of 21 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m11:05:31.433121 [info ] [Thread-2 (]: 2 of 21 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m11:05:31.440468 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m11:05:31.432089 [info ] [Thread-1 (]: 1 of 21 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m11:05:31.439377 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9'
[0m11:05:31.435947 [info ] [Thread-3 (]: 3 of 21 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m11:05:31.442163 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:05:31.443189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m11:05:31.463782 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:05:31.446693 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m11:05:31.473519 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:05:31.477491 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:05:31.471873 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:05:31.444350 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:05:31.485875 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:05:31.487311 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:05:31.467589 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:05:31.488566 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:05:31.506859 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:05:31.508700 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:05:31.525462 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:05:31.543945 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:05:31.539265 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:05:31.527050 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:05:31.547581 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m11:05:31.554191 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m11:05:31.557498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:05:31.556255 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:05:31.556660 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m11:05:31.555029 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m11:05:31.691058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:31.763011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:05:32.181342 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6d0510f9-7584-428a-a3af-54bb502afe43&page=queryresults
[0m11:05:32.206198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b95b9e76-fb28-4eb4-84f8-e5317007de00&page=queryresults
[0m11:05:32.219889 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dc6d2441-1abe-495a-83fd-eff4c3cd68f3&page=queryresults
[0m11:05:32.233363 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ad3f2d2e-a952-47fb-b450-63fa07298508&page=queryresults
[0m11:05:32.590743 [info ] [Thread-3 (]: 3 of 21 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.14s]
[0m11:05:32.592593 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:05:32.593640 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:05:32.594676 [info ] [Thread-3 (]: 5 of 21 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m11:05:32.596384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m11:05:32.597252 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:05:32.616897 [info ] [Thread-4 (]: 4 of 21 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.18s]
[0m11:05:32.630866 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:05:32.632158 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:05:32.637038 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:05:32.643852 [info ] [Thread-2 (]: 2 of 21 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.20s]
[0m11:05:32.649800 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:05:32.663789 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:05:32.665102 [info ] [Thread-2 (]: 7 of 21 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m11:05:32.666861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m11:05:32.668121 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:05:32.658256 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:05:32.645466 [info ] [Thread-4 (]: 6 of 21 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m11:05:32.679503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m11:05:32.680333 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:05:32.674787 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:05:32.678045 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:05:32.684734 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:05:32.693288 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:05:32.704753 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:05:32.708983 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m11:05:32.713088 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:32.710366 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:05:32.718332 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:05:32.756738 [info ] [Thread-1 (]: 1 of 21 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.31s]
[0m11:05:32.760913 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:05:32.766930 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:05:32.757833 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m11:05:32.774097 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:32.773162 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m11:05:32.776458 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:32.771930 [info ] [Thread-1 (]: 8 of 21 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m11:05:32.854335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m11:05:32.855995 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:05:32.860983 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:05:32.867168 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:05:32.870779 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:05:32.874220 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:05:32.875526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:33.237786 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:abd062a9-986f-48f4-bf57-fb736b1c9dfa&page=queryresults
[0m11:05:33.239621 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:46774662-bd8a-42d6-a8e5-246e412f1072&page=queryresults
[0m11:05:33.243418 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:16e8353d-55d2-4627-a436-a6bc60a0fd05&page=queryresults
[0m11:05:33.305878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d6531160-6172-4cfd-a82c-ae96f3201ae0&page=queryresults
[0m11:05:33.540700 [info ] [Thread-4 (]: 6 of 21 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.86s]
[0m11:05:33.542720 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:05:33.543764 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:05:33.544747 [info ] [Thread-4 (]: 9 of 21 START test not_null_agg_pollution_by_day_avg_SO2 ....................... [RUN]
[0m11:05:33.545719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m11:05:33.546555 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:05:33.550616 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:05:33.555514 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:05:33.558066 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:05:33.563212 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m11:05:33.564168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:33.566024 [info ] [Thread-3 (]: 5 of 21 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.97s]
[0m11:05:33.568441 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:05:33.569892 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:05:33.571242 [info ] [Thread-3 (]: 10 of 21 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m11:05:33.573403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m11:05:33.574305 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:05:33.580416 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:05:33.573103 [info ] [Thread-2 (]: 7 of 21 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.91s]
[0m11:05:33.622424 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:05:33.623613 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:05:33.626667 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:05:33.630095 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:05:33.627110 [info ] [Thread-2 (]: 11 of 21 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m11:05:33.632457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m11:05:33.635973 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:05:33.637339 [info ] [Thread-1 (]: 8 of 21 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.78s]
[0m11:05:33.640997 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:05:33.643860 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:05:33.646645 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:05:33.652779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:33.648958 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:05:33.670561 [info ] [Thread-1 (]: 12 of 21 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m11:05:33.706413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m11:05:33.666423 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:05:33.712766 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:05:33.708809 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:05:33.717852 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:05:33.791428 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m11:05:33.832264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:33.849030 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:05:33.889556 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:05:33.894963 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:05:33.895990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:34.181313 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28bf1ac8-df3f-4501-b5cf-d65421adf892&page=queryresults
[0m11:05:34.204269 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:40cc82e4-7199-40bf-b5a1-2e5d271d1f40&page=queryresults
[0m11:05:34.264608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13ee2785-302f-4ba1-b069-fdb24970ed17&page=queryresults
[0m11:05:34.291300 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4976dad0-b404-47c7-9264-c404a1f4eca3&page=queryresults
[0m11:05:34.501205 [info ] [Thread-4 (]: 9 of 21 PASS not_null_agg_pollution_by_day_avg_SO2 ............................. [[32mPASS[0m in 0.96s]
[0m11:05:34.503267 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:05:34.504241 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:05:34.505284 [info ] [Thread-4 (]: 13 of 21 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m11:05:34.506694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m11:05:34.507434 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:05:34.512546 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:05:34.516779 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:05:34.519034 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:05:34.521403 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:34.522261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:34.559371 [info ] [Thread-3 (]: 10 of 21 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.99s]
[0m11:05:34.561361 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:05:34.562299 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:05:34.564275 [info ] [Thread-3 (]: 14 of 21 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m11:05:34.565831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m11:05:34.567087 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:05:34.570868 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:05:34.573608 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:05:34.575830 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:05:34.578261 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:34.579179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:34.616624 [info ] [Thread-1 (]: 12 of 21 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 0.91s]
[0m11:05:34.617768 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:05:34.619444 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:05:34.620189 [info ] [Thread-1 (]: 15 of 21 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m11:05:34.621176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m11:05:34.622106 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:05:34.627193 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:05:34.632383 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:05:34.634707 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:05:34.638543 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:34.640125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:34.677487 [info ] [Thread-2 (]: 11 of 21 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 1.05s]
[0m11:05:34.679239 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:05:34.680841 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:05:34.681920 [info ] [Thread-2 (]: 16 of 21 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m11:05:34.683970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m11:05:34.685103 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:05:34.690677 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:05:34.693573 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:05:34.695981 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:05:34.700218 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:34.701277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:35.186597 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d5394c3e-9222-4b9c-977e-cba0b8427db7&page=queryresults
[0m11:05:35.202943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4582ffb3-e033-45d5-ae28-abba0bd0accc&page=queryresults
[0m11:05:35.258994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2e14a7bd-fb67-4acb-aead-0f3a2b2fe546&page=queryresults
[0m11:05:35.290616 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eba73e13-268d-4d91-bb14-8a3e74141bd9&page=queryresults
[0m11:05:35.499469 [info ] [Thread-3 (]: 14 of 21 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.93s]
[0m11:05:35.501666 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:05:35.502736 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:05:35.503913 [info ] [Thread-3 (]: 17 of 21 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m11:05:35.505365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m11:05:35.506607 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:05:35.512114 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:05:35.517555 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:05:35.520039 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:05:35.522214 [info ] [Thread-1 (]: 15 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.90s]
[0m11:05:35.525548 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:05:35.526765 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:05:35.528323 [info ] [Thread-1 (]: 18 of 21 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m11:05:35.534034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m11:05:35.527637 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:35.536047 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:05:35.541787 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:05:35.537475 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:35.581362 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:05:35.585676 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:05:35.590216 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:35.591470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:35.641921 [info ] [Thread-4 (]: 13 of 21 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.13s]
[0m11:05:35.647087 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:05:35.650014 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:05:35.653661 [info ] [Thread-2 (]: 16 of 21 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.97s]
[0m11:05:35.658002 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:05:35.659171 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:05:35.660520 [info ] [Thread-2 (]: 20 of 21 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m11:05:35.662466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m11:05:35.665093 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:05:35.672770 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:05:35.656540 [info ] [Thread-4 (]: 19 of 21 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m11:05:35.686697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m11:05:35.688647 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:05:35.693915 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:05:35.694860 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:05:35.702220 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:05:35.703666 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:05:35.706935 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:05:35.708895 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:35.710302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:35.712112 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:05:35.714718 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:36.231992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb54f130-6236-478f-9ccc-05e19595981c&page=queryresults
[0m11:05:36.255721 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d26c93d4-a438-4e5e-9a11-330c7633e312&page=queryresults
[0m11:05:36.401935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a87ff7e-3cb8-473f-a8ff-39e2e673d151&page=queryresults
[0m11:05:36.453674 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9edf97d4-dc53-4125-860d-0cd0714345d4&page=queryresults
[0m11:05:36.539673 [info ] [Thread-1 (]: 18 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 1.00s]
[0m11:05:36.544338 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:05:36.551107 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:05:36.553259 [info ] [Thread-1 (]: 21 of 21 START test test_is_last_date_inserted_agg_pollution_by_day_date ....... [RUN]
[0m11:05:36.556883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d)
[0m11:05:36.558152 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:05:36.573504 [info ] [Thread-3 (]: 17 of 21 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.07s]
[0m11:05:36.581418 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:05:36.579354 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:05:36.596209 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:05:36.600083 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:05:36.603674 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    last_date_cte AS (
        SELECT city, MAX(date) AS last_date
        FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
        GROUP BY city
    )

SELECT city, last_date
FROM last_date_cte
WHERE
    last_date < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:05:36.604879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:36.771549 [info ] [Thread-4 (]: 19 of 21 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.09s]
[0m11:05:36.774323 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:05:36.795873 [info ] [Thread-2 (]: 20 of 21 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 1.13s]
[0m11:05:36.798228 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:05:37.126730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be943690-7611-4bf7-a0fc-2f99db5393ee&page=queryresults
[0m11:05:37.442675 [info ] [Thread-1 (]: 21 of 21 PASS test_is_last_date_inserted_agg_pollution_by_day_date ............. [[32mPASS[0m in 0.89s]
[0m11:05:37.443963 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:05:37.448236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:37.451467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:37.452371 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d' was properly closed.
[0m11:05:37.453000 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m11:05:37.453551 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m11:05:37.454096 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650' was properly closed.
[0m11:05:37.455008 [info ] [MainThread]: 
[0m11:05:37.455870 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m11:05:37.459201 [debug] [MainThread]: Command end result
[0m11:05:37.561077 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:05:37.577735 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:05:37.591120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m11:05:37.591940 [info ] [MainThread]: 
[0m11:05:37.592728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:37.593784 [info ] [MainThread]: 
[0m11:05:37.594777 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m11:05:37.599413 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.104219, "process_in_blocks": "0", "process_kernel_time": 1.436669, "process_mem_max_rss": "380956", "process_out_blocks": "0", "process_user_time": 5.519342}
[0m11:05:37.602129 [debug] [MainThread]: Command `dbt test` succeeded at 11:05:37.601730 after 10.11 seconds
[0m11:05:37.615112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81019760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833b3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64077ad0>]}
[0m11:05:37.619710 [debug] [MainThread]: Flushing usage events
[0m11:05:38.119784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:11.015010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7f52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbbdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d96a3c0>]}


============================== 11:06:11.020255 | ab813d72-cb93-4b26-b9a8-51106e49b835 ==============================
[0m11:06:11.020255 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:06:11.021391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:06:13.129992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c41b0e0>]}
[0m11:06:13.164744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7054f0>]}
[0m11:06:13.165952 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:06:13.334331 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m11:06:13.451498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:13.452466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:13.479273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62984050>]}
[0m11:06:13.784411 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:06:13.807256 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:06:13.928336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4259a0>]}
[0m11:06:13.930101 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 497 macros
[0m11:06:13.933748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62985280>]}
[0m11:06:13.939635 [info ] [MainThread]: 
[0m11:06:13.941231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:06:13.942190 [info ] [MainThread]: 
[0m11:06:13.944062 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:06:13.950043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m11:06:13.951219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:14.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab813d72-cb93-4b26-b9a8-51106e49b835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff625cdd90>]}
[0m11:06:14.294479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:14.300991 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:06:14.301383 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:06:14.301847 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:06:14.302618 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:06:14.305737 [info ] [Thread-4 (]: 4 of 54 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m11:06:14.303866 [info ] [Thread-2 (]: 2 of 54 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m11:06:14.304685 [info ] [Thread-3 (]: 3 of 54 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m11:06:14.302898 [info ] [Thread-1 (]: 1 of 54 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m11:06:14.309083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m11:06:14.309783 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:06:14.308435 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m11:06:14.306737 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m11:06:14.307616 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m11:06:14.327018 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:06:14.325213 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:06:14.326134 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:06:14.324798 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:06:14.340470 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m11:06:14.345862 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:06:14.349851 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:06:14.356501 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:06:14.367261 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:06:14.367812 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:06:14.368146 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:06:14.386462 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:06:14.383030 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:06:14.384505 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m11:06:14.381984 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:06:14.392224 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m11:06:14.402164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:06:14.392775 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m11:06:14.405953 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m11:06:14.413064 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:06:14.406479 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:06:14.496644 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m11:06:14.539362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:14.920952 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be3b2d34-fa3c-48d4-ac2d-f06d1a6cf4b7&page=queryresults
[0m11:06:14.939090 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7e0096ef-eb82-4b77-a4a9-6569e7de6f7a&page=queryresults
[0m11:06:14.952258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:33521776-16f0-41fa-a4b5-11b853bdd0d2&page=queryresults
[0m11:06:14.953283 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:afb342c3-d842-4547-8be2-13fa95a4d442&page=queryresults
[0m11:06:15.333353 [info ] [Thread-1 (]: 1 of 54 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.02s]
[0m11:06:15.336745 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:06:15.334103 [info ] [Thread-4 (]: 4 of 54 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.03s]
[0m11:06:15.335008 [info ] [Thread-2 (]: 2 of 54 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.03s]
[0m11:06:15.335747 [info ] [Thread-3 (]: 3 of 54 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.03s]
[0m11:06:15.337941 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:06:15.342940 [info ] [Thread-1 (]: 5 of 54 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m11:06:15.341259 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:06:15.346474 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:06:15.347930 [info ] [Thread-2 (]: 6 of 54 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m11:06:15.351520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m11:06:15.342353 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:06:15.340091 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:06:15.344231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m11:06:15.353483 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:06:15.356312 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:06:15.359144 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:06:15.361385 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:06:15.366945 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:06:15.368278 [info ] [Thread-3 (]: 7 of 54 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m11:06:15.373063 [info ] [Thread-4 (]: 8 of 54 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m11:06:15.379566 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:06:15.381382 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m11:06:15.386116 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:06:15.385682 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:06:15.384355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m11:06:15.389174 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:06:15.392223 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:06:15.396374 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:06:15.397069 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:06:15.415017 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:06:15.408836 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:06:15.415442 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:06:15.419381 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m11:06:15.421956 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:06:15.422885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:15.423642 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m11:06:15.473103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:15.431552 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:06:15.474994 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m11:06:15.485972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:15.483114 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:06:15.561381 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m11:06:15.563779 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:15.979643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3b5e48be-0164-46b2-aae7-4a4e2b2b34cb&page=queryresults
[0m11:06:15.981438 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f5402b0c-9a4b-4a57-b30b-8a8e68458bcf&page=queryresults
[0m11:06:15.982205 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7e32db87-9a4f-49f7-9517-acdd9566d2c6&page=queryresults
[0m11:06:15.983327 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1cf175ef-294a-4e98-8aa9-17349f74b807&page=queryresults
[0m11:06:16.296546 [info ] [Thread-1 (]: 5 of 54 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 0.95s]
[0m11:06:16.298408 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:06:16.300052 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:06:16.301026 [info ] [Thread-1 (]: 9 of 54 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m11:06:16.302543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m11:06:16.303457 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:06:16.310182 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:06:16.315213 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:06:16.318258 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:06:16.321045 [info ] [Thread-2 (]: 6 of 54 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.97s]
[0m11:06:16.322930 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:06:16.323767 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:06:16.324530 [info ] [Thread-2 (]: 10 of 54 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m11:06:16.326332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m11:06:16.325467 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:06:16.328076 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:06:16.336036 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:06:16.330676 [info ] [Thread-4 (]: 8 of 54 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.95s]
[0m11:06:16.331191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:16.338521 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:06:16.340258 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:06:16.343059 [info ] [Thread-3 (]: 7 of 54 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.96s]
[0m11:06:16.345050 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:06:16.346858 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:06:16.348330 [info ] [Thread-3 (]: 12 of 54 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m11:06:16.346366 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:06:16.343382 [info ] [Thread-4 (]: 11 of 54 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m11:06:16.391473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m11:06:16.392899 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:06:16.396632 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:06:16.389735 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:06:16.383731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m11:06:16.398991 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:06:16.403245 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:06:16.403698 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m11:06:16.412554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:16.404068 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:06:16.452898 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:06:16.453413 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:06:16.456584 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:06:16.459131 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:06:16.461390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:16.463548 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m11:06:16.499183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:16.818634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e0b1d31a-1168-4c58-b108-9e6f58ae10f8&page=queryresults
[0m11:06:16.852767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2f763420-c92a-497b-9bce-c5532d2596cf&page=queryresults
[0m11:06:16.875868 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fb7d9c29-f27b-46b6-9f0e-60a14e58831d&page=queryresults
[0m11:06:16.925676 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0930dd16-ed2b-420d-9cc6-ef6faa8d1c19&page=queryresults
[0m11:06:17.198057 [info ] [Thread-3 (]: 12 of 54 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.81s]
[0m11:06:17.200017 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:06:17.201021 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:06:17.201952 [info ] [Thread-3 (]: 13 of 54 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m11:06:17.203426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m11:06:17.205176 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:06:17.222319 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:06:17.230213 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:06:17.233553 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:06:17.236836 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:06:17.237834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:17.283064 [info ] [Thread-2 (]: 10 of 54 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.96s]
[0m11:06:17.285684 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:06:17.287101 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:06:17.288438 [info ] [Thread-2 (]: 14 of 54 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m11:06:17.289828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m11:06:17.290972 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:06:17.295802 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m11:06:17.299084 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:06:17.301476 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m11:06:17.305867 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m11:06:17.306704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:17.378869 [info ] [Thread-4 (]: 11 of 54 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.99s]
[0m11:06:17.381510 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:06:17.383413 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d
[0m11:06:17.384669 [info ] [Thread-4 (]: 15 of 54 START test not_null_fact_air_pollution_city_name ...................... [RUN]
[0m11:06:17.387069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d)
[0m11:06:17.387885 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d
[0m11:06:17.391255 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d"
[0m11:06:17.397386 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d
[0m11:06:17.399722 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d"
[0m11:06:17.405031 [info ] [Thread-1 (]: 9 of 54 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 1.10s]
[0m11:06:17.406293 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_name
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_name is null



  
  
      
    ) dbt_internal_test
[0m11:06:17.407117 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:06:17.408686 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:06:17.408056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:17.410491 [info ] [Thread-1 (]: 16 of 54 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m11:06:17.417294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m11:06:17.420369 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:06:17.428416 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m11:06:17.469195 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:06:17.471500 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m11:06:17.474187 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m11:06:17.476709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:17.706742 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cae4ebcc-f2e5-4837-b16e-2e8d413e0bf4&page=queryresults
[0m11:06:17.875473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0f51be67-aa2a-473c-a47f-c837bca65a4b&page=queryresults
[0m11:06:17.916510 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6aaed4d0-84ca-4078-9817-95b40fca2546&page=queryresults
[0m11:06:17.966544 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:affd7d49-6f01-49da-b508-a6327e7495d6&page=queryresults
[0m11:06:17.969912 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:affd7d49-6f01-49da-b508-a6327e7495d6&page=queryresults
[0m11:06:17.980913 [debug] [Thread-4 (]: Database Error in test not_null_fact_air_pollution_city_name (models/schema.yml)
  Unrecognized name: city_name at [18:7]
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_fact_air_pollution_city_name.sql
[0m11:06:17.983963 [error] [Thread-4 (]: 15 of 54 ERROR not_null_fact_air_pollution_city_name ........................... [[31mERROR[0m in 0.60s]
[0m11:06:17.987693 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d
[0m11:06:17.989083 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:06:17.989763 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_air_pollution_city_name (models/schema.yml)
  Unrecognized name: city_name at [18:7]
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_fact_air_pollution_city_name.sql.
[0m11:06:17.991362 [info ] [Thread-4 (]: 17 of 54 START test not_null_staging_cities_city ............................... [RUN]
[0m11:06:17.995435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_name.663022c57d, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m11:06:17.997361 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:06:18.002861 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m11:06:18.004437 [info ] [Thread-3 (]: 13 of 54 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 0.80s]
[0m11:06:18.006845 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:06:18.007959 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:06:18.009258 [info ] [Thread-3 (]: 18 of 54 START test not_null_staging_cities_id ................................. [RUN]
[0m11:06:18.011574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m11:06:18.012839 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:06:18.017879 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m11:06:18.010721 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:06:18.024625 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m11:06:18.026744 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:06:18.030675 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m11:06:18.031415 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:06:18.035238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:18.198147 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:06:18.199733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:18.293395 [info ] [Thread-1 (]: 16 of 54 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.88s]
[0m11:06:18.295169 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:06:18.296131 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:06:18.297039 [info ] [Thread-1 (]: 19 of 54 START test not_null_staging_cities_latitude ........................... [RUN]
[0m11:06:18.298030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m11:06:18.299407 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:06:18.307408 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m11:06:18.309120 [info ] [Thread-2 (]: 14 of 54 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 1.02s]
[0m11:06:18.314636 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:06:18.317643 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:06:18.320299 [info ] [Thread-2 (]: 20 of 54 START test not_null_staging_cities_longitude .......................... [RUN]
[0m11:06:18.322900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m11:06:18.324454 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:06:18.321272 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:06:18.334761 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m11:06:18.339870 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m11:06:18.346451 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:06:18.351693 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m11:06:18.352603 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m11:06:18.358252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:18.359278 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m11:06:18.361464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:18.677102 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ebc55e2a-6543-483e-a4f0-1bea0a50fe94&page=queryresults
[0m11:06:18.783760 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6d6f8f4d-1451-4b39-9f1e-baf0cf7c5b7e&page=queryresults
[0m11:06:18.879845 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:941d452f-117f-4d8d-aa69-0e283c90554e&page=queryresults
[0m11:06:18.884755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1949ec0-7d75-4970-922f-7e75c820e338&page=queryresults
[0m11:06:18.980485 [info ] [Thread-4 (]: 17 of 54 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 0.99s]
[0m11:06:18.982343 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:06:18.983380 [debug] [Thread-4 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:06:18.984591 [info ] [Thread-4 (]: 21 of 54 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m11:06:18.987363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m11:06:18.988543 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:06:18.998837 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m11:06:19.003314 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:06:19.005900 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m11:06:19.011353 [debug] [Thread-4 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:06:19.012357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:19.160305 [info ] [Thread-3 (]: 18 of 54 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 1.15s]
[0m11:06:19.162688 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:06:19.163953 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:06:19.166571 [info ] [Thread-3 (]: 22 of 54 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m11:06:19.168408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m11:06:19.169415 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:06:19.175151 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m11:06:19.181355 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:06:19.184166 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m11:06:19.187489 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m11:06:19.188318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:19.229290 [info ] [Thread-1 (]: 19 of 54 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 0.93s]
[0m11:06:19.230048 [info ] [Thread-2 (]: 20 of 54 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.91s]
[0m11:06:19.234208 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:06:19.235300 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:06:19.233156 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:06:19.236986 [info ] [Thread-2 (]: 23 of 54 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m11:06:19.238017 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:06:19.240972 [info ] [Thread-1 (]: 24 of 54 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m11:06:19.239976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m11:06:19.242281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m11:06:19.243157 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:06:19.244541 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:06:19.252574 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m11:06:19.249140 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m11:06:19.256740 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:06:19.258707 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:06:19.260750 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m11:06:19.265025 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m11:06:19.270525 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m11:06:19.273743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:19.274430 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m11:06:19.277251 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:19.640711 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2b763116-6262-4f48-b3b6-402ea3138112&page=queryresults
[0m11:06:19.684514 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e5498013-b117-447a-a04c-83e7492f9d3f&page=queryresults
[0m11:06:19.716718 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f103fe07-a4a1-4714-82eb-0f7727daa22c&page=queryresults
[0m11:06:19.749061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c3ae2cdc-a927-4efc-9171-0ed73756bb12&page=queryresults
[0m11:06:20.031180 [info ] [Thread-2 (]: 23 of 54 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 0.79s]
[0m11:06:20.032209 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:06:20.033129 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:06:20.033967 [info ] [Thread-2 (]: 25 of 54 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m11:06:20.034845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m11:06:20.035546 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:06:20.039063 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m11:06:20.041858 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:06:20.044027 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m11:06:20.047478 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m11:06:20.048257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:20.095964 [info ] [Thread-3 (]: 22 of 54 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.93s]
[0m11:06:20.098388 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:06:20.099501 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:06:20.100341 [info ] [Thread-3 (]: 26 of 54 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m11:06:20.101282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m11:06:20.102184 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:06:20.106480 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m11:06:20.109740 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:06:20.111810 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m11:06:20.115072 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m11:06:20.117683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:20.122180 [info ] [Thread-4 (]: 21 of 54 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 1.14s]
[0m11:06:20.123530 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:06:20.125081 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:06:20.159980 [info ] [Thread-4 (]: 27 of 54 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m11:06:20.162050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m11:06:20.163421 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:06:20.172310 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m11:06:20.201581 [info ] [Thread-1 (]: 24 of 54 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 0.96s]
[0m11:06:20.209125 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:06:20.255956 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:06:20.264819 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:06:20.273098 [info ] [Thread-1 (]: 28 of 54 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m11:06:20.291614 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m11:06:20.295822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m11:06:20.304435 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:06:20.308495 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m11:06:20.309517 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m11:06:20.311566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:20.312312 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:06:20.353908 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m11:06:20.368537 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m11:06:20.370010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:20.580404 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:05e1b0ac-8910-45fe-b4c1-36bb3b58fa5e&page=queryresults
[0m11:06:20.680318 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d23cee3e-8a3d-47ae-980b-89dfc6065360&page=queryresults
[0m11:06:20.709175 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d6c38f82-cc57-4956-82d2-7434ed72b8f8&page=queryresults
[0m11:06:20.752083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b8c387ea-2db3-444b-b591-add400f9a57c&page=queryresults
[0m11:06:20.902128 [info ] [Thread-2 (]: 25 of 54 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 0.87s]
[0m11:06:20.903978 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:06:20.906226 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:06:20.907243 [info ] [Thread-2 (]: 29 of 54 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m11:06:20.908237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m11:06:20.909115 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:06:20.916142 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m11:06:20.919270 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:06:20.921535 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m11:06:20.924692 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:06:20.925488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:20.982966 [info ] [Thread-3 (]: 26 of 54 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 0.88s]
[0m11:06:20.984218 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:06:20.991258 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:06:20.993479 [info ] [Thread-3 (]: 30 of 54 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m11:06:20.995539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m11:06:20.996898 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:06:21.059520 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m11:06:21.067228 [info ] [Thread-1 (]: 28 of 54 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.77s]
[0m11:06:21.071018 [info ] [Thread-4 (]: 27 of 54 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.91s]
[0m11:06:21.076315 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:06:21.073124 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:06:21.080684 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:06:21.082943 [info ] [Thread-1 (]: 32 of 54 START test source_not_null_source_cities_city_index ................... [RUN]
[0m11:06:21.084326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m11:06:21.079421 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:06:21.086581 [info ] [Thread-4 (]: 31 of 54 START test source_not_null_source_cities_city ......................... [RUN]
[0m11:06:21.085395 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:06:21.081973 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:06:21.087740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m11:06:21.103026 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:06:21.098730 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m11:06:21.092399 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m11:06:21.109259 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m11:06:21.120889 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:06:21.123558 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m11:06:21.124596 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m11:06:21.129031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:21.127766 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:06:21.131341 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m11:06:21.134389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.133051 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m11:06:21.216245 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:06:21.217401 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:21.367834 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:41febfc0-0eba-47fa-817d-21f11c1fe65b&page=queryresults
[0m11:06:21.569200 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d2f1c202-ffa4-4834-ab58-f85993b79a91&page=queryresults
[0m11:06:21.582146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b01adc04-35c7-468d-aea1-0adc3f173a61&page=queryresults
[0m11:06:21.625256 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c9eb9cf6-7776-4c04-a2dd-dad3571aa693&page=queryresults
[0m11:06:21.661361 [info ] [Thread-2 (]: 29 of 54 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.75s]
[0m11:06:21.662464 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:06:21.663514 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:06:21.664297 [info ] [Thread-2 (]: 33 of 54 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m11:06:21.665551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m11:06:21.666272 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:06:21.670575 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m11:06:21.674585 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:06:21.678193 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m11:06:21.683931 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m11:06:21.685005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:21.861440 [info ] [Thread-3 (]: 30 of 54 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.87s]
[0m11:06:21.862784 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:06:21.863733 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:06:21.864474 [info ] [Thread-3 (]: 34 of 54 START test source_not_null_source_cities_longitude .................... [RUN]
[0m11:06:21.865383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m11:06:21.870310 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:06:21.878670 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m11:06:21.882051 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:06:21.884093 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m11:06:21.886731 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m11:06:21.887620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:21.927332 [info ] [Thread-1 (]: 32 of 54 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.84s]
[0m11:06:21.928758 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:06:21.929535 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:06:21.930238 [info ] [Thread-1 (]: 35 of 54 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m11:06:21.931377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m11:06:21.932182 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:06:21.937393 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m11:06:21.941348 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:06:21.943634 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m11:06:21.946257 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:21.948072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.985201 [info ] [Thread-4 (]: 31 of 54 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.90s]
[0m11:06:21.987960 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:06:21.988768 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:06:21.989854 [info ] [Thread-4 (]: 36 of 54 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m11:06:21.991359 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m11:06:21.992558 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:06:21.996260 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m11:06:22.000061 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:06:22.002172 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m11:06:22.004674 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:22.005250 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:22.115556 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b8208c7d-a7e0-49a3-8248-703e130acc7b&page=queryresults
[0m11:06:22.358518 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aec4e573-c61a-446f-83dd-0049d34b4f0d&page=queryresults
[0m11:06:22.457325 [info ] [Thread-2 (]: 33 of 54 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.79s]
[0m11:06:22.459005 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:06:22.459907 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:06:22.460827 [info ] [Thread-2 (]: 37 of 54 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m11:06:22.462157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m11:06:22.463019 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:06:22.468600 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m11:06:22.471977 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:06:22.474475 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m11:06:22.477199 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:22.478134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:22.555587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f3c3a578-f197-4225-9975-5c899c7b11b4&page=queryresults
[0m11:06:22.696656 [info ] [Thread-3 (]: 34 of 54 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.83s]
[0m11:06:22.698224 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:06:22.699386 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:06:22.700401 [info ] [Thread-3 (]: 38 of 54 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m11:06:22.701338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m11:06:22.702077 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:06:22.707180 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m11:06:22.710142 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:06:22.712399 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m11:06:22.715368 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:22.716115 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:22.750331 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8dc1312e-2807-4c67-95ea-a374810734c7&page=queryresults
[0m11:06:23.018957 [info ] [Thread-1 (]: 35 of 54 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.09s]
[0m11:06:23.020174 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:06:23.021098 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:06:23.022027 [info ] [Thread-1 (]: 39 of 54 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m11:06:23.022953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m11:06:23.023711 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:06:23.028682 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m11:06:23.033420 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:06:23.035784 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m11:06:23.038631 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:23.040648 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:704f2426-241c-4a40-ad31-97b7bd9b536f&page=queryresults
[0m11:06:23.041081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:23.077456 [info ] [Thread-4 (]: 36 of 54 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 1.09s]
[0m11:06:23.079524 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:06:23.080805 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:06:23.081713 [info ] [Thread-4 (]: 40 of 54 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m11:06:23.082633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m11:06:23.083389 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:06:23.086621 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m11:06:23.090545 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:06:23.092669 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m11:06:23.095738 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:23.096705 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:23.308659 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:00ee8572-5397-401a-862c-f508e4211eda&page=queryresults
[0m11:06:23.417310 [info ] [Thread-2 (]: 37 of 54 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.96s]
[0m11:06:23.418365 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:06:23.419015 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:06:23.419725 [info ] [Thread-2 (]: 41 of 54 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m11:06:23.420820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m11:06:23.421973 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:06:23.425780 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m11:06:23.428854 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:06:23.430989 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m11:06:23.434149 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:23.434875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:23.624865 [info ] [Thread-3 (]: 38 of 54 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.92s]
[0m11:06:23.626281 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:06:23.627328 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:06:23.628261 [info ] [Thread-3 (]: 42 of 54 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m11:06:23.629088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m11:06:23.629820 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:06:23.634523 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m11:06:23.638790 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:06:23.641296 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m11:06:23.644094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0ddacf3c-52d2-46f0-92dc-a71e0c861d70&page=queryresults
[0m11:06:23.644798 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:23.647032 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:23.682055 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:887887a7-854b-4a47-a6c7-a81c12b376b0&page=queryresults
[0m11:06:23.960610 [info ] [Thread-1 (]: 39 of 54 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 0.94s]
[0m11:06:23.961982 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:06:23.962763 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:06:23.963344 [info ] [Thread-1 (]: 43 of 54 START test source_unique_source_cities_city_index ..................... [RUN]
[0m11:06:23.964231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m11:06:23.965045 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:06:23.970518 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m11:06:23.973437 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:06:23.975841 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m11:06:23.978624 [debug] [Thread-1 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:06:23.979771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:24.044854 [info ] [Thread-4 (]: 40 of 54 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.96s]
[0m11:06:24.046549 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:06:24.047714 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:06:24.048501 [info ] [Thread-4 (]: 44 of 54 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m11:06:24.049487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m11:06:24.050332 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:06:24.056989 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:06:24.062482 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:06:24.064824 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:06:24.067564 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:24.068336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:24.150323 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5d415094-ffde-48fd-bbd9-d64574d06a44&page=queryresults
[0m11:06:24.307749 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a5967955-59b5-43b4-8ac4-7179f0b8c4ed&page=queryresults
[0m11:06:24.374525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f33820aa-33e3-4159-9b40-4552e55d3802&page=queryresults
[0m11:06:24.471655 [info ] [Thread-2 (]: 41 of 54 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 1.05s]
[0m11:06:24.486740 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:06:24.489490 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:06:24.493105 [info ] [Thread-2 (]: 45 of 54 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m11:06:24.495785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m11:06:24.496994 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:06:24.501535 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:06:24.504804 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:06:24.507416 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:06:24.509868 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:24.511541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:24.697884 [info ] [Thread-1 (]: 43 of 54 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.73s]
[0m11:06:24.706532 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:06:24.713293 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:06:24.728062 [info ] [Thread-1 (]: 46 of 54 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m11:06:24.729666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m11:06:24.731964 [info ] [Thread-3 (]: 42 of 54 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 1.10s]
[0m11:06:24.735577 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:06:24.737774 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:06:24.732408 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:06:24.739539 [info ] [Thread-3 (]: 47 of 54 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m11:06:24.745101 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:06:24.746702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m11:06:24.748370 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:06:24.751599 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:06:24.753152 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:06:24.755664 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:06:24.756722 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:06:24.760327 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:06:24.761724 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:24.763807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:24.802716 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:24.805640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:24.842610 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c93bc599-e2bc-45c1-bd0e-a911c2457c6a&page=queryresults
[0m11:06:25.099704 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5529d5a1-1807-4587-971a-1742364bee64&page=queryresults
[0m11:06:25.172722 [info ] [Thread-4 (]: 44 of 54 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.12s]
[0m11:06:25.173833 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:06:25.174575 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:06:25.175381 [info ] [Thread-4 (]: 48 of 54 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m11:06:25.176256 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m11:06:25.176888 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:06:25.180089 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:06:25.182526 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:06:25.185068 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:06:25.187460 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:25.188540 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:25.324427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d26d6b19-3b11-4c12-b31f-f9642582dbe4&page=queryresults
[0m11:06:25.331722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:351a70e7-c0b1-4b6e-9a1a-6bd2c5daf542&page=queryresults
[0m11:06:25.431584 [info ] [Thread-2 (]: 45 of 54 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.94s]
[0m11:06:25.432958 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:06:25.433805 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:06:25.434604 [info ] [Thread-2 (]: 49 of 54 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m11:06:25.435570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m11:06:25.436404 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:06:25.441404 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:06:25.444289 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:06:25.446961 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:06:25.450540 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:25.451395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:25.609287 [info ] [Thread-3 (]: 47 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.86s]
[0m11:06:25.610521 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:06:25.611233 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:06:25.611960 [info ] [Thread-3 (]: 50 of 54 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m11:06:25.612840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m11:06:25.613993 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:06:25.617348 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:06:25.619550 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:06:25.621389 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:06:25.624357 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:25.625297 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:25.690965 [info ] [Thread-1 (]: 46 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.96s]
[0m11:06:25.696443 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:06:25.708967 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:06:25.711894 [info ] [Thread-1 (]: 51 of 54 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m11:06:25.735350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m11:06:25.738231 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:06:25.738929 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5e0085b9-c9b1-4fc3-aac7-fd27b7356d80&page=queryresults
[0m11:06:25.748953 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:06:25.753648 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:06:25.755897 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:06:25.758582 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:06:25.759804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:26.048840 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6b95069a-2a61-4e5a-b5ce-c709ee99986a&page=queryresults
[0m11:06:26.084668 [info ] [Thread-4 (]: 48 of 54 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.91s]
[0m11:06:26.085754 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:06:26.086617 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:06:26.087270 [info ] [Thread-4 (]: 52 of 54 START test test_is_last_date_inserted_agg_pollution_by_day_date ....... [RUN]
[0m11:06:26.088198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d)
[0m11:06:26.088965 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:06:26.092882 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:06:26.095589 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:06:26.097746 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:06:26.100238 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    last_date_cte AS (
        SELECT city, MAX(date) AS last_date
        FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
        GROUP BY city
    )

SELECT city, last_date
FROM last_date_cte
WHERE
    last_date < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:06:26.101057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:26.280741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cac70084-e8fb-4f3b-8e73-3eecea17505a&page=queryresults
[0m11:06:26.387713 [info ] [Thread-2 (]: 49 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.95s]
[0m11:06:26.391085 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:06:26.392432 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:06:26.393450 [info ] [Thread-2 (]: 53 of 54 START test test_is_last_datetime_inserted_fact_air_pollution_ ......... [RUN]
[0m11:06:26.395066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a)
[0m11:06:26.397608 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:06:26.405102 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"
[0m11:06:26.410093 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:06:26.412762 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"
[0m11:06:26.417868 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    max_date_time_cte AS (
        SELECT city_id, MAX(dt) AS max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
        GROUP BY city_id
    )

SELECT city_id, max_date_time
FROM max_date_time_cte
WHERE
    DATE(max_date_time, "Europe/Paris")
    < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:06:26.422886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:26.431692 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:68b2d400-1a99-47a4-815f-072bf5700bf3&page=queryresults
[0m11:06:26.666273 [info ] [Thread-1 (]: 51 of 54 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.95s]
[0m11:06:26.669130 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:06:26.672181 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:06:26.673402 [info ] [Thread-1 (]: 54 of 54 START test unique_staging_cities_id ................................... [RUN]
[0m11:06:26.676716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m11:06:26.677752 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:06:26.683767 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m11:06:26.688348 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:06:26.690805 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m11:06:26.693533 [debug] [Thread-1 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:06:26.694866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:26.765462 [info ] [Thread-3 (]: 50 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.15s]
[0m11:06:26.767239 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:06:26.833446 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74b4bae1-479d-429d-890e-61f96a259946&page=queryresults
[0m11:06:27.133273 [info ] [Thread-4 (]: 52 of 54 PASS test_is_last_date_inserted_agg_pollution_by_day_date ............. [[32mPASS[0m in 1.04s]
[0m11:06:27.134438 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:06:27.231358 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9ec469ec-404b-4d88-b767-86e0255e557f&page=queryresults
[0m11:06:27.312838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d2b5ffb-ae3d-4d87-b77b-e0f5c7d0a471&page=queryresults
[0m11:06:27.544714 [info ] [Thread-2 (]: 53 of 54 PASS test_is_last_datetime_inserted_fact_air_pollution_ ............... [[32mPASS[0m in 1.15s]
[0m11:06:27.546031 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:06:27.612826 [info ] [Thread-1 (]: 54 of 54 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.94s]
[0m11:06:27.614260 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:06:27.619275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:27.622334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:27.623050 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m11:06:27.623975 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d' was properly closed.
[0m11:06:27.624800 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a' was properly closed.
[0m11:06:27.625674 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m11:06:27.626712 [info ] [MainThread]: 
[0m11:06:27.627942 [info ] [MainThread]: Finished running 54 data tests in 0 hours 0 minutes and 13.68 seconds (13.68s).
[0m11:06:27.633626 [debug] [MainThread]: Command end result
[0m11:06:27.736700 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:06:27.745355 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:06:27.768485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m11:06:27.769642 [info ] [MainThread]: 
[0m11:06:27.770837 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:06:27.771648 [info ] [MainThread]: 
[0m11:06:27.772643 [error] [MainThread]: [31mFailure in test not_null_fact_air_pollution_city_name (models/schema.yml)[0m
[0m11:06:27.773620 [error] [MainThread]:   Database Error in test not_null_fact_air_pollution_city_name (models/schema.yml)
  Unrecognized name: city_name at [18:7]
  compiled code at target/run/france_air_pollution/models/schema.yml/not_null_fact_air_pollution_city_name.sql
[0m11:06:27.774424 [info ] [MainThread]: 
[0m11:06:27.775495 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/not_null_fact_air_pollution_city_name.sql
[0m11:06:27.776317 [info ] [MainThread]: 
[0m11:06:27.777090 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=54
[0m11:06:27.791049 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.816298, "process_in_blocks": "0", "process_kernel_time": 1.13149, "process_mem_max_rss": "379448", "process_out_blocks": "0", "process_user_time": 6.994764}
[0m11:06:27.795676 [debug] [MainThread]: Command `dbt test` failed at 11:06:27.795417 after 16.82 seconds
[0m11:06:27.797340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce2ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5259de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60270a10>]}
[0m11:06:27.798666 [debug] [MainThread]: Flushing usage events
[0m11:06:28.251182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:28.772163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da95550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de46f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de44860>]}


============================== 11:07:28.778548 | 2d93bccc-5716-48b5-b438-217bea17ea83 ==============================
[0m11:07:28.778548 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:07:28.779864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:31.346063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f35f2f0>]}
[0m11:07:31.379933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f43cbf0>]}
[0m11:07:31.381163 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:07:31.546364 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m11:07:31.669005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:31.671558 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m11:07:32.055239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b6d370>]}
[0m11:07:32.397801 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:07:32.410870 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:07:32.452442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7293c7a0>]}
[0m11:07:32.454552 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 497 macros
[0m11:07:32.456109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b6e120>]}
[0m11:07:32.460833 [info ] [MainThread]: 
[0m11:07:32.463962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:32.467382 [info ] [MainThread]: 
[0m11:07:32.470040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:07:32.476834 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m11:07:32.478786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:32.791123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d93bccc-5716-48b5-b438-217bea17ea83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72a62c30>]}
[0m11:07:32.792902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:32.799950 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:07:32.801044 [info ] [Thread-1 (]: 1 of 54 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m11:07:32.800295 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:07:32.801743 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:07:32.802258 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:07:32.802577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m11:07:32.803279 [info ] [Thread-2 (]: 2 of 54 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m11:07:32.804426 [info ] [Thread-3 (]: 3 of 54 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m11:07:32.805461 [info ] [Thread-4 (]: 4 of 54 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m11:07:32.809799 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m11:07:32.807557 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m11:07:32.808683 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m11:07:32.806550 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:07:32.810406 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:07:32.811014 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:07:32.811744 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:07:32.842186 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:07:32.828549 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:07:32.834658 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m11:07:32.822110 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:07:32.851590 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:07:32.859013 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:07:32.865116 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:07:32.881581 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m11:07:32.878893 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m11:07:32.878103 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m11:07:32.882728 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:07:32.893220 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m11:07:32.890553 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m11:07:32.894095 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m11:07:32.895310 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m11:07:32.895927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:32.903040 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m11:07:32.903428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:32.904178 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:32.938600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:33.390059 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ea8d4d2b-6a78-4796-80e8-136d946fcd3e&page=queryresults
[0m11:07:33.418998 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:420cf994-2804-48ef-ac41-07962ec0ca20&page=queryresults
[0m11:07:33.455714 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0a502cb3-ff16-4241-9cb1-e77b4c376923&page=queryresults
[0m11:07:33.463712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:51afa4f0-32e3-4fd4-aa99-f2d7fb8f398d&page=queryresults
[0m11:07:33.758713 [info ] [Thread-4 (]: 4 of 54 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 0.95s]
[0m11:07:33.760164 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m11:07:33.761032 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:07:33.761831 [info ] [Thread-4 (]: 5 of 54 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m11:07:33.762588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m11:07:33.763783 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:07:33.766930 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:07:33.769962 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:07:33.771600 [info ] [Thread-1 (]: 1 of 54 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 0.97s]
[0m11:07:33.774488 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m11:07:33.773442 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m11:07:33.775723 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:07:33.780521 [info ] [Thread-1 (]: 6 of 54 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m11:07:33.777744 [info ] [Thread-2 (]: 2 of 54 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 0.97s]
[0m11:07:33.775305 [info ] [Thread-3 (]: 3 of 54 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 0.97s]
[0m11:07:33.782609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m11:07:33.783253 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m11:07:33.783807 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m11:07:33.788204 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:07:33.786123 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:07:33.787166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:33.784920 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m11:07:33.789189 [info ] [Thread-2 (]: 7 of 54 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m11:07:33.868369 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:07:33.868990 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:07:33.888756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m11:07:33.926766 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:07:33.923886 [info ] [Thread-3 (]: 8 of 54 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m11:07:33.935803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m11:07:33.935446 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:07:33.933926 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:07:33.936489 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:07:33.940130 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m11:07:33.945108 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:07:33.944165 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:07:33.948851 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m11:07:33.952299 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m11:07:33.959308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:33.958855 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:07:33.960862 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.005429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:34.001776 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m11:07:34.054525 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.056426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:34.416773 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cb2efd39-4e5f-4e36-ae5c-c97b2ad6d75c&page=queryresults
[0m11:07:34.421145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:652fd6ea-02f2-4f35-8e61-0b8caa1b5650&page=queryresults
[0m11:07:34.421887 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7ce403a-508a-4248-a278-d3753e1f1ca1&page=queryresults
[0m11:07:34.424923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a95cdbda-3a0a-4a02-90c5-eeb3581d4553&page=queryresults
[0m11:07:34.739492 [info ] [Thread-4 (]: 5 of 54 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 0.98s]
[0m11:07:34.740636 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m11:07:34.741226 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:07:34.741991 [info ] [Thread-4 (]: 9 of 54 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m11:07:34.742869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m11:07:34.743515 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:07:34.746941 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:07:34.749560 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:07:34.751997 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m11:07:34.754445 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.755164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:34.798262 [info ] [Thread-3 (]: 8 of 54 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.86s]
[0m11:07:34.800001 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m11:07:34.798948 [info ] [Thread-1 (]: 6 of 54 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.02s]
[0m11:07:34.801585 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m11:07:34.802630 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:07:34.800779 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:07:34.803345 [info ] [Thread-1 (]: 11 of 54 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m11:07:34.804152 [info ] [Thread-3 (]: 10 of 54 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m11:07:34.804986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m11:07:34.805679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m11:07:34.807958 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:07:34.806703 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:07:34.811929 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:07:34.815461 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:07:34.821255 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:07:34.823553 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m11:07:34.823849 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:07:34.826484 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m11:07:34.827337 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.828727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:34.864058 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.866683 [info ] [Thread-2 (]: 7 of 54 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.98s]
[0m11:07:34.868226 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m11:07:34.873879 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:07:34.875080 [info ] [Thread-2 (]: 12 of 54 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m11:07:34.867780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:34.876142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m11:07:34.877699 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:07:34.892725 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:07:34.936313 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:07:34.939022 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m11:07:34.941508 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m11:07:34.942248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:35.271758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be684b9f-a287-4832-b6fe-f243f5194901&page=queryresults
[0m11:07:35.293499 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ebd27e40-56b5-4051-a558-e28883cb301b&page=queryresults
[0m11:07:35.328446 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:affea954-79b9-408d-a817-8893a50f750c&page=queryresults
[0m11:07:35.354120 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:77b6f96d-bfac-4e04-bef3-f8cd66a822f6&page=queryresults
[0m11:07:35.578204 [info ] [Thread-1 (]: 11 of 54 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.77s]
[0m11:07:35.579793 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m11:07:35.580381 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:07:35.580970 [info ] [Thread-1 (]: 13 of 54 START test not_null_agg_pollution_by_day_date ......................... [RUN]
[0m11:07:35.581675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc)
[0m11:07:35.582367 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:07:35.585978 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:07:35.589747 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:07:35.592940 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"
[0m11:07:35.595106 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:07:35.595876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:35.641848 [info ] [Thread-2 (]: 12 of 54 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.77s]
[0m11:07:35.643114 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m11:07:35.644187 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m11:07:35.645199 [info ] [Thread-2 (]: 14 of 54 START test not_null_fact_air_pollution_city ........................... [RUN]
[0m11:07:35.646251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654)
[0m11:07:35.646986 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m11:07:35.650448 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m11:07:35.653986 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m11:07:35.658428 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m11:07:35.659471 [info ] [Thread-3 (]: 10 of 54 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.85s]
[0m11:07:35.661094 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m11:07:35.661906 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:07:35.662454 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:07:35.663983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:35.662861 [info ] [Thread-3 (]: 15 of 54 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m11:07:35.701594 [info ] [Thread-4 (]: 9 of 54 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.96s]
[0m11:07:35.704673 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m11:07:35.702861 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m11:07:35.705733 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:07:35.707617 [info ] [Thread-4 (]: 16 of 54 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m11:07:35.706764 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:07:35.709110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m11:07:35.713630 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:07:35.716629 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m11:07:35.712554 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m11:07:35.720157 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:07:35.720974 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:07:35.723603 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m11:07:35.725455 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m11:07:35.730169 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:35.731430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:35.731159 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:35.766107 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:36.103653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ebfb8d09-4927-47b2-9747-53b313f62f40&page=queryresults
[0m11:07:36.185791 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ca1f1a0e-c43e-4417-a397-d1f48076eb5f&page=queryresults
[0m11:07:36.190690 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:abe9c524-59c1-40fd-850c-a67303df82b0&page=queryresults
[0m11:07:36.226317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ee19c3fb-b667-4594-a397-76ba1832ba36&page=queryresults
[0m11:07:36.463722 [info ] [Thread-1 (]: 13 of 54 PASS not_null_agg_pollution_by_day_date ............................... [[32mPASS[0m in 0.88s]
[0m11:07:36.508707 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc
[0m11:07:36.520889 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:07:36.527371 [info ] [Thread-3 (]: 15 of 54 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 0.82s]
[0m11:07:36.535190 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m11:07:36.537968 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:07:36.534613 [info ] [Thread-2 (]: 14 of 54 PASS not_null_fact_air_pollution_city ................................. [[32mPASS[0m in 0.89s]
[0m11:07:36.528474 [info ] [Thread-1 (]: 17 of 54 START test not_null_staging_cities_city ............................... [RUN]
[0m11:07:36.544310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_date.67a18ca1bc, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m11:07:36.539844 [info ] [Thread-3 (]: 18 of 54 START test not_null_staging_cities_id ................................. [RUN]
[0m11:07:36.542783 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m11:07:36.547036 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:07:36.548274 [info ] [Thread-2 (]: 19 of 54 START test not_null_staging_cities_latitude ........................... [RUN]
[0m11:07:36.546113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m11:07:36.550502 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:07:36.545182 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:07:36.549536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m11:07:36.529879 [info ] [Thread-4 (]: 16 of 54 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.82s]
[0m11:07:36.555966 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m11:07:36.559948 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m11:07:36.560837 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:07:36.561985 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m11:07:36.567012 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m11:07:36.568089 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:07:36.568542 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:07:36.569143 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:07:36.576149 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m11:07:36.573787 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:07:36.574113 [info ] [Thread-4 (]: 20 of 54 START test not_null_staging_cities_longitude .......................... [RUN]
[0m11:07:36.572866 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m11:07:36.579084 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m11:07:36.579969 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:07:36.580681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m11:07:36.587310 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:07:36.582729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:36.587916 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:07:36.592130 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m11:07:36.592663 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m11:07:36.629476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:36.626304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:36.631084 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:07:36.668233 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m11:07:36.708336 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m11:07:36.709276 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:37.066272 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cb39fbff-8599-4713-80a7-1f3d2a938800&page=queryresults
[0m11:07:37.072200 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1d465128-b81b-45a5-b937-fdae909dacab&page=queryresults
[0m11:07:37.096925 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:06898df4-e7b6-4702-a61b-bf8e9605ae39&page=queryresults
[0m11:07:37.097548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:137c8838-24cb-4342-9907-6b0a50a1fb8a&page=queryresults
[0m11:07:37.404964 [info ] [Thread-4 (]: 20 of 54 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.82s]
[0m11:07:37.407060 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m11:07:37.407996 [debug] [Thread-4 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:07:37.409352 [info ] [Thread-4 (]: 21 of 54 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m11:07:37.410458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m11:07:37.411347 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:07:37.419313 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m11:07:37.421723 [info ] [Thread-2 (]: 19 of 54 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 0.87s]
[0m11:07:37.426540 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m11:07:37.423738 [info ] [Thread-1 (]: 17 of 54 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 0.88s]
[0m11:07:37.428005 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:07:37.428778 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:07:37.434295 [info ] [Thread-2 (]: 22 of 54 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m11:07:37.433169 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m11:07:37.430152 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m11:07:37.437854 [info ] [Thread-3 (]: 18 of 54 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 0.89s]
[0m11:07:37.438321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m11:07:37.446667 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:07:37.451232 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m11:07:37.444788 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m11:07:37.440873 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:07:37.455657 [info ] [Thread-1 (]: 23 of 54 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m11:07:37.457938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m11:07:37.458817 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:07:37.463191 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m11:07:37.453959 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:07:37.466658 [info ] [Thread-3 (]: 24 of 54 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m11:07:37.442974 [debug] [Thread-4 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:07:37.456403 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:07:37.468237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m11:07:37.474579 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:07:37.481898 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m11:07:37.472925 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m11:07:37.469538 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:07:37.469993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:37.492462 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m11:07:37.532607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:37.487398 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m11:07:37.491787 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:07:37.571868 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m11:07:37.573847 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m11:07:37.575035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:37.576193 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m11:07:37.578326 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:37.998434 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0b6e0fc4-630e-4347-b023-455fd8efb5e6&page=queryresults
[0m11:07:38.021231 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c453b9e1-6c6c-4f67-a813-61b4d795bad0&page=queryresults
[0m11:07:38.029263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a52ada01-adf6-4d84-846c-d27a37f92123&page=queryresults
[0m11:07:38.045993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e35abae8-91bb-473e-8bf6-28e7a374bff6&page=queryresults
[0m11:07:38.336684 [info ] [Thread-4 (]: 21 of 54 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 0.93s]
[0m11:07:38.338886 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m11:07:38.339945 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:07:38.341048 [info ] [Thread-4 (]: 25 of 54 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m11:07:38.342175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m11:07:38.343303 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:07:38.348619 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m11:07:38.350427 [info ] [Thread-3 (]: 24 of 54 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 0.88s]
[0m11:07:38.353925 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m11:07:38.355226 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:07:38.357146 [info ] [Thread-3 (]: 26 of 54 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m11:07:38.359315 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:07:38.360232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m11:07:38.364020 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m11:07:38.366494 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:07:38.373439 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m11:07:38.375840 [info ] [Thread-1 (]: 23 of 54 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 0.92s]
[0m11:07:38.377443 [info ] [Thread-2 (]: 22 of 54 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.94s]
[0m11:07:38.381901 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m11:07:38.380238 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m11:07:38.384221 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:07:38.382595 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:07:38.383215 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:07:38.389236 [info ] [Thread-2 (]: 27 of 54 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m11:07:38.390207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m11:07:38.391424 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:07:38.385268 [info ] [Thread-1 (]: 28 of 54 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m11:07:38.396447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m11:07:38.400123 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:07:38.395482 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m11:07:38.378564 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m11:07:38.408343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:38.404457 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m11:07:38.444548 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:07:38.453411 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m11:07:38.387970 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m11:07:38.455243 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:07:38.462080 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m11:07:38.463660 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m11:07:38.466447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:38.466968 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m11:07:38.502380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:38.503906 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m11:07:38.509447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:38.950486 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b18a1ace-290e-4b37-a0ae-fce33ef42f1d&page=queryresults
[0m11:07:39.013110 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c30ebbf5-0005-49f0-8ed7-3022575b5f58&page=queryresults
[0m11:07:39.022551 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a190e81e-d7d4-4e21-9030-b5943078eb0b&page=queryresults
[0m11:07:39.029937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1f48721-d51d-4c7e-8866-cf8f030f40f9&page=queryresults
[0m11:07:39.265203 [info ] [Thread-4 (]: 25 of 54 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 0.92s]
[0m11:07:39.266879 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m11:07:39.268004 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:07:39.268850 [info ] [Thread-4 (]: 29 of 54 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m11:07:39.269940 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m11:07:39.271512 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:07:39.278034 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m11:07:39.281180 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:07:39.283739 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m11:07:39.286829 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m11:07:39.287973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:39.327043 [info ] [Thread-3 (]: 26 of 54 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 0.97s]
[0m11:07:39.329879 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m11:07:39.333067 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:07:39.334651 [info ] [Thread-3 (]: 30 of 54 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m11:07:39.336038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m11:07:39.343600 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:07:39.342774 [info ] [Thread-2 (]: 27 of 54 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.95s]
[0m11:07:39.354552 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m11:07:39.355228 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m11:07:39.358836 [info ] [Thread-1 (]: 28 of 54 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.96s]
[0m11:07:39.363380 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m11:07:39.364310 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:07:39.365679 [info ] [Thread-1 (]: 32 of 54 START test source_not_null_source_cities_city_index ................... [RUN]
[0m11:07:39.362087 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:07:39.369379 [info ] [Thread-2 (]: 31 of 54 START test source_not_null_source_cities_city ......................... [RUN]
[0m11:07:39.367751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m11:07:39.371395 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:07:39.370744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m11:07:39.366398 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:07:39.375248 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m11:07:39.376379 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:07:39.380277 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m11:07:39.386273 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m11:07:39.388337 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:07:39.394440 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m11:07:39.394876 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m11:07:39.395934 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:07:39.398127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:39.401144 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m11:07:39.409452 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m11:07:39.457493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:39.460555 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m11:07:39.497737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:39.825040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:37fffafe-4e99-4318-aafb-ca2e6346b5fa&page=queryresults
[0m11:07:39.868894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6f31743b-d611-461f-99cf-f2402e95e5dd&page=queryresults
[0m11:07:39.878916 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:43467b4a-370b-44a0-8253-6f0650457e7f&page=queryresults
[0m11:07:39.944141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:23088b5a-73de-4fcc-b08a-3462121c25f0&page=queryresults
[0m11:07:40.187531 [info ] [Thread-4 (]: 29 of 54 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.92s]
[0m11:07:40.189770 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m11:07:40.190645 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:07:40.188458 [info ] [Thread-3 (]: 30 of 54 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.85s]
[0m11:07:40.191635 [info ] [Thread-4 (]: 33 of 54 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m11:07:40.192700 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m11:07:40.193593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m11:07:40.197935 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:07:40.197376 [info ] [Thread-1 (]: 32 of 54 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.83s]
[0m11:07:40.204628 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m11:07:40.205426 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:07:40.206120 [info ] [Thread-1 (]: 35 of 54 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m11:07:40.207869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m11:07:40.195240 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:07:40.203395 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m11:07:40.208821 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:07:40.209602 [info ] [Thread-3 (]: 34 of 54 START test source_not_null_source_cities_longitude .................... [RUN]
[0m11:07:40.225387 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m11:07:40.226853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m11:07:40.228819 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:07:40.231967 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:07:40.236200 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m11:07:40.242412 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m11:07:40.243124 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:07:40.261609 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m11:07:40.263742 [info ] [Thread-2 (]: 31 of 54 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.89s]
[0m11:07:40.265749 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:07:40.266995 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m11:07:40.267771 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m11:07:40.274147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:40.271740 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:40.272499 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:07:40.279656 [info ] [Thread-2 (]: 36 of 54 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m11:07:40.278291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:40.271134 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m11:07:40.325902 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m11:07:40.367297 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m11:07:40.367836 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:07:40.369817 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:40.375181 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m11:07:40.417065 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:07:40.421356 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m11:07:40.424303 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:40.425225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:40.775546 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1a17c0c1-9d73-48bd-a879-a4d80afff8d9&page=queryresults
[0m11:07:40.782323 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1b9798e2-6a42-4356-bfc6-61762ead7231&page=queryresults
[0m11:07:40.947567 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c70f7133-e2ba-4012-b253-ffefca49ac0a&page=queryresults
[0m11:07:40.988793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9ed75ba0-f028-490a-98e8-3d30087d465c&page=queryresults
[0m11:07:41.157139 [info ] [Thread-3 (]: 34 of 54 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.93s]
[0m11:07:41.158547 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m11:07:41.159591 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:07:41.160589 [info ] [Thread-3 (]: 37 of 54 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m11:07:41.161958 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m11:07:41.162713 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:07:41.166609 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m11:07:41.168297 [info ] [Thread-4 (]: 33 of 54 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.97s]
[0m11:07:41.172426 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m11:07:41.173896 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:07:41.174918 [info ] [Thread-4 (]: 38 of 54 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m11:07:41.178818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m11:07:41.170103 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:07:41.179655 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:07:41.189647 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m11:07:41.185738 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m11:07:41.193681 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:07:41.194510 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:41.197268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:41.196478 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m11:07:41.239621 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:41.241013 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:41.279999 [info ] [Thread-2 (]: 36 of 54 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 0.95s]
[0m11:07:41.281992 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m11:07:41.284241 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:07:41.285434 [info ] [Thread-2 (]: 39 of 54 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m11:07:41.287844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m11:07:41.288841 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:07:41.293136 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m11:07:41.296864 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:07:41.299762 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m11:07:41.303391 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:41.304415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:41.357934 [info ] [Thread-1 (]: 35 of 54 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.15s]
[0m11:07:41.359265 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m11:07:41.360300 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:07:41.361192 [info ] [Thread-1 (]: 40 of 54 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m11:07:41.362459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m11:07:41.363675 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:07:41.371938 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m11:07:41.375832 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:07:41.379798 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m11:07:41.384153 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:41.385204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:41.810831 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c10988d0-47b4-4ca0-8f1a-6a863dc53ddd&page=queryresults
[0m11:07:41.861477 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:849d473c-3db9-4242-9fe4-0c37621d7823&page=queryresults
[0m11:07:41.929008 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04cf1cf0-53ad-4bec-9ecc-a5d7c050baf0&page=queryresults
[0m11:07:42.122416 [info ] [Thread-3 (]: 37 of 54 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.96s]
[0m11:07:42.124337 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m11:07:42.125376 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:07:42.126363 [info ] [Thread-3 (]: 41 of 54 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m11:07:42.127337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m11:07:42.128282 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:07:42.133655 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m11:07:42.136790 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:07:42.139292 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m11:07:42.142135 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:42.143345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:42.180909 [info ] [Thread-4 (]: 38 of 54 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 1.00s]
[0m11:07:42.182981 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m11:07:42.184458 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:07:42.185363 [info ] [Thread-4 (]: 42 of 54 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m11:07:42.186224 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m11:07:42.187039 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:07:42.191170 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m11:07:42.194393 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:07:42.197971 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m11:07:42.200370 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:42.201316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:42.239510 [info ] [Thread-1 (]: 40 of 54 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.88s]
[0m11:07:42.241005 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m11:07:42.242284 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:07:42.244188 [info ] [Thread-1 (]: 43 of 54 START test source_unique_source_cities_city_index ..................... [RUN]
[0m11:07:42.245227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m11:07:42.246224 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:07:42.251463 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m11:07:42.255540 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:07:42.257874 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m11:07:42.260393 [debug] [Thread-1 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:42.261248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:42.393884 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:68d4159a-3d0c-4748-b159-79d6ca789a45&page=queryresults
[0m11:07:42.675472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:22f41ef1-72f6-4799-8533-c11d49b319c6&page=queryresults
[0m11:07:42.711297 [info ] [Thread-2 (]: 39 of 54 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 1.42s]
[0m11:07:42.713240 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m11:07:42.714483 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:07:42.715906 [info ] [Thread-2 (]: 44 of 54 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m11:07:42.717249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m11:07:42.718110 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:07:42.723086 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:07:42.726235 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:07:42.729057 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m11:07:42.736428 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:42.740455 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cd5510dd-c3b1-4904-b93e-c370f3e4716d&page=queryresults
[0m11:07:42.741466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:42.781359 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cdf33921-4a65-45d8-b222-8a55619ee31b&page=queryresults
[0m11:07:43.073849 [info ] [Thread-1 (]: 43 of 54 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.83s]
[0m11:07:43.077084 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m11:07:43.078401 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:07:43.079314 [info ] [Thread-1 (]: 45 of 54 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m11:07:43.082160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m11:07:43.083799 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:07:43.089096 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:07:43.094036 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:07:43.098486 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m11:07:43.102463 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:43.103727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:43.142584 [info ] [Thread-4 (]: 42 of 54 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.96s]
[0m11:07:43.145188 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m11:07:43.146105 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:07:43.147304 [info ] [Thread-4 (]: 46 of 54 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m11:07:43.149203 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m11:07:43.150504 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:07:43.154788 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:07:43.158424 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:07:43.162512 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m11:07:43.166384 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:43.167717 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:43.205019 [info ] [Thread-3 (]: 41 of 54 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 1.08s]
[0m11:07:43.208146 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m11:07:43.209060 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:07:43.210160 [info ] [Thread-3 (]: 47 of 54 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m11:07:43.211982 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m11:07:43.213583 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:07:43.217636 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:07:43.221278 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:07:43.226235 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m11:07:43.229163 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:43.230353 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:43.410039 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb0d4433-be0d-485f-97bc-58e666175f88&page=queryresults
[0m11:07:43.684745 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c240f978-ca35-4c30-ad44-2b4953125605&page=queryresults
[0m11:07:43.704651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9053c721-e578-4264-989b-24023a4cdec9&page=queryresults
[0m11:07:43.764897 [info ] [Thread-2 (]: 44 of 54 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.05s]
[0m11:07:43.765925 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m11:07:43.766601 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:07:43.767292 [info ] [Thread-2 (]: 48 of 54 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m11:07:43.768249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m11:07:43.770375 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:07:43.774740 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:07:43.776738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f66a8142-caa9-4fcf-9505-a303dc1da35c&page=queryresults
[0m11:07:43.779968 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:07:43.782697 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m11:07:43.786483 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:43.787352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:44.036247 [info ] [Thread-4 (]: 46 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.89s]
[0m11:07:44.039128 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m11:07:44.041364 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:07:44.042531 [info ] [Thread-4 (]: 49 of 54 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m11:07:44.045730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m11:07:44.048278 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:07:44.047422 [info ] [Thread-1 (]: 45 of 54 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.97s]
[0m11:07:44.053926 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m11:07:44.054969 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:07:44.055971 [info ] [Thread-1 (]: 50 of 54 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m11:07:44.051926 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:07:44.058313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m11:07:44.060223 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:07:44.064017 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:07:44.064989 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:07:44.069584 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m11:07:44.071146 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:07:44.074035 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m11:07:44.076138 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:44.077880 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:44.078675 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:44.113138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:44.115077 [info ] [Thread-3 (]: 47 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.90s]
[0m11:07:44.119366 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m11:07:44.121381 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:07:44.122801 [info ] [Thread-3 (]: 51 of 54 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m11:07:44.157198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m11:07:44.159619 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:07:44.164717 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:07:44.169165 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:07:44.171544 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m11:07:44.174005 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m11:07:44.174659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:44.489174 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b42f9529-a8ea-4ced-b5f2-de0ffd3007c9&page=queryresults
[0m11:07:44.723830 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8ae96929-0b87-4700-8175-f62e8c528b58&page=queryresults
[0m11:07:44.729352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1b6ae513-8510-4374-9734-015ef75bf9ef&page=queryresults
[0m11:07:44.748682 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:58ecfb63-c654-4f9f-8c9f-39fd06cb4ec9&page=queryresults
[0m11:07:44.907782 [info ] [Thread-2 (]: 48 of 54 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.13s]
[0m11:07:45.053368 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m11:07:45.089952 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:07:45.093041 [info ] [Thread-2 (]: 52 of 54 START test test_is_last_date_inserted_agg_pollution_by_day_date ....... [RUN]
[0m11:07:45.097450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d)
[0m11:07:45.099187 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:07:45.121909 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:07:45.127129 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:07:45.131615 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"
[0m11:07:45.138495 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    last_date_cte AS (
        SELECT city, MAX(date) AS last_date
        FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
        GROUP BY city
    )

SELECT city, last_date
FROM last_date_cte
WHERE
    last_date < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:07:45.139980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:45.203444 [info ] [Thread-3 (]: 51 of 54 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 1.05s]
[0m11:07:45.206449 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m11:07:45.205558 [info ] [Thread-4 (]: 49 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 1.16s]
[0m11:07:45.212332 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m11:07:45.209365 [info ] [Thread-1 (]: 50 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.15s]
[0m11:07:45.216762 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m11:07:45.214741 [debug] [Thread-4 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:07:45.208339 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:07:45.220184 [info ] [Thread-4 (]: 54 of 54 START test unique_staging_cities_id ................................... [RUN]
[0m11:07:45.221270 [info ] [Thread-3 (]: 53 of 54 START test test_is_last_datetime_inserted_fact_air_pollution_ ......... [RUN]
[0m11:07:45.222474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m11:07:45.223956 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714, now test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a)
[0m11:07:45.225551 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:07:45.226731 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:07:45.232012 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m11:07:45.236053 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"
[0m11:07:45.240714 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:07:45.243556 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"
[0m11:07:45.243897 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:07:45.246931 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m11:07:45.250743 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH
    max_date_time_cte AS (
        SELECT city_id, MAX(dt) AS max_date_time
        FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
        GROUP BY city_id
    )

SELECT city_id, max_date_time
FROM max_date_time_cte
WHERE
    DATE(max_date_time, "Europe/Paris")
    < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)


  
  
      
    ) dbt_internal_test
[0m11:07:45.252131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:45.251670 [debug] [Thread-4 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:45.256920 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:45.808039 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6ef5f129-a57d-4132-83b2-01cda68df223&page=queryresults
[0m11:07:45.809326 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:05fa80f7-d48d-4288-b5b5-3edac60ae86b&page=queryresults
[0m11:07:45.896952 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2ac64cb1-74ff-4fef-9516-b560707cc296&page=queryresults
[0m11:07:46.098594 [info ] [Thread-2 (]: 52 of 54 PASS test_is_last_date_inserted_agg_pollution_by_day_date ............. [[32mPASS[0m in 1.00s]
[0m11:07:46.101618 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d
[0m11:07:46.157297 [info ] [Thread-4 (]: 54 of 54 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.93s]
[0m11:07:46.159988 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m11:07:46.246946 [info ] [Thread-3 (]: 53 of 54 PASS test_is_last_datetime_inserted_fact_air_pollution_ ............... [[32mPASS[0m in 1.02s]
[0m11:07:46.250295 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a
[0m11:07:46.258245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:46.261373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:46.264080 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m11:07:46.266092 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_date_inserted_agg_pollution_by_day_date.1a0fa5a63d' was properly closed.
[0m11:07:46.267697 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_last_datetime_inserted_fact_air_pollution_.b443fa106a' was properly closed.
[0m11:07:46.269165 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m11:07:46.271047 [info ] [MainThread]: 
[0m11:07:46.273004 [info ] [MainThread]: Finished running 54 data tests in 0 hours 0 minutes and 13.80 seconds (13.80s).
[0m11:07:46.284097 [debug] [MainThread]: Command end result
[0m11:07:46.494970 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m11:07:46.507282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m11:07:46.547345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m11:07:46.549408 [info ] [MainThread]: 
[0m11:07:46.551590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:46.562651 [info ] [MainThread]: 
[0m11:07:46.564217 [info ] [MainThread]: Done. PASS=54 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=54
[0m11:07:46.578580 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.842014, "process_in_blocks": "0", "process_kernel_time": 1.892668, "process_mem_max_rss": "384464", "process_out_blocks": "0", "process_user_time": 6.778104}
[0m11:07:46.581136 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:46.580933 after 17.85 seconds
[0m11:07:46.587706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d30fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a5e78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a5e7e90>]}
[0m11:07:46.590138 [debug] [MainThread]: Flushing usage events
[0m11:07:47.214465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:30.423500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981a7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98081fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981a4fb0>]}


============================== 13:18:30.429971 | 028e7a79-c15a-4d8d-ac46-4143213edfb2 ==============================
[0m13:18:30.429971 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:18:30.431061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:32.577752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '028e7a79-c15a-4d8d-ac46-4143213edfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e569c70>]}
[0m13:18:32.684462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '028e7a79-c15a-4d8d-ac46-4143213edfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98359160>]}
[0m13:18:32.691585 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:18:32.861402 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:18:32.960097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:18:32.961311 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_latest_datetime_by_city.sql
[0m13:18:32.962383 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m13:18:33.263219 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('test_latest_datetime_by_city', None), ('group_by_column', 'city_id'), ('datetime_column', 'dt'), ('timezone', 'Europe/Paris')] instead (4 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:18:33.265311 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8903, "process_in_blocks": "0", "process_kernel_time": 1.268874, "process_mem_max_rss": "368728", "process_out_blocks": "0", "process_user_time": 3.041255}
[0m13:18:33.266502 [debug] [MainThread]: Command `dbt test` failed at 13:18:33.266416 after 2.89 seconds
[0m13:18:33.267442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a65280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977ddd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b3dd0>]}
[0m13:18:33.268364 [debug] [MainThread]: Flushing usage events
[0m13:18:33.749846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:56.390337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837b7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b1d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b67350>]}


============================== 13:18:56.395965 | 5d76df58-56c4-44b7-b23a-59a15b41767b ==============================
[0m13:18:56.395965 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:18:56.397252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:18:58.514129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d76df58-56c4-44b7-b23a-59a15b41767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2aa9f0>]}
[0m13:18:58.550008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d76df58-56c4-44b7-b23a-59a15b41767b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69e67ad0>]}
[0m13:18:58.551206 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:18:58.707620 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:18:58.799801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:18:58.800882 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_latest_datetime_by_city.sql
[0m13:18:58.801959 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m13:18:59.163743 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('test_latest_datetime_by_city', None), ('group_by_column', 'city'), ('datetime_column', 'date'), ('timezone', 'Europe/Paris')] instead (4 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:18:59.166222 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8166509, "process_in_blocks": "0", "process_kernel_time": 1.283668, "process_mem_max_rss": "368960", "process_out_blocks": "0", "process_user_time": 3.039572}
[0m13:18:59.168022 [debug] [MainThread]: Command `dbt test` failed at 13:18:59.167922 after 2.82 seconds
[0m13:18:59.168835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8378bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6974a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69ef6150>]}
[0m13:18:59.169807 [debug] [MainThread]: Flushing usage events
[0m13:18:59.584667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:25.262936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa389f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fd26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d31ca0>]}


============================== 13:21:25.268347 | bdb51bb4-b930-48c8-a6c0-63ea98c4dc46 ==============================
[0m13:21:25.268347 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:21:25.270226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:27.247443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0630e0>]}
[0m13:21:27.278410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4764bc0>]}
[0m13:21:27.280775 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:21:27.432454 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:21:27.527957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:21:27.529015 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://macros/tests/test_latest_datetime_by_city.sql
[0m13:21:27.530116 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m13:21:27.894684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89268710>]}
[0m13:21:28.017795 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:21:28.024990 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:21:28.063421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890512e0>]}
[0m13:21:28.064896 [info ] [MainThread]: Found 4 models, 53 data tests, 2 sources, 498 macros
[0m13:21:28.066289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a086a80>]}
[0m13:21:28.070553 [info ] [MainThread]: 
[0m13:21:28.072162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:28.073664 [info ] [MainThread]: 
[0m13:21:28.075106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:28.079371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m13:21:28.080686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.532249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb51bb4-b930-48c8-a6c0-63ea98c4dc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89025670>]}
[0m13:21:28.534251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:28.543200 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:21:28.543660 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:21:28.544118 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:21:28.545203 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:21:28.544749 [info ] [Thread-1 (]: 1 of 53 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m13:21:28.546365 [info ] [Thread-2 (]: 2 of 53 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m13:21:28.547296 [info ] [Thread-3 (]: 3 of 53 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m13:21:28.548293 [info ] [Thread-4 (]: 4 of 53 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m13:21:28.549477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m13:21:28.550479 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m13:21:28.555296 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:21:28.553364 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m13:21:28.554389 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:21:28.552202 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m13:21:28.566222 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:21:28.566633 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:21:28.570422 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:21:28.571261 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:21:28.578346 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:21:28.582766 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:21:28.583808 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:21:28.584326 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:21:28.606666 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:21:28.607178 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:21:28.607701 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:21:28.608204 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:21:28.612746 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:21:28.610658 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:21:28.613685 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m13:21:28.616564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:28.615374 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m13:21:28.614454 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m13:21:28.617484 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m13:21:28.617891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:28.619008 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:28.651848 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:29.285254 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be830e23-f917-4d7f-9b9a-5a8afeb24979&page=queryresults
[0m13:21:29.295918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c32b2f0c-f839-491a-9a40-cfd4f6256b40&page=queryresults
[0m13:21:29.297415 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:188bef0c-bf72-4969-82cd-f0ac820dca75&page=queryresults
[0m13:21:29.298789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2892ffab-726e-4233-9207-d9c422af600e&page=queryresults
[0m13:21:29.757185 [info ] [Thread-4 (]: 4 of 53 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.20s]
[0m13:21:29.759395 [info ] [Thread-1 (]: 1 of 53 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.21s]
[0m13:21:29.761689 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:21:29.763885 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:21:29.775608 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:21:29.774547 [info ] [Thread-3 (]: 3 of 53 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.22s]
[0m13:21:29.766474 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:21:29.780670 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:21:29.777655 [info ] [Thread-1 (]: 6 of 53 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m13:21:29.784216 [info ] [Thread-4 (]: 5 of 53 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m13:21:29.786229 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:21:29.788413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m13:21:29.789921 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m13:21:29.791139 [info ] [Thread-3 (]: 7 of 53 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m13:21:29.792840 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:21:29.793913 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:21:29.795366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m13:21:29.805546 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:21:29.804586 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:21:29.800806 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:21:29.809290 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:21:29.813007 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:21:29.814484 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:21:29.825270 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:21:29.818234 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:21:29.816696 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:21:29.830757 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:21:29.828567 [info ] [Thread-2 (]: 2 of 53 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.28s]
[0m13:21:29.832137 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m13:21:29.834010 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:21:29.834535 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m13:21:29.835395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:29.835725 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m13:21:29.836942 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:21:29.839575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:29.841074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:29.874181 [info ] [Thread-2 (]: 8 of 53 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m13:21:29.914637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m13:21:29.947092 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:21:29.952571 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:21:29.956002 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:21:29.959687 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:21:29.962749 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m13:21:29.965249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:30.438826 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:77b61246-63b9-463c-ad1d-bd508698bbe0&page=queryresults
[0m13:21:30.441368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64f3ff4a-d7cb-426c-84ec-2ceea78493d5&page=queryresults
[0m13:21:30.442468 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:97f4b2ef-b87f-4535-a1e7-2932bcca3c44&page=queryresults
[0m13:21:30.443433 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:48455e08-88b2-4399-bf0c-f562478ce31b&page=queryresults
[0m13:21:30.811586 [info ] [Thread-4 (]: 5 of 53 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.02s]
[0m13:21:30.814987 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:21:30.817154 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:21:30.819982 [info ] [Thread-4 (]: 9 of 53 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m13:21:30.822325 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m13:21:30.825584 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:21:30.824284 [info ] [Thread-1 (]: 6 of 53 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.04s]
[0m13:21:30.837574 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:21:30.838705 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:21:30.839419 [info ] [Thread-3 (]: 7 of 53 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 1.04s]
[0m13:21:30.843847 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:21:30.842637 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:21:30.840438 [info ] [Thread-2 (]: 8 of 53 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.93s]
[0m13:21:30.844873 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:21:30.845613 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:21:30.847306 [info ] [Thread-1 (]: 10 of 53 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m13:21:30.849022 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:21:30.850552 [info ] [Thread-3 (]: 11 of 53 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m13:21:30.854447 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:21:30.855999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m13:21:30.859513 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:21:30.858007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m13:21:30.857195 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:21:30.863698 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:21:30.864803 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:21:30.865260 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:21:30.866882 [info ] [Thread-2 (]: 12 of 53 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m13:21:30.868700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:30.872444 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:21:30.873227 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:21:30.873888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m13:21:30.909244 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:21:30.910783 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:21:30.911305 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:21:30.914799 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:21:30.915766 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m13:21:30.917563 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:21:30.918965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:30.920167 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:21:30.922865 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:21:30.923269 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:21:30.955776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:30.958255 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m13:21:30.990588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:31.345878 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:48bec121-68d2-4a95-9c91-b6fa780d80cb&page=queryresults
[0m13:21:31.418101 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7015d27d-7b5b-4709-bcd2-cc7b63f57239&page=queryresults
[0m13:21:31.419003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4a76a287-1ff5-4153-b372-63c721d8074b&page=queryresults
[0m13:21:31.457298 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:022b650a-3260-42b1-a34e-b43d80ce7069&page=queryresults
[0m13:21:31.699831 [info ] [Thread-4 (]: 9 of 53 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.88s]
[0m13:21:31.702749 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:21:31.704497 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:21:31.706036 [info ] [Thread-4 (]: 13 of 53 START test not_null_fact_air_pollution_city ........................... [RUN]
[0m13:21:31.708481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654)
[0m13:21:31.710411 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:21:31.717103 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:21:31.721410 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:21:31.725551 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:21:31.728747 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:21:31.729624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:31.766345 [info ] [Thread-1 (]: 10 of 53 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.91s]
[0m13:21:31.767667 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:21:31.770206 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:21:31.770849 [info ] [Thread-1 (]: 14 of 53 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m13:21:31.771659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m13:21:31.772281 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:21:31.776565 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:21:31.779931 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:21:31.782406 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:21:31.785969 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:21:31.786886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:31.821496 [info ] [Thread-2 (]: 12 of 53 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.95s]
[0m13:21:31.824769 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:21:31.825664 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:21:31.826507 [info ] [Thread-2 (]: 15 of 53 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m13:21:31.827240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m13:21:31.827922 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:21:31.831688 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:21:31.834351 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:21:31.836510 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:21:31.840140 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:21:31.840944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:31.936890 [info ] [Thread-3 (]: 11 of 53 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 1.08s]
[0m13:21:31.938155 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:21:31.939584 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:21:31.940442 [info ] [Thread-3 (]: 16 of 53 START test not_null_staging_cities_city ............................... [RUN]
[0m13:21:31.941290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m13:21:31.941952 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:21:31.945198 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:21:31.947483 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:21:31.949489 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:21:31.953025 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:21:31.953823 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:32.191385 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eab175e1-1ee2-4d85-aa8c-b86bcb57e758&page=queryresults
[0m13:21:32.222022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e028a95c-0e09-4e6a-8455-edb8a69c403a&page=queryresults
[0m13:21:32.563482 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1a751840-a259-4229-97d4-1755bdc99ecc&page=queryresults
[0m13:21:32.565054 [info ] [Thread-4 (]: 13 of 53 PASS not_null_fact_air_pollution_city ................................. [[32mPASS[0m in 0.86s]
[0m13:21:32.573063 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:21:32.576162 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:21:32.577851 [info ] [Thread-4 (]: 17 of 53 START test not_null_staging_cities_id ................................. [RUN]
[0m13:21:32.579802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m13:21:32.581344 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:21:32.586234 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:21:32.588401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b28b3090-e9fe-442a-b4c9-14075142bad0&page=queryresults
[0m13:21:32.589722 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:21:32.593080 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:21:32.596137 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:21:32.597250 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:32.632564 [info ] [Thread-1 (]: 14 of 53 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 0.86s]
[0m13:21:32.633931 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:21:32.636094 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:21:32.636949 [info ] [Thread-1 (]: 18 of 53 START test not_null_staging_cities_latitude ........................... [RUN]
[0m13:21:32.638260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m13:21:32.639153 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:21:32.644489 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:21:32.647544 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:21:32.650295 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:21:32.652958 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:21:32.653702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:32.898365 [info ] [Thread-3 (]: 16 of 53 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 0.96s]
[0m13:21:32.900203 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:21:32.901096 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:21:32.902161 [info ] [Thread-3 (]: 19 of 53 START test not_null_staging_cities_longitude .......................... [RUN]
[0m13:21:32.903208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m13:21:32.904175 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:21:32.908186 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:21:32.911644 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:21:32.913961 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:21:32.916964 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:21:32.918487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:32.958880 [info ] [Thread-2 (]: 15 of 53 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 1.13s]
[0m13:21:32.960198 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:21:32.961233 [debug] [Thread-2 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:21:32.961993 [info ] [Thread-2 (]: 20 of 53 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m13:21:32.962968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m13:21:32.963734 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:21:32.968123 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:21:32.971594 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:21:32.974706 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:21:32.977858 [debug] [Thread-2 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:21:32.978600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:33.200312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c054c0e9-9017-4c9c-baef-a27dc71aea70&page=queryresults
[0m13:21:33.200888 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f99565af-82e0-4c41-90be-d6b8d793482d&page=queryresults
[0m13:21:33.337476 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d7fe09c0-2f5d-4cd3-8344-7d957b434475&page=queryresults
[0m13:21:33.434321 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9985c420-d88a-4141-ba83-7498615cdde2&page=queryresults
[0m13:21:33.498272 [info ] [Thread-1 (]: 18 of 53 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 0.86s]
[0m13:21:33.500706 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:21:33.502229 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:21:33.503410 [info ] [Thread-1 (]: 21 of 53 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m13:21:33.504942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m13:21:33.506280 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:21:33.512411 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:21:33.517086 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:21:33.520137 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:21:33.523975 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m13:21:33.525067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:33.563462 [info ] [Thread-4 (]: 17 of 53 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 0.98s]
[0m13:21:33.564933 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:21:33.566871 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:21:33.567922 [info ] [Thread-4 (]: 22 of 53 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m13:21:33.569757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m13:21:33.570811 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:21:33.576409 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:21:33.584696 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:21:33.588574 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:21:33.596091 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:21:33.597430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:33.689111 [info ] [Thread-3 (]: 19 of 53 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.79s]
[0m13:21:33.690260 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:21:33.690977 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:21:33.691704 [info ] [Thread-3 (]: 23 of 53 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m13:21:33.692421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m13:21:33.693114 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:21:33.697477 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:21:33.700865 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:21:33.703524 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:21:33.706106 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m13:21:33.707411 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:33.817273 [info ] [Thread-2 (]: 20 of 53 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 0.85s]
[0m13:21:33.833350 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:21:33.843666 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:21:33.845032 [info ] [Thread-2 (]: 24 of 53 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m13:21:33.846665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m13:21:33.850366 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:21:33.856306 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:21:33.860222 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:21:33.864021 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:21:33.869171 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m13:21:33.870903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:33.954654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b992956f-86cb-4047-bf8e-a82fd52e3718&page=queryresults
[0m13:21:34.205006 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5b87579c-5698-4732-a26b-322f93ebcec6&page=queryresults
[0m13:21:34.250863 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9cf86b47-e8c9-4547-9213-5908885051e1&page=queryresults
[0m13:21:34.271418 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fd59d07e-8a1b-4ba6-955f-3126a9dda8b5&page=queryresults
[0m13:21:34.299240 [info ] [Thread-1 (]: 21 of 53 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.79s]
[0m13:21:34.301190 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:21:34.303169 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:21:34.312260 [info ] [Thread-1 (]: 25 of 53 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m13:21:34.314871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m13:21:34.317682 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:21:34.327877 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:21:34.336761 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:21:34.343605 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:21:34.356634 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m13:21:34.358543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:34.702135 [info ] [Thread-4 (]: 22 of 53 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 1.13s]
[0m13:21:34.709148 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:21:34.718231 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:21:34.720548 [info ] [Thread-4 (]: 26 of 53 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m13:21:34.723533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m13:21:34.724818 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:21:34.734441 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:21:34.741900 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:21:34.744952 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:21:34.750277 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m13:21:34.751444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:34.814708 [info ] [Thread-2 (]: 24 of 53 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 0.97s]
[0m13:21:34.815465 [info ] [Thread-3 (]: 23 of 53 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 1.12s]
[0m13:21:34.818000 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:21:34.816867 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:21:34.818993 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:21:34.820084 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:21:34.824493 [info ] [Thread-2 (]: 28 of 53 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m13:21:34.825867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m13:21:34.821421 [info ] [Thread-3 (]: 27 of 53 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m13:21:34.826901 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:21:34.828699 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m13:21:34.840372 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:21:34.844151 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:21:34.838499 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:21:34.848264 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:21:34.852684 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:21:34.853064 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:21:34.857379 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:21:34.859273 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m13:21:34.860453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:34.862383 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:21:34.863483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:35.032811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bb7e4e5e-02da-4dc8-b961-cb74f61cbf79&page=queryresults
[0m13:21:35.233144 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:715c7e10-d15f-4fba-a251-0f0e1cf87218&page=queryresults
[0m13:21:35.321622 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:71a510a4-ee18-487d-85c6-1a808e4ca4ea&page=queryresults
[0m13:21:35.325430 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:736eab26-bf85-4f4b-896a-7c4d827bac06&page=queryresults
[0m13:21:35.328903 [info ] [Thread-1 (]: 25 of 53 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 1.01s]
[0m13:21:35.330190 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:21:35.331188 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:21:35.332108 [info ] [Thread-1 (]: 29 of 53 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m13:21:35.333124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m13:21:35.333985 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:21:35.339321 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:21:35.342241 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:21:35.345318 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:21:35.348579 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m13:21:35.349454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:35.599348 [info ] [Thread-4 (]: 26 of 53 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.88s]
[0m13:21:35.600525 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:21:35.601463 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:21:35.602129 [info ] [Thread-4 (]: 30 of 53 START test source_not_null_source_cities_city ......................... [RUN]
[0m13:21:35.602931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m13:21:35.603715 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:21:35.610470 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:21:35.613841 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:21:35.616196 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:21:35.618439 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:21:35.619141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:35.654481 [info ] [Thread-3 (]: 27 of 53 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.83s]
[0m13:21:35.655941 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:21:35.657177 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:21:35.658053 [info ] [Thread-3 (]: 31 of 53 START test source_not_null_source_cities_city_index ................... [RUN]
[0m13:21:35.658992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m13:21:35.655569 [info ] [Thread-2 (]: 28 of 53 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.83s]
[0m13:21:35.660225 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:21:35.661154 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:21:35.664983 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:21:35.666016 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:21:35.667785 [info ] [Thread-2 (]: 32 of 53 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m13:21:35.668673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m13:21:35.669465 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:21:35.669920 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:21:35.672914 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:21:35.675338 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:21:35.678260 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:21:35.680821 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:21:35.681812 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:21:35.682756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:35.683701 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:21:35.685020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:35.819145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1dff6db0-28af-4bc0-bf49-3f6f92919441&page=queryresults
[0m13:21:36.091622 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fd6b4e71-fe4c-42cb-8950-18a0cb3c724e&page=queryresults
[0m13:21:36.121173 [info ] [Thread-1 (]: 29 of 53 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.79s]
[0m13:21:36.123253 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:21:36.124576 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:21:36.125604 [info ] [Thread-1 (]: 33 of 53 START test source_not_null_source_cities_longitude .................... [RUN]
[0m13:21:36.127275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m13:21:36.130924 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d0b64b83-dfaf-4d36-82d4-e1865470c7e9&page=queryresults
[0m13:21:36.131979 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:21:36.138826 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:21:36.141861 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:21:36.144488 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:21:36.147000 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:21:36.147788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:36.149082 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b7571eab-5aa2-4d36-b95a-dea5cccb140e&page=queryresults
[0m13:21:36.413441 [info ] [Thread-4 (]: 30 of 53 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.81s]
[0m13:21:36.414740 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:21:36.415805 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:21:36.416703 [info ] [Thread-4 (]: 34 of 53 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m13:21:36.417599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m13:21:36.418323 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:21:36.422714 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:21:36.425985 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:21:36.428495 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:21:36.431158 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:36.432269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:36.467259 [info ] [Thread-3 (]: 31 of 53 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.81s]
[0m13:21:36.468251 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:21:36.469386 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:21:36.470337 [info ] [Thread-3 (]: 35 of 53 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m13:21:36.471329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m13:21:36.472094 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:21:36.475036 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:21:36.478300 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:21:36.480778 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:21:36.484204 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:36.485113 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:36.522081 [info ] [Thread-2 (]: 32 of 53 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.85s]
[0m13:21:36.524274 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:21:36.525326 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:21:36.526057 [info ] [Thread-2 (]: 36 of 53 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m13:21:36.526840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m13:21:36.527562 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:21:36.531057 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:21:36.535249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5a7cf302-c458-46ce-8d0d-6453d3ef1ea2&page=queryresults
[0m13:21:36.535975 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:21:36.540822 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:21:36.544026 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:36.545006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:36.876711 [info ] [Thread-1 (]: 33 of 53 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.75s]
[0m13:21:36.878471 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:21:36.879450 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:21:36.880326 [info ] [Thread-1 (]: 37 of 53 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m13:21:36.881371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m13:21:36.882358 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:21:36.888336 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:21:36.891682 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:21:36.895572 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:21:36.897859 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:36.898587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:37.046355 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:88923126-f6c6-4e05-b5b1-9c302196bb88&page=queryresults
[0m13:21:37.088745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1717e2ec-500d-450a-9827-a588d99534b5&page=queryresults
[0m13:21:37.247182 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e0e465dd-df9f-4364-aebd-768c12f783be&page=queryresults
[0m13:21:37.366367 [info ] [Thread-4 (]: 34 of 53 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 0.95s]
[0m13:21:37.368458 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:21:37.369704 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:21:37.371004 [info ] [Thread-4 (]: 38 of 53 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m13:21:37.372589 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m13:21:37.373926 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:21:37.378699 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:21:37.383774 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:21:37.386656 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:21:37.390929 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:37.392214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:37.472408 [info ] [Thread-2 (]: 36 of 53 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.95s]
[0m13:21:37.474460 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:21:37.475342 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:21:37.476352 [info ] [Thread-2 (]: 39 of 53 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m13:21:37.477897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m13:21:37.482962 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:21:37.487004 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:21:37.487670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b25b29d0-dbdf-49bf-8fa8-5a0f092f2151&page=queryresults
[0m13:21:37.491612 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:21:37.494222 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:21:37.497231 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:37.498060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:37.641108 [info ] [Thread-3 (]: 35 of 53 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 1.17s]
[0m13:21:37.642110 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:21:37.642896 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:21:37.643651 [info ] [Thread-3 (]: 40 of 53 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m13:21:37.644444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m13:21:37.645290 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:21:37.648846 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:21:37.652644 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:21:37.654786 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:21:37.658140 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:37.659251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:37.818061 [info ] [Thread-1 (]: 37 of 53 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.94s]
[0m13:21:37.819150 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:21:37.819945 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:21:37.820663 [info ] [Thread-1 (]: 41 of 53 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m13:21:37.821417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m13:21:37.822182 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:21:37.826341 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:21:37.828722 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:21:37.830774 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:21:37.833347 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:37.834279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:37.984661 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0680fbc1-43b2-4458-a37f-e2a6767bbd6c&page=queryresults
[0m13:21:38.064356 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:21042b28-6248-4cdd-be42-54b5f7a19c81&page=queryresults
[0m13:21:38.207568 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6a8485a8-5030-4288-97a5-91bad591c78e&page=queryresults
[0m13:21:38.286963 [info ] [Thread-4 (]: 38 of 53 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 0.91s]
[0m13:21:38.288513 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:21:38.289832 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:21:38.291420 [info ] [Thread-4 (]: 42 of 53 START test source_unique_source_cities_city_index ..................... [RUN]
[0m13:21:38.292413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m13:21:38.293215 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:21:38.300510 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:21:38.304646 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:21:38.308660 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:21:38.311127 [debug] [Thread-4 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:21:38.311901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:38.392685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fa63c006-c494-4ef2-9293-7d1095ba4f61&page=queryresults
[0m13:21:38.399455 [info ] [Thread-2 (]: 39 of 53 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.92s]
[0m13:21:38.400345 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:21:38.401238 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:21:38.401907 [info ] [Thread-2 (]: 43 of 53 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m13:21:38.402653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m13:21:38.403367 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:21:38.406614 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:21:38.408957 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:21:38.411472 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:21:38.414453 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:38.415656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:38.565365 [info ] [Thread-3 (]: 40 of 53 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 0.92s]
[0m13:21:38.566492 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:21:38.567428 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:21:38.568168 [info ] [Thread-3 (]: 44 of 53 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m13:21:38.568979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m13:21:38.569754 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:21:38.572774 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:21:38.575600 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:21:38.577810 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:21:38.580550 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:38.581329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:38.709324 [info ] [Thread-1 (]: 41 of 53 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.89s]
[0m13:21:38.710424 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:21:38.711206 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:21:38.712004 [info ] [Thread-1 (]: 45 of 53 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m13:21:38.712760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m13:21:38.713459 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:21:38.716778 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:21:38.719165 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:21:38.721277 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:21:38.725809 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:38.728344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:38.878536 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:25a85249-aeb7-4e69-96ad-b85857543cf8&page=queryresults
[0m13:21:38.967411 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a93bd39-a00a-4124-b75b-f8b955482cb6&page=queryresults
[0m13:21:39.137604 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:26a3e706-9f7c-49e9-b2ce-777c85ad8313&page=queryresults
[0m13:21:39.166218 [info ] [Thread-4 (]: 42 of 53 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.87s]
[0m13:21:39.167403 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:21:39.168110 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:21:39.168847 [info ] [Thread-4 (]: 46 of 53 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m13:21:39.169734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m13:21:39.170345 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:21:39.175998 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:21:39.180291 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:21:39.182533 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:21:39.185503 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:39.187369 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:39.276189 [info ] [Thread-2 (]: 43 of 53 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.87s]
[0m13:21:39.277358 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:21:39.278096 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:21:39.278690 [info ] [Thread-2 (]: 47 of 53 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m13:21:39.279462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m13:21:39.280078 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:21:39.283144 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:21:39.286460 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:21:39.289995 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:21:39.292505 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:39.293258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:39.327933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:025a8198-906b-460d-8af7-8e361119b827&page=queryresults
[0m13:21:39.412618 [info ] [Thread-3 (]: 44 of 53 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.84s]
[0m13:21:39.413707 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:21:39.414590 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:21:39.415304 [info ] [Thread-3 (]: 48 of 53 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m13:21:39.416088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m13:21:39.417100 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:21:39.420198 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:21:39.422712 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:21:39.424788 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:21:39.427530 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:39.428406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:39.682618 [info ] [Thread-1 (]: 45 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.97s]
[0m13:21:39.684534 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:21:39.685818 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:21:39.686934 [info ] [Thread-1 (]: 49 of 53 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m13:21:39.688228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m13:21:39.690179 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:21:39.695023 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:21:39.697794 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:21:39.701955 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:21:39.704865 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:39.706024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:39.817447 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6f0e662b-d6a4-4de7-a4fd-0ea7fd95bf3c&page=queryresults
[0m13:21:39.873482 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1e8419e4-95cb-4f67-9836-9f04de7821d8&page=queryresults
[0m13:21:39.933553 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ab9e2cc3-0058-4a91-83df-787d4a979342&page=queryresults
[0m13:21:40.129957 [info ] [Thread-4 (]: 46 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.96s]
[0m13:21:40.131845 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:21:40.133518 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:21:40.134731 [info ] [Thread-4 (]: 50 of 53 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m13:21:40.136209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m13:21:40.137311 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:21:40.138232 [info ] [Thread-2 (]: 47 of 53 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.86s]
[0m13:21:40.142469 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:21:40.143764 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:21:40.145657 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:21:40.146818 [info ] [Thread-2 (]: 51 of 53 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m13:21:40.148517 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:21:40.148985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m13:21:40.152737 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:21:40.155066 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:21:40.161446 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:21:40.162926 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:21:40.166891 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:21:40.170360 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:21:40.204031 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:21:40.207833 [debug] [Thread-2 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    DATE(max_datetime, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)



  
  
      
    ) dbt_internal_test
[0m13:21:40.209164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:40.262260 [info ] [Thread-3 (]: 48 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.85s]
[0m13:21:40.263546 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:21:40.264440 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:21:40.265139 [info ] [Thread-3 (]: 52 of 53 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m13:21:40.267516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m13:21:40.268345 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:21:40.272100 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:21:40.274814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b2f7264c-9e18-4d83-8aca-08b1eb61f134&page=queryresults
[0m13:21:40.276535 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:21:40.280260 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:21:40.284936 [debug] [Thread-3 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    DATE(max_datetime, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)



  
  
      
    ) dbt_internal_test
[0m13:21:40.286194 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:40.567584 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28d2a2c4-4e87-4f6a-bb93-996d6f8b0a24&page=queryresults
[0m13:21:40.569373 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28d2a2c4-4e87-4f6a-bb93-996d6f8b0a24&page=queryresults
[0m13:21:40.589912 [debug] [Thread-2 (]: Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:21:40.592589 [info ] [Thread-1 (]: 49 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.90s]
[0m13:21:40.598718 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:21:40.600130 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:21:40.602729 [info ] [Thread-1 (]: 53 of 53 START test unique_staging_cities_id ................................... [RUN]
[0m13:21:40.604392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m13:21:40.605493 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:21:40.613415 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:21:40.597342 [error] [Thread-2 (]: 51 of 53 ERROR test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[31mERROR[0m in 0.45s]
[0m13:21:40.616649 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:21:40.621893 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:21:40.627593 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:21:40.628456 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' to be skipped because of status 'error'.  Reason: Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql.
[0m13:21:40.629319 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c60da023-3c99-4c99-ad1e-100cf1a04a30&page=queryresults
[0m13:21:40.644018 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c60da023-3c99-4c99-ad1e-100cf1a04a30&page=queryresults
[0m13:21:40.647910 [debug] [Thread-3 (]: Database Error in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql
[0m13:21:40.649785 [error] [Thread-3 (]: 52 of 53 ERROR test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[31mERROR[0m in 0.38s]
[0m13:21:40.653203 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:21:40.649276 [debug] [Thread-1 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:21:40.656344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:40.657796 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' to be skipped because of status 'error'.  Reason: Database Error in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql.
[0m13:21:40.731967 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1d2f93a0-7405-4c6b-864b-24029e054a44&page=queryresults
[0m13:21:41.088236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c212651c-06a6-4e86-a27d-6315a54f8eab&page=queryresults
[0m13:21:41.197615 [info ] [Thread-4 (]: 50 of 53 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 1.06s]
[0m13:21:41.199766 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:21:41.472279 [info ] [Thread-1 (]: 53 of 53 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.87s]
[0m13:21:41.473475 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:21:41.480126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:41.484661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:41.486628 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m13:21:41.487478 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' was properly closed.
[0m13:21:41.488223 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m13:21:41.488908 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m13:21:41.490019 [info ] [MainThread]: 
[0m13:21:41.491090 [info ] [MainThread]: Finished running 53 data tests in 0 hours 0 minutes and 13.41 seconds (13.41s).
[0m13:21:41.497078 [debug] [MainThread]: Command end result
[0m13:21:41.616492 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:21:41.622931 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:21:41.642345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:21:41.644196 [info ] [MainThread]: 
[0m13:21:41.645407 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:21:41.646392 [info ] [MainThread]: 
[0m13:21:41.647545 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)[0m
[0m13:21:41.648384 [error] [MainThread]:   Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:21:41.649076 [info ] [MainThread]: 
[0m13:21:41.649855 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:21:41.650669 [info ] [MainThread]: 
[0m13:21:41.651602 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)[0m
[0m13:21:41.652536 [error] [MainThread]:   Database Error in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)
  Unrecognized name: max_datetime; Did you mean max_date_time? at [25:10]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql
[0m13:21:41.653314 [info ] [MainThread]: 
[0m13:21:41.654209 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql
[0m13:21:41.655371 [info ] [MainThread]: 
[0m13:21:41.656650 [info ] [MainThread]: Done. PASS=51 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=53
[0m13:21:41.664913 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.440935, "process_in_blocks": "0", "process_kernel_time": 1.337771, "process_mem_max_rss": "385624", "process_out_blocks": "0", "process_user_time": 6.509111}
[0m13:21:41.666703 [debug] [MainThread]: Command `dbt test` failed at 13:21:41.666590 after 16.44 seconds
[0m13:21:41.668562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35ad310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70eb8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885cac60>]}
[0m13:21:41.669657 [debug] [MainThread]: Flushing usage events
[0m13:21:42.175862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:41.502521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac12de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa67f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa236db0>]}


============================== 13:22:41.508190 | cd7d5ccc-d652-4225-ac2d-67544c2832d0 ==============================
[0m13:22:41.508190 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:22:41.509925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:43.560780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908cbe60>]}
[0m13:22:43.592327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabf7500>]}
[0m13:22:43.593426 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:22:43.749007 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:22:43.844615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:22:43.847135 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://macros/tests/test_latest_datetime_by_city.sql
[0m13:22:44.391403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa5b1d0>]}
[0m13:22:44.525561 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:22:44.559282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:22:44.674187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa58fb0>]}
[0m13:22:44.675690 [info ] [MainThread]: Found 4 models, 53 data tests, 2 sources, 498 macros
[0m13:22:44.676752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7f9520>]}
[0m13:22:44.682112 [info ] [MainThread]: 
[0m13:22:44.687491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:44.688987 [info ] [MainThread]: 
[0m13:22:44.693956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:44.699166 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m13:22:44.700091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:44.972522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7d5ccc-d652-4225-ac2d-67544c2832d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90142d80>]}
[0m13:22:44.974111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:44.981567 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:22:44.982177 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:22:44.982596 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:22:44.983362 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:22:44.983964 [info ] [Thread-1 (]: 1 of 53 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m13:22:44.985104 [info ] [Thread-2 (]: 2 of 53 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m13:22:44.987184 [info ] [Thread-3 (]: 3 of 53 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m13:22:44.988092 [info ] [Thread-4 (]: 4 of 53 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m13:22:44.989254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m13:22:44.990189 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m13:22:44.991135 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m13:22:44.994494 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:22:44.992889 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:22:44.993698 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:22:44.991921 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m13:22:45.014790 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:22:45.008960 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:22:45.014060 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:22:45.005834 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:22:45.018150 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:22:45.021444 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:22:45.022009 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:22:45.034213 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:22:45.036921 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:22:45.037584 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:22:45.037886 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:22:45.047839 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:22:45.039854 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:22:45.049668 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m13:22:45.053040 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m13:22:45.053600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:45.054146 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m13:22:45.054581 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:22:45.054944 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m13:22:45.088244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:22:45.131243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:22:45.550114 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7035ca7c-647f-40f7-9864-9f76035ff1b8&page=queryresults
[0m13:22:45.576723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:813675b1-d8d0-4995-898a-93291136d37d&page=queryresults
[0m13:22:45.578161 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cbc3dba7-5fa9-4ef5-84e4-419c86f952c5&page=queryresults
[0m13:22:45.584575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fc1df4d6-f951-4a87-ab18-6509e1bb24ed&page=queryresults
[0m13:22:46.005160 [info ] [Thread-1 (]: 1 of 53 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.02s]
[0m13:22:46.007170 [info ] [Thread-2 (]: 2 of 53 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.02s]
[0m13:22:46.008687 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:22:46.010542 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:22:46.016063 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:22:46.012742 [info ] [Thread-3 (]: 3 of 53 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.02s]
[0m13:22:46.014509 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:22:46.023370 [info ] [Thread-1 (]: 5 of 53 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m13:22:46.021151 [info ] [Thread-4 (]: 4 of 53 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.03s]
[0m13:22:46.026157 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:22:46.019290 [info ] [Thread-2 (]: 6 of 53 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m13:22:46.024738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m13:22:46.022258 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:22:46.028234 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:22:46.029655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m13:22:46.031203 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:22:46.035994 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:22:46.037334 [info ] [Thread-4 (]: 7 of 53 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m13:22:46.038575 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:22:46.048570 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:22:46.050345 [info ] [Thread-3 (]: 8 of 53 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m13:22:46.052050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m13:22:46.056636 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:22:46.059313 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m13:22:46.060471 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:22:46.060965 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:22:46.062104 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:22:46.065913 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:22:46.066225 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:22:46.068053 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:22:46.071018 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:22:46.073797 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:22:46.074912 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:22:46.079674 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:22:46.080167 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.080886 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:22:46.081210 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.081716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:46.085159 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:22:46.085868 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.087008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:46.120663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:46.122397 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.201592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:46.532702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:557dbfd6-65cc-4ce2-835a-7d4be9316eea&page=queryresults
[0m13:22:46.584949 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:55702dc1-31b1-414e-9c59-c1b2918f7b57&page=queryresults
[0m13:22:46.598234 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64486aff-4600-42b6-8933-a25ef5c7c449&page=queryresults
[0m13:22:46.616962 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d9ccfa62-cc43-4713-a29e-1fc70ceb21aa&page=queryresults
[0m13:22:46.857623 [info ] [Thread-1 (]: 5 of 53 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 0.83s]
[0m13:22:46.858900 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:22:46.859791 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:22:46.860549 [info ] [Thread-1 (]: 9 of 53 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m13:22:46.861428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m13:22:46.862306 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:22:46.867731 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:22:46.873317 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:22:46.875496 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:22:46.877641 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.878564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:46.937980 [info ] [Thread-2 (]: 6 of 53 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.91s]
[0m13:22:46.939043 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:22:46.939715 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:22:46.940428 [info ] [Thread-2 (]: 10 of 53 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m13:22:46.941244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m13:22:46.943799 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:22:46.942240 [info ] [Thread-3 (]: 8 of 53 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.88s]
[0m13:22:46.947251 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:22:46.948129 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:22:46.949571 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:22:46.950419 [info ] [Thread-3 (]: 11 of 53 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m13:22:46.951503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m13:22:46.952988 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:22:46.952521 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:22:46.956899 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:22:46.953585 [info ] [Thread-4 (]: 7 of 53 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.90s]
[0m13:22:46.961661 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:22:46.962536 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:22:46.958988 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:22:46.962913 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:22:46.963244 [info ] [Thread-4 (]: 12 of 53 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m13:22:46.966809 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:22:46.967698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m13:22:46.968090 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.970084 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:22:46.971072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:46.974115 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:22:46.974500 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:22:46.976322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:47.049172 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:22:47.051854 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:22:47.055424 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m13:22:47.056140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:47.349179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5c632040-f1be-4f2f-9a47-28ab3b114d5e&page=queryresults
[0m13:22:47.421169 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ee8144e1-2e6a-4e62-9165-5e839f277233&page=queryresults
[0m13:22:47.432876 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:435906be-11a8-449e-a1f8-6a080123360d&page=queryresults
[0m13:22:47.441015 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fcb52f75-9645-4050-adbb-e442a1f85404&page=queryresults
[0m13:22:47.674704 [info ] [Thread-1 (]: 9 of 53 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.81s]
[0m13:22:47.676614 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:22:47.677845 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:22:47.679131 [info ] [Thread-1 (]: 13 of 53 START test not_null_fact_air_pollution_city ........................... [RUN]
[0m13:22:47.680636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654)
[0m13:22:47.681655 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:22:47.686427 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:22:47.691647 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:22:47.695906 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:22:47.699187 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:22:47.700346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:47.739197 [info ] [Thread-4 (]: 12 of 53 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.77s]
[0m13:22:47.740463 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:22:47.741338 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:22:47.742792 [info ] [Thread-4 (]: 14 of 53 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m13:22:47.744071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m13:22:47.743516 [info ] [Thread-2 (]: 10 of 53 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.80s]
[0m13:22:47.744951 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:22:47.745915 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:22:47.748997 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:22:47.749803 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:22:47.752806 [info ] [Thread-3 (]: 11 of 53 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.80s]
[0m13:22:47.753996 [info ] [Thread-2 (]: 15 of 53 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m13:22:47.754942 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:22:47.755450 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:22:47.757080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m13:22:47.758077 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:22:47.761612 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:22:47.762503 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:22:47.763385 [info ] [Thread-3 (]: 16 of 53 START test not_null_staging_cities_city ............................... [RUN]
[0m13:22:47.768573 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m13:22:47.767442 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:22:47.769041 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:22:47.769503 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:22:47.771401 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:47.774261 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:22:47.774565 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:22:47.777388 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:22:47.810908 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:22:47.814233 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:22:47.815524 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:22:47.816308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:47.817334 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:22:47.818171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:48.227254 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d65b7e89-2e36-431e-8f9e-ea935083aedb&page=queryresults
[0m13:22:48.233939 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4847c203-b215-42d5-a78b-55a1dea6edae&page=queryresults
[0m13:22:48.266266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3fab9309-bbcd-433e-8fa2-55b16b1f67ab&page=queryresults
[0m13:22:48.278134 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ab7a7952-b152-46d8-9c6b-78d60e7c98bc&page=queryresults
[0m13:22:48.545009 [info ] [Thread-2 (]: 15 of 53 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.79s]
[0m13:22:48.547598 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:22:48.549151 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:22:48.550595 [info ] [Thread-2 (]: 17 of 53 START test not_null_staging_cities_id ................................. [RUN]
[0m13:22:48.554048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m13:22:48.555303 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:22:48.562024 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:22:48.568597 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:22:48.572188 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:22:48.576112 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:22:48.577435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:48.614472 [info ] [Thread-1 (]: 13 of 53 PASS not_null_fact_air_pollution_city ................................. [[32mPASS[0m in 0.93s]
[0m13:22:48.615796 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:22:48.616602 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:22:48.617952 [info ] [Thread-1 (]: 18 of 53 START test not_null_staging_cities_latitude ........................... [RUN]
[0m13:22:48.618809 [info ] [Thread-4 (]: 14 of 53 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 0.87s]
[0m13:22:48.619531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m13:22:48.620414 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:22:48.621088 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:22:48.622095 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:22:48.635153 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:22:48.638341 [info ] [Thread-4 (]: 19 of 53 START test not_null_staging_cities_longitude .......................... [RUN]
[0m13:22:48.641197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m13:22:48.642105 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:22:48.646574 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:22:48.646998 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:22:48.650173 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:22:48.651717 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:22:48.653816 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:22:48.654206 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:22:48.655610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:48.656385 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:22:48.688486 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:48.690907 [info ] [Thread-3 (]: 16 of 53 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 0.92s]
[0m13:22:48.723952 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:22:48.725385 [debug] [Thread-3 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:22:48.726723 [info ] [Thread-3 (]: 20 of 53 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m13:22:48.728489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m13:22:48.729562 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:22:48.733891 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:22:48.736191 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:22:48.738138 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:22:48.740454 [debug] [Thread-3 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:22:48.741377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:49.078053 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:49bc5fa8-5caa-4030-a7fe-2b34f3beb758&page=queryresults
[0m13:22:49.115106 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:efd826ee-4e9b-49b4-b7cf-90d31fa145f8&page=queryresults
[0m13:22:49.123876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:41ddb11f-5a08-451f-b527-cfc167315085&page=queryresults
[0m13:22:49.210559 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:078d89ef-e0e8-4110-aeaf-c77125c75d71&page=queryresults
[0m13:22:49.399761 [info ] [Thread-2 (]: 17 of 53 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 0.85s]
[0m13:22:49.401575 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:22:49.403068 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:22:49.404070 [info ] [Thread-2 (]: 21 of 53 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m13:22:49.405151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m13:22:49.406090 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:22:49.410898 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:22:49.415141 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:22:49.417401 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:22:49.420163 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m13:22:49.421084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:49.456318 [info ] [Thread-4 (]: 19 of 53 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.82s]
[0m13:22:49.458299 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:22:49.459825 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:22:49.460536 [info ] [Thread-1 (]: 18 of 53 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 0.84s]
[0m13:22:49.461721 [info ] [Thread-4 (]: 22 of 53 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m13:22:49.462937 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:22:49.463668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m13:22:49.465281 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:22:49.464386 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:22:49.468882 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:22:49.470252 [info ] [Thread-1 (]: 23 of 53 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m13:22:49.472641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m13:22:49.473401 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:22:49.476996 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:22:49.477524 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:22:49.480205 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:22:49.481263 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:22:49.485474 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:22:49.486352 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:22:49.489742 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:49.490662 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m13:22:49.492523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:49.557963 [info ] [Thread-3 (]: 20 of 53 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 0.83s]
[0m13:22:49.559362 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:22:49.560254 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:22:49.561041 [info ] [Thread-3 (]: 24 of 53 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m13:22:49.561913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m13:22:49.562623 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:22:49.565897 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:22:49.568817 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:22:49.570780 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:22:49.574225 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m13:22:49.574944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:49.910118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4649fc3a-416f-452d-b28d-6c410b4213f6&page=queryresults
[0m13:22:49.918297 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:08313cf3-6eea-4d7f-bd96-0f7985672898&page=queryresults
[0m13:22:49.922074 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:718a6ee2-0dc3-4451-b477-c1699c63945e&page=queryresults
[0m13:22:49.956728 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a316e646-c582-4ca3-8124-bdb16e635edc&page=queryresults
[0m13:22:50.241638 [info ] [Thread-1 (]: 23 of 53 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 0.77s]
[0m13:22:50.244013 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:22:50.245134 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:22:50.246112 [info ] [Thread-1 (]: 25 of 53 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m13:22:50.248280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m13:22:50.249208 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:22:50.254870 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:22:50.258013 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:22:50.260641 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:22:50.263339 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m13:22:50.264250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:50.300677 [info ] [Thread-2 (]: 21 of 53 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.90s]
[0m13:22:50.306367 [info ] [Thread-4 (]: 22 of 53 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 0.84s]
[0m13:22:50.307862 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:22:50.311186 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:22:50.312657 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:22:50.313580 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:22:50.314323 [info ] [Thread-2 (]: 26 of 53 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m13:22:50.316080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m13:22:50.318566 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:22:50.318193 [info ] [Thread-3 (]: 24 of 53 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 0.76s]
[0m13:22:50.315224 [info ] [Thread-4 (]: 27 of 53 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m13:22:50.322328 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:22:50.323390 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:22:50.327855 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:22:50.329130 [info ] [Thread-3 (]: 28 of 53 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m13:22:50.324300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m13:22:50.329548 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:22:50.330279 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m13:22:50.331091 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:22:50.337524 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:22:50.334155 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:22:50.333313 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:22:50.342891 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:22:50.341830 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:22:50.347015 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:22:50.348190 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m13:22:50.350150 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:22:50.354531 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:22:50.350902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:50.354880 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m13:22:50.356304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:50.389410 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:22:50.390517 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:50.742470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3cd479e-a4f9-45ce-9987-2624fdf896fb&page=queryresults
[0m13:22:50.767312 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:33b66ecc-2721-4e6f-b36a-c394b610d8cf&page=queryresults
[0m13:22:50.780344 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:594a3193-bc29-4d4e-9c74-70b76a2a782d&page=queryresults
[0m13:22:50.820114 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d1b44944-1c32-4370-b617-6daca1b9ac2c&page=queryresults
[0m13:22:51.094927 [info ] [Thread-1 (]: 25 of 53 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 0.85s]
[0m13:22:51.097113 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:22:51.099208 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:22:51.100287 [info ] [Thread-1 (]: 29 of 53 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m13:22:51.101308 [info ] [Thread-3 (]: 28 of 53 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.77s]
[0m13:22:51.101902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m13:22:51.103198 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:22:51.105150 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:22:51.106508 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:22:51.112602 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:22:51.114124 [info ] [Thread-3 (]: 30 of 53 START test source_not_null_source_cities_city ......................... [RUN]
[0m13:22:51.115082 [info ] [Thread-2 (]: 26 of 53 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.80s]
[0m13:22:51.116711 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m13:22:51.117960 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:22:51.118340 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:22:51.118776 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:22:51.119558 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:22:51.122179 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:22:51.125579 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:22:51.126577 [info ] [Thread-2 (]: 31 of 53 START test source_not_null_source_cities_city_index ................... [RUN]
[0m13:22:51.129335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m13:22:51.130291 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:22:51.130759 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m13:22:51.133543 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:22:51.135163 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:22:51.134747 [info ] [Thread-4 (]: 27 of 53 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.81s]
[0m13:22:51.135701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:51.138503 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:22:51.139401 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:22:51.139726 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:22:51.175274 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:22:51.179943 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:22:51.182572 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:22:51.184401 [info ] [Thread-4 (]: 32 of 53 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m13:22:51.185620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:51.187486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m13:22:51.188991 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:22:51.188618 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:22:51.225339 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:22:51.226886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:51.263444 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:22:51.265859 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:22:51.270142 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:22:51.271016 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:51.599258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:883b4c3d-45eb-42ae-91f1-9ca1f256d6e4&page=queryresults
[0m13:22:51.621857 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2db3f63f-0d78-4aea-9621-e2830765a8c3&page=queryresults
[0m13:22:51.622475 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b169f2c6-8ea4-4e8e-90e0-c62f946bd72d&page=queryresults
[0m13:22:51.648205 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c0527f90-261e-496c-aebe-8d58043ba1fe&page=queryresults
[0m13:22:51.957520 [info ] [Thread-1 (]: 29 of 53 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.86s]
[0m13:22:51.959810 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:22:51.961387 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:22:51.962857 [info ] [Thread-1 (]: 33 of 53 START test source_not_null_source_cities_longitude .................... [RUN]
[0m13:22:51.967537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m13:22:51.969475 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:22:51.975822 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:22:51.978031 [info ] [Thread-2 (]: 31 of 53 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.85s]
[0m13:22:51.979540 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:22:51.980690 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:22:51.981837 [info ] [Thread-2 (]: 34 of 53 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m13:22:51.982293 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:22:51.983042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m13:22:51.986757 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:22:51.985898 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:22:51.991739 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:22:51.993608 [info ] [Thread-4 (]: 32 of 53 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.81s]
[0m13:22:51.995689 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:22:51.996801 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:22:51.997383 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:22:51.997869 [info ] [Thread-4 (]: 35 of 53 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m13:22:51.999025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:51.999560 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:22:52.000682 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m13:22:52.001381 [info ] [Thread-3 (]: 30 of 53 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.88s]
[0m13:22:52.038819 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:22:52.037537 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:22:52.035732 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:22:52.040156 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:22:52.045472 [info ] [Thread-3 (]: 36 of 53 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m13:22:52.046365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m13:22:52.043488 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:22:52.047018 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:22:52.047447 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:52.052286 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:22:52.053032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:52.053350 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:22:52.057064 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:22:52.089357 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:22:52.092102 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:22:52.094099 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:52.095495 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:52.096093 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:52.096936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:52.450477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a79d2afa-0d9a-49b2-a78a-4e947c3e9c2a&page=queryresults
[0m13:22:52.648027 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:56a852fe-aac4-4237-9d33-2007fba3f3a7&page=queryresults
[0m13:22:52.655705 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d33c305f-f90a-4cdc-ad18-6997187c5d6a&page=queryresults
[0m13:22:52.982888 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:89993836-9f45-4f8b-b76b-414ea5157027&page=queryresults
[0m13:22:52.984832 [info ] [Thread-2 (]: 34 of 53 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.00s]
[0m13:22:53.000905 [info ] [Thread-3 (]: 36 of 53 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.95s]
[0m13:22:53.006949 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:22:53.070878 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:22:53.077072 [info ] [Thread-2 (]: 37 of 53 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m13:22:53.080968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m13:22:53.082184 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:22:53.064478 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:22:53.066210 [info ] [Thread-1 (]: 33 of 53 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 1.10s]
[0m13:22:53.091048 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:22:53.092276 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:22:53.094202 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:22:53.095848 [info ] [Thread-3 (]: 38 of 53 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m13:22:53.096923 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:22:53.097363 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:22:53.097921 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m13:22:53.104226 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:22:53.103234 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:22:53.098661 [info ] [Thread-1 (]: 39 of 53 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m13:22:53.107394 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:22:53.108895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m13:22:53.112900 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:22:53.110497 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:53.116080 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:22:53.116960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:53.117975 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:22:53.120885 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:22:53.158298 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:22:53.163879 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:22:53.165262 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:53.167553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:53.169164 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:53.170503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:53.369441 [info ] [Thread-4 (]: 35 of 53 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 1.37s]
[0m13:22:53.370663 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:22:53.371579 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:22:53.372643 [info ] [Thread-4 (]: 40 of 53 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m13:22:53.373594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m13:22:53.374393 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:22:53.378472 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:22:53.382558 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:22:53.384776 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:22:53.387308 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:53.388414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:53.637006 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d9d2fb18-f173-4462-aa28-9017d39fb3eb&page=queryresults
[0m13:22:53.841888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:24081136-4558-40c0-b860-6df19a852bd5&page=queryresults
[0m13:22:53.871748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e6a3d05b-c90a-42ec-b668-880b36c5979d&page=queryresults
[0m13:22:53.921841 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:995bcdf6-e402-4810-a69d-de53e0ada485&page=queryresults
[0m13:22:53.975984 [info ] [Thread-2 (]: 37 of 53 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.90s]
[0m13:22:53.978425 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:22:53.979377 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:22:53.984805 [info ] [Thread-2 (]: 41 of 53 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m13:22:53.985679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m13:22:53.986506 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:22:53.991390 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:22:53.994680 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:22:53.997033 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:22:53.999804 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:54.001019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:54.165207 [info ] [Thread-3 (]: 38 of 53 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 1.07s]
[0m13:22:54.166165 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:22:54.166932 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:22:54.167608 [info ] [Thread-3 (]: 42 of 53 START test source_unique_source_cities_city_index ..................... [RUN]
[0m13:22:54.168391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m13:22:54.169058 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:22:54.173917 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:22:54.176288 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:22:54.179756 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:22:54.182585 [debug] [Thread-3 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:22:54.183438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:54.218375 [info ] [Thread-1 (]: 39 of 53 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 1.11s]
[0m13:22:54.219695 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:22:54.221069 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:22:54.221985 [info ] [Thread-1 (]: 43 of 53 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m13:22:54.223133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m13:22:54.224022 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:22:54.227431 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:22:54.230618 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:22:54.232973 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:22:54.236878 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:54.238138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:54.276224 [info ] [Thread-4 (]: 40 of 53 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 0.90s]
[0m13:22:54.278409 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:22:54.279318 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:22:54.280175 [info ] [Thread-4 (]: 44 of 53 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m13:22:54.281019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m13:22:54.281712 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:22:54.284949 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:22:54.287552 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:22:54.290059 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:22:54.292510 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:54.293317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:54.535243 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e6eabe94-2426-4a82-9338-9d1a58223847&page=queryresults
[0m13:22:54.607893 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:73fce57d-86e0-4662-969b-4f9adfaee721&page=queryresults
[0m13:22:54.818511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0507ef17-18e0-4dfb-bd97-7bdbf637e69a&page=queryresults
[0m13:22:54.843297 [info ] [Thread-2 (]: 41 of 53 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.86s]
[0m13:22:54.845560 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:22:54.846699 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:22:54.847558 [info ] [Thread-2 (]: 45 of 53 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m13:22:54.848524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m13:22:54.849442 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:22:54.854269 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:22:54.857428 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:22:54.860121 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:22:54.863371 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:54.864385 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2238f6c6-3b38-4bf5-892a-2704c868539a&page=queryresults
[0m13:22:54.864890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:54.923225 [info ] [Thread-3 (]: 42 of 53 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.75s]
[0m13:22:54.925741 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:22:54.926755 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:22:54.927814 [info ] [Thread-3 (]: 46 of 53 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m13:22:54.930876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m13:22:54.931910 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:22:54.936510 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:22:54.939844 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:22:54.943249 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:22:54.946666 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:54.947600 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:55.212654 [info ] [Thread-1 (]: 43 of 53 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.99s]
[0m13:22:55.217545 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:22:55.224871 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:22:55.227078 [info ] [Thread-1 (]: 47 of 53 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m13:22:55.229904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m13:22:55.232036 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:22:55.250444 [info ] [Thread-4 (]: 44 of 53 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.97s]
[0m13:22:55.255856 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:22:55.257487 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:22:55.255108 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:22:55.258950 [info ] [Thread-4 (]: 48 of 53 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m13:22:55.261394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m13:22:55.262854 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:22:55.267262 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:22:55.267744 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:22:55.271019 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:22:55.272086 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:22:55.275015 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:22:55.275905 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:55.277757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:55.279085 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:55.280500 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:55.485572 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f489b38d-48c9-45fe-9d40-3e78c681b35b&page=queryresults
[0m13:22:55.525016 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6a01969a-b17f-4b96-babd-10fbd76e8ef9&page=queryresults
[0m13:22:55.797885 [info ] [Thread-3 (]: 46 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.87s]
[0m13:22:55.799405 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:22:55.800325 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:22:55.801140 [info ] [Thread-3 (]: 49 of 53 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m13:22:55.802249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m13:22:55.803125 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:22:55.806588 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:22:55.809570 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:22:55.813073 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:22:55.816453 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:55.817859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:55.853902 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2761572c-98ce-4b96-8876-2d7a57b61624&page=queryresults
[0m13:22:55.877330 [info ] [Thread-2 (]: 45 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 1.03s]
[0m13:22:55.878594 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:22:55.879462 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:22:55.880508 [info ] [Thread-2 (]: 50 of 53 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m13:22:55.881532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m13:22:55.882370 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:22:55.886412 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:22:55.890002 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:22:55.892340 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:22:55.895526 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:22:55.897521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:55.995988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5b514f72-7858-4f7e-be46-670036fe61d8&page=queryresults
[0m13:22:56.179146 [info ] [Thread-4 (]: 48 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.92s]
[0m13:22:56.180840 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:22:56.181942 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:22:56.183189 [info ] [Thread-4 (]: 51 of 53 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m13:22:56.184083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m13:22:56.185210 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:22:56.190888 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:22:56.195028 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:22:56.198247 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:22:56.201545 [debug] [Thread-4 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)



  
  
      
    ) dbt_internal_test
[0m13:22:56.202497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:56.354519 [info ] [Thread-1 (]: 47 of 53 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.13s]
[0m13:22:56.355835 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:22:56.356839 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:22:56.358402 [info ] [Thread-1 (]: 52 of 53 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m13:22:56.360795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m13:22:56.361665 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:22:56.368404 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:22:56.371477 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:22:56.373620 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:22:56.376162 [debug] [Thread-1 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)



  
  
      
    ) dbt_internal_test
[0m13:22:56.377200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:56.431991 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c6aac3db-3635-4513-957d-8d61c7b5247a&page=queryresults
[0m13:22:56.497675 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d8d6f322-4068-4fda-9677-ab5927f2c311&page=queryresults
[0m13:22:56.557869 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e230f41d-a869-4e55-9502-8694905cf438&page=queryresults
[0m13:22:56.559087 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e230f41d-a869-4e55-9502-8694905cf438&page=queryresults
[0m13:22:56.566584 [debug] [Thread-4 (]: Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  No matching signature for function DATE
    Argument types: DATE, STRING
    Signature: DATE(TIMESTAMP, [STRING])
      Argument 1: Unable to coerce type DATE to expected type TIMESTAMP
    Signature: DATE(DATETIME)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(INT64, INT64, INT64)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE(DATE)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(STRING)
      Signature accepts at most 1 argument, found 2 arguments at [25:5]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:22:56.567515 [error] [Thread-4 (]: 51 of 53 ERROR test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[31mERROR[0m in 0.38s]
[0m13:22:56.568503 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:22:56.569278 [debug] [Thread-4 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:22:56.569948 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' to be skipped because of status 'error'.  Reason: Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  No matching signature for function DATE
    Argument types: DATE, STRING
    Signature: DATE(TIMESTAMP, [STRING])
      Argument 1: Unable to coerce type DATE to expected type TIMESTAMP
    Signature: DATE(DATETIME)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(INT64, INT64, INT64)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE(DATE)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(STRING)
      Signature accepts at most 1 argument, found 2 arguments at [25:5]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql.
[0m13:22:56.570742 [info ] [Thread-4 (]: 53 of 53 START test unique_staging_cities_id ................................... [RUN]
[0m13:22:56.578519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m13:22:56.579366 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:22:56.584463 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:22:56.587206 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:22:56.589079 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:22:56.591751 [debug] [Thread-4 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:22:56.592471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:22:56.782410 [info ] [Thread-3 (]: 49 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.98s]
[0m13:22:56.783670 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:22:56.843314 [info ] [Thread-2 (]: 50 of 53 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.96s]
[0m13:22:56.844499 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:22:56.981848 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9a81fc77-8cb9-453c-8acc-8a393b9c920c&page=queryresults
[0m13:22:56.994051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0be850f1-fc3a-4072-b047-d5dbe0d146b9&page=queryresults
[0m13:22:57.326695 [info ] [Thread-4 (]: 53 of 53 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.74s]
[0m13:22:57.343278 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:22:57.353856 [info ] [Thread-1 (]: 52 of 53 PASS test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[32mPASS[0m in 0.99s]
[0m13:22:57.357370 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:22:57.365799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:57.371061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:57.371864 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m13:22:57.372590 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m13:22:57.373460 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m13:22:57.374585 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m13:22:57.375712 [info ] [MainThread]: 
[0m13:22:57.376647 [info ] [MainThread]: Finished running 53 data tests in 0 hours 0 minutes and 12.68 seconds (12.68s).
[0m13:22:57.385759 [debug] [MainThread]: Command end result
[0m13:22:57.486926 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:22:57.493646 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:22:57.511660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:22:57.512380 [info ] [MainThread]: 
[0m13:22:57.513314 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:22:57.514140 [info ] [MainThread]: 
[0m13:22:57.515005 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)[0m
[0m13:22:57.515907 [error] [MainThread]:   Database Error in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)
  No matching signature for function DATE
    Argument types: DATE, STRING
    Signature: DATE(TIMESTAMP, [STRING])
      Argument 1: Unable to coerce type DATE to expected type TIMESTAMP
    Signature: DATE(DATETIME)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(INT64, INT64, INT64)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE(DATE)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: DATE(STRING)
      Signature accepts at most 1 argument, found 2 arguments at [25:5]
  compiled code at target/run/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:22:57.516559 [info ] [MainThread]: 
[0m13:22:57.517223 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m13:22:57.518260 [info ] [MainThread]: 
[0m13:22:57.519151 [info ] [MainThread]: Done. PASS=52 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=53
[0m13:22:57.550274 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.082972, "process_in_blocks": "0", "process_kernel_time": 1.444384, "process_mem_max_rss": "385252", "process_out_blocks": "0", "process_user_time": 6.55172}
[0m13:22:57.553614 [debug] [MainThread]: Command `dbt test` failed at 13:22:57.553440 after 16.09 seconds
[0m13:22:57.558724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e5c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa48da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c08f530>]}
[0m13:22:57.560119 [debug] [MainThread]: Flushing usage events
[0m13:23:00.207097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:08.056216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c90650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa851d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c93560>]}


============================== 13:28:08.061660 | 9110e459-163d-48e1-ae30-da6798bbcf83 ==============================
[0m13:28:08.061660 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:28:08.063864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:10.047673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8e5e80>]}
[0m13:28:10.089147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77a6a50>]}
[0m13:28:10.090593 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:28:10.274669 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:28:10.366421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:10.367852 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://macros/tests/test_latest_datetime_by_city.sql
[0m13:28:10.861159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c889100>]}
[0m13:28:10.985376 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:28:10.988949 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:28:11.013287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c65c860>]}
[0m13:28:11.014344 [info ] [MainThread]: Found 4 models, 53 data tests, 2 sources, 498 macros
[0m13:28:11.015108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2c7ec0>]}
[0m13:28:11.017908 [info ] [MainThread]: 
[0m13:28:11.019479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:11.024848 [info ] [MainThread]: 
[0m13:28:11.028508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:11.038723 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m13:28:11.042434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:11.437902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9110e459-163d-48e1-ae30-da6798bbcf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cff8950>]}
[0m13:28:11.440702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:11.471023 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:28:11.472222 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:28:11.473081 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:28:11.473933 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:28:11.481235 [info ] [Thread-4 (]: 4 of 53 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m13:28:11.477012 [info ] [Thread-2 (]: 2 of 53 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m13:28:11.490131 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m13:28:11.492413 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:28:11.485852 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885'
[0m13:28:11.479398 [info ] [Thread-3 (]: 3 of 53 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m13:28:11.474457 [info ] [Thread-1 (]: 1 of 53 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m13:28:11.512754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m13:28:11.513942 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:28:11.511621 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m13:28:11.506734 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:28:11.525669 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:28:11.517942 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:28:11.518924 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:28:11.511116 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:28:11.536248 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:28:11.539409 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:28:11.538942 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:28:11.555555 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:28:11.567513 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:28:11.565817 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:28:11.565311 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:28:11.568560 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:28:11.586861 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:28:11.587629 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m13:28:11.592977 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m13:28:11.595450 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:11.596034 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m13:28:11.599903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:11.597787 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m13:28:11.597026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:11.645133 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:12.269341 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a08e6dff-949a-4653-a202-c57b10568581&page=queryresults
[0m13:28:12.271648 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15dd27b1-b04b-40d7-854d-cfcf6211884e&page=queryresults
[0m13:28:12.272733 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2b7b9df1-f230-4cb9-be8b-bc597e6c1887&page=queryresults
[0m13:28:12.273400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ba4cf1ca-69ec-4aeb-8c29-27413c647e5a&page=queryresults
[0m13:28:12.758330 [info ] [Thread-4 (]: 4 of 53 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.27s]
[0m13:28:12.762801 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:28:12.761448 [info ] [Thread-3 (]: 3 of 53 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.25s]
[0m13:28:12.764817 [info ] [Thread-1 (]: 1 of 53 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.25s]
[0m13:28:12.791195 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:28:12.771338 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:28:12.785501 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:28:12.794928 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:28:12.792151 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:28:12.797413 [info ] [Thread-1 (]: 6 of 53 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m13:28:12.799158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m13:28:12.796379 [info ] [Thread-3 (]: 7 of 53 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m13:28:12.802287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m13:28:12.765813 [info ] [Thread-2 (]: 2 of 53 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.28s]
[0m13:28:12.800429 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:28:12.793817 [info ] [Thread-4 (]: 5 of 53 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m13:28:12.803290 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:28:12.804761 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:28:12.814563 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:28:12.815074 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m13:28:12.819262 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:28:12.820501 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:28:12.825672 [info ] [Thread-2 (]: 8 of 53 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m13:28:12.828636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m13:28:12.829694 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:28:12.822579 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:28:12.830332 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:28:12.846229 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:28:12.835175 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:28:12.842749 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:28:12.827775 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:28:12.851162 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m13:28:12.856634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:12.853870 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:28:12.857165 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:28:12.908755 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:28:12.910577 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:28:12.913757 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m13:28:12.937354 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m13:28:12.938165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:12.940645 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:28:12.942722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:13.034956 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m13:28:13.037129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:13.436184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5562e5e2-ffc4-4210-af23-c1774bf74a6f&page=queryresults
[0m13:28:13.477199 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c750f32e-936d-4d3d-96be-4262d361dbb0&page=queryresults
[0m13:28:13.504599 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a57d591d-66be-4cdd-91af-a7eb25ab0035&page=queryresults
[0m13:28:13.511978 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:349cb9d3-3829-4447-8328-a0b08261e25d&page=queryresults
[0m13:28:13.775356 [info ] [Thread-3 (]: 7 of 53 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.97s]
[0m13:28:13.777072 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:28:13.778198 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:28:13.779512 [info ] [Thread-3 (]: 9 of 53 START test not_null_agg_pollution_by_day_avg_PM2_5 ..................... [RUN]
[0m13:28:13.780718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m13:28:13.781550 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:28:13.787471 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:28:13.791576 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:28:13.794024 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:28:13.796787 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:28:13.797613 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:13.836183 [info ] [Thread-1 (]: 6 of 53 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.04s]
[0m13:28:13.844305 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:28:13.841051 [info ] [Thread-2 (]: 8 of 53 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 1.01s]
[0m13:28:13.848696 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:28:13.845728 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:28:13.839639 [info ] [Thread-4 (]: 5 of 53 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.02s]
[0m13:28:13.857355 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:28:13.854450 [info ] [Thread-1 (]: 10 of 53 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m13:28:13.852517 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:28:13.858548 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:28:13.859811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m13:28:13.864691 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:28:13.863729 [info ] [Thread-4 (]: 12 of 53 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m13:28:13.861672 [info ] [Thread-2 (]: 11 of 53 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m13:28:13.873002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m13:28:13.871052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m13:28:13.875140 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:28:13.874190 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:28:13.868477 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:28:13.880389 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:28:13.884207 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:28:13.889572 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:28:13.890010 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:28:13.892261 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:28:13.893369 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:28:13.899311 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:28:13.895807 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:28:13.901316 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m13:28:13.903172 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:28:13.903905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:13.904769 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m13:28:13.905234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:13.906814 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:14.415108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fe1bec3c-413e-492f-bd8f-bea0fb1acbd0&page=queryresults
[0m13:28:14.416646 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b9e96e1f-fd18-4054-9643-dd04d2910b89&page=queryresults
[0m13:28:14.419923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:38bd696b-8157-4655-b2b0-a768277c9862&page=queryresults
[0m13:28:14.451410 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:326d686a-505d-488b-b8b9-e3484eb3e9a8&page=queryresults
[0m13:28:14.737881 [info ] [Thread-3 (]: 9 of 53 PASS not_null_agg_pollution_by_day_avg_PM2_5 ........................... [[32mPASS[0m in 0.96s]
[0m13:28:14.746190 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:28:14.747787 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:28:14.743432 [info ] [Thread-2 (]: 11 of 53 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.87s]
[0m13:28:14.751235 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:28:14.752445 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:28:14.754006 [info ] [Thread-2 (]: 14 of 53 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m13:28:14.755075 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m13:28:14.749726 [info ] [Thread-3 (]: 13 of 53 START test not_null_fact_air_pollution_city ........................... [RUN]
[0m13:28:14.757176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654)
[0m13:28:14.757934 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:28:14.755945 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:28:14.762241 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:28:14.766495 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:28:14.770236 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:28:14.770772 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:28:14.774297 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:28:14.776357 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:28:14.778871 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:28:14.779929 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:28:14.781326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:14.780380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:14.861820 [info ] [Thread-1 (]: 10 of 53 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 1.00s]
[0m13:28:14.863511 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:28:14.862585 [info ] [Thread-4 (]: 12 of 53 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.99s]
[0m13:28:14.867988 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:28:14.864805 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:28:14.870430 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:28:14.871904 [info ] [Thread-1 (]: 15 of 53 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m13:28:14.874417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m13:28:14.873203 [info ] [Thread-4 (]: 16 of 53 START test not_null_staging_cities_city ............................... [RUN]
[0m13:28:14.876268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m13:28:14.875315 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:28:14.881731 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:28:14.877023 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:28:14.886080 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:28:14.888025 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:28:14.891429 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:28:14.891763 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:28:14.894545 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:28:14.895647 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:28:14.896516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:14.897448 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:28:14.934044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:15.296610 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fe6fa7bb-9481-4f5b-8751-0e41ae657b38&page=queryresults
[0m13:28:15.349212 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3cd2f71e-09fa-40b4-9e32-909c29a60d3e&page=queryresults
[0m13:28:15.379764 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a506f215-7695-48f2-8e60-c360935aca27&page=queryresults
[0m13:28:15.486033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9d297152-5517-4969-8557-acdbcc48667e&page=queryresults
[0m13:28:15.645999 [info ] [Thread-3 (]: 13 of 53 PASS not_null_fact_air_pollution_city ................................. [[32mPASS[0m in 0.89s]
[0m13:28:15.647605 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:28:15.648636 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:28:15.649466 [info ] [Thread-3 (]: 17 of 53 START test not_null_staging_cities_id ................................. [RUN]
[0m13:28:15.650581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m13:28:15.652460 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:28:15.659586 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:28:15.663407 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:28:15.665800 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:28:15.668312 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:28:15.669395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:15.710127 [info ] [Thread-4 (]: 16 of 53 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 0.83s]
[0m13:28:15.711177 [info ] [Thread-2 (]: 14 of 53 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 0.96s]
[0m13:28:15.715568 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:28:15.714430 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:28:15.716675 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:28:15.717900 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:28:15.720692 [info ] [Thread-2 (]: 18 of 53 START test not_null_staging_cities_latitude ........................... [RUN]
[0m13:28:15.723004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m13:28:15.722000 [info ] [Thread-4 (]: 19 of 53 START test not_null_staging_cities_longitude .......................... [RUN]
[0m13:28:15.724891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m13:28:15.723956 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:28:15.726568 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:28:15.743039 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:28:15.736505 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:28:15.747404 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:28:15.748026 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:28:15.753262 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:28:15.756853 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:28:15.763644 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:28:15.768564 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:28:15.777089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:15.773285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:15.821339 [info ] [Thread-1 (]: 15 of 53 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.95s]
[0m13:28:15.823964 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:28:15.856497 [debug] [Thread-1 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:28:15.859485 [info ] [Thread-1 (]: 20 of 53 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m13:28:15.861383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m13:28:15.862342 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:28:15.869208 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:28:15.876407 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:28:15.885671 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:28:15.889175 [debug] [Thread-1 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:28:15.890019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:16.192482 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cfeb5dfe-f29e-4481-8c81-62abafa0bfcd&page=queryresults
[0m13:28:16.232437 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:41308422-d474-438d-a620-376d65ecb49b&page=queryresults
[0m13:28:16.237159 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d1cdf7f9-ff28-4686-b6d7-62e392c64db1&page=queryresults
[0m13:28:16.315228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cb33aefe-df10-4b58-a528-32cd690d15bb&page=queryresults
[0m13:28:16.501786 [info ] [Thread-3 (]: 17 of 53 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 0.85s]
[0m13:28:16.503114 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:28:16.504208 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:28:16.505081 [info ] [Thread-3 (]: 21 of 53 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m13:28:16.506069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m13:28:16.506740 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:28:16.510675 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:28:16.521597 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:28:16.524969 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:28:16.528946 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m13:28:16.529645 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:16.583939 [info ] [Thread-2 (]: 18 of 53 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 0.86s]
[0m13:28:16.585136 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:28:16.586065 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:28:16.587519 [info ] [Thread-2 (]: 22 of 53 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m13:28:16.588505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m13:28:16.589285 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:28:16.593131 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:28:16.596262 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:28:16.598427 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:28:16.600522 [info ] [Thread-4 (]: 19 of 53 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.88s]
[0m13:28:16.602894 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:28:16.604637 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:28:16.616167 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:28:16.608066 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:16.617309 [info ] [Thread-4 (]: 23 of 53 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m13:28:16.619235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m13:28:16.620602 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:28:16.624445 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:28:16.659199 [info ] [Thread-1 (]: 20 of 53 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 0.80s]
[0m13:28:16.665383 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:28:16.669268 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:28:16.672621 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:28:16.675377 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:28:16.671284 [info ] [Thread-1 (]: 24 of 53 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m13:28:16.677560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m13:28:16.678614 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:28:16.679144 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m13:28:16.694466 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:28:16.695418 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:16.739664 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:28:16.751343 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:28:16.875861 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m13:28:16.881219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:17.014152 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e41f7386-2017-4119-b60c-97b0f94fd0a0&page=queryresults
[0m13:28:17.198136 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3b1eb1e-47f5-4f38-a1bd-fd4d6d70a400&page=queryresults
[0m13:28:17.210490 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a62405a2-e979-4336-b932-2e410735b423&page=queryresults
[0m13:28:17.321872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e84b28ee-6db2-4f93-8d6b-25886e8192f2&page=queryresults
[0m13:28:17.402061 [info ] [Thread-3 (]: 21 of 53 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.89s]
[0m13:28:17.406140 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:28:17.419968 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:28:17.423519 [info ] [Thread-3 (]: 25 of 53 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m13:28:17.426584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m13:28:17.428424 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:28:17.439195 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:28:17.445965 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:28:17.452232 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:28:17.470567 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m13:28:17.472974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:17.630598 [info ] [Thread-4 (]: 23 of 53 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 1.01s]
[0m13:28:17.632031 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:28:17.632884 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:28:17.633932 [info ] [Thread-4 (]: 26 of 53 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m13:28:17.635621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m13:28:17.637621 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:28:17.642516 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:28:17.644078 [info ] [Thread-2 (]: 22 of 53 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 1.06s]
[0m13:28:17.645373 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:28:17.646516 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:28:17.647461 [info ] [Thread-2 (]: 27 of 53 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m13:28:17.648898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m13:28:17.649400 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:28:17.649773 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:28:17.655528 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:28:17.651916 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:28:17.659959 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:28:17.662442 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:28:17.662948 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m13:28:17.663797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:17.674440 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m13:28:17.708482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:17.747136 [info ] [Thread-1 (]: 24 of 53 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 1.07s]
[0m13:28:17.748320 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:28:17.749212 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:28:17.750344 [info ] [Thread-1 (]: 28 of 53 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m13:28:17.751446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m13:28:17.752173 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:28:17.758595 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:28:17.764305 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:28:17.768775 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:28:17.771958 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:28:17.773016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:17.878696 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc66ae38-b212-4bd1-be2b-800a8f752a6a&page=queryresults
[0m13:28:18.077271 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c293ba93-f94d-4262-a8c1-a19371e8e19c&page=queryresults
[0m13:28:18.125724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2bdf16e6-166b-4ad3-81a0-87bc051b4975&page=queryresults
[0m13:28:18.178493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8dff354b-65de-4ff6-969c-9d339dbcc845&page=queryresults
[0m13:28:18.191535 [info ] [Thread-3 (]: 25 of 53 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 0.77s]
[0m13:28:18.192570 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:28:18.193626 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:28:18.194538 [info ] [Thread-3 (]: 29 of 53 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m13:28:18.195453 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m13:28:18.196468 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:28:18.202919 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:28:18.206800 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:28:18.209658 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:28:18.211918 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m13:28:18.212654 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:18.432499 [info ] [Thread-2 (]: 27 of 53 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.78s]
[0m13:28:18.433685 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:28:18.434427 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:28:18.435106 [info ] [Thread-2 (]: 30 of 53 START test source_not_null_source_cities_city ......................... [RUN]
[0m13:28:18.436059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m13:28:18.436751 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:28:18.440390 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:28:18.443119 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:28:18.445554 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:28:18.446923 [info ] [Thread-4 (]: 26 of 53 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.81s]
[0m13:28:18.448630 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:28:18.449582 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:28:18.450626 [info ] [Thread-4 (]: 31 of 53 START test source_not_null_source_cities_city_index ................... [RUN]
[0m13:28:18.451493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m13:28:18.450133 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:28:18.452329 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:28:18.453033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:18.456666 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:28:18.494619 [info ] [Thread-1 (]: 28 of 53 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.74s]
[0m13:28:18.497327 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:28:18.499336 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:28:18.498823 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:28:18.499999 [info ] [Thread-1 (]: 32 of 53 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m13:28:18.502509 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:28:18.503317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m13:28:18.504555 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:28:18.508494 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:28:18.509536 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:28:18.510273 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:18.511647 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:28:18.514768 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:28:18.550778 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:28:18.552298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:18.607043 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5af54341-925c-4707-9ec4-f1c4432ba43a&page=queryresults
[0m13:28:18.914618 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3facf45b-f6c8-4a7b-b046-6751173c8e5f&page=queryresults
[0m13:28:18.920165 [info ] [Thread-3 (]: 29 of 53 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.72s]
[0m13:28:18.985546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0074adfd-7a92-41a0-b112-3be42640f6f5&page=queryresults
[0m13:28:18.987234 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:28:18.987773 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5f260df6-a6e1-4bbe-9391-022f3b0871f0&page=queryresults
[0m13:28:19.001120 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:28:19.004452 [info ] [Thread-3 (]: 33 of 53 START test source_not_null_source_cities_longitude .................... [RUN]
[0m13:28:19.005892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m13:28:19.006730 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:28:19.010705 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:28:19.014060 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:28:19.018172 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:28:19.020770 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:28:19.022150 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:19.282176 [info ] [Thread-2 (]: 30 of 53 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.85s]
[0m13:28:19.283668 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:28:19.284739 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:28:19.285743 [info ] [Thread-2 (]: 34 of 53 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m13:28:19.288097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m13:28:19.289143 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:28:19.293280 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:28:19.295805 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:28:19.298139 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:28:19.300435 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:19.301410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:19.337477 [info ] [Thread-4 (]: 31 of 53 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.89s]
[0m13:28:19.338263 [info ] [Thread-1 (]: 32 of 53 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.84s]
[0m13:28:19.339197 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:28:19.339993 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:28:19.340718 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:28:19.341446 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:28:19.342200 [info ] [Thread-4 (]: 35 of 53 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m13:28:19.342984 [info ] [Thread-1 (]: 36 of 53 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m13:28:19.343971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m13:28:19.345684 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:28:19.344909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m13:28:19.349788 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:28:19.351076 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:28:19.356193 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:28:19.357609 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:28:19.361691 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:28:19.363270 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:28:19.365825 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:28:19.367100 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:19.368755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:19.370063 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:19.371874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:19.409427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d7b29c6e-2c95-4e91-bcae-06b1951fcafa&page=queryresults
[0m13:28:19.751332 [info ] [Thread-3 (]: 33 of 53 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.75s]
[0m13:28:19.752620 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:28:19.753502 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:28:19.754221 [info ] [Thread-3 (]: 37 of 53 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m13:28:19.754987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m13:28:19.755734 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:28:19.759719 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:28:19.763598 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:28:19.766241 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:28:19.769252 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:19.770366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:19.864111 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eed61df4-333b-415d-9af3-3a0def09a997&page=queryresults
[0m13:28:19.904110 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9bfb2408-c796-4990-a024-9528639fdb9b&page=queryresults
[0m13:28:19.948245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3d0098d3-556f-4b6b-a3ce-e3e79ba34054&page=queryresults
[0m13:28:20.148631 [info ] [Thread-2 (]: 34 of 53 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 0.86s]
[0m13:28:20.150301 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:28:20.151303 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:28:20.152138 [info ] [Thread-2 (]: 38 of 53 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m13:28:20.153490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m13:28:20.154347 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:28:20.158809 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:28:20.164087 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:28:20.167934 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:28:20.179555 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:20.180556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:20.225976 [info ] [Thread-4 (]: 35 of 53 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 0.88s]
[0m13:28:20.227299 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:28:20.228979 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:28:20.229693 [info ] [Thread-4 (]: 39 of 53 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m13:28:20.230563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m13:28:20.231589 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:28:20.237609 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:28:20.244602 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:28:20.247433 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:28:20.250639 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:20.251487 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:20.306991 [info ] [Thread-1 (]: 36 of 53 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.96s]
[0m13:28:20.308218 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:28:20.309011 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:28:20.309759 [info ] [Thread-1 (]: 40 of 53 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m13:28:20.310767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m13:28:20.311509 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:28:20.314419 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:28:20.317745 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:28:20.321905 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:28:20.327079 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:20.328551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:20.378488 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:606004a5-1410-4adc-bee6-dce36732f2bd&page=queryresults
[0m13:28:20.690907 [info ] [Thread-3 (]: 37 of 53 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.94s]
[0m13:28:20.693321 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:28:20.694431 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:28:20.695389 [info ] [Thread-3 (]: 41 of 53 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m13:28:20.696319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m13:28:20.697108 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:28:20.700948 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:28:20.703766 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:28:20.706312 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:28:20.708859 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:20.709497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:20.795141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d25c29ca-0c9b-4f5e-9ed0-2e2c99fc467e&page=queryresults
[0m13:28:20.829598 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a89b62f2-e36c-4e9e-bf3f-d0b893fe695a&page=queryresults
[0m13:28:20.839321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f4155912-513c-4c33-8fb5-9a7babe06b8b&page=queryresults
[0m13:28:21.134585 [info ] [Thread-4 (]: 39 of 53 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.90s]
[0m13:28:21.136152 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:28:21.137108 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:28:21.137919 [info ] [Thread-4 (]: 42 of 53 START test source_unique_source_cities_city_index ..................... [RUN]
[0m13:28:21.138740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m13:28:21.139933 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:28:21.147825 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:28:21.151234 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:28:21.153522 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:28:21.156398 [info ] [Thread-1 (]: 40 of 53 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 0.85s]
[0m13:28:21.157105 [debug] [Thread-4 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:28:21.158141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:21.157525 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:28:21.159240 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:28:21.191692 [info ] [Thread-1 (]: 43 of 53 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m13:28:21.192877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m13:28:21.194125 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:28:21.200327 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:28:21.203613 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:28:21.205732 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:28:21.206966 [info ] [Thread-2 (]: 38 of 53 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 1.05s]
[0m13:28:21.208171 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:28:21.209235 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:21.209613 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:28:21.210387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:21.211174 [info ] [Thread-2 (]: 44 of 53 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m13:28:21.212490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m13:28:21.246580 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:28:21.251506 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:28:21.255808 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:28:21.257930 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:28:21.259925 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:21.260629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:21.316770 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:248dc366-ea63-4d65-a95d-98e726c03542&page=queryresults
[0m13:28:21.615755 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a8cd4d93-e577-4cdd-8858-5168dc0340ba&page=queryresults
[0m13:28:21.649670 [info ] [Thread-3 (]: 41 of 53 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.95s]
[0m13:28:21.652299 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:28:21.654974 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:28:21.656495 [info ] [Thread-3 (]: 45 of 53 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m13:28:21.658406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m13:28:21.659743 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:28:21.669110 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:28:21.674080 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:28:21.678080 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:28:21.682205 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:21.683650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:21.771264 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f2bf518a-e7dc-4ad9-ba97-8ed74ebdcd18&page=queryresults
[0m13:28:21.831636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0aed3082-b54c-4521-9463-a1c515de8a68&page=queryresults
[0m13:28:21.927759 [info ] [Thread-4 (]: 42 of 53 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.79s]
[0m13:28:21.930119 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:28:21.931050 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:28:21.932028 [info ] [Thread-4 (]: 46 of 53 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m13:28:21.932908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m13:28:21.933653 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:28:21.937737 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:28:21.941953 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:28:21.944465 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:28:21.948075 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:21.948969 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:22.073438 [info ] [Thread-2 (]: 44 of 53 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.86s]
[0m13:28:22.074991 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:28:22.075999 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:28:22.076877 [info ] [Thread-2 (]: 47 of 53 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m13:28:22.078111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m13:28:22.079014 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:28:22.084329 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:28:22.087927 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:28:22.091113 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:28:22.100917 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:22.103252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:22.155808 [info ] [Thread-1 (]: 43 of 53 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.96s]
[0m13:28:22.156923 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:28:22.158191 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:28:22.160153 [info ] [Thread-1 (]: 48 of 53 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m13:28:22.161276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m13:28:22.162045 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:28:22.166906 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:28:22.169704 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:28:22.171585 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:28:22.173952 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:22.174681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:22.208538 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e338179f-b6aa-4560-9bd3-942f72490925&page=queryresults
[0m13:28:22.445040 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:773cdfce-b70d-4fc2-8676-496094536286&page=queryresults
[0m13:28:22.529022 [info ] [Thread-3 (]: 45 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.87s]
[0m13:28:22.530963 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:28:22.532390 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:28:22.533971 [info ] [Thread-3 (]: 49 of 53 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m13:28:22.535539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m13:28:22.536753 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:28:22.542936 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:28:22.546583 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:28:22.549417 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:28:22.552877 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:22.554035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:22.627979 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b4993384-2569-4555-8bc6-9e247003606d&page=queryresults
[0m13:28:22.727701 [info ] [Thread-4 (]: 46 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.79s]
[0m13:28:22.728796 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:28:22.729560 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:28:22.730334 [info ] [Thread-4 (]: 50 of 53 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m13:28:22.731188 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m13:28:22.733720 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:28:22.737425 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:28:22.740757 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:28:22.742914 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:28:22.745647 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:28:22.746394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:28:22.747583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fd7e54d7-c10a-4360-bfef-687f9226a858&page=queryresults
[0m13:28:22.931400 [info ] [Thread-2 (]: 47 of 53 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.85s]
[0m13:28:22.932684 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:28:22.933633 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:28:22.934920 [info ] [Thread-2 (]: 51 of 53 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m13:28:22.935752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m13:28:22.936545 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:28:22.940629 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:28:22.944844 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:28:22.947236 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:28:22.950068 [debug] [Thread-2 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    


  
  
      
    ) dbt_internal_test
[0m13:28:22.950674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:23.038581 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:95774ce9-0fd5-4e62-aef6-12fdd8f2241e&page=queryresults
[0m13:28:23.045064 [info ] [Thread-1 (]: 48 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.88s]
[0m13:28:23.046141 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:28:23.046879 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:28:23.047537 [info ] [Thread-1 (]: 52 of 53 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m13:28:23.048279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m13:28:23.048936 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:28:23.052257 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:28:23.054556 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:28:23.056455 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:28:23.060809 [debug] [Thread-1 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    


  
  
      
    ) dbt_internal_test
[0m13:28:23.061604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:23.322426 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2a819418-9ab0-477c-a45e-ff1e8e7a546b&page=queryresults
[0m13:28:23.392623 [info ] [Thread-3 (]: 49 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.86s]
[0m13:28:23.394747 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:28:23.396796 [debug] [Thread-3 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:28:23.398442 [info ] [Thread-3 (]: 53 of 53 START test unique_staging_cities_id ................................... [RUN]
[0m13:28:23.401444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m13:28:23.402856 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:28:23.410770 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:28:23.415346 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:28:23.418197 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:28:23.422031 [debug] [Thread-3 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:28:23.422982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:23.509979 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1a780f41-f883-40ea-8b73-9f1c36f5fd4c&page=queryresults
[0m13:28:23.625028 [info ] [Thread-4 (]: 50 of 53 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.89s]
[0m13:28:23.626122 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:28:23.697164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7c06bc63-8210-45dc-9965-380151ab4759&page=queryresults
[0m13:28:23.764483 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:36c4fb69-ea58-4091-9c03-3bca2a56111c&page=queryresults
[0m13:28:23.793546 [info ] [Thread-2 (]: 51 of 53 PASS test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[32mPASS[0m in 0.86s]
[0m13:28:23.794631 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:28:23.965599 [info ] [Thread-1 (]: 52 of 53 PASS test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[32mPASS[0m in 0.92s]
[0m13:28:23.967214 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:28:24.053432 [info ] [Thread-3 (]: 53 of 53 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.65s]
[0m13:28:24.054878 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:28:24.062926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:24.066704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:24.067527 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m13:28:24.068429 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m13:28:24.069250 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' was properly closed.
[0m13:28:24.070056 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m13:28:24.071220 [info ] [MainThread]: 
[0m13:28:24.072467 [info ] [MainThread]: Finished running 53 data tests in 0 hours 0 minutes and 13.04 seconds (13.04s).
[0m13:28:24.077979 [debug] [MainThread]: Command end result
[0m13:28:24.183239 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:28:24.200484 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:28:24.215717 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:28:24.216460 [info ] [MainThread]: 
[0m13:28:24.217347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:24.218004 [info ] [MainThread]: 
[0m13:28:24.218852 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=53
[0m13:28:24.223255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.212543, "process_in_blocks": "0", "process_kernel_time": 1.246619, "process_mem_max_rss": "384724", "process_out_blocks": "0", "process_user_time": 6.564981}
[0m13:28:24.224621 [debug] [MainThread]: Command `dbt test` succeeded at 13:28:24.224475 after 16.21 seconds
[0m13:28:24.225794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7591d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6e9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8b5580>]}
[0m13:28:24.226854 [debug] [MainThread]: Flushing usage events
[0m13:28:24.685633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:50.625795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c55790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82223a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ae0fb0>]}


============================== 13:39:50.630556 | e281b7a3-4648-4db1-b0ce-2bfad5d0800f ==============================
[0m13:39:50.630556 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:39:50.631613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:52.600501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e281b7a3-4648-4db1-b0ce-2bfad5d0800f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68301cd0>]}
[0m13:39:52.638113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e281b7a3-4648-4db1-b0ce-2bfad5d0800f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff683583b0>]}
[0m13:39:52.639437 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:39:52.793571 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:39:52.868735 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading france_air_pollution: schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: staging_cities
    5  |     description: A staging table containing French metropolitan cities with their geographical 
    6  |     coordinates and unique identifiers.
    7  |     columns:
    8  |       - name: id
    9  |         tests:
    10 |           - unique
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 6, column 5
    could not find expected ':'
      in "<unicode string>", line 7, column 5
[0m13:39:52.870258 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.279997, "process_in_blocks": "0", "process_kernel_time": 0.904236, "process_mem_max_rss": "365732", "process_out_blocks": "0", "process_user_time": 2.618854}
[0m13:39:52.871430 [debug] [MainThread]: Command `dbt test` failed at 13:39:52.871283 after 2.28 seconds
[0m13:39:52.872174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c96d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c7b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67e0c9e0>]}
[0m13:39:52.872978 [debug] [MainThread]: Flushing usage events
[0m13:39:53.348407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:34.026778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5cde6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36c3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59323f0>]}


============================== 13:41:34.032529 | e19c4d96-7f47-485c-b2a2-2b70b1f48466 ==============================
[0m13:41:34.032529 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:41:34.033601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:36.152112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c7bb90>]}
[0m13:41:36.186766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c513d0>]}
[0m13:41:36.187861 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:41:36.330065 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:41:36.424149 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m13:41:36.425619 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/schema.yml
[0m13:41:36.426242 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/tests/test_is_last_datetime_inserted.sql
[0m13:41:36.426785 [debug] [MainThread]: Partial parsing: deleted file: france_air_pollution://macros/tests/tes_is_last_date_inserted.sql
[0m13:41:36.784747 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:41:36.843061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b7d280>]}
[0m13:41:36.968667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:41:36.972012 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:41:37.001975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c01a90>]}
[0m13:41:37.002917 [info ] [MainThread]: Found 54 data tests, 4 models, 2 sources, 496 macros
[0m13:41:37.003789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a9a690>]}
[0m13:41:37.006681 [info ] [MainThread]: 
[0m13:41:37.007447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:37.008114 [info ] [MainThread]: 
[0m13:41:37.008965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:41:37.012436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m13:41:37.013527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:37.451598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19c4d96-7f47-485c-b2a2-2b70b1f48466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99781820>]}
[0m13:41:37.454232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:37.465879 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:41:37.466426 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m13:41:37.468868 [debug] [Thread-3 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:41:37.469289 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:41:37.469795 [info ] [Thread-1 (]: 1 of 54 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m13:41:37.471254 [info ] [Thread-2 (]: 2 of 54 START test accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m13:41:37.473016 [info ] [Thread-3 (]: 3 of 54 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m13:41:37.474080 [info ] [Thread-4 (]: 4 of 54 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m13:41:37.475225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m13:41:37.476525 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3'
[0m13:41:37.478069 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m13:41:37.484142 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:41:37.480340 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:41:37.481385 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m13:41:37.479315 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m13:41:37.492046 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:41:37.494887 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:41:37.498053 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m13:41:37.498875 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:41:37.501866 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:41:37.507258 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:41:37.520084 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m13:41:37.520421 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:41:37.520682 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m13:41:37.526217 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m13:41:37.523991 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m13:41:37.526667 [debug] [Thread-3 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m13:41:37.527127 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:41:37.529201 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:41:37.532739 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m13:41:37.534475 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m13:41:37.535269 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m13:41:37.536758 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:41:37.570020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:37.571065 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m13:41:37.606242 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:41:38.065894 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e6ff7979-b2df-4f1b-b993-e0e801d563c5&page=queryresults
[0m13:41:38.166184 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b2141658-4c58-4148-a3bf-c4ac026bfcd4&page=queryresults
[0m13:41:38.194865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b97c8434-048e-4d40-896f-fc737b699a95&page=queryresults
[0m13:41:38.320826 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2f5c7bf5-3693-449f-9ad0-6e0e3745896b&page=queryresults
[0m13:41:38.516676 [info ] [Thread-3 (]: 3 of 54 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.04s]
[0m13:41:38.518003 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m13:41:38.518940 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:41:38.519906 [info ] [Thread-3 (]: 5 of 54 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m13:41:38.520983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885)
[0m13:41:38.522005 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:41:38.528654 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:41:38.533489 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:41:38.536040 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m13:41:38.538805 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m13:41:38.539627 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:38.608759 [info ] [Thread-4 (]: 4 of 54 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.13s]
[0m13:41:38.611451 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m13:41:38.609379 [info ] [Thread-1 (]: 1 of 54 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.13s]
[0m13:41:38.613717 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:41:38.615155 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m13:41:38.617842 [info ] [Thread-4 (]: 6 of 54 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m13:41:38.619539 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:41:38.622527 [info ] [Thread-1 (]: 7 of 54 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m13:41:38.621359 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m13:41:38.623471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m13:41:38.624669 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:41:38.625487 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:41:38.629483 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:41:38.633179 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:41:38.637019 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:41:38.639531 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m13:41:38.639948 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:41:38.642314 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m13:41:38.644245 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m13:41:38.645187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:38.645566 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m13:41:38.647160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:38.726140 [info ] [Thread-2 (]: 2 of 54 PASS accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.25s]
[0m13:41:38.729455 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m13:41:38.731229 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:41:38.733995 [info ] [Thread-2 (]: 8 of 54 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m13:41:38.735160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m13:41:38.736028 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:41:38.739612 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:41:38.742756 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:41:38.745375 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m13:41:38.748699 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m13:41:38.749445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:39.081013 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4a69bdd1-0e20-4c71-8499-c03403fa6db5&page=queryresults
[0m13:41:39.171120 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9986e892-d931-40b5-a838-fcc0a62d0b19&page=queryresults
[0m13:41:39.182562 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:336e945d-9a77-476f-bc4e-63b1591ada7c&page=queryresults
[0m13:41:39.244847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4145bdc5-99af-4a56-89a2-b3f6f18ef45f&page=queryresults
[0m13:41:39.439772 [info ] [Thread-3 (]: 5 of 54 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 0.92s]
[0m13:41:39.441509 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m13:41:39.442756 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:41:39.444176 [info ] [Thread-3 (]: 9 of 54 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m13:41:39.445290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m13:41:39.446063 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:41:39.452505 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:41:39.456333 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:41:39.458964 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m13:41:39.462187 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m13:41:39.463109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:39.542643 [info ] [Thread-2 (]: 8 of 54 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.81s]
[0m13:41:39.543991 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m13:41:39.544869 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:41:39.545766 [info ] [Thread-2 (]: 10 of 54 START test not_null_agg_pollution_by_day_avg_PM2_5 .................... [RUN]
[0m13:41:39.547172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m13:41:39.547920 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:41:39.551987 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:41:39.556318 [info ] [Thread-4 (]: 6 of 54 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 0.93s]
[0m13:41:39.556682 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:41:39.557460 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m13:41:39.559675 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m13:41:39.560533 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:41:39.561853 [info ] [Thread-4 (]: 11 of 54 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m13:41:39.563912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m13:41:39.565092 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:41:39.566172 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:41:39.570082 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:41:39.571704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:39.612004 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:41:39.619730 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m13:41:39.624318 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m13:41:39.625183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:39.662663 [info ] [Thread-1 (]: 7 of 54 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.04s]
[0m13:41:39.664080 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m13:41:39.664979 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:41:39.665910 [info ] [Thread-1 (]: 12 of 54 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m13:41:39.666696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m13:41:39.667526 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:41:39.670710 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:41:39.673357 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:41:39.677198 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m13:41:39.679942 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:41:39.680758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.972231 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ff3f168b-3ac8-4e15-baf3-20e6584a71c6&page=queryresults
[0m13:41:40.032661 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3f472b75-52c4-475f-9bc5-5faf0ebac6c4&page=queryresults
[0m13:41:40.044708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e456e102-50cf-4886-8bb3-520b14afbcf2&page=queryresults
[0m13:41:40.284002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:56ca02ec-c75d-449e-8b6d-855a1a5c28b0&page=queryresults
[0m13:41:40.326608 [info ] [Thread-3 (]: 9 of 54 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.88s]
[0m13:41:40.327841 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m13:41:40.329407 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:41:40.330471 [info ] [Thread-3 (]: 13 of 54 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m13:41:40.331645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m13:41:40.332627 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:41:40.335946 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:41:40.339092 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:41:40.341097 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m13:41:40.343984 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m13:41:40.344704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:40.380412 [info ] [Thread-4 (]: 11 of 54 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.82s]
[0m13:41:40.382165 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m13:41:40.384638 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:41:40.386268 [info ] [Thread-4 (]: 14 of 54 START test not_null_fact_air_pollution_city ........................... [RUN]
[0m13:41:40.387822 [info ] [Thread-2 (]: 10 of 54 PASS not_null_agg_pollution_by_day_avg_PM2_5 .......................... [[32mPASS[0m in 0.84s]
[0m13:41:40.389637 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654)
[0m13:41:40.392316 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m13:41:40.395975 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:41:40.394113 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:41:40.398410 [info ] [Thread-2 (]: 15 of 54 START test not_null_fact_air_pollution_city_id ........................ [RUN]
[0m13:41:40.404361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78)
[0m13:41:40.405671 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:41:40.410429 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:41:40.402783 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:41:40.419829 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:41:40.425970 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"
[0m13:41:40.427319 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:41:40.430615 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"
[0m13:41:40.433019 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:41:40.434472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:40.481551 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:41:40.483843 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:40.620763 [info ] [Thread-1 (]: 12 of 54 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.95s]
[0m13:41:40.622798 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m13:41:40.623893 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:41:40.625081 [info ] [Thread-1 (]: 16 of 54 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m13:41:40.626531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m13:41:40.628308 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:41:40.635852 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:41:40.656526 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:41:40.660075 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m13:41:40.668154 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m13:41:40.670890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:40.894995 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b24baa98-8d6b-45b9-bfe8-37e5556b6532&page=queryresults
[0m13:41:40.922355 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6279cc35-0628-4b05-b2e4-519065dde7c6&page=queryresults
[0m13:41:40.967574 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8377ef7c-0533-404c-b6b0-cdf35978a30b&page=queryresults
[0m13:41:41.150277 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2025688b-3f99-4d37-aa5f-2487f5bcb653&page=queryresults
[0m13:41:41.199879 [info ] [Thread-4 (]: 14 of 54 PASS not_null_fact_air_pollution_city ................................. [[32mPASS[0m in 0.81s]
[0m13:41:41.201408 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654
[0m13:41:41.202415 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:41:41.203181 [info ] [Thread-4 (]: 17 of 54 START test not_null_staging_cities_city ............................... [RUN]
[0m13:41:41.204093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city.6ffaa84654, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m13:41:41.204887 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:41:41.210950 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:41:41.213977 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:41:41.216338 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m13:41:41.219118 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:41:41.219946 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:41.272172 [info ] [Thread-3 (]: 13 of 54 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.94s]
[0m13:41:41.291348 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m13:41:41.297196 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:41:41.298631 [info ] [Thread-3 (]: 18 of 54 START test not_null_staging_cities_id ................................. [RUN]
[0m13:41:41.299940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_cities_id.c4626abdf2)
[0m13:41:41.300880 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:41:41.305147 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:41:41.315563 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:41:41.319331 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"
[0m13:41:41.325658 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_id.c4626abdf2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_id.c4626abdf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:41:41.326635 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:41.454421 [info ] [Thread-2 (]: 15 of 54 PASS not_null_fact_air_pollution_city_id .............................. [[32mPASS[0m in 1.05s]
[0m13:41:41.457382 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78
[0m13:41:41.458630 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:41:41.459622 [info ] [Thread-2 (]: 19 of 54 START test not_null_staging_cities_latitude ........................... [RUN]
[0m13:41:41.461382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_city_id.e1f231da78, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m13:41:41.464337 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:41:41.471623 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:41:41.480848 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:41:41.483917 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m13:41:41.504121 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:41:41.506273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:41.562326 [info ] [Thread-1 (]: 16 of 54 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.94s]
[0m13:41:41.564201 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m13:41:41.565533 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:41:41.566626 [info ] [Thread-1 (]: 20 of 54 START test not_null_staging_cities_longitude .......................... [RUN]
[0m13:41:41.567952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m13:41:41.570029 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:41:41.575668 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:41:41.579639 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:41:41.582289 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m13:41:41.585608 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:41:41.586425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:41.840421 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:77d0122d-4bda-4b06-870a-900d1ce2cf90&page=queryresults
[0m13:41:41.910152 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:36f07c49-10c9-465b-bbb6-6db3e61437b4&page=queryresults
[0m13:41:42.007497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4e2c515e-2ee9-44ff-8c55-33e4eac573a9&page=queryresults
[0m13:41:42.040503 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8b008fea-3b02-4cae-aa8c-668638ba79fd&page=queryresults
[0m13:41:42.267056 [info ] [Thread-4 (]: 17 of 54 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 1.06s]
[0m13:41:42.269868 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m13:41:42.270810 [debug] [Thread-4 (]: Began running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:41:42.271574 [info ] [Thread-4 (]: 21 of 54 START test relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [RUN]
[0m13:41:42.272323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6)
[0m13:41:42.273044 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:41:42.278730 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:41:42.282485 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:41:42.285472 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"
[0m13:41:42.289114 [debug] [Thread-4 (]: On test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    where city_id is not null
),

parent as (
    select id as to_field
    from `paris-air-pollution-quangnc`.`development`.`staging_cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:41:42.290063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:42.333729 [info ] [Thread-3 (]: 18 of 54 PASS not_null_staging_cities_id ....................................... [[32mPASS[0m in 1.03s]
[0m13:41:42.335628 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_id.c4626abdf2
[0m13:41:42.336817 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:41:42.337696 [info ] [Thread-3 (]: 22 of 54 START test source_not_null_source_airpollution_carbon_monoxide_co ..... [RUN]
[0m13:41:42.338585 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_id.c4626abdf2, now test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a)
[0m13:41:42.339353 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:41:42.345779 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:41:42.350435 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:41:42.353198 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"
[0m13:41:42.356523 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m13:41:42.357212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:42.395909 [info ] [Thread-1 (]: 20 of 54 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 0.83s]
[0m13:41:42.397717 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m13:41:42.399079 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:41:42.400462 [info ] [Thread-1 (]: 23 of 54 START test source_not_null_source_airpollution_city_index ............. [RUN]
[0m13:41:42.401788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6)
[0m13:41:42.402874 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:41:42.406747 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:41:42.410069 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:41:42.414595 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"
[0m13:41:42.418554 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:41:42.420479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:42.457686 [info ] [Thread-2 (]: 19 of 54 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 1.00s]
[0m13:41:42.460078 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m13:41:42.460936 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:41:42.461741 [info ] [Thread-2 (]: 24 of 54 START test source_not_null_source_airpollution_nh3 .................... [RUN]
[0m13:41:42.462758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb)
[0m13:41:42.463509 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:41:42.467411 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:41:42.470304 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:41:42.472907 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"
[0m13:41:42.475498 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m13:41:42.476181 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:42.790044 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9baf86a1-2a90-4f56-91c8-44c3ab953d76&page=queryresults
[0m13:41:42.801562 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3c0d9fd3-630f-47ab-ad8a-585ed2693d68&page=queryresults
[0m13:41:42.859198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3e00d977-fb04-424f-b1c2-b89711125f09&page=queryresults
[0m13:41:42.871534 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0450c8e1-aa6e-41d3-815d-5fedb19acf38&page=queryresults
[0m13:41:43.091316 [info ] [Thread-4 (]: 21 of 54 PASS relationships_fact_air_pollution_city_id__id__ref_staging_cities_  [[32mPASS[0m in 0.82s]
[0m13:41:43.092977 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6
[0m13:41:43.093988 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:41:43.094868 [info ] [Thread-4 (]: 25 of 54 START test source_not_null_source_airpollution_nitric_oxide_no ........ [RUN]
[0m13:41:43.095965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_fact_air_pollution_city_id__id__ref_staging_cities_.454667dcf6, now test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20)
[0m13:41:43.097183 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:41:43.104610 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:41:43.107436 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:41:43.110946 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"
[0m13:41:43.114292 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.115131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:43.152801 [info ] [Thread-3 (]: 22 of 54 PASS source_not_null_source_airpollution_carbon_monoxide_co ........... [[32mPASS[0m in 0.81s]
[0m13:41:43.154695 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a
[0m13:41:43.155822 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:41:43.156633 [info ] [Thread-3 (]: 26 of 54 START test source_not_null_source_airpollution_nitrogen_dioxide_no2 ... [RUN]
[0m13:41:43.157488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_carbon_monoxide_co.428c97b99a, now test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d)
[0m13:41:43.158294 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:41:43.161847 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:41:43.164654 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:41:43.167008 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"
[0m13:41:43.169846 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.170648 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:43.205707 [info ] [Thread-1 (]: 23 of 54 PASS source_not_null_source_airpollution_city_index ................... [[32mPASS[0m in 0.80s]
[0m13:41:43.208613 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6
[0m13:41:43.208204 [info ] [Thread-2 (]: 24 of 54 PASS source_not_null_source_airpollution_nh3 .......................... [[32mPASS[0m in 0.75s]
[0m13:41:43.211596 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb
[0m13:41:43.212227 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:41:43.212793 [info ] [Thread-2 (]: 28 of 54 START test source_not_null_source_airpollution_pm10 ................... [RUN]
[0m13:41:43.210299 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:41:43.214198 [info ] [Thread-1 (]: 27 of 54 START test source_not_null_source_airpollution_ozone_o3 ............... [RUN]
[0m13:41:43.214914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_city_index.d60497bae6, now test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441)
[0m13:41:43.213515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nh3.132ca773eb, now test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538)
[0m13:41:43.216229 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:41:43.215427 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:41:43.221291 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:41:43.225153 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:41:43.228492 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:41:43.230825 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"
[0m13:41:43.229278 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:41:43.233400 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"
[0m13:41:43.234514 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.235406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:43.235994 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.237379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:43.589773 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74d8fb19-daa2-490f-bf06-0ee4760e2f9c&page=queryresults
[0m13:41:43.646725 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3fae9c9f-3a63-4ade-b7e3-1fa16d197465&page=queryresults
[0m13:41:43.669623 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:113ae0dc-0010-4e1c-8c71-532f28390574&page=queryresults
[0m13:41:43.733733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f432744b-83df-4b6f-a25f-23aa132b5f65&page=queryresults
[0m13:41:43.906781 [info ] [Thread-3 (]: 26 of 54 PASS source_not_null_source_airpollution_nitrogen_dioxide_no2 ......... [[32mPASS[0m in 0.75s]
[0m13:41:43.907990 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d
[0m13:41:43.908734 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:41:43.909393 [info ] [Thread-3 (]: 29 of 54 START test source_not_null_source_airpollution_pm2_5 .................. [RUN]
[0m13:41:43.910288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitrogen_dioxide_no2.f12e22741d, now test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d)
[0m13:41:43.911029 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:41:43.914962 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:41:43.917419 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:41:43.920144 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"
[0m13:41:43.923211 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.924306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:43.959330 [info ] [Thread-4 (]: 25 of 54 PASS source_not_null_source_airpollution_nitric_oxide_no .............. [[32mPASS[0m in 0.86s]
[0m13:41:43.960757 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20
[0m13:41:43.961665 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:41:43.962697 [info ] [Thread-4 (]: 30 of 54 START test source_not_null_source_airpollution_sulfur_dioxide_so2 ..... [RUN]
[0m13:41:43.963526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_nitric_oxide_no.7b925f5e20, now test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13)
[0m13:41:43.964290 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:41:43.967559 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:41:43.970504 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:41:43.973472 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"
[0m13:41:43.977349 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m13:41:43.978263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:44.013702 [info ] [Thread-2 (]: 28 of 54 PASS source_not_null_source_airpollution_pm10 ......................... [[32mPASS[0m in 0.80s]
[0m13:41:44.015961 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538
[0m13:41:44.017108 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:41:44.018047 [info ] [Thread-2 (]: 31 of 54 START test source_not_null_source_cities_city ......................... [RUN]
[0m13:41:44.018934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm10.4a545b8538, now test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a)
[0m13:41:44.019680 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:41:44.022931 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:41:44.026112 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:41:44.028351 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"
[0m13:41:44.031138 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m13:41:44.031900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:44.133673 [info ] [Thread-1 (]: 27 of 54 PASS source_not_null_source_airpollution_ozone_o3 ..................... [[32mPASS[0m in 0.92s]
[0m13:41:44.134838 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441
[0m13:41:44.135627 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:41:44.136359 [info ] [Thread-1 (]: 32 of 54 START test source_not_null_source_cities_city_index ................... [RUN]
[0m13:41:44.137206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_ozone_o3.3f61785441, now test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103)
[0m13:41:44.137840 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:41:44.142515 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:41:44.145354 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:41:44.147899 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"
[0m13:41:44.150095 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m13:41:44.150852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:44.359714 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a97d73f2-6779-4e15-a244-0aeb5d675b0f&page=queryresults
[0m13:41:44.389626 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:848c33fd-2514-4c01-b88b-fe7c508b77b3&page=queryresults
[0m13:41:44.461550 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:960df56d-daee-4466-8783-5e03cf933934&page=queryresults
[0m13:41:44.547263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:79ba5b3c-b32f-4317-aeaa-18dddd9817dc&page=queryresults
[0m13:41:44.702183 [info ] [Thread-3 (]: 29 of 54 PASS source_not_null_source_airpollution_pm2_5 ........................ [[32mPASS[0m in 0.79s]
[0m13:41:44.704151 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d
[0m13:41:44.705220 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:41:44.706076 [info ] [Thread-3 (]: 33 of 54 START test source_not_null_source_cities_latitude ..................... [RUN]
[0m13:41:44.707097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_pm2_5.11a7441d3d, now test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5)
[0m13:41:44.707776 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:41:44.711286 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:41:44.714858 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:41:44.716243 [info ] [Thread-4 (]: 30 of 54 PASS source_not_null_source_airpollution_sulfur_dioxide_so2 ........... [[32mPASS[0m in 0.75s]
[0m13:41:44.718050 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"
[0m13:41:44.719036 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13
[0m13:41:44.720544 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:41:44.721595 [info ] [Thread-4 (]: 34 of 54 START test source_not_null_source_cities_longitude .................... [RUN]
[0m13:41:44.722551 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m13:41:44.722936 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_airpollution_sulfur_dioxide_so2.d02b3f7c13, now test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee)
[0m13:41:44.724433 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:44.725871 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:41:44.729852 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:41:44.768117 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:41:44.771247 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"
[0m13:41:44.776939 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m13:41:44.778031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:44.852880 [info ] [Thread-1 (]: 32 of 54 PASS source_not_null_source_cities_city_index ......................... [[32mPASS[0m in 0.72s]
[0m13:41:44.854158 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103
[0m13:41:44.855351 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:41:44.856224 [info ] [Thread-1 (]: 35 of 54 START test source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [RUN]
[0m13:41:44.857110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city_index.5ca09fb103, now test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e)
[0m13:41:44.857828 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:41:44.861155 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:41:44.863898 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:41:44.867146 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"
[0m13:41:44.871183 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:44.872536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:44.908526 [info ] [Thread-2 (]: 31 of 54 PASS source_not_null_source_cities_city ............................... [[32mPASS[0m in 0.89s]
[0m13:41:44.910270 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a
[0m13:41:44.913635 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:41:44.920026 [info ] [Thread-2 (]: 36 of 54 START test source_test_is_float_source_airpollution_nh3__float64 ...... [RUN]
[0m13:41:44.921472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_city.c6d7f02e4a, now test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075)
[0m13:41:44.922331 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:41:44.927541 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:41:44.934466 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:41:44.944850 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"
[0m13:41:44.950579 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:44.951794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:45.158631 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c1b90d8b-743a-45eb-a1d0-96c66ae077de&page=queryresults
[0m13:41:45.243883 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:72c716b0-bb6b-4ca4-840a-cf9d3544b326&page=queryresults
[0m13:41:45.454421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:90ab3f2a-1457-4d9c-8aca-25f4849f47f6&page=queryresults
[0m13:41:45.459910 [info ] [Thread-3 (]: 33 of 54 PASS source_not_null_source_cities_latitude ........................... [[32mPASS[0m in 0.75s]
[0m13:41:45.461062 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5
[0m13:41:45.461749 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:41:45.462434 [info ] [Thread-3 (]: 37 of 54 START test source_test_is_float_source_airpollution_nitric_oxide_no__float64  [RUN]
[0m13:41:45.463708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_latitude.cd5d336dd5, now test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9)
[0m13:41:45.464479 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:41:45.468025 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:41:45.471729 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:41:45.474041 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"
[0m13:41:45.478225 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:45.479200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:45.574344 [info ] [Thread-4 (]: 34 of 54 PASS source_not_null_source_cities_longitude .......................... [[32mPASS[0m in 0.85s]
[0m13:41:45.575172 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee
[0m13:41:45.575735 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:41:45.576577 [info ] [Thread-4 (]: 38 of 54 START test source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m13:41:45.638731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_source_cities_longitude.1aa3addaee, now test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7)
[0m13:41:45.649454 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:41:45.681315 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:41:45.700212 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:41:45.706199 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"
[0m13:41:45.719868 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:45.723244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:45.770993 [info ] [Thread-1 (]: 35 of 54 PASS source_test_is_float_source_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 0.91s]
[0m13:41:45.772241 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e
[0m13:41:45.773007 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:41:45.773859 [info ] [Thread-1 (]: 39 of 54 START test source_test_is_float_source_airpollution_ozone_o3__float64 . [RUN]
[0m13:41:45.775089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_carbon_monoxide_co__float64.b543a1149e, now test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e)
[0m13:41:45.775806 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:41:45.780738 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:41:45.783493 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:41:45.785677 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"
[0m13:41:45.788081 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:45.788907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:45.874918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3d2f771a-d834-413b-9a81-dbf6861730fb&page=queryresults
[0m13:41:46.057866 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:40d40a5b-10b7-48c0-8f13-c10845ad1110&page=queryresults
[0m13:41:46.187105 [info ] [Thread-2 (]: 36 of 54 PASS source_test_is_float_source_airpollution_nh3__float64 ............ [[32mPASS[0m in 1.27s]
[0m13:41:46.188547 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075
[0m13:41:46.189404 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:41:46.191444 [info ] [Thread-2 (]: 40 of 54 START test source_test_is_float_source_airpollution_pm10__float64 ..... [RUN]
[0m13:41:46.192563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nh3__float64.9ea9d1f075, now test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea)
[0m13:41:46.193432 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:41:46.200391 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:41:46.216520 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:41:46.221096 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"
[0m13:41:46.224406 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:46.225648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:46.266424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:27463011-73f4-4e8b-90b6-d08fdb075a4b&page=queryresults
[0m13:41:46.272886 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:98829784-63b1-416f-b395-f6428da91400&page=queryresults
[0m13:41:46.366425 [info ] [Thread-3 (]: 37 of 54 PASS source_test_is_float_source_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 0.90s]
[0m13:41:46.368461 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9
[0m13:41:46.372953 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:41:46.375856 [info ] [Thread-3 (]: 41 of 54 START test source_test_is_float_source_airpollution_pm2_5__float64 .... [RUN]
[0m13:41:46.379354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitric_oxide_no__float64.04bb3462c9, now test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0)
[0m13:41:46.381281 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:41:46.395997 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:41:46.400100 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:41:46.402882 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"
[0m13:41:46.405561 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:46.406678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:46.586719 [info ] [Thread-1 (]: 39 of 54 PASS source_test_is_float_source_airpollution_ozone_o3__float64 ....... [[32mPASS[0m in 0.81s]
[0m13:41:46.587934 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e
[0m13:41:46.591518 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:41:46.595962 [info ] [Thread-1 (]: 42 of 54 START test source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m13:41:46.596772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_ozone_o3__float64.34a8a9610e, now test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7)
[0m13:41:46.597699 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:41:46.602526 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:41:46.605503 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:41:46.607972 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"
[0m13:41:46.609730 [info ] [Thread-4 (]: 38 of 54 PASS source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.97s]
[0m13:41:46.610913 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7
[0m13:41:46.611659 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:46.612318 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:41:46.613194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:46.614076 [info ] [Thread-4 (]: 43 of 54 START test source_unique_source_cities_city_index ..................... [RUN]
[0m13:41:46.616855 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_nitrogen_dioxide_no2__float64.18bf1d4ae7, now test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd)
[0m13:41:46.650588 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:41:46.659103 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:41:46.662249 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:41:46.664738 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"
[0m13:41:46.667371 [debug] [Thread-4 (]: On test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:41:46.668122 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:46.760450 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7f0325dd-1208-45bf-981b-e96de5e95d45&page=queryresults
[0m13:41:46.985600 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:29642cd7-8851-4763-badd-d84b4067b33b&page=queryresults
[0m13:41:47.071260 [info ] [Thread-2 (]: 40 of 54 PASS source_test_is_float_source_airpollution_pm10__float64 ........... [[32mPASS[0m in 0.88s]
[0m13:41:47.072941 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea
[0m13:41:47.073868 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:41:47.074844 [info ] [Thread-2 (]: 44 of 54 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m13:41:47.075929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm10__float64.c85f82c0ea, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m13:41:47.076716 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:41:47.081865 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:41:47.085157 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:41:47.088233 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m13:41:47.091085 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:47.092299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:47.128723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ba051bfa-69ff-40ec-983f-47d354ae3818&page=queryresults
[0m13:41:47.148378 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dfcf11f6-9ed7-4df0-8ec2-d137dd0de217&page=queryresults
[0m13:41:47.318001 [info ] [Thread-4 (]: 43 of 54 PASS source_unique_source_cities_city_index ........................... [[32mPASS[0m in 0.70s]
[0m13:41:47.319275 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd
[0m13:41:47.320038 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:41:47.320922 [info ] [Thread-4 (]: 45 of 54 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m13:41:47.321892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_source_cities_city_index.cc55573afd, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m13:41:47.322850 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:41:47.326348 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:41:47.387577 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:41:47.390682 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m13:41:47.393360 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:47.394239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:47.461729 [info ] [Thread-1 (]: 42 of 54 PASS source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 0.86s]
[0m13:41:47.463283 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7
[0m13:41:47.464119 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:41:47.465314 [info ] [Thread-1 (]: 46 of 54 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m13:41:47.466650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_sulfur_dioxide_so2__float64.33442db0a7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m13:41:47.469869 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:41:47.475330 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:41:47.477733 [info ] [Thread-3 (]: 41 of 54 PASS source_test_is_float_source_airpollution_pm2_5__float64 .......... [[32mPASS[0m in 1.10s]
[0m13:41:47.479747 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0
[0m13:41:47.480814 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:41:47.481632 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:41:47.486423 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m13:41:47.487677 [info ] [Thread-3 (]: 47 of 54 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m13:41:47.489625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_source_airpollution_pm2_5__float64.8c1a1584b0, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m13:41:47.490706 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:41:47.495602 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:41:47.491477 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:47.497936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:47.538227 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:41:47.542021 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m13:41:47.549734 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:47.552586 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:47.613095 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ae51f22a-27ff-4827-8235-503bcbeeaef1&page=queryresults
[0m13:41:47.890455 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:78711689-0d3c-4b49-aeb1-c79b348517bd&page=queryresults
[0m13:41:47.905529 [info ] [Thread-2 (]: 44 of 54 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.83s]
[0m13:41:47.907136 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m13:41:47.908140 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:41:47.909042 [info ] [Thread-2 (]: 48 of 54 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m13:41:47.909990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m13:41:47.910772 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:41:47.915436 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:41:47.918628 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:41:47.921005 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m13:41:47.924055 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:47.925057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:48.036772 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f95b2492-e21f-4acb-a606-ca02c096a158&page=queryresults
[0m13:41:48.048888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d321e99-99e0-4448-92b3-a0b7f0934f83&page=queryresults
[0m13:41:48.222554 [info ] [Thread-4 (]: 45 of 54 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.90s]
[0m13:41:48.223671 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m13:41:48.224459 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:41:48.225201 [info ] [Thread-4 (]: 49 of 54 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m13:41:48.226052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m13:41:48.226984 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:41:48.230674 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:41:48.233278 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:41:48.236449 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m13:41:48.239273 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:48.240008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:48.391310 [info ] [Thread-1 (]: 46 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.92s]
[0m13:41:48.392723 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m13:41:48.393758 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:41:48.395217 [info ] [Thread-1 (]: 50 of 54 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m13:41:48.396848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m13:41:48.397911 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:41:48.404465 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:41:48.398709 [info ] [Thread-3 (]: 47 of 54 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.91s]
[0m13:41:48.410974 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m13:41:48.411995 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:41:48.409374 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:41:48.412973 [info ] [Thread-3 (]: 51 of 54 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m13:41:48.415596 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m13:41:48.417292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m13:41:48.419022 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:41:48.422559 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:41:48.423028 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:48.424313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:48.425509 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:41:48.430144 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m13:41:48.466297 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m13:41:48.468464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:41:48.541194 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c1e9f443-c7ef-4d31-84f1-5ca37fe1ab4e&page=queryresults
[0m13:41:48.777561 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:88295398-768c-44a5-8cf6-d9666df5e98a&page=queryresults
[0m13:41:48.864532 [info ] [Thread-2 (]: 48 of 54 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.95s]
[0m13:41:48.865534 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m13:41:48.866226 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:41:48.867209 [info ] [Thread-2 (]: 52 of 54 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m13:41:48.868272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m13:41:48.869201 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:41:48.874376 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:41:48.876884 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:41:48.879071 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m13:41:48.881739 [debug] [Thread-2 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    


  
  
      
    ) dbt_internal_test
[0m13:41:48.882829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:41:48.968316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:34b9572c-4a4c-4e0c-98da-e12c99f07a00&page=queryresults
[0m13:41:48.991760 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3f11f5ea-2c90-4894-ab97-f7bddc7fe56d&page=queryresults
[0m13:41:49.161903 [info ] [Thread-4 (]: 49 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.94s]
[0m13:41:49.163359 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m13:41:49.164688 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:41:49.165528 [info ] [Thread-4 (]: 53 of 54 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m13:41:49.166445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m13:41:49.167282 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:41:49.173874 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:41:49.178153 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:41:49.180476 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m13:41:49.183087 [debug] [Thread-4 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    


  
  
      
    ) dbt_internal_test
[0m13:41:49.183953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:41:49.268680 [info ] [Thread-1 (]: 50 of 54 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.87s]
[0m13:41:49.269857 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m13:41:49.270775 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:41:49.271638 [info ] [Thread-1 (]: 54 of 54 START test unique_staging_cities_id ................................... [RUN]
[0m13:41:49.272361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.unique_staging_cities_id.87f93cf477)
[0m13:41:49.272971 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:41:49.276276 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:41:49.278731 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:41:49.281559 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_id.87f93cf477"
[0m13:41:49.284920 [debug] [Thread-1 (]: On test.france_air_pollution.unique_staging_cities_id.87f93cf477: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_id.87f93cf477"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:41:49.286250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:49.322103 [info ] [Thread-3 (]: 51 of 54 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.90s]
[0m13:41:49.324206 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m13:41:49.419736 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c43adca4-cbf4-497b-90b4-58668fa112c8&page=queryresults
[0m13:41:49.687663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64e3ccdc-fdbd-4b81-b174-67513922bb49&page=queryresults
[0m13:41:49.739939 [info ] [Thread-2 (]: 52 of 54 PASS test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[32mPASS[0m in 0.87s]
[0m13:41:49.740990 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m13:41:49.880708 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0bc5e8aa-01d0-4446-a990-479e2cb0c818&page=queryresults
[0m13:41:50.136843 [info ] [Thread-1 (]: 54 of 54 PASS unique_staging_cities_id ......................................... [[32mPASS[0m in 0.86s]
[0m13:41:50.138503 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_staging_cities_id.87f93cf477
[0m13:41:50.188568 [info ] [Thread-4 (]: 53 of 54 PASS test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[32mPASS[0m in 1.02s]
[0m13:41:50.190000 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m13:41:50.194883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:50.198452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:50.199494 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_id.87f93cf477' was properly closed.
[0m13:41:50.200275 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' was properly closed.
[0m13:41:50.200945 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m13:41:50.201570 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m13:41:50.202460 [info ] [MainThread]: 
[0m13:41:50.203393 [info ] [MainThread]: Finished running 54 data tests in 0 hours 0 minutes and 13.19 seconds (13.19s).
[0m13:41:50.213630 [debug] [MainThread]: Command end result
[0m13:41:50.321179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:41:50.327822 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:41:50.343880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:41:50.344603 [info ] [MainThread]: 
[0m13:41:50.345504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:50.346314 [info ] [MainThread]: 
[0m13:41:50.347102 [info ] [MainThread]: Done. PASS=54 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=54
[0m13:41:50.351875 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.36909, "process_in_blocks": "0", "process_kernel_time": 1.425086, "process_mem_max_rss": "384940", "process_out_blocks": "0", "process_user_time": 6.429386}
[0m13:41:50.353406 [debug] [MainThread]: Command `dbt test` succeeded at 13:41:50.353292 after 16.37 seconds
[0m13:41:50.354820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dffb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9897b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9897ae40>]}
[0m13:41:50.355887 [debug] [MainThread]: Flushing usage events
[0m13:41:50.855842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:13:44.875131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991a6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991a7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991a53a0>]}


============================== 08:13:44.880000 | bb65c6b4-50b6-4be7-a149-67ce2fdf00f6 ==============================
[0m08:13:44.880000 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:13:44.880941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:13:46.832101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98253530>]}
[0m08:13:46.865805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ffbad0>]}
[0m08:13:46.866910 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:13:47.024507 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:13:47.088744 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:13:47.089964 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m08:13:47.090686 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:13:47.091558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebe2540>]}
[0m08:13:47.827061 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_cities_snapshot' in the 'snapshots' section of file 'snapshots/staging_cities_snapshot.yml'
[0m08:13:47.871016 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m08:13:47.949969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb214c0>]}
[0m08:13:48.084727 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:13:48.088966 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:13:48.111315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de14ce0>]}
[0m08:13:48.112368 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m08:13:48.113334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eba29f0>]}
[0m08:13:48.115840 [info ] [MainThread]: 
[0m08:13:48.116565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:48.117301 [info ] [MainThread]: 
[0m08:13:48.118492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:13:48.122096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:13:48.122948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:48.616766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:13:48.619672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:48.947261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef5a990>]}
[0m08:13:48.949841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:48.961667 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:13:48.962305 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:13:48.963613 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:13:48.965534 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m08:13:48.968594 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:13:48.967240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:13:48.969789 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:13:48.970891 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:13:48.987854 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:13:48.988503 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:13:48.992641 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:13:48.993130 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:13:49.031788 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:13:49.042786 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:13:49.044037 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m08:13:49.045138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:13:49.045587 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m08:13:49.078062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:49.696861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e6b17183-ff32-4318-8f91-cc60cb25526a&page=queryresults
[0m08:13:49.789977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7eb19f41-d640-4dd5-9489-1be4eea3f462&page=queryresults
[0m08:13:51.258866 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb57a10>]}
[0m08:13:51.261295 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.29s]
[0m08:13:51.262955 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:13:58.084760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd038c0>]}
[0m08:13:58.090857 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 9.12s]
[0m08:13:58.094830 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:13:58.105336 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:13:58.108561 [info ] [Thread-4 (]: 3 of 4 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m08:13:58.111172 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m08:13:58.113350 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:13:58.130717 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:13:58.137388 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:13:58.142285 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:13:58.145549 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
WHERE 1=1

ON 
    p.city_id = c.id
ORDER BY 
    city, dt
    );
  
[0m08:13:58.146848 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:13:58.450609 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a1de937-711b-4f0d-9197-47b35e41355f&page=queryresults
[0m08:13:58.453173 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a1de937-711b-4f0d-9197-47b35e41355f&page=queryresults
[0m08:13:58.468983 [debug] [Thread-4 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Expected ")" but got keyword ON at [53:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m08:13:58.470762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb65c6b4-50b6-4be7-a149-67ce2fdf00f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df406b0>]}
[0m08:13:58.472872 [error] [Thread-4 (]: 3 of 4 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.36s]
[0m08:13:58.474687 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:13:58.476627 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Expected ")" but got keyword ON at [53:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql.
[0m08:13:58.481140 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:13:58.483325 [info ] [Thread-2 (]: 4 of 4 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m08:13:58.486079 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:13:58.489614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:13:58.492891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:58.493626 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:13:58.494325 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m08:13:58.494944 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:13:58.495898 [info ] [MainThread]: 
[0m08:13:58.496821 [info ] [MainThread]: Finished running 3 incremental models, 1 table model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m08:13:58.498037 [debug] [MainThread]: Command end result
[0m08:13:58.588265 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:13:58.593743 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:13:58.600948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:13:58.601819 [info ] [MainThread]: 
[0m08:13:58.602525 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:13:58.603171 [info ] [MainThread]: 
[0m08:13:58.603939 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m08:13:58.604580 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Expected ")" but got keyword ON at [53:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m08:13:58.605100 [info ] [MainThread]: 
[0m08:13:58.605879 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m08:13:58.606519 [info ] [MainThread]: 
[0m08:13:58.607165 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=4
[0m08:13:58.610961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.775343, "process_in_blocks": "0", "process_kernel_time": 1.125562, "process_mem_max_rss": "382816", "process_out_blocks": "0", "process_user_time": 4.024089}
[0m08:13:58.612495 [debug] [MainThread]: Command `dbt run` failed at 08:13:58.612334 after 13.78 seconds
[0m08:13:58.613805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee5ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df93770>]}
[0m08:13:58.614510 [debug] [MainThread]: Flushing usage events
[0m08:13:59.179884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:15:39.924739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1c66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9dea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2c3050>]}


============================== 08:15:39.931157 | 225bc779-be68-4b0d-b16c-46a05c4eb94d ==============================
[0m08:15:39.931157 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:15:39.932270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:15:41.852937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62ea5c40>]}
[0m08:15:41.884587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6528d0>]}
[0m08:15:41.885721 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:15:42.045872 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:15:42.132033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:15:42.133396 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m08:15:42.571166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff625e9040>]}
[0m08:15:42.687551 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:15:42.693189 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:15:42.713565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62513b90>]}
[0m08:15:42.714391 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m08:15:42.715042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff627a1160>]}
[0m08:15:42.717119 [info ] [MainThread]: 
[0m08:15:42.717815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:15:42.718564 [info ] [MainThread]: 
[0m08:15:42.719442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:15:42.723275 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:15:42.724116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:43.119903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:15:43.122637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:43.466626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62457140>]}
[0m08:15:43.469405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:15:43.480660 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:15:43.481633 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:15:43.482819 [info ] [Thread-1 (]: 1 of 4 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:15:43.484650 [info ] [Thread-2 (]: 2 of 4 START sql table model development.staging_cities ........................ [RUN]
[0m08:15:43.486740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:15:43.488511 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:15:43.490988 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:15:43.492500 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:15:43.505163 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:15:43.507753 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:15:43.512567 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:15:43.513210 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:15:43.544899 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:15:43.565443 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m08:15:43.596505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:43.905418 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:15:43.908626 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by City_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY City_index
)
SELECT 
    City_index AS id,
    City AS city,
    Latitude as latitude,
    Longitude AS longitude
FROM 
    cities
    );
  
[0m08:15:44.477172 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fd7402ec-62cc-4fab-bd56-4aa28f8f18d8&page=queryresults
[0m08:15:44.622678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0bcddedc-2bea-44d7-8ff0-d3eaf11f322d&page=queryresults
[0m08:15:46.088478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677e1700>]}
[0m08:15:46.090464 [info ] [Thread-2 (]: 2 of 4 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 2.60s]
[0m08:15:46.092385 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:15:48.967079 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:15:48.989294 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:15:48.993434 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m08:15:49.902580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ec7935e5-86b9-449b-8b94-2add07024b28&page=queryresults
[0m08:15:51.471003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600e1ee0>]}
[0m08:15:51.472968 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 7.98s]
[0m08:15:51.474618 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:15:51.477987 [debug] [Thread-4 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:15:51.479012 [info ] [Thread-4 (]: 3 of 4 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m08:15:51.480518 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.fact_air_pollution'
[0m08:15:51.481485 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:15:51.490237 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:15:51.494271 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:15:51.498155 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:15:51.504264 [debug] [Thread-4 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities as (
    SELECT  
        id,
        city,
        latitude,
        longitude 
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_cities`
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
INNER JOIN 
    cities AS c
ON 
    p.city_id = c.id
WHERE 1=1

ORDER BY 
    city, dt
    );
  
[0m08:15:51.505954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:15:52.256538 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:72fbe8b2-f0bf-4730-bc85-feffe047ff98&page=queryresults
[0m08:16:00.986764 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600c3aa0>]}
[0m08:16:00.993019 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 9.50s]
[0m08:16:00.996108 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:16:01.001492 [debug] [Thread-2 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:16:01.002890 [info ] [Thread-2 (]: 4 of 4 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m08:16:01.004615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:16:01.006885 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:16:01.031261 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:16:01.038097 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:16:01.045054 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:16:01.048865 [debug] [Thread-2 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m08:16:01.049804 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:16:01.678059 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9e6e521b-8c09-4056-9d96-6ca10ca1d8d8&page=queryresults
[0m08:16:07.900528 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225bc779-be68-4b0d-b16c-46a05c4eb94d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5277a180>]}
[0m08:16:07.906820 [info ] [Thread-2 (]: 4 of 4 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.6k rows, 335.5 MiB processed)[0m in 6.89s]
[0m08:16:07.911120 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:16:07.924599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:16:07.932694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:07.934293 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:16:07.936624 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:16:07.938108 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:16:07.940383 [info ] [MainThread]: 
[0m08:16:07.941771 [info ] [MainThread]: Finished running 3 incremental models, 1 table model in 0 hours 0 minutes and 25.22 seconds (25.22s).
[0m08:16:07.944552 [debug] [MainThread]: Command end result
[0m08:16:08.057342 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:16:08.063819 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:16:08.073789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:16:08.074522 [info ] [MainThread]: 
[0m08:16:08.075336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:16:08.076208 [info ] [MainThread]: 
[0m08:16:08.077095 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m08:16:08.081906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.199211, "process_in_blocks": "0", "process_kernel_time": 1.135799, "process_mem_max_rss": "379012", "process_out_blocks": "0", "process_user_time": 3.81149}
[0m08:16:08.083624 [debug] [MainThread]: Command `dbt run` succeeded at 08:16:08.083482 after 28.20 seconds
[0m08:16:08.085046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c255ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff625cc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6021a0c0>]}
[0m08:16:08.085893 [debug] [MainThread]: Flushing usage events
[0m08:16:08.539088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:19.709907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd78b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd79130>]}


============================== 08:17:19.716044 | 2f3c4e13-c658-4053-b040-47c8aa62ead2 ==============================
[0m08:17:19.716044 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:17:19.717041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:17:21.969953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64317620>]}
[0m08:17:22.001889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64389dc0>]}
[0m08:17:22.003019 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:17:22.150062 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:17:22.210003 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:17:22.210939 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m08:17:22.211789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dda1460>]}
[0m08:17:22.779622 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_cities_snapshot' in the 'snapshots' section of file 'snapshots/staging_cities_snapshot.yml'
[0m08:17:23.002565 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m08:17:23.074747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f0c140>]}
[0m08:17:23.203332 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:17:23.207062 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:17:23.223331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63186ab0>]}
[0m08:17:23.224131 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m08:17:23.225146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3c4e13-c658-4053-b040-47c8aa62ead2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63dd4920>]}
[0m08:17:23.228780 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:17:23.230129 [debug] [MainThread]: Command end result
[0m08:17:23.314160 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:17:23.317752 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:17:23.321784 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:17:23.323041 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 3.651298, "process_in_blocks": "0", "process_kernel_time": 1.379609, "process_mem_max_rss": "374108", "process_out_blocks": "0", "process_user_time": 3.664391}
[0m08:17:23.323707 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:17:23.323637 after 3.65 seconds
[0m08:17:23.324303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dca4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6317c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6317cd40>]}
[0m08:17:23.324852 [debug] [MainThread]: Flushing usage events
[0m08:17:23.902742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:20:36.244984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad309bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf26f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6304a0>]}


============================== 08:20:36.256833 | 663a034d-fa90-48a9-9cca-20b6160a8e9b ==============================
[0m08:20:36.256833 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:20:36.265376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:20:38.284595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663a034d-fa90-48a9-9cca-20b6160a8e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91828bc0>]}
[0m08:20:38.320127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663a034d-fa90-48a9-9cca-20b6160a8e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad208b90>]}
[0m08:20:38.321743 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:20:38.464070 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:20:38.552835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:38.553603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:38.578742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663a034d-fa90-48a9-9cca-20b6160a8e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91609bb0>]}
[0m08:20:38.795379 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:20:38.799104 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:20:38.816409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663a034d-fa90-48a9-9cca-20b6160a8e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912ed160>]}
[0m08:20:38.817265 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m08:20:38.818283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663a034d-fa90-48a9-9cca-20b6160a8e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916f5d00>]}
[0m08:20:38.820262 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:20:38.822177 [debug] [MainThread]: Command end result
[0m08:20:38.915148 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:20:38.918135 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:20:38.922012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:20:38.923366 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.7286437, "process_in_blocks": "0", "process_kernel_time": 1.144882, "process_mem_max_rss": "367028", "process_out_blocks": "0", "process_user_time": 2.912686}
[0m08:20:38.924243 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:20:38.924176 after 2.73 seconds
[0m08:20:38.924853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabd46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917cac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8433e0>]}
[0m08:20:38.925447 [debug] [MainThread]: Flushing usage events
[0m08:20:39.442823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:15.828387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6e6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981f7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98baaf00>]}


============================== 08:21:15.837645 | f5924f4b-3d98-4d76-bae6-dbfafdee8cfe ==============================
[0m08:21:15.837645 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:21:15.838856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:21:17.871353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5924f4b-3d98-4d76-bae6-dbfafdee8cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edbb1a0>]}
[0m08:21:17.903159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5924f4b-3d98-4d76-bae6-dbfafdee8cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea61550>]}
[0m08:21:17.904365 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:21:18.149592 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:21:18.244765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:21:18.246086 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/staging_cities_snapshot.yml
[0m08:21:18.377188 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_cities_snapshot' in the 'snapshots' section of file 'snapshots/staging_cities_snapshot.yml'
[0m08:21:18.442325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5924f4b-3d98-4d76-bae6-dbfafdee8cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3c7140>]}
[0m08:21:18.558165 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:21:18.561937 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:21:18.580081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5924f4b-3d98-4d76-bae6-dbfafdee8cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d1f890>]}
[0m08:21:18.580930 [info ] [MainThread]: Found 4 models, 54 data tests, 2 sources, 496 macros
[0m08:21:18.581626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5924f4b-3d98-4d76-bae6-dbfafdee8cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec2f800>]}
[0m08:21:18.583412 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:21:18.584183 [debug] [MainThread]: Command end result
[0m08:21:18.663802 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:21:18.667360 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:21:18.671178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:21:18.672601 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.8866782, "process_in_blocks": "0", "process_kernel_time": 1.318019, "process_mem_max_rss": "367660", "process_out_blocks": "0", "process_user_time": 2.945266}
[0m08:21:18.673435 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:21:18.673337 after 2.89 seconds
[0m08:21:18.674043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c0f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e61b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e45b2f0>]}
[0m08:21:18.674661 [debug] [MainThread]: Flushing usage events
[0m08:21:19.128763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:30.802747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879ce630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8524ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86acbc20>]}


============================== 08:27:30.807384 | 2a86b2e7-c8d6-4504-a4f2-54cafd20b42e ==============================
[0m08:27:30.807384 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:27:30.808602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:27:32.682577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a86b2e7-c8d6-4504-a4f2-54cafd20b42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc91850>]}
[0m08:27:32.718990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a86b2e7-c8d6-4504-a4f2-54cafd20b42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ac9d00>]}
[0m08:27:32.720397 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:27:32.880855 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:27:32.969886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:27:32.971360 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:27:33.202849 [error] [MainThread]: Encountered an error:
A 'timestamp' snapshot should not have 'check_cols'
[0m08:27:33.205084 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 67, in final_validate
    raise ValidationError("A 'timestamp' snapshot should not have 'check_cols'")
dbt_common.dataclass_schema.ValidationError: A 'timestamp' snapshot should not have 'check_cols'

[0m08:27:33.208475 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.4483376, "process_in_blocks": "0", "process_kernel_time": 0.693529, "process_mem_max_rss": "366884", "process_out_blocks": "0", "process_user_time": 2.832413}
[0m08:27:33.210995 [debug] [MainThread]: Command `dbt snapshot` failed at 08:27:33.210838 after 2.45 seconds
[0m08:27:33.212746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b71af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897bebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb5d4c0>]}
[0m08:27:33.216568 [debug] [MainThread]: Flushing usage events
[0m08:27:33.674125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:18.672469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc33fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc30ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc32b40>]}


============================== 08:29:18.677152 | 35e2ff26-a368-41b5-94d0-b0a323ea11b0 ==============================
[0m08:29:18.677152 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:29:18.678891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:29:20.880990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6420dcd0>]}
[0m08:29:20.915632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4ac530>]}
[0m08:29:20.917543 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:29:21.119293 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:29:21.250780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:21.252016 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:29:21.752686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63bb19d0>]}
[0m08:29:21.890314 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:29:21.900233 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:29:21.929626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63d769f0>]}
[0m08:29:21.931558 [info ] [MainThread]: Found 4 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m08:29:21.932569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d489a60>]}
[0m08:29:21.935109 [info ] [MainThread]: 
[0m08:29:21.935955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:21.936778 [info ] [MainThread]: 
[0m08:29:21.938269 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:29:21.939865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:29:21.940712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:22.338078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now create_paris-air-pollution-quangnc_snapshots)
[0m08:29:22.339926 [debug] [ThreadPool]: Creating schema "database: "paris-air-pollution-quangnc"
schema: "snapshots"
"
[0m08:29:22.348885 [debug] [ThreadPool]: On create_paris-air-pollution-quangnc_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "connection_name": "create_paris-air-pollution-quangnc_snapshots"} */
create schema if not exists `paris-air-pollution-quangnc`.`snapshots`
  
[0m08:29:22.349917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:23.146523 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8c256188-d480-4150-ae7e-7ccb35b33da2&page=queryresults
[0m08:29:25.143967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_paris-air-pollution-quangnc_snapshots, now list_paris-air-pollution-quangnc_snapshots)
[0m08:29:25.145525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m08:29:25.150655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:25.147212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:25.516874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2fbe60>]}
[0m08:29:25.518423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:29:25.524246 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:29:25.525172 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.staging_cities_snapshot ........................ [RUN]
[0m08:29:25.526335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.staging_cities_snapshot)
[0m08:29:25.527416 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:29:25.534806 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:29:25.688930 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(updated_at as string), '')))) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:29:25.695155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:26.120513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f1ef21fb-092b-4bed-9068-b17ac6cf4a41&page=queryresults
[0m08:29:26.121750 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f1ef21fb-092b-4bed-9068-b17ac6cf4a41&page=queryresults
[0m08:29:26.128791 [debug] [Thread-1 (]: Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79]
[0m08:29:26.131213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2ff26-a368-41b5-94d0-b0a323ea11b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62fa8b60>]}
[0m08:29:26.132626 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.staging_cities_snapshot .................... [[31mERROR[0m in 0.60s]
[0m08:29:26.133552 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:29:26.134616 [debug] [Thread-7 (]: Marking all children of 'snapshot.france_air_pollution.staging_cities_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79].
[0m08:29:26.138587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:29:26.141523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:26.142242 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_snapshots' was properly closed.
[0m08:29:26.143054 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.staging_cities_snapshot' was properly closed.
[0m08:29:26.144051 [info ] [MainThread]: 
[0m08:29:26.145071 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m08:29:26.146407 [debug] [MainThread]: Command end result
[0m08:29:26.258048 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:29:26.273739 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:29:26.281520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:29:26.282336 [info ] [MainThread]: 
[0m08:29:26.283411 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:29:26.284451 [info ] [MainThread]: 
[0m08:29:26.285385 [error] [MainThread]: [31mFailure in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)[0m
[0m08:29:26.286431 [error] [MainThread]:   Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79]
[0m08:29:26.287272 [info ] [MainThread]: 
[0m08:29:26.288056 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:29:26.291229 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 7.656433, "process_in_blocks": "0", "process_kernel_time": 1.057814, "process_mem_max_rss": "375992", "process_out_blocks": "0", "process_user_time": 3.658102}
[0m08:29:26.292779 [debug] [MainThread]: Command `dbt snapshot` failed at 08:29:26.292669 after 7.66 seconds
[0m08:29:26.293808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6dedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644bda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3825d0>]}
[0m08:29:26.294558 [debug] [MainThread]: Flushing usage events
[0m08:29:26.764436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:23.172855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830556a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83054980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83055760>]}


============================== 08:30:23.177769 | 99b0f960-82c6-40e3-a414-6f0cda7e1316 ==============================
[0m08:30:23.177769 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:30:23.178939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:30:25.123129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99b0f960-82c6-40e3-a414-6f0cda7e1316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff695eb050>]}
[0m08:30:25.156159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99b0f960-82c6-40e3-a414-6f0cda7e1316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6963bdd0>]}
[0m08:30:25.157759 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:30:25.306339 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:30:25.401135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:25.402128 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:30:25.624720 [error] [MainThread]: Encountered an error:
A snapshot configured with the timestamp strategy must specify an updated_at configuration.
[0m08:30:25.626510 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 62, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: A snapshot configured with the timestamp strategy must specify an updated_at configuration.

[0m08:30:25.628172 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.4910562, "process_in_blocks": "0", "process_kernel_time": 0.874341, "process_mem_max_rss": "366296", "process_out_blocks": "0", "process_user_time": 2.82731}
[0m08:30:25.630030 [debug] [MainThread]: Command `dbt snapshot` failed at 08:30:25.629922 after 2.49 seconds
[0m08:30:25.631138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83298380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6963ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6963afc0>]}
[0m08:30:25.631776 [debug] [MainThread]: Flushing usage events
[0m08:30:26.055677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:20.171394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb22b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbca7e870>]}


============================== 08:36:20.177047 | aafda471-b4fa-48c7-b6b8-a44de4a4de66 ==============================
[0m08:36:20.177047 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:36:20.178148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:36:22.241167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafda471-b4fa-48c7-b6b8-a44de4a4de66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc72f350>]}
[0m08:36:22.278119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aafda471-b4fa-48c7-b6b8-a44de4a4de66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3b7770>]}
[0m08:36:22.279405 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:36:22.422780 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:36:22.518931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:22.520014 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:36:22.713640 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  expected token ',', got 'check_cols'
    line 7
      check_cols=['city', 'region'],
[0m08:36:22.715431 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.5846753, "process_in_blocks": "0", "process_kernel_time": 1.084741, "process_mem_max_rss": "366252", "process_out_blocks": "0", "process_user_time": 2.8047}
[0m08:36:22.716352 [debug] [MainThread]: Command `dbt snapshot` failed at 08:36:22.716254 after 2.59 seconds
[0m08:36:22.717215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbacc7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b4aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07efe00>]}
[0m08:36:22.717945 [debug] [MainThread]: Flushing usage events
[0m08:36:23.112459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:46.116957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f765280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8039d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8039d8b0>]}


============================== 08:36:46.121240 | 3456ee57-7f50-4c22-bcbc-5321d991dfb7 ==============================
[0m08:36:46.121240 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:36:46.122323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:36:47.881288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3456ee57-7f50-4c22-bcbc-5321d991dfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c4b620>]}
[0m08:36:47.915424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3456ee57-7f50-4c22-bcbc-5321d991dfb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c8620>]}
[0m08:36:47.916660 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:36:48.068573 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:36:48.154413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:48.155680 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:36:48.355232 [error] [MainThread]: Encountered an error:
Snapshots must be configured with a 'strategy' and 'unique_key'.
[0m08:36:48.357116 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 479, in load
    self.check_valid_snapshot_config()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1418, in check_valid_snapshot_config
    node.config.final_validate()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/artifacts/resources/v1/snapshot.py", line 46, in final_validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Snapshots must be configured with a 'strategy' and 'unique_key'.

[0m08:36:48.358653 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.2873394, "process_in_blocks": "0", "process_kernel_time": 0.648828, "process_mem_max_rss": "366304", "process_out_blocks": "0", "process_user_time": 2.817769}
[0m08:36:48.359480 [debug] [MainThread]: Command `dbt snapshot` failed at 08:36:48.359413 after 2.29 seconds
[0m08:36:48.360283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6f46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6606bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8039d1f0>]}
[0m08:36:48.361131 [debug] [MainThread]: Flushing usage events
[0m08:36:48.760643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:53.525350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edb83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e79aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9c5910>]}


============================== 08:37:53.530533 | 2b0f256e-e774-4eb8-9e40-b5acc3570802 ==============================
[0m08:37:53.530533 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:37:53.531726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:37:55.634947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6500b0e0>]}
[0m08:37:55.671733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64fab7d0>]}
[0m08:37:55.673201 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:37:55.832718 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:37:55.942825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:55.944267 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m08:37:56.258132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64913e90>]}
[0m08:37:56.434280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:37:56.442900 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:37:56.466533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64983080>]}
[0m08:37:56.467492 [info ] [MainThread]: Found 4 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m08:37:56.468587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650fa840>]}
[0m08:37:56.471371 [info ] [MainThread]: 
[0m08:37:56.473307 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:56.474968 [info ] [MainThread]: 
[0m08:37:56.476654 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:37:56.479042 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:37:56.479990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:56.936485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:37:56.937511 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_snapshots'
[0m08:37:56.938091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:56.938845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:57.333608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64989fa0>]}
[0m08:37:57.335104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:57.341734 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:37:57.343196 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.staging_cities_snapshot ........................ [RUN]
[0m08:37:57.344343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.staging_cities_snapshot)
[0m08:37:57.345147 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:37:57.352971 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:37:57.411165 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:37:57.412421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:58.123028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:683e6056-8877-47dc-8b3c-23657726590c&page=queryresults
[0m08:37:58.321767 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:37:58.631096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c688d8fc-997c-4f05-af36-d82eba28d6e0&page=queryresults
[0m08:37:58.939766 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.staging_cities_snapshot"
[0m08:37:58.947183 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.staging_cities_snapshot"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`snapshots`.`staging_cities_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m08:37:59.337167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d97c9b23-7f00-4ec7-9bd9-415d87af1349&page=queryresults
[0m08:38:00.967342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0f256e-e774-4eb8-9e40-b5acc3570802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f110830>]}
[0m08:38:00.970215 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.staging_cities_snapshot ........................ [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 3.62s]
[0m08:38:00.973979 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:38:00.977175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:00.981625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:00.982848 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.staging_cities_snapshot' was properly closed.
[0m08:38:00.986879 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_snapshots' was properly closed.
[0m08:38:00.988748 [info ] [MainThread]: 
[0m08:38:00.991029 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m08:38:00.992904 [debug] [MainThread]: Command end result
[0m08:38:01.104480 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:38:01.109853 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:38:01.117822 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:38:01.118518 [info ] [MainThread]: 
[0m08:38:01.119404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:01.120165 [info ] [MainThread]: 
[0m08:38:01.120924 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:38:01.123328 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.636501, "process_in_blocks": "0", "process_kernel_time": 1.187515, "process_mem_max_rss": "375408", "process_out_blocks": "0", "process_user_time": 3.472213}
[0m08:38:01.124342 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:38:01.124263 after 7.64 seconds
[0m08:38:01.125605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e895ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65249d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a52150>]}
[0m08:38:01.126163 [debug] [MainThread]: Flushing usage events
[0m08:38:01.728704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:43.501410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eeabbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f05b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e918980>]}


============================== 08:58:43.506648 | 57aff4d3-321b-4be1-b55c-c6219d51e294 ==============================
[0m08:58:43.506648 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:58:43.508862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:58:45.107955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57aff4d3-321b-4be1-b55c-c6219d51e294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65008bc0>]}
[0m08:58:45.141449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57aff4d3-321b-4be1-b55c-c6219d51e294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64ebb9e0>]}
[0m08:58:45.142836 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:58:45.282642 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:58:45.367094 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:58:45.368164 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m08:58:45.368904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57aff4d3-321b-4be1-b55c-c6219d51e294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64fd6870>]}
[0m08:58:46.091303 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  expected token ',', got 'unique_key'
    line 7
      unique_key='id',
[0m08:58:46.093461 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.628721, "process_in_blocks": "0", "process_kernel_time": 0.788992, "process_mem_max_rss": "368544", "process_out_blocks": "0", "process_user_time": 3.084517}
[0m08:58:46.094427 [debug] [MainThread]: Command `dbt snapshot` failed at 08:58:46.094337 after 2.63 seconds
[0m08:58:46.095103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8d0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57f89880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649ed250>]}
[0m08:58:46.096250 [debug] [MainThread]: Flushing usage events
[0m08:58:46.604499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:56.276202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbb7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f339fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f57ab70>]}


============================== 08:58:56.280847 | 15b95c55-d6a0-4159-8476-7a0b217639eb ==============================
[0m08:58:56.280847 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:58:56.282312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:58.278567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8605d160>]}
[0m08:58:58.315550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d8acc0>]}
[0m08:58:58.316909 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:58:58.472176 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:58:58.539780 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:58:58.540832 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m08:58:58.541609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7a52b0>]}
[0m08:58:59.388082 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m08:58:59.474340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e3f530>]}
[0m08:58:59.633341 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:58:59.639616 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:58:59.662326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b10110>]}
[0m08:58:59.664054 [info ] [MainThread]: Found 4 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m08:58:59.664942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b50bc0>]}
[0m08:58:59.667573 [info ] [MainThread]: 
[0m08:58:59.668315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:58:59.668992 [info ] [MainThread]: 
[0m08:58:59.670063 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:58:59.671476 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:58:59.672070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:00.111105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now create_paris-air-pollution-quangnc_snapshots_dev)
[0m08:59:00.114448 [debug] [ThreadPool]: Creating schema "database: "paris-air-pollution-quangnc"
schema: "snapshots_dev"
"
[0m08:59:00.132000 [debug] [ThreadPool]: On create_paris-air-pollution-quangnc_snapshots_dev: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "connection_name": "create_paris-air-pollution-quangnc_snapshots_dev"} */
create schema if not exists `paris-air-pollution-quangnc`.`snapshots_dev`
  
[0m08:59:00.133736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:00.601676 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8f8053b2-6b88-480b-93eb-493a9f8ff910&page=queryresults
[0m08:59:02.158930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_paris-air-pollution-quangnc_snapshots_dev, now list_paris-air-pollution-quangnc_snapshots_dev)
[0m08:59:02.159545 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m08:59:02.159995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:02.160897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:02.605508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee6bdd0>]}
[0m08:59:02.607384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:02.615307 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:59:02.616607 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots_dev.staging_cities_snapshot .................... [RUN]
[0m08:59:02.617831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_snapshots_dev, now snapshot.france_air_pollution.staging_cities_snapshot)
[0m08:59:02.618658 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:59:02.627073 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:59:02.677131 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(updated_at as string), '')))) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m08:59:02.678900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:03.101605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0ac46bbf-7701-415a-9b08-9762f16faad2&page=queryresults
[0m08:59:03.110089 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0ac46bbf-7701-415a-9b08-9762f16faad2&page=queryresults
[0m08:59:03.129619 [debug] [Thread-1 (]: Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79]
[0m08:59:03.134594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b95c55-d6a0-4159-8476-7a0b217639eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fef0b00>]}
[0m08:59:03.138548 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots_dev.staging_cities_snapshot ................ [[31mERROR[0m in 0.51s]
[0m08:59:03.141071 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.staging_cities_snapshot
[0m08:59:03.143254 [debug] [Thread-7 (]: Marking all children of 'snapshot.france_air_pollution.staging_cities_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79].
[0m08:59:03.148221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:03.151862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:03.152979 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.staging_cities_snapshot' was properly closed.
[0m08:59:03.154071 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_development' was properly closed.
[0m08:59:03.155060 [info ] [MainThread]: 
[0m08:59:03.156083 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m08:59:03.157259 [debug] [MainThread]: Command end result
[0m08:59:03.242041 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:59:03.245708 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:59:03.250916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:59:03.251470 [info ] [MainThread]: 
[0m08:59:03.252212 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:59:03.252921 [info ] [MainThread]: 
[0m08:59:03.253660 [error] [MainThread]: [31mFailure in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)[0m
[0m08:59:03.254405 [error] [MainThread]:   Database Error in snapshot staging_cities_snapshot (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: updated_at at [6:79]
[0m08:59:03.254985 [info ] [MainThread]: 
[0m08:59:03.255589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:59:03.257402 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 7.0185666, "process_in_blocks": "0", "process_kernel_time": 1.228768, "process_mem_max_rss": "385044", "process_out_blocks": "0", "process_user_time": 4.038846}
[0m08:59:03.258143 [debug] [MainThread]: Command `dbt snapshot` failed at 08:59:03.258048 after 7.02 seconds
[0m08:59:03.258810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a57020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cce3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cce2c60>]}
[0m08:59:03.259767 [debug] [MainThread]: Flushing usage events
[0m08:59:03.729243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:01:51.156919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1361400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb353e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13862a0>]}


============================== 09:01:51.161218 | 86f6908a-d522-4e40-b3ef-65193fbcfc52 ==============================
[0m09:01:51.161218 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:01:51.162191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:01:53.060799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97801160>]}
[0m09:01:53.094735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975e8e90>]}
[0m09:01:53.096028 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:01:53.255345 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m09:01:53.342503 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:01:53.612417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09e3aa0>]}
[0m09:01:53.744820 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:01:53.749814 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:01:53.767886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9733a180>]}
[0m09:01:53.768800 [info ] [MainThread]: Found 4 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m09:01:53.769867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970fff50>]}
[0m09:01:53.772118 [info ] [MainThread]: 
[0m09:01:53.772865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:01:53.773683 [info ] [MainThread]: 
[0m09:01:53.774689 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:01:53.775958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m09:01:53.776699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:54.193534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m09:01:54.194268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_snapshots_dev'
[0m09:01:54.194677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:01:54.195372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:54.570542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976ee180>]}
[0m09:01:54.571710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:01:54.576297 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.staging_cities_snapshot
[0m09:01:54.577107 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots_dev.staging_cities_snapshot .................... [RUN]
[0m09:01:54.578032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.staging_cities_snapshot)
[0m09:01:54.578622 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.staging_cities_snapshot
[0m09:01:54.584720 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.staging_cities_snapshot
[0m09:01:54.639658 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:01:54.640880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:01:55.252542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bdff7e72-9cf7-47fd-af3e-d214be10ac81&page=queryresults
[0m09:01:55.428566 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m09:01:55.762142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3cb8d09c-1ae6-4d00-abb9-37d070238534&page=queryresults
[0m09:01:55.898885 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.staging_cities_snapshot"
[0m09:01:55.903258 [debug] [Thread-1 (]: On snapshot.france_air_pollution.staging_cities_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.staging_cities_snapshot"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`snapshots_dev`.`staging_cities_snapshot`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        


SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m09:01:56.339149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:44533e91-6d42-4674-b7f2-85abf27212d5&page=queryresults
[0m09:01:58.019142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f6908a-d522-4e40-b3ef-65193fbcfc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1900770>]}
[0m09:01:58.021742 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots_dev.staging_cities_snapshot .................... [[32mCREATE TABLE (105.0 rows, 3.6 KiB processed)[0m in 3.44s]
[0m09:01:58.023427 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.staging_cities_snapshot
[0m09:01:58.027100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:01:58.031968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:58.032702 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.staging_cities_snapshot' was properly closed.
[0m09:01:58.033662 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_snapshots_dev' was properly closed.
[0m09:01:58.034491 [info ] [MainThread]: 
[0m09:01:58.035323 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m09:01:58.036605 [debug] [MainThread]: Command end result
[0m09:01:58.170177 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m09:01:58.174830 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m09:01:58.181961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m09:01:58.182759 [info ] [MainThread]: 
[0m09:01:58.184091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:01:58.185230 [info ] [MainThread]: 
[0m09:01:58.186291 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:01:58.197551 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.0838695, "process_in_blocks": "0", "process_kernel_time": 0.754887, "process_mem_max_rss": "374764", "process_out_blocks": "0", "process_user_time": 3.411845}
[0m09:01:58.199003 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:01:58.198834 after 7.09 seconds
[0m09:01:58.200117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb261e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9712f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19035f0>]}
[0m09:01:58.200953 [debug] [MainThread]: Flushing usage events
[0m09:01:58.682330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:02.202023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa623da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa676bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d6a4e0>]}


============================== 12:10:02.207086 | 4b7841e0-3910-480d-8a70-70d146a0c4aa ==============================
[0m12:10:02.207086 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:10:02.208197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:04.372363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b7841e0-3910-480d-8a70-70d146a0c4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d943b0>]}
[0m12:10:04.410453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b7841e0-3910-480d-8a70-70d146a0c4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88a4f80>]}
[0m12:10:04.411969 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:10:04.567301 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:10:04.673370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m12:10:04.674890 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://models/dim/dim_cities.sql
[0m12:10:04.676676 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/sources.yml
[0m12:10:04.677389 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m12:10:04.678025 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_air_pollution.sql
[0m12:10:04.678855 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_cities.sql
[0m12:10:04.679623 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m12:10:04.680405 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m12:10:05.293400 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.france_air_pollution.dim_cities' (models/dim/dim_cities.sql) depends on a node named 'snapshot_staging_cities' which was not found
[0m12:10:05.295653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1343365, "process_in_blocks": "0", "process_kernel_time": 1.003932, "process_mem_max_rss": "373204", "process_out_blocks": "0", "process_user_time": 3.399863}
[0m12:10:05.296514 [debug] [MainThread]: Command `dbt run` failed at 12:10:05.296433 after 3.14 seconds
[0m12:10:05.297569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fc1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd7bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbea960>]}
[0m12:10:05.298459 [debug] [MainThread]: Flushing usage events
[0m12:10:05.785392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:29.031892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9403ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ee5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f38f50>]}


============================== 12:12:29.038040 | e04df80f-621f-48fe-96c0-ca8a05094a9f ==============================
[0m12:12:29.038040 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:12:29.039154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m12:12:31.415147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb43f380>]}
[0m12:12:31.466379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fadb710>]}
[0m12:12:31.468751 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:12:31.688573 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:12:31.812158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m12:12:31.813829 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://models/dim/dim_cities.sql
[0m12:12:31.815854 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/sources.yml
[0m12:12:31.816760 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m12:12:31.818159 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m12:12:31.819077 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m12:12:31.820179 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_air_pollution.sql
[0m12:12:31.821209 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/staging/staging_cities.sql
[0m12:12:32.533419 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m12:12:32.621998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f321640>]}
[0m12:12:32.948566 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:12:32.955293 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:12:32.994278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e87fef0>]}
[0m12:12:32.995642 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:12:32.996446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7615e0>]}
[0m12:12:32.999728 [info ] [MainThread]: 
[0m12:12:33.001123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:33.002782 [info ] [MainThread]: 
[0m12:12:33.005175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:33.009555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:12:33.011516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:33.465048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_developement)
[0m12:12:33.465966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m12:12:33.466511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:33.467487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:34.205823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f56b7a0>]}
[0m12:12:34.207616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:34.217210 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:12:34.217823 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:12:34.221272 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:12:34.219569 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:12:34.223180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m12:12:34.225079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_developement, now model.france_air_pollution.staging_air_pollution)
[0m12:12:34.226743 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:12:34.227794 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:12:34.234231 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:12:34.239921 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:12:34.244603 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:12:34.251912 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:12:34.254848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:34.332764 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m12:12:34.334306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:34.625688 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:12:34.629403 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:12:34.941452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f15ad1e3-c0b4-4c9b-b3d2-34be4053e805&page=queryresults
[0m12:12:34.995301 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:67819595-51cb-42fa-b88c-12a1c571847f&page=queryresults
[0m12:12:37.023411 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8980e0>]}
[0m12:12:37.026506 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.80s]
[0m12:12:37.029189 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:12:37.031878 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:12:37.032825 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:12:37.037040 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:12:37.038497 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:12:37.045221 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:12:37.050765 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:12:37.065347 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:12:37.071182 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`developement`.`snapshot_staging_cities`
    ORDER BY id
)

SELECT 
    id,
    city,
    latitude, 
    longitude, 
    region,
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:12:37.072176 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:12:37.686150 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47b0e401-0593-457a-a38f-3609074fdf71&page=queryresults
[0m12:12:37.687561 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47b0e401-0593-457a-a38f-3609074fdf71&page=queryresults
[0m12:12:37.709324 [debug] [Thread-4 (]: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:12:37.710774 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3c9640>]}
[0m12:12:37.712036 [error] [Thread-4 (]: 3 of 5 ERROR creating sql view model development.dim_cities .................... [[31mERROR[0m in 0.67s]
[0m12:12:37.713967 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:12:37.715124 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.dim_cities' to be skipped because of status 'error'.  Reason: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql.
[0m12:12:38.218366 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:12:38.238272 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:12:38.241984 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m12:12:38.791351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:723c984f-e0f8-4b67-bcfa-26c73c4050a4&page=queryresults
[0m12:12:40.327388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5c9430>]}
[0m12:12:40.329313 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 6.10s]
[0m12:12:40.330582 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:12:40.333127 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:12:40.333972 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:12:40.335031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:12:40.335857 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:12:40.339958 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:12:40.349590 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:12:40.355010 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`developement`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:12:40.357551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:40.899145 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e085947d-4862-4dbd-9e6f-3342bc3be3cb&page=queryresults
[0m12:12:40.905365 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e085947d-4862-4dbd-9e6f-3342bc3be3cb&page=queryresults
[0m12:12:40.921158 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2
[0m12:12:40.922986 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04df80f-621f-48fe-96c0-ca8a05094a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c271760>]}
[0m12:12:40.924755 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.59s]
[0m12:12:40.926515 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:12:40.928043 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2.
[0m12:12:40.930808 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:12:40.932658 [info ] [Thread-4 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m12:12:40.934577 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:12:40.938780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:40.943126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:40.944664 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:12:40.946653 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:12:40.947497 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m12:12:40.951004 [info ] [MainThread]: 
[0m12:12:40.953972 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m12:12:40.960073 [debug] [MainThread]: Command end result
[0m12:12:41.114949 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:12:41.225046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:12:41.241631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:12:41.242462 [info ] [MainThread]: 
[0m12:12:41.243809 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:12:41.244749 [info ] [MainThread]: 
[0m12:12:41.248020 [error] [MainThread]: [31mFailure in model dim_cities (models/dim/dim_cities.sql)[0m
[0m12:12:41.249973 [error] [MainThread]:   Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:12:41.251318 [info ] [MainThread]: 
[0m12:12:41.252393 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/dim/dim_cities.sql
[0m12:12:41.254148 [info ] [MainThread]: 
[0m12:12:41.256261 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m12:12:41.258340 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Dataset paris-air-pollution-quangnc:developement was not found in location europe-west2
[0m12:12:41.259573 [info ] [MainThread]: 
[0m12:12:41.261728 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:12:41.263396 [info ] [MainThread]: 
[0m12:12:41.264919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=5
[0m12:12:41.271395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.279853, "process_in_blocks": "0", "process_kernel_time": 1.530227, "process_mem_max_rss": "385372", "process_out_blocks": "0", "process_user_time": 4.69111}
[0m12:12:41.274753 [debug] [MainThread]: Command `dbt run` failed at 12:12:41.274472 after 12.28 seconds
[0m12:12:41.308468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f38f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e995070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b535c0>]}
[0m12:12:41.314361 [debug] [MainThread]: Flushing usage events
[0m12:12:41.804332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:21.016157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c2d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d18bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c2ec60>]}


============================== 12:13:21.021858 | 91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0 ==============================
[0m12:13:21.021858 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:13:21.022933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:22.534327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988b8bc0>]}
[0m12:13:22.565068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9871c350>]}
[0m12:13:22.566436 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:13:22.701993 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:13:22.804272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:22.805264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:22.837948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98695a00>]}
[0m12:13:23.068399 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:13:23.071628 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:13:23.093289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982d8530>]}
[0m12:13:23.094790 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:13:23.095646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4295c10>]}
[0m12:13:23.097780 [info ] [MainThread]: 
[0m12:13:23.098410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:23.099001 [info ] [MainThread]: 
[0m12:13:23.099707 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:13:23.100873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:13:23.101518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:23.483570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now create_paris-air-pollution-quangnc_developement)
[0m12:13:23.486167 [debug] [ThreadPool]: Creating schema "database: "paris-air-pollution-quangnc"
schema: "developement"
"
[0m12:13:23.501764 [debug] [ThreadPool]: On create_paris-air-pollution-quangnc_developement: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "connection_name": "create_paris-air-pollution-quangnc_developement"} */
create schema if not exists `paris-air-pollution-quangnc`.`developement`
  
[0m12:13:23.502702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:23.892424 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:48faa5bf-7a4a-4b93-a3df-1193843fcc7f&page=queryresults
[0m12:13:25.322930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_paris-air-pollution-quangnc_developement, now list_paris-air-pollution-quangnc_developement)
[0m12:13:25.323797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m12:13:25.324408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:25.325550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:25.819227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982d83b0>]}
[0m12:13:25.824619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:25.842560 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:13:25.844834 [info ] [Thread-1 (]: 1 of 1 START snapshot developement.snapshot_staging_cities ..................... [RUN]
[0m12:13:25.848661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_developement, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m12:13:25.850019 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:13:25.864320 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:13:25.920333 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:13:25.921395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:26.428556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04ce9e07-7b6f-4ac2-9601-dacc82e5933a&page=queryresults
[0m12:13:26.438842 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04ce9e07-7b6f-4ac2-9601-dacc82e5933a&page=queryresults
[0m12:13:26.459366 [debug] [Thread-1 (]: Database Error in snapshot snapshot_staging_cities (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: id at [6:41]
[0m12:13:26.464540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b1301b-96f1-46c0-a0c0-5b1a1ca7bab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28d0890>]}
[0m12:13:26.466839 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting developement.snapshot_staging_cities ................. [[31mERROR[0m in 0.61s]
[0m12:13:26.468755 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:13:26.470596 [debug] [Thread-7 (]: Marking all children of 'snapshot.france_air_pollution.snapshot_staging_cities' to be skipped because of status 'error'.  Reason: Database Error in snapshot snapshot_staging_cities (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: id at [6:41].
[0m12:13:26.475537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:26.479362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:26.480649 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m12:13:26.481638 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_development' was properly closed.
[0m12:13:26.482660 [info ] [MainThread]: 
[0m12:13:26.483997 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m12:13:26.486793 [debug] [MainThread]: Command end result
[0m12:13:26.588164 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:13:26.592357 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:13:26.598482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:13:26.599041 [info ] [MainThread]: 
[0m12:13:26.599913 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:13:26.600642 [info ] [MainThread]: 
[0m12:13:26.601530 [error] [MainThread]: [31mFailure in snapshot snapshot_staging_cities (snapshots/snapshot_staging_cities.sql)[0m
[0m12:13:26.602252 [error] [MainThread]:   Database Error in snapshot snapshot_staging_cities (snapshots/snapshot_staging_cities.sql)
  Unrecognized name: id at [6:41]
[0m12:13:26.602884 [info ] [MainThread]: 
[0m12:13:26.603494 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:13:26.606023 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.6230516, "process_in_blocks": "0", "process_kernel_time": 0.673506, "process_mem_max_rss": "374512", "process_out_blocks": "0", "process_user_time": 2.984118}
[0m12:13:26.607081 [debug] [MainThread]: Command `dbt snapshot` failed at 12:13:26.606977 after 5.62 seconds
[0m12:13:26.607976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c2d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9899eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb456c6e0>]}
[0m12:13:26.608620 [debug] [MainThread]: Flushing usage events
[0m12:13:27.086111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:10.657058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fac200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845f6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85151ee0>]}


============================== 12:15:10.661984 | d8e28fd1-d4d8-452f-945e-5c3160b067a9 ==============================
[0m12:15:10.661984 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:15:10.665172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:12.938658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af9b680>]}
[0m12:15:12.990027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aea3980>]}
[0m12:15:13.015164 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:15:13.413436 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:15:13.637756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:13.639791 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m12:15:14.363049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a741160>]}
[0m12:15:14.513737 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:15:14.517785 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:15:14.547555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9490a0>]}
[0m12:15:14.550303 [info ] [MainThread]: Found 5 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m12:15:14.552457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8404c710>]}
[0m12:15:14.567367 [info ] [MainThread]: 
[0m12:15:14.569773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:14.571257 [info ] [MainThread]: 
[0m12:15:14.573366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:15:14.574955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:15:14.576351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:15.003469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:15:15.004435 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_developement'
[0m12:15:15.005791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:15.004883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:15.329626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a71b710>]}
[0m12:15:15.331221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:15.340037 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:15:15.341509 [info ] [Thread-1 (]: 1 of 1 START snapshot developement.snapshot_staging_cities ..................... [RUN]
[0m12:15:15.342795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_developement, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m12:15:15.343733 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:15:15.353636 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:15:15.408663 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:15:15.410251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:15.991729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:487025b3-4536-476f-86ab-6fe310c689e0&page=queryresults
[0m12:15:16.133072 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:15:16.440623 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c0a63c2f-4887-4576-81eb-f7427fdaec0d&page=queryresults
[0m12:15:16.595820 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m12:15:16.608954 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`developement`.`snapshot_staging_cities`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m12:15:17.031352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:554c35eb-695a-4a33-9400-b29dffaf9e8e&page=queryresults
[0m12:15:18.678007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8e28fd1-d4d8-452f-945e-5c3160b067a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a65a660>]}
[0m12:15:18.680725 [info ] [Thread-1 (]: 1 of 1 OK snapshotted developement.snapshot_staging_cities ..................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 3.33s]
[0m12:15:18.682787 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:15:18.687312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:18.691848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:18.692826 [debug] [MainThread]: Connection 'list_paris-air-pollution-quangnc_development' was properly closed.
[0m12:15:18.693930 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m12:15:18.695182 [info ] [MainThread]: 
[0m12:15:18.696487 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m12:15:18.698648 [debug] [MainThread]: Command end result
[0m12:15:18.827980 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:15:18.832524 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:15:18.839795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:15:18.840348 [info ] [MainThread]: 
[0m12:15:18.841256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:18.841961 [info ] [MainThread]: 
[0m12:15:18.842671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:18.846333 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.234953, "process_in_blocks": "0", "process_kernel_time": 0.928741, "process_mem_max_rss": "375376", "process_out_blocks": "0", "process_user_time": 4.248324}
[0m12:15:18.847919 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:15:18.847773 after 8.24 seconds
[0m12:15:18.849031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9b29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad2e390>]}
[0m12:15:18.849704 [debug] [MainThread]: Flushing usage events
[0m12:15:19.330268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:21.510987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1575370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb317ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15752b0>]}


============================== 12:16:21.519389 | 2fa33afc-5d47-4280-8d35-e71c63e7654f ==============================
[0m12:16:21.519389 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:16:21.521207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:23.779676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97392960>]}
[0m12:16:23.811196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974a0740>]}
[0m12:16:23.812348 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:16:23.964350 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:16:24.063603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:24.064715 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://snapshots/snapshot_staging_cities.sql
[0m12:16:24.427833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d68c50>]}
[0m12:16:24.563927 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:16:24.567995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:16:24.589585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f37b00>]}
[0m12:16:24.590765 [info ] [MainThread]: Found 5 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m12:16:24.591704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974cbce0>]}
[0m12:16:24.593943 [info ] [MainThread]: 
[0m12:16:24.594700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:24.595501 [info ] [MainThread]: 
[0m12:16:24.596878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:24.598970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:16:24.599956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:25.003379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:16:25.007137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:25.323578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f362d0>]}
[0m12:16:25.325438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:25.333011 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:16:25.334649 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m12:16:25.336188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m12:16:25.337089 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:16:25.349096 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:16:25.407168 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:16:25.408515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:25.934612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13f0df44-4e7e-4581-8238-6808c6a193eb&page=queryresults
[0m12:16:26.082295 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:16:26.651595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ea5678d9-01b8-47da-be47-c7476204a32f&page=queryresults
[0m12:16:26.798080 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m12:16:26.810697 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m12:16:27.260776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3f697204-c92a-494a-8e09-356ddfef3108&page=queryresults
[0m12:16:28.814840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa33afc-5d47-4280-8d35-e71c63e7654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf90c20>]}
[0m12:16:28.816655 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 3.48s]
[0m12:16:28.818147 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:16:28.820718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:28.827669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:28.828637 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m12:16:28.829414 [info ] [MainThread]: 
[0m12:16:28.830360 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m12:16:28.831897 [debug] [MainThread]: Command end result
[0m12:16:28.941662 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:16:28.948606 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:16:28.957417 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:16:28.959740 [info ] [MainThread]: 
[0m12:16:28.961272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:28.962428 [info ] [MainThread]: 
[0m12:16:28.963419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:16:28.967896 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.513308, "process_in_blocks": "0", "process_kernel_time": 1.467745, "process_mem_max_rss": "375152", "process_out_blocks": "0", "process_user_time": 3.476452}
[0m12:16:28.972078 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:16:28.971312 after 7.52 seconds
[0m12:16:28.975946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08d45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f360f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f46fc0>]}
[0m12:16:28.977353 [debug] [MainThread]: Flushing usage events
[0m12:16:29.425156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:59.921091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89140ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af8ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bafec0>]}


============================== 12:16:59.926821 | 3ae3d54b-f5f6-4efe-8856-6fe0967975a6 ==============================
[0m12:16:59.926821 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:16:59.937216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:02.075572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7436f380>]}
[0m12:17:02.107041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88caf620>]}
[0m12:17:02.108270 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:17:02.267702 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:17:02.364926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:02.365866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:02.398288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f13f380>]}
[0m12:17:02.722607 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:17:02.726341 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:17:02.744509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eef3b30>]}
[0m12:17:02.745371 [info ] [MainThread]: Found 5 models, 54 data tests, 1 snapshot, 2 sources, 496 macros
[0m12:17:02.746378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed5a810>]}
[0m12:17:02.748838 [info ] [MainThread]: 
[0m12:17:02.749586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:02.750359 [info ] [MainThread]: 
[0m12:17:02.751122 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:17:02.754637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:17:02.755447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:03.305773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:17:03.307744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:03.601679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f03be90>]}
[0m12:17:03.603380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:03.613078 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:17:03.613572 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:17:03.614698 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:17:03.616102 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:17:03.617455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:17:03.618667 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:17:03.619715 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:17:03.620757 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:17:03.636287 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:17:03.641882 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:17:03.644609 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:17:03.652153 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:17:03.654925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:17:03.722023 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m12:17:03.723089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:03.980374 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:17:03.985388 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:17:04.346972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:73f12bf3-2605-4ea2-8d38-2c8c42b18822&page=queryresults
[0m12:17:04.382735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:76ce2677-b710-41f0-bd1d-7de826ff07c6&page=queryresults
[0m12:17:06.760020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c140050>]}
[0m12:17:06.763638 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 3.14s]
[0m12:17:06.766103 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:17:06.768650 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:17:06.770361 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:17:06.771702 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:17:06.772601 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:17:06.777215 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:17:06.780865 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:17:06.823447 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:17:06.872937 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY id
)

SELECT 
    id,
    city,
    latitude, 
    longitude, 
    region,
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:17:06.882543 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:17:06.929205 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:17:06.949187 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:17:06.954075 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m12:17:07.623293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:507a821c-c09d-4660-9223-f9c79fd6731b&page=queryresults
[0m12:17:07.705603 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:799037dd-26bb-4baf-a57b-455bcdc67fd0&page=queryresults
[0m12:17:07.891324 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:799037dd-26bb-4baf-a57b-455bcdc67fd0&page=queryresults
[0m12:17:07.907767 [debug] [Thread-4 (]: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:17:07.913148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88458ef0>]}
[0m12:17:07.915136 [error] [Thread-4 (]: 3 of 5 ERROR creating sql view model development.dim_cities .................... [[31mERROR[0m in 1.14s]
[0m12:17:07.918879 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:17:07.920579 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.dim_cities' to be skipped because of status 'error'.  Reason: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql.
[0m12:17:09.467362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56f73a70>]}
[0m12:17:09.471510 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.85s]
[0m12:17:09.477347 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:17:09.483262 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:17:09.484698 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:17:09.486290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:17:09.487585 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:17:09.494788 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:17:09.500751 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:17:09.505141 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:17:09.507039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:10.091552 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0f6c2a97-6549-4fe8-8712-7841ebd922ef&page=queryresults
[0m12:17:10.184341 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0f6c2a97-6549-4fe8-8712-7841ebd922ef&page=queryresults
[0m12:17:10.191107 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Name id not found inside c at [55:19]
[0m12:17:10.197637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae3d54b-f5f6-4efe-8856-6fe0967975a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56cf2fc0>]}
[0m12:17:10.201518 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.71s]
[0m12:17:10.204696 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:17:10.207423 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Name id not found inside c at [55:19].
[0m12:17:10.210766 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:17:10.212056 [info ] [Thread-4 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m12:17:10.214860 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:17:10.220108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:10.230364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:10.234118 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:17:10.237014 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:17:10.239365 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m12:17:10.241302 [info ] [MainThread]: 
[0m12:17:10.243277 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m12:17:10.245574 [debug] [MainThread]: Command end result
[0m12:17:10.356699 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:17:10.367689 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:17:10.376480 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:17:10.377211 [info ] [MainThread]: 
[0m12:17:10.378107 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:17:10.378937 [info ] [MainThread]: 
[0m12:17:10.379783 [error] [MainThread]: [31mFailure in model dim_cities (models/dim/dim_cities.sql)[0m
[0m12:17:10.380563 [error] [MainThread]:   Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:17:10.381652 [info ] [MainThread]: 
[0m12:17:10.382300 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/dim/dim_cities.sql
[0m12:17:10.383009 [info ] [MainThread]: 
[0m12:17:10.386749 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m12:17:10.387735 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Name id not found inside c at [55:19]
[0m12:17:10.389093 [info ] [MainThread]: 
[0m12:17:10.391256 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:17:10.394123 [info ] [MainThread]: 
[0m12:17:10.395068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=5
[0m12:17:10.399951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.523884, "process_in_blocks": "0", "process_kernel_time": 1.472975, "process_mem_max_rss": "375768", "process_out_blocks": "0", "process_user_time": 3.539599}
[0m12:17:10.401709 [debug] [MainThread]: Command `dbt run` failed at 12:17:10.401555 after 10.53 seconds
[0m12:17:10.403576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891030e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f98bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56e5ade0>]}
[0m12:17:10.404417 [debug] [MainThread]: Flushing usage events
[0m12:17:10.880768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:04.556478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9099dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb920e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f2e060>]}


============================== 12:18:04.561227 | 05b9430d-8c54-4d01-9ef1-7559197f9eca ==============================
[0m12:18:04.561227 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:18:04.562141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:06.540752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d55b0e0>]}
[0m12:18:06.572376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d46a5d0>]}
[0m12:18:06.573388 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:18:06.717140 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:18:06.785622 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:18:06.786708 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m12:18:06.787968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e85460>]}
[0m12:18:07.633828 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m12:18:07.708664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c42c080>]}
[0m12:18:07.848375 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:18:07.857366 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:18:07.877431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1d8140>]}
[0m12:18:07.878467 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:18:07.879541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1b3800>]}
[0m12:18:07.881776 [info ] [MainThread]: 
[0m12:18:07.882524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:07.883268 [info ] [MainThread]: 
[0m12:18:07.884539 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:07.888007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:18:07.888737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:08.249259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:18:08.250991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:08.531749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb654bf80>]}
[0m12:18:08.533363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:08.543168 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:18:08.543673 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:18:08.544644 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:18:08.545953 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:18:08.547499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:18:08.549102 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:18:08.550080 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:18:08.550998 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:18:08.561071 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:18:08.564354 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:18:08.567924 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:18:08.568399 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:18:08.596909 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:08.598877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:08.964751 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:18:08.965279 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:18:08.968357 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:18:08.969011 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:18:09.356165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2ae2513f-36fa-47b3-9570-4c38002a6c55&page=queryresults
[0m12:18:09.358257 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3a81ab64-35b3-4f58-ae90-ff90fc071d1e&page=queryresults
[0m12:18:11.065495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2011580>]}
[0m12:18:11.069785 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.51s]
[0m12:18:11.073397 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:18:11.077636 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:18:11.078975 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:18:11.080460 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:18:11.081624 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:18:11.087480 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:18:11.090477 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:18:11.106005 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:18:11.109177 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY id
)

SELECT 
    id,
    city,
    latitude, 
    longitude, 
    region,
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:18:11.110067 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:18:11.562208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6d047ed5-86c3-4a70-9e79-5322c60be1b3&page=queryresults
[0m12:18:11.677015 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6d047ed5-86c3-4a70-9e79-5322c60be1b3&page=queryresults
[0m12:18:11.687782 [debug] [Thread-4 (]: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:18:11.689304 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2f46e0>]}
[0m12:18:11.691548 [error] [Thread-4 (]: 3 of 5 ERROR creating sql view model development.dim_cities .................... [[31mERROR[0m in 0.61s]
[0m12:18:11.692895 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:18:11.694369 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.dim_cities' to be skipped because of status 'error'.  Reason: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql.
[0m12:18:16.969337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c22c890>]}
[0m12:18:16.976705 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.42s]
[0m12:18:16.979688 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:18:16.992936 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:18:16.995572 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:18:16.998109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:18:16.999668 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:18:17.020188 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:18:17.025164 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:18:17.028430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:17.345824 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:18:17.355755 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:18:17.748134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:03fcf863-22b0-4fe2-9689-8b0bae766619&page=queryresults
[0m12:18:17.841684 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:03fcf863-22b0-4fe2-9689-8b0bae766619&page=queryresults
[0m12:18:17.852741 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:18:17.856383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b9430d-8c54-4d01-9ef1-7559197f9eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c483830>]}
[0m12:18:17.860689 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.86s]
[0m12:18:17.863059 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:18:17.865760 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql.
[0m12:18:17.870596 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:18:17.872378 [info ] [Thread-4 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m12:18:17.874998 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:18:17.883250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:17.888099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:17.890037 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:18:17.891414 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:18:17.892359 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m12:18:17.894420 [info ] [MainThread]: 
[0m12:18:17.895468 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m12:18:17.898245 [debug] [MainThread]: Command end result
[0m12:18:18.024764 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:18:18.031278 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:18:18.047590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:18:18.048226 [info ] [MainThread]: 
[0m12:18:18.048975 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:18:18.049766 [info ] [MainThread]: 
[0m12:18:18.050714 [error] [MainThread]: [31mFailure in model dim_cities (models/dim/dim_cities.sql)[0m
[0m12:18:18.051468 [error] [MainThread]:   Database Error in model dim_cities (models/dim/dim_cities.sql)
  Unrecognized name: id at [9:14]
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:18:18.052237 [info ] [MainThread]: 
[0m12:18:18.053128 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/dim/dim_cities.sql
[0m12:18:18.054192 [info ] [MainThread]: 
[0m12:18:18.055275 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m12:18:18.056359 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:18:18.056975 [info ] [MainThread]: 
[0m12:18:18.061595 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:18:18.062744 [info ] [MainThread]: 
[0m12:18:18.064200 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=5
[0m12:18:18.068595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.5493765, "process_in_blocks": "0", "process_kernel_time": 0.848695, "process_mem_max_rss": "386052", "process_out_blocks": "0", "process_user_time": 4.373731}
[0m12:18:18.070402 [debug] [MainThread]: Command `dbt run` failed at 12:18:18.070272 after 13.55 seconds
[0m12:18:18.071409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e2c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c42e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3ee450>]}
[0m12:18:18.072267 [debug] [MainThread]: Flushing usage events
[0m12:18:18.599364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:40.263378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890125a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87746420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872bb170>]}


============================== 12:19:40.269716 | 7a458e68-503e-47b8-bbe9-820bdf833f62 ==============================
[0m12:19:40.269716 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:19:40.271205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:42.422636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9eb0e0>]}
[0m12:19:42.456924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872e7920>]}
[0m12:19:42.458240 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:19:42.617958 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:19:42.712627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:42.713573 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/dim/dim_cities.sql
[0m12:19:42.971447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2c4590>]}
[0m12:19:43.097456 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:19:43.101192 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:19:43.123762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2c64b0>]}
[0m12:19:43.124613 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:19:43.125457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9c3fb0>]}
[0m12:19:43.127584 [info ] [MainThread]: 
[0m12:19:43.128274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:43.129752 [info ] [MainThread]: 
[0m12:19:43.130696 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:43.133518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:19:43.134093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:43.572075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:19:43.573277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:43.888636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d3d1c70>]}
[0m12:19:43.890984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:43.900902 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:19:43.901445 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:19:43.904922 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:19:43.906733 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:19:43.902597 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:19:43.908882 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:19:43.910179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:19:43.919314 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:19:43.919765 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:19:43.928499 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:19:43.929462 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:19:43.939451 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:19:43.940261 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:19:43.992144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:44.294323 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:19:44.298054 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:19:44.310611 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:19:44.313418 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:19:44.634297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:efb1fa90-5d10-49bd-a2b5-c02b8f7febcd&page=queryresults
[0m12:19:44.636750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f0f53567-a798-46b8-8faa-1eba8d100f19&page=queryresults
[0m12:19:46.324084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff724a5280>]}
[0m12:19:46.327490 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.41s]
[0m12:19:46.331421 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:19:46.333669 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:19:46.335392 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:19:46.337950 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:19:46.339671 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:19:46.345946 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:19:46.350052 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:19:46.365394 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:19:46.368965 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY city_id
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:19:46.369749 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:46.843208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ef94ccf5-d1ac-4df8-8086-2be72b9070a2&page=queryresults
[0m12:19:47.084329 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58d76b10>]}
[0m12:19:47.086952 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m12:19:47.089075 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:19:51.294609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886718e0>]}
[0m12:19:51.301089 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 7.38s]
[0m12:19:51.307519 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:19:51.332981 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:19:51.335064 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:19:51.336466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:19:51.337505 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:19:51.352646 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:19:51.357275 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:19:51.360931 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:19:51.651273 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:19:51.658266 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:19:53.307898 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7a5972e4-a7a2-4e61-a962-2f515dc882d1&page=queryresults
[0m12:19:53.424332 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7a5972e4-a7a2-4e61-a962-2f515dc882d1&page=queryresults
[0m12:19:53.453682 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:19:53.456466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a458e68-503e-47b8-bbe9-820bdf833f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2c5520>]}
[0m12:19:53.459368 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 2.12s]
[0m12:19:53.461167 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:19:53.463508 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql.
[0m12:19:53.469164 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:19:53.470748 [info ] [Thread-4 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m12:19:53.471692 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:19:53.476551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:53.480389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:53.481165 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:19:53.481931 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:19:53.482580 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m12:19:53.483858 [info ] [MainThread]: 
[0m12:19:53.485782 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m12:19:53.487599 [debug] [MainThread]: Command end result
[0m12:19:53.594426 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:19:53.601601 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:19:53.611523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:19:53.612176 [info ] [MainThread]: 
[0m12:19:53.612940 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:53.613691 [info ] [MainThread]: 
[0m12:19:53.614404 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m12:19:53.615077 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Column name city_id is ambiguous at [32:5]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:19:53.615858 [info ] [MainThread]: 
[0m12:19:53.616972 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:19:53.617772 [info ] [MainThread]: 
[0m12:19:53.618609 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m12:19:53.624357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.402638, "process_in_blocks": "0", "process_kernel_time": 1.343052, "process_mem_max_rss": "377736", "process_out_blocks": "0", "process_user_time": 3.741507}
[0m12:19:53.626332 [debug] [MainThread]: Command `dbt run` failed at 12:19:53.626182 after 13.41 seconds
[0m12:19:53.627767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c8c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a5ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5b9ac0>]}
[0m12:19:53.628825 [debug] [MainThread]: Flushing usage events
[0m12:19:54.105745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:00.123665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e993dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f251010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2531a0>]}


============================== 12:21:00.129493 | cacf421e-7d22-4e68-a019-b98834ef6913 ==============================
[0m12:21:00.129493 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:21:00.130578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:02.407842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650e82f0>]}
[0m12:21:02.459098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b708f0>]}
[0m12:21:02.461489 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:21:02.774989 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:21:02.938941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:02.949012 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m12:21:03.492078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649a9fa0>]}
[0m12:21:03.644926 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:21:03.650645 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:21:03.681133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff647f7b00>]}
[0m12:21:03.682492 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:21:03.683395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b98b00>]}
[0m12:21:03.686345 [info ] [MainThread]: 
[0m12:21:03.687294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:03.688155 [info ] [MainThread]: 
[0m12:21:03.691062 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:03.695980 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:21:03.696935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:04.433208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:21:04.434954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:04.725231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e25cc20>]}
[0m12:21:04.726999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:04.735560 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:21:04.735977 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:21:04.736753 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:21:04.737904 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:21:04.739136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:21:04.740239 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:21:04.741268 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:21:04.742178 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:21:04.757372 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:21:04.757790 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:21:04.762623 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:21:04.763029 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:21:04.798065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:04.798576 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:21:05.128755 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:21:05.135370 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:21:05.136499 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:21:05.139031 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:21:05.481441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:680c17be-fd0b-4a4a-993c-47f204682fa4&page=queryresults
[0m12:21:05.496741 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c0439cca-fd22-4959-b744-96d94150d9e1&page=queryresults
[0m12:21:07.669617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64e2d2b0>]}
[0m12:21:07.671764 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.93s]
[0m12:21:07.673659 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:21:07.675495 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:21:07.676670 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:21:07.677904 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:21:07.678867 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:21:07.683532 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:21:07.687522 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:21:07.701255 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:21:07.704180 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY city_id
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:21:07.705107 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:21:08.122482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e592eaad-4b08-4238-9512-09c9a9aaf178&page=queryresults
[0m12:21:08.382602 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d5f6b0>]}
[0m12:21:08.387201 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m12:21:08.389224 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:21:14.531078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff647bfe90>]}
[0m12:21:14.535294 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 9.79s]
[0m12:21:14.537700 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:21:14.546446 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:21:14.548925 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:21:14.550631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:21:14.551587 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:21:14.565570 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:21:14.569882 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:21:14.573231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:21:14.908617 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:21:14.916198 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:21:15.206048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2024bc65-5a8a-4191-90d7-450696982607&page=queryresults
[0m12:21:23.458116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff647bfe90>]}
[0m12:21:23.463049 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 8.91s]
[0m12:21:23.466132 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:21:23.473788 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:21:23.476496 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:21:23.478954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:21:23.480959 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:21:23.490863 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:21:23.497580 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:21:23.504658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:21:23.874864 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:21:23.883719 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m12:21:24.533447 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:baf5248c-eba8-44fa-9bb1-d53540205364&page=queryresults
[0m12:21:24.648539 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:baf5248c-eba8-44fa-9bb1-d53540205364&page=queryresults
[0m12:21:24.683756 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: region at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:21:24.687732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacf421e-7d22-4e68-a019-b98834ef6913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60b36d20>]}
[0m12:21:24.688835 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 1.21s]
[0m12:21:24.689927 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:21:24.691168 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: region at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql.
[0m12:21:24.696268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:24.698757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:24.699469 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:21:24.700119 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:21:24.700878 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:21:24.702149 [info ] [MainThread]: 
[0m12:21:24.703469 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 21.01 seconds (21.01s).
[0m12:21:24.705255 [debug] [MainThread]: Command end result
[0m12:21:24.806239 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:21:24.812846 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:21:24.822197 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:21:24.822925 [info ] [MainThread]: 
[0m12:21:24.823876 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:24.826638 [info ] [MainThread]: 
[0m12:21:24.827454 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m12:21:24.828233 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: region at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:21:24.829280 [info ] [MainThread]: 
[0m12:21:24.830184 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:21:24.831059 [info ] [MainThread]: 
[0m12:21:24.831878 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:21:24.848868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.762342, "process_in_blocks": "0", "process_kernel_time": 1.109101, "process_mem_max_rss": "380196", "process_out_blocks": "0", "process_user_time": 4.646091}
[0m12:21:24.851406 [debug] [MainThread]: Command `dbt run` failed at 12:21:24.851219 after 24.77 seconds
[0m12:21:24.852758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e35c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f12f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b305c0>]}
[0m12:21:24.853487 [debug] [MainThread]: Flushing usage events
[0m12:21:25.355737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:08.564903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9023bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7b5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904d74d0>]}


============================== 12:22:08.569603 | 78da24c8-00b3-4205-bc22-a03f06b93f00 ==============================
[0m12:22:08.569603 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:22:08.570584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:22:10.600815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f493410>]}
[0m12:22:10.641329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9023ba70>]}
[0m12:22:10.642690 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:22:10.819188 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:22:10.928115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:10.929229 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m12:22:11.302694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75a791c0>]}
[0m12:22:11.552618 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:22:11.560046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:22:11.617926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76129820>]}
[0m12:22:11.627757 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:22:11.635584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75bb0e30>]}
[0m12:22:11.645007 [info ] [MainThread]: 
[0m12:22:11.651878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:22:11.655490 [info ] [MainThread]: 
[0m12:22:11.658657 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:22:11.668971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:22:11.671029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:12.086021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:22:12.086906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:12.398797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75c97590>]}
[0m12:22:12.400081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:12.404874 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:22:12.405189 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:22:12.406509 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:22:12.407480 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:22:12.408312 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:22:12.405646 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:22:12.414678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:22:12.415565 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:22:12.413905 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:22:12.420552 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:22:12.424433 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:22:12.425091 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:22:12.435352 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:12.456403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:12.819927 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:22:12.820838 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:22:12.824320 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:22:12.825050 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:22:13.266548 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e272fbac-be56-405b-9c7c-39fbb6d59ac4&page=queryresults
[0m12:22:13.268565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e153c387-d137-42ad-a0e9-813b455f5f43&page=queryresults
[0m12:22:14.863882 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adf12e0>]}
[0m12:22:14.873836 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.45s]
[0m12:22:14.880098 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:22:14.883015 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:22:14.884097 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:22:14.885713 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:22:14.886711 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:22:14.900534 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:22:14.916238 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:22:14.932994 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:22:14.938191 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY city_id
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:22:14.939220 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:22:15.518163 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c7153d15-1f82-4022-ab37-cced00df6520&page=queryresults
[0m12:22:15.752585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65cea180>]}
[0m12:22:15.757933 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m12:22:15.760406 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:22:20.660775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d58ef0>]}
[0m12:22:20.664602 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.24s]
[0m12:22:20.666377 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:22:20.671451 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:22:20.673140 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:22:20.674680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:22:20.675675 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:22:20.691930 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:22:20.696286 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:22:20.699607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:21.006903 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:22:21.011553 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:22:21.455004 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:747b52db-dbc7-42d1-9dce-e954f2e7cc07&page=queryresults
[0m12:22:30.162289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65cce090>]}
[0m12:22:30.169789 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 9.49s]
[0m12:22:30.173933 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:22:30.180432 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:22:30.183851 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:22:30.186357 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:22:30.188311 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:22:30.202913 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:22:30.211075 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:22:30.219911 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:22:30.507801 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:22:30.528955 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2
ORDER BY 
  date ASC
    );
  
[0m12:22:31.088687 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e8f6fdef-6278-4e8d-8149-382756b95483&page=queryresults
[0m12:22:31.199899 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e8f6fdef-6278-4e8d-8149-382756b95483&page=queryresults
[0m12:22:31.236592 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  SELECT list expression references column region which is neither grouped nor aggregated at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:22:31.239008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78da24c8-00b3-4205-bc22-a03f06b93f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d87440>]}
[0m12:22:31.241966 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 1.05s]
[0m12:22:31.243027 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:22:31.247219 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  SELECT list expression references column region which is neither grouped nor aggregated at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql.
[0m12:22:31.256851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:31.260167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:31.260862 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:22:31.261592 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:22:31.262273 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:22:31.263676 [info ] [MainThread]: 
[0m12:22:31.264729 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 19.60 seconds (19.60s).
[0m12:22:31.266602 [debug] [MainThread]: Command end result
[0m12:22:31.360011 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:22:31.366455 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:22:31.376231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:22:31.376933 [info ] [MainThread]: 
[0m12:22:31.377849 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:22:31.381308 [info ] [MainThread]: 
[0m12:22:31.382048 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m12:22:31.383065 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  SELECT list expression references column region which is neither grouped nor aggregated at [22:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:22:31.383919 [info ] [MainThread]: 
[0m12:22:31.384722 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m12:22:31.385690 [info ] [MainThread]: 
[0m12:22:31.386753 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m12:22:31.391561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.862574, "process_in_blocks": "0", "process_kernel_time": 0.956419, "process_mem_max_rss": "380136", "process_out_blocks": "0", "process_user_time": 3.885581}
[0m12:22:31.393345 [debug] [MainThread]: Command `dbt run` failed at 12:22:31.393223 after 22.86 seconds
[0m12:22:31.394913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc64a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b0a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f97830>]}
[0m12:22:31.395874 [debug] [MainThread]: Flushing usage events
[0m12:22:31.878615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:15.285748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d225a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9a0d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf0ea20>]}


============================== 12:23:15.291668 | 8b9bb79c-cb8b-4dee-9445-2b5476a9035b ==============================
[0m12:23:15.291668 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:23:15.292928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:17.646890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f45d00>]}
[0m12:23:17.679493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73286f60>]}
[0m12:23:17.680658 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:23:17.845682 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:23:17.951289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:17.952791 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m12:23:18.334697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729916a0>]}
[0m12:23:18.466971 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:23:18.470884 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:23:18.488171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729843b0>]}
[0m12:23:18.488975 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:23:18.489652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c81c70>]}
[0m12:23:18.491759 [info ] [MainThread]: 
[0m12:23:18.492511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:18.493225 [info ] [MainThread]: 
[0m12:23:18.493949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:18.496922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:23:18.497543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:18.916742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:23:18.918339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:19.205042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c82b70>]}
[0m12:23:19.206439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:19.213479 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:23:19.213908 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:23:19.214705 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:23:19.217314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:23:19.215591 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:23:19.218134 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:23:19.218969 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:23:19.229335 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:23:19.229722 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:23:19.234403 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:23:19.235383 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:23:19.258706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:19.259113 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:23:19.299609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:19.631115 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:23:19.633468 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:23:19.637386 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:23:19.638124 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:23:20.036541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:334a464d-a298-4ce9-a666-2b634f79b00a&page=queryresults
[0m12:23:20.055033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ec856cfd-14aa-4469-9b78-585a09f7b180&page=queryresults
[0m12:23:21.651862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77c35310>]}
[0m12:23:21.653936 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.43s]
[0m12:23:21.655680 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:23:21.657558 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:23:21.658741 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:23:21.660201 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:23:21.661038 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:23:21.664418 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:23:21.668360 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:23:21.682299 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:23:21.685361 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    ORDER BY city_id
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:23:21.686118 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:23:22.077387 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4d15a130-7016-4108-aa68-9a0e62416fc1&page=queryresults
[0m12:23:22.304898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70374f50>]}
[0m12:23:22.306657 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m12:23:22.307731 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:23:27.885118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff728034a0>]}
[0m12:23:27.891982 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.67s]
[0m12:23:27.897604 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:23:27.903530 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:23:27.911278 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:23:27.921569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:23:27.927801 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:23:27.939699 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:23:27.943688 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:23:27.946242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:23:28.264885 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:23:28.273497 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:23:28.538005 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:843cc4b6-0483-4919-bf34-8ac3f645839e&page=queryresults
[0m12:23:35.663214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bf6720>]}
[0m12:23:35.665135 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 7.74s]
[0m12:23:35.666802 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:23:35.668590 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:23:35.669485 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:23:35.670443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:23:35.671463 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:23:35.677192 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:23:35.680235 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:23:35.682822 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:23:35.979941 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:23:36.009314 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m12:23:36.314069 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1a93ed22-a210-4e2b-aca8-8b519f89b5e1&page=queryresults
[0m12:23:40.248734 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9bb79c-cb8b-4dee-9445-2b5476a9035b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bf6720>]}
[0m12:23:40.252121 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (1.6k rows, 293.5 MiB processed)[0m in 4.58s]
[0m12:23:40.254011 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:23:40.263477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:40.269846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:40.270925 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:23:40.271800 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:23:40.272461 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:23:40.274162 [info ] [MainThread]: 
[0m12:23:40.275435 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 21.78 seconds (21.78s).
[0m12:23:40.278767 [debug] [MainThread]: Command end result
[0m12:23:40.416960 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:23:40.424211 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:23:40.434772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:23:40.435378 [info ] [MainThread]: 
[0m12:23:40.436410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:23:40.437219 [info ] [MainThread]: 
[0m12:23:40.438133 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:23:40.442500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.1965, "process_in_blocks": "0", "process_kernel_time": 1.629024, "process_mem_max_rss": "379496", "process_out_blocks": "0", "process_user_time": 4.262769}
[0m12:23:40.444578 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:40.444404 after 25.20 seconds
[0m12:23:40.448883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70556660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70555ca0>]}
[0m12:23:40.449914 [debug] [MainThread]: Flushing usage events
[0m12:23:40.917715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:45.204124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40eaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4014740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa489d520>]}


============================== 12:28:45.209016 | 59d42ac9-e784-4602-a3fe-a63a770fbb0f ==============================
[0m12:28:45.209016 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:28:45.210286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m12:28:47.754343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a719340>]}
[0m12:28:47.791037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a64c770>]}
[0m12:28:47.792485 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:28:48.190251 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:28:48.431842 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:48.435533 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m12:28:48.437421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41114f0>]}
[0m12:28:50.163110 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m12:28:50.238071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895c18b0>]}
[0m12:28:50.521097 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:28:50.526582 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:28:50.548406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89486270>]}
[0m12:28:50.549484 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:28:50.550330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898687a0>]}
[0m12:28:50.553444 [info ] [MainThread]: 
[0m12:28:50.554186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:50.554871 [info ] [MainThread]: 
[0m12:28:50.556159 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:50.559539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:28:50.560329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:51.000247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:28:51.001878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:51.489493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3820200>]}
[0m12:28:51.491091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:51.499357 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:28:51.499840 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:28:51.500780 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:28:51.501936 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:28:51.502892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:28:51.504663 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:28:51.506089 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:28:51.507086 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:28:51.539435 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:28:51.544728 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:28:51.549803 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:28:51.550357 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:28:51.599120 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:28:51.612865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:51.965571 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:28:51.971766 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:28:51.987061 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:28:51.990452 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:28:52.332583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c87c2aca-5614-4a4b-8506-b3de50d7c106&page=queryresults
[0m12:28:52.349904 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:af2fb67a-1385-4b22-a23d-00462b212fe6&page=queryresults
[0m12:28:54.020439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2a1850>]}
[0m12:28:54.033670 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.51s]
[0m12:28:54.045223 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:28:54.054105 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:28:54.057761 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:28:54.061994 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:28:54.063686 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:28:54.069311 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:28:54.072048 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:28:54.085647 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:28:54.088505 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:28:54.089325 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:28:54.496397 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7f0aa89a-104d-45eb-8248-ce205883cc8b&page=queryresults
[0m12:28:54.874156 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7178ba40>]}
[0m12:28:54.880113 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m12:28:54.883013 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:29:02.790317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89375220>]}
[0m12:29:02.795012 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 11.29s]
[0m12:29:02.797160 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:29:02.804831 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:29:02.805970 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:29:02.807111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:29:02.807973 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:29:02.824099 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:29:02.827880 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:29:02.831248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:29:03.194760 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:29:03.198293 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:29:03.574072 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e0c25cec-31a5-4982-8dce-f026785cbdfd&page=queryresults
[0m12:29:12.622517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8937bc50>]}
[0m12:29:12.641309 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 9.81s]
[0m12:29:12.649050 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:29:12.654539 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:29:12.656232 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:29:12.657801 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:29:12.665031 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:29:12.685569 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:29:12.689772 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:29:12.693347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:29:13.026806 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:29:13.036331 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m12:29:13.447125 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7232c4ac-4293-425d-be01-a1e0547da33d&page=queryresults
[0m12:29:21.673169 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d42ac9-e784-4602-a3fe-a63a770fbb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7177ce90>]}
[0m12:29:21.676089 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (1.6k rows, 293.5 MiB processed)[0m in 9.02s]
[0m12:29:21.678495 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:29:21.686068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:21.691215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:21.692157 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:29:21.693120 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:29:21.694001 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:29:21.695955 [info ] [MainThread]: 
[0m12:29:21.697378 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 31.14 seconds (31.14s).
[0m12:29:21.699435 [debug] [MainThread]: Command end result
[0m12:29:21.825422 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:29:21.832760 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:29:21.851351 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:29:21.852972 [info ] [MainThread]: 
[0m12:29:21.854370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:21.855197 [info ] [MainThread]: 
[0m12:29:21.856256 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:29:21.864877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.69647, "process_in_blocks": "0", "process_kernel_time": 1.557764, "process_mem_max_rss": "385992", "process_out_blocks": "0", "process_user_time": 6.115109}
[0m12:29:21.869011 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:21.868786 after 36.70 seconds
[0m12:29:21.873214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c23ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894a6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896399a0>]}
[0m12:29:21.875701 [debug] [MainThread]: Flushing usage events
[0m12:29:22.368700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:51.530054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7ce9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f95310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b30890>]}


============================== 12:33:51.536647 | 52e94104-013e-4985-a01e-9a8437d0f1c3 ==============================
[0m12:33:51.536647 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:33:51.537715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:53.837249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb78fb0>]}
[0m12:33:53.874761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b554ec0>]}
[0m12:33:53.876165 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:33:54.079999 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:33:54.201598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:33:54.203095 [debug] [MainThread]: Partial parsing: added file: france_air_pollution://snapshots/snapshot_staging_cities.yml
[0m12:33:54.442484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f37b8f0>]}
[0m12:33:54.569953 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:33:54.573666 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:33:54.592515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f406d80>]}
[0m12:33:54.593562 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:33:54.594220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f399850>]}
[0m12:33:54.596323 [info ] [MainThread]: 
[0m12:33:54.597648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:54.598387 [info ] [MainThread]: 
[0m12:33:54.599781 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:54.601373 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:33:54.602005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:55.088278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:33:55.091715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:55.452613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f399850>]}
[0m12:33:55.458043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:55.473584 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:33:55.476440 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m12:33:55.477935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m12:33:55.479869 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:33:55.493170 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:33:55.535533 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m12:33:55.536887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:56.130707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e71c9e79-2fe3-4849-b7f5-7e1ad5272331&page=queryresults
[0m12:33:56.957009 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m12:33:57.469385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d5c31af5-e538-4217-b1eb-b62b13f8f130&page=queryresults
[0m12:33:59.312230 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m12:33:59.759099 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:34:00.132758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:377fbb24-cb24-419a-904e-ab39d4e7921d&page=queryresults
[0m12:34:00.287186 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m12:34:00.517238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13a836ef-3306-4211-a750-6d849e4e5781&page=queryresults
[0m12:34:00.621302 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m12:34:00.642809 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m12:34:01.025988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d589674d-9116-46a0-9bbb-125e06f5eb20&page=queryresults
[0m12:34:02.865688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e94104-013e-4985-a01e-9a8437d0f1c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff745d5310>]}
[0m12:34:02.872831 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (0.0 rows, 10.5 KiB processed)[0m in 7.38s]
[0m12:34:02.881861 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m12:34:02.905003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:02.914026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:02.915544 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m12:34:02.916834 [info ] [MainThread]: 
[0m12:34:02.917818 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m12:34:02.919349 [debug] [MainThread]: Command end result
[0m12:34:03.055566 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:34:03.063260 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:34:03.074240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:34:03.075628 [info ] [MainThread]: 
[0m12:34:03.076726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:03.077642 [info ] [MainThread]: 
[0m12:34:03.078370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:34:03.084395 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.588987, "process_in_blocks": "0", "process_kernel_time": 1.425987, "process_mem_max_rss": "375568", "process_out_blocks": "0", "process_user_time": 3.82968}
[0m12:34:03.086379 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:34:03.086195 after 11.59 seconds
[0m12:34:03.087858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bc7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57773aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57643ad0>]}
[0m12:34:03.091205 [debug] [MainThread]: Flushing usage events
[0m12:34:03.605873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:07.880886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8319d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8326f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b830d70>]}


============================== 12:34:07.887278 | 9ae05158-4bd0-4158-a5a7-6992ad8336e0 ==============================
[0m12:34:07.887278 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:34:07.888978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:09.682179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff623766f0>]}
[0m12:34:09.716278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6210b1a0>]}
[0m12:34:09.717503 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:34:09.868673 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:34:09.977981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:09.979279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:10.036712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d49910>]}
[0m12:34:10.539851 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:34:10.544469 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:34:10.564039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7d6b70>]}
[0m12:34:10.565485 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:34:10.566359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7786b0>]}
[0m12:34:10.568913 [info ] [MainThread]: 
[0m12:34:10.569868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:10.570629 [info ] [MainThread]: 
[0m12:34:10.572536 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:10.575831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:34:10.576839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:11.006234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:34:11.007997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:11.428253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7d6b70>]}
[0m12:34:11.430844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:11.444073 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:34:11.444873 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:34:11.446341 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:34:11.448219 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:34:11.449892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:34:11.451320 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:34:11.453059 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:34:11.454309 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:34:11.471929 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:34:11.480026 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:34:11.484539 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:34:11.484917 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:34:11.502466 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:34:11.515686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:11.879943 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:34:11.882209 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:34:11.887051 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:34:11.887687 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:34:12.208908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1ef1ae39-b1cf-4e53-8f1f-1109d84c70f7&page=queryresults
[0m12:34:12.209833 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b38b05b2-bb94-4629-9900-e48167f04961&page=queryresults
[0m12:34:13.881501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61ada690>]}
[0m12:34:13.884870 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.43s]
[0m12:34:13.887711 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:34:13.889900 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:34:13.891341 [info ] [Thread-4 (]: 3 of 5 START sql view model development.dim_cities ............................. [RUN]
[0m12:34:13.895280 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:34:13.898153 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:34:13.980834 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:34:14.000795 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:34:14.023278 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:34:14.026934 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`dim_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL;


[0m12:34:14.028167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:34:14.561032 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d8dbd30-2743-4d5b-832c-31c4581a3760&page=queryresults
[0m12:34:14.766170 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b088e60>]}
[0m12:34:14.768063 [info ] [Thread-4 (]: 3 of 5 OK created sql view model development.dim_cities ........................ [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m12:34:14.769424 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:34:19.632306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61935460>]}
[0m12:34:19.637150 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.18s]
[0m12:34:19.639345 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:34:19.659803 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:34:19.666765 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:34:19.673767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:34:19.676772 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:34:19.695500 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:34:19.701936 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:34:19.710040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:34:20.024456 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:34:20.033174 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:34:20.306826 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a2c6fc9c-a557-425f-820c-51f93c31e37d&page=queryresults
[0m12:34:27.360200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff617b5a90>]}
[0m12:34:27.367901 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 7.69s]
[0m12:34:27.370718 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:34:27.376432 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:34:27.379883 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:34:27.382634 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:34:27.383907 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:34:27.400349 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:34:27.405655 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:34:27.409815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:34:27.718804 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:34:27.726202 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m12:34:28.081325 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4fb71cdb-bf7a-4424-ac29-73ea9ac74369&page=queryresults
[0m12:34:33.306233 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae05158-4bd0-4158-a5a7-6992ad8336e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603190a0>]}
[0m12:34:33.309605 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (1.6k rows, 293.5 MiB processed)[0m in 5.92s]
[0m12:34:33.312325 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:34:33.324751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:33.330505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:33.331948 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:34:33.333669 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:34:33.335519 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:34:33.339323 [info ] [MainThread]: 
[0m12:34:33.341594 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 22.77 seconds (22.77s).
[0m12:34:33.344198 [debug] [MainThread]: Command end result
[0m12:34:33.460514 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:34:33.467468 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:34:33.479325 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:34:33.480188 [info ] [MainThread]: 
[0m12:34:33.481108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:33.481855 [info ] [MainThread]: 
[0m12:34:33.482772 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:34:33.488039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.641253, "process_in_blocks": "0", "process_kernel_time": 0.905672, "process_mem_max_rss": "375184", "process_out_blocks": "0", "process_user_time": 4.012921}
[0m12:34:33.490558 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:33.490340 after 25.64 seconds
[0m12:34:33.495699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b667cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf82c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf82750>]}
[0m12:34:33.496586 [debug] [MainThread]: Flushing usage events
[0m12:34:33.963570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:04.303203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b8be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29e0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b8b020>]}


============================== 12:37:04.307954 | 0f099b38-17df-445e-b70c-d86be2b4e01f ==============================
[0m12:37:04.307954 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:37:04.308921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m12:37:07.056441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de88140>]}
[0m12:37:07.093900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d04ec0>]}
[0m12:37:07.095546 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:37:07.264039 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:37:07.339206 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:37:07.340392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bdd280>]}
[0m12:37:08.359798 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m12:37:08.426733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88371e20>]}
[0m12:37:08.592336 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:37:08.597736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:37:08.617505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e520c0>]}
[0m12:37:08.618370 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:37:08.619131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883e0aa0>]}
[0m12:37:08.621704 [info ] [MainThread]: 
[0m12:37:08.622374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:08.623065 [info ] [MainThread]: 
[0m12:37:08.623908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:08.627257 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:37:08.628044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:09.043191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:37:09.044887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:09.340083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8819b740>]}
[0m12:37:09.342147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:09.350220 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:37:09.350953 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:37:09.351849 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:37:09.355133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:37:09.354253 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:37:09.356031 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:37:09.357977 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:37:09.367738 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:37:09.368105 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:37:09.371549 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:37:09.373014 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:37:09.399228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:09.399677 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:37:09.438626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:37:09.756220 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:37:09.757074 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:37:09.760004 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:37:09.761887 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:37:10.082911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9c24bf57-4897-47cd-adee-f420303f45da&page=queryresults
[0m12:37:10.167294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0dca2803-04f3-4a34-a2d8-fccf78c9b190&page=queryresults
[0m12:37:12.027248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa332ca40>]}
[0m12:37:12.028924 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.67s]
[0m12:37:12.030401 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:37:12.032701 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:37:12.033720 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m12:37:12.036229 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:37:12.037309 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:37:12.040550 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:37:12.043962 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:37:12.046676 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:37:12.504361 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:37:12.512952 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m12:37:12.851074 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1c023ddc-6e2e-4164-aabb-017d7281e82e&page=queryresults
[0m12:37:14.509048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80263680>]}
[0m12:37:14.513209 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.47s]
[0m12:37:14.518132 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:37:20.564861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884e9f10>]}
[0m12:37:20.570008 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 11.21s]
[0m12:37:20.576253 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:37:20.581189 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:37:20.584557 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:37:20.586463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:37:20.590509 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:37:20.602951 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:37:20.607009 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:37:20.610925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:37:20.913985 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:37:20.921744 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
LEFT JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
AND 
    p.dt BETWEEN c.dbt_valid_from AND COALESCE(c.dbt_valid_to, CURRENT_TIMESTAMP())
ORDER BY 
    city, dt
    );
  
[0m12:37:21.330590 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:82ecf185-6551-40a2-946b-1fddbdc2a135&page=queryresults
[0m12:37:28.359212 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801fb800>]}
[0m12:37:28.370270 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 7.77s]
[0m12:37:28.373481 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:37:28.382120 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:37:28.383637 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:37:28.385115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:37:28.386275 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:37:28.425461 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:37:28.430159 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:37:28.436783 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:37:28.788346 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:37:28.793920 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m12:37:29.224279 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:829107ae-023a-4966-bf6f-2dbbab148dc9&page=queryresults
[0m12:37:33.523180 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f099b38-17df-445e-b70c-d86be2b4e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8827aba0>]}
[0m12:37:33.526802 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (1.6k rows, 293.5 MiB processed)[0m in 5.14s]
[0m12:37:33.528579 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:37:33.537198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:33.541429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:33.542165 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:37:33.542909 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:37:33.543545 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:37:33.544952 [info ] [MainThread]: 
[0m12:37:33.545813 [info ] [MainThread]: Finished running 3 incremental models, 2 table models in 0 hours 0 minutes and 24.92 seconds (24.92s).
[0m12:37:33.548079 [debug] [MainThread]: Command end result
[0m12:37:33.673553 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:37:33.681237 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:37:33.691777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:37:33.692444 [info ] [MainThread]: 
[0m12:37:33.693526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:33.696474 [info ] [MainThread]: 
[0m12:37:33.697373 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:37:33.701765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.425991, "process_in_blocks": "0", "process_kernel_time": 1.571444, "process_mem_max_rss": "385320", "process_out_blocks": "0", "process_user_time": 5.130424}
[0m12:37:33.703225 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:33.703071 after 29.43 seconds
[0m12:37:33.704642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2dd9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88168860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8816a7e0>]}
[0m12:37:33.705438 [debug] [MainThread]: Flushing usage events
[0m12:37:34.192138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:59.205773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57b2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fbcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57b3980>]}


============================== 12:41:59.210907 | 03ed92aa-301c-493b-ba68-0927283cae08 ==============================
[0m12:41:59.210907 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:41:59.211924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:42:01.689467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7cec00>]}
[0m12:42:01.726415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b768b90>]}
[0m12:42:01.727957 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:42:01.907797 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:42:02.014191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:02.015562 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m12:42:02.474670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aea3440>]}
[0m12:42:02.593158 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:42:02.597211 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:42:02.614947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b143f80>]}
[0m12:42:02.616014 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:42:02.616802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afa83b0>]}
[0m12:42:02.619193 [info ] [MainThread]: 
[0m12:42:02.620190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:02.620923 [info ] [MainThread]: 
[0m12:42:02.622103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:02.625133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:42:02.625859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:04.118182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:42:04.120597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:04.556695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af870e0>]}
[0m12:42:04.559467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:04.575768 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:42:04.576410 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:42:04.578345 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:42:04.581631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:42:04.582583 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:42:04.579942 [info ] [Thread-2 (]: 2 of 5 START sql table model development.staging_cities ........................ [RUN]
[0m12:42:04.592382 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:42:04.592874 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:42:04.595457 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:42:04.598688 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:42:04.599712 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:42:04.618714 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:42:04.622261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:04.628907 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:04.952607 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:42:04.956448 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
    );
  
[0m12:42:04.963804 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:42:04.966478 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:42:05.393114 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f49a7bae-7637-4068-ad4b-981016061f48&page=queryresults
[0m12:42:05.394889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2d004e80-7714-40a1-8c69-36b08fb3549c&page=queryresults
[0m12:42:07.012559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01f13a0>]}
[0m12:42:07.015443 [info ] [Thread-2 (]: 2 of 5 OK created sql table model development.staging_cities ................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.42s]
[0m12:42:07.017859 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:42:07.021293 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:42:07.023598 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m12:42:07.026225 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:42:07.027501 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:42:07.032168 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:42:07.037020 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:42:07.039954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:07.305478 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:42:07.311372 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m12:42:07.772273 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fa702371-0435-471a-9cff-f492572d6abf&page=queryresults
[0m12:42:09.315331 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982e3560>]}
[0m12:42:09.319080 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.29s]
[0m12:42:09.323629 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:42:12.048479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98131b80>]}
[0m12:42:12.050668 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 7.47s]
[0m12:42:12.052212 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:42:12.054384 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:42:12.056095 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:42:12.057249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:42:12.058045 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:42:12.065848 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:42:12.070751 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:42:12.075670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:12.352548 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:42:12.357203 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m12:42:12.806751 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:702122d0-700a-404f-8ea5-63e522566a14&page=queryresults
[0m12:42:19.511539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada1700>]}
[0m12:42:19.516486 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 7.45s]
[0m12:42:19.518878 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:42:19.523916 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:42:19.525422 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m12:42:19.526828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m12:42:19.527709 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m12:42:19.545289 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:42:19.549300 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m12:42:19.552732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:42:19.887197 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m12:42:19.890147 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m12:42:20.238906 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:db3e2dcd-8b2d-481c-b159-860be439f029&page=queryresults
[0m12:42:26.961074 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ed92aa-301c-493b-ba68-0927283cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9812c5f0>]}
[0m12:42:26.965211 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.6k rows, 401.1 MiB processed)[0m in 7.43s]
[0m12:42:26.970142 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:42:26.978927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:26.989945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:26.991558 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:42:26.993079 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:42:26.994332 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m12:42:26.996222 [info ] [MainThread]: 
[0m12:42:26.997881 [info ] [MainThread]: Finished running 3 incremental models, 2 table models in 0 hours 0 minutes and 24.37 seconds (24.37s).
[0m12:42:27.001491 [debug] [MainThread]: Command end result
[0m12:42:27.119514 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:42:27.126525 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:42:27.135973 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:42:27.136656 [info ] [MainThread]: 
[0m12:42:27.137513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:27.138165 [info ] [MainThread]: 
[0m12:42:27.138888 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:27.143398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.974714, "process_in_blocks": "0", "process_kernel_time": 1.640702, "process_mem_max_rss": "379408", "process_out_blocks": "0", "process_user_time": 4.055284}
[0m12:42:27.144740 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:27.144589 after 27.98 seconds
[0m12:42:27.149517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57b3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57b26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57b3650>]}
[0m12:42:27.151010 [debug] [MainThread]: Flushing usage events
[0m12:42:27.715518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:27.718041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c6a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66dc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c694f0>]}


============================== 12:55:27.723125 | d1f60728-3f83-4507-a068-26cb9e6a7dc1 ==============================
[0m12:55:27.723125 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:55:27.724090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m12:55:29.487511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cacdca0>]}
[0m12:55:29.518896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc1d9a0>]}
[0m12:55:29.520096 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:55:29.666351 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m12:55:29.741908 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:55:29.745191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64e1400>]}
[0m12:55:30.766792 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m12:55:30.829136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc4c590>]}
[0m12:55:30.967531 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:55:30.974684 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:55:30.994972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc4c6e0>]}
[0m12:55:30.995773 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m12:55:30.996599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8daf30>]}
[0m12:55:30.998925 [info ] [MainThread]: 
[0m12:55:30.999591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:31.000249 [info ] [MainThread]: 
[0m12:55:31.001124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:55:31.004394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m12:55:31.005353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:31.425097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m12:55:31.427249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:31.733926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5d5d90>]}
[0m12:55:31.735918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:31.744618 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m12:55:31.745200 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m12:55:31.746145 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m12:55:31.747427 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m12:55:31.749072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m12:55:31.751137 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m12:55:31.752100 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m12:55:31.753074 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m12:55:31.762963 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m12:55:31.765510 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m12:55:31.770269 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m12:55:31.770758 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m12:55:31.782941 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:55:31.800708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:32.229699 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m12:55:32.249109 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m12:55:32.250011 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m12:55:32.252470 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m12:55:32.589643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d1f5fa7-6952-4769-a6c4-ca6ca6cb4a96&page=queryresults
[0m12:55:32.597448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:66d1d150-6b36-48d7-99d7-c050e43b7a54&page=queryresults
[0m12:55:32.915563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c30890>]}
[0m12:55:32.916846 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m12:55:32.918084 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m12:55:32.919190 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m12:55:32.920050 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m12:55:32.921460 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m12:55:32.922278 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m12:55:32.925584 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m12:55:32.928607 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m12:55:32.936958 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:55:33.249710 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m12:55:33.256356 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m12:55:33.552736 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1fbeddb4-70d5-40fa-bf61-43023c3d974a&page=queryresults
[0m12:55:33.555405 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1fbeddb4-70d5-40fa-bf61-43023c3d974a&page=queryresults
[0m12:55:33.590917 [debug] [Thread-4 (]: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:55:33.594656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b99f050>]}
[0m12:55:33.598792 [error] [Thread-4 (]: 3 of 5 ERROR creating sql table model development.dim_cities ................... [[31mERROR[0m in 0.67s]
[0m12:55:33.601229 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m12:55:33.603513 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.dim_cities' to be skipped because of status 'error'.  Reason: Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql.
[0m12:55:40.442451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8c7b30>]}
[0m12:55:40.446747 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.69s]
[0m12:55:40.449206 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m12:55:40.452709 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m12:55:40.454935 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m12:55:40.456446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m12:55:40.457413 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m12:55:40.466133 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m12:55:40.470700 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m12:55:40.473909 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:55:40.770997 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m12:55:40.779639 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m12:55:41.239958 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eba18fd7-3cc7-4fbc-afa0-1753da0410c6&page=queryresults
[0m12:55:41.241141 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eba18fd7-3cc7-4fbc-afa0-1753da0410c6&page=queryresults
[0m12:55:41.247143 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:55:41.248890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f60728-3f83-4507-a068-26cb9e6a7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8814da30>]}
[0m12:55:41.252149 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.79s]
[0m12:55:41.254474 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m12:55:41.259821 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql.
[0m12:55:41.262033 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m12:55:41.264329 [info ] [Thread-4 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m12:55:41.265352 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m12:55:41.268252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:41.271570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:41.273784 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m12:55:41.275970 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m12:55:41.277105 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m12:55:41.278468 [info ] [MainThread]: 
[0m12:55:41.279458 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m12:55:41.281021 [debug] [MainThread]: Command end result
[0m12:55:41.412070 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m12:55:41.419728 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m12:55:41.436707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m12:55:41.438534 [info ] [MainThread]: 
[0m12:55:41.440109 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:55:41.441135 [info ] [MainThread]: 
[0m12:55:41.443111 [error] [MainThread]: [31mFailure in model dim_cities (models/dim/dim_cities.sql)[0m
[0m12:55:41.444247 [error] [MainThread]:   Database Error in model dim_cities (models/dim/dim_cities.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/dim/dim_cities.sql
[0m12:55:41.445302 [info ] [MainThread]: 
[0m12:55:41.445942 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/dim/dim_cities.sql
[0m12:55:41.447305 [info ] [MainThread]: 
[0m12:55:41.448623 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m12:55:41.450862 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Not found: Table paris-air-pollution-quangnc:development.snapshot_staging_cities was not found in location europe-west2
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:55:41.453790 [info ] [MainThread]: 
[0m12:55:41.454583 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m12:55:41.455242 [info ] [MainThread]: 
[0m12:55:41.456159 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=5
[0m12:55:41.461759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.83846, "process_in_blocks": "0", "process_kernel_time": 0.933676, "process_mem_max_rss": "386936", "process_out_blocks": "0", "process_user_time": 4.226325}
[0m12:55:41.463128 [debug] [MainThread]: Command `dbt run` failed at 12:55:41.462931 after 13.84 seconds
[0m12:55:41.464443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6aafb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88270290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88272ff0>]}
[0m12:55:41.465290 [debug] [MainThread]: Flushing usage events
[0m12:55:41.931388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:45.510108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf26270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf08ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaced71a0>]}


============================== 13:37:45.515847 | 06c72144-455a-4ab9-8eb9-2459353e80e5 ==============================
[0m13:37:45.515847 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:37:45.516849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging_air_pollution', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:37:48.057524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed3b830>]}
[0m13:37:48.089031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee14e30>]}
[0m13:37:48.090129 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:37:48.232980 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:37:48.306267 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:37:48.307386 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m13:37:48.308351 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:37:48.309228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd01550>]}
[0m13:37:49.321430 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:37:49.393908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9226cf50>]}
[0m13:37:49.532493 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:37:49.538328 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:37:49.572807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92049640>]}
[0m13:37:49.574007 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:37:49.574860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92456420>]}
[0m13:37:49.578072 [info ] [MainThread]: 
[0m13:37:49.579939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:49.582961 [info ] [MainThread]: 
[0m13:37:49.589830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:37:49.594821 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:37:49.595985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:50.059363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:37:50.061261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:50.352311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9323e540>]}
[0m13:37:50.354057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:50.369864 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m13:37:50.371214 [info ] [Thread-1 (]: 1 of 1 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m13:37:50.373437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m13:37:50.374220 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m13:37:50.390385 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m13:37:50.396403 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m13:37:50.447953 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m13:37:50.450828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:51.086926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b966f41c-d512-428d-b6fd-66abd030677d&page=queryresults
[0m13:37:53.190104 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:37:53.213688 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m13:37:53.217525 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m13:37:53.548166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:67797cae-2ed6-4908-b078-75ff6b8882e7&page=queryresults
[0m13:37:55.333287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c72144-455a-4ab9-8eb9-2459353e80e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90539a90>]}
[0m13:37:55.335949 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.96s]
[0m13:37:55.339870 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m13:37:55.350119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:55.357575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:55.359068 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m13:37:55.360881 [info ] [MainThread]: 
[0m13:37:55.362525 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m13:37:55.366748 [debug] [MainThread]: Command end result
[0m13:37:55.677205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:37:55.687082 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:37:55.696194 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:37:55.696947 [info ] [MainThread]: 
[0m13:37:55.698664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:55.699384 [info ] [MainThread]: 
[0m13:37:55.700261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:37:55.704392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.232031, "process_in_blocks": "11768", "process_kernel_time": 1.779201, "process_mem_max_rss": "383464", "process_out_blocks": "0", "process_user_time": 4.374801}
[0m13:37:55.706489 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:55.706316 after 10.23 seconds
[0m13:37:55.708445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccaf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92049670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92426180>]}
[0m13:37:55.709341 [debug] [MainThread]: Flushing usage events
[0m13:37:56.184092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:19.434702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11e14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b5eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb140db20>]}


============================== 13:38:19.439990 | cff195ae-1845-4ae9-aeeb-d10299b60599 ==============================
[0m13:38:19.439990 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:38:19.440993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging_cities', 'send_anonymous_usage_stats': 'True'}
[0m13:38:21.919993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c159a0>]}
[0m13:38:21.963574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fa7980>]}
[0m13:38:21.965304 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:38:22.145341 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:38:22.242567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:22.243610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:22.279509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a69c70>]}
[0m13:38:22.514692 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:38:22.518461 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:38:22.535346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cd59a0>]}
[0m13:38:22.536139 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:38:22.536912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97015940>]}
[0m13:38:22.538769 [info ] [MainThread]: 
[0m13:38:22.539768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:22.541654 [info ] [MainThread]: 
[0m13:38:22.543206 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:22.546609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m13:38:22.547429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:22.858599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff195ae-1845-4ae9-aeeb-d10299b60599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cd5b50>]}
[0m13:38:22.860381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:22.867495 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m13:38:22.868389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m13:38:22.869298 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m13:38:22.877301 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m13:38:22.882942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:22.886251 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m13:38:22.889126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:22.895293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:22.897566 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m13:38:22.898281 [info ] [MainThread]: 
[0m13:38:22.899167 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:38:22.900285 [debug] [MainThread]: Command end result
[0m13:38:23.093598 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:38:23.098328 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:38:23.103135 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:38:23.105636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7065804, "process_in_blocks": "0", "process_kernel_time": 1.514586, "process_mem_max_rss": "367548", "process_out_blocks": "0", "process_user_time": 3.221306}
[0m13:38:23.106558 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:23.106442 after 3.71 seconds
[0m13:38:23.107357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb013d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb280b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9699f260>]}
[0m13:38:23.107922 [debug] [MainThread]: Flushing usage events
[0m13:38:23.504248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:49.345342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93493ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9586e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9358f5c0>]}


============================== 13:38:49.349041 | bafde7d2-9b8f-41cb-9049-7c23cbfbbef9 ==============================
[0m13:38:49.349041 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:38:49.350153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:51.256478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ad2540>]}
[0m13:38:51.288960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79fdfd40>]}
[0m13:38:51.290020 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:38:51.424300 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m13:38:51.495240 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:38:51.496208 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m13:38:51.496971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7991b560>]}
[0m13:38:52.421398 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:38:52.503841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789dc5f0>]}
[0m13:38:52.769465 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:38:52.775827 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:38:52.808859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a8ae40>]}
[0m13:38:52.810415 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:38:52.811235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a40e00>]}
[0m13:38:52.814818 [info ] [MainThread]: 
[0m13:38:52.816044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:52.817250 [info ] [MainThread]: 
[0m13:38:52.819472 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:52.824062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:38:52.825841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:53.279001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:38:53.283982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:53.565568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e4fe60>]}
[0m13:38:53.566978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:53.573123 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:38:53.574320 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m13:38:53.575564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m13:38:53.576383 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:38:53.591775 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m13:38:53.596752 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:38:53.648927 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



with __dbt__cte__staging_cities as (
WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
) SELECT * FROM __dbt__cte__staging_cities

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m13:38:53.650065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:54.169955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:230fcdc7-323c-4179-87b1-70bba902c9c8&page=queryresults
[0m13:38:54.463194 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m13:38:54.765750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4d04a5c8-3c87-41d4-b614-892c0fbea52f&page=queryresults
[0m13:38:54.904492 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m13:38:54.910319 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



with __dbt__cte__staging_cities as (
WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities
) SELECT * FROM __dbt__cte__staging_cities

    ) sbq



    );
  
  
[0m13:38:55.241871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c3abe480-7309-497b-a9af-23560c7b2919&page=queryresults
[0m13:38:57.144794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafde7d2-9b8f-41cb-9049-7c23cbfbbef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713bb530>]}
[0m13:38:57.147723 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 3.57s]
[0m13:38:57.150041 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:38:57.154866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:57.158087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:57.158818 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m13:38:57.159740 [info ] [MainThread]: 
[0m13:38:57.162374 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m13:38:57.164583 [debug] [MainThread]: Command end result
[0m13:38:57.272429 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:38:57.278228 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:38:57.284793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:38:57.285461 [info ] [MainThread]: 
[0m13:38:57.286494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:57.287235 [info ] [MainThread]: 
[0m13:38:57.287930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:38:57.291190 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.9798236, "process_in_blocks": "0", "process_kernel_time": 0.970317, "process_mem_max_rss": "383324", "process_out_blocks": "0", "process_user_time": 3.994169}
[0m13:38:57.293080 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:38:57.292897 after 7.98 seconds
[0m13:38:57.294488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956f6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ab0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a4cd10>]}
[0m13:38:57.295332 [debug] [MainThread]: Flushing usage events
[0m13:38:57.772359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:23.314670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8640f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8819fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86197e00>]}


============================== 13:49:23.319310 | fc759fc7-3316-4966-83b9-5f045adcf947 ==============================
[0m13:49:23.319310 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:49:23.320537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging_cities', 'send_anonymous_usage_stats': 'True'}
[0m13:49:25.253676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ca81160>]}
[0m13:49:25.287823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e9b82f0>]}
[0m13:49:25.289270 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:49:25.453058 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:49:25.531609 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:49:25.541171 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m13:49:25.573597 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:49:25.587799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86195250>]}
[0m13:49:26.502260 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:49:26.562500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b81d430>]}
[0m13:49:26.689612 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:49:26.693125 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:49:26.728149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b525040>]}
[0m13:49:26.729235 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:49:26.730025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b8d0e90>]}
[0m13:49:26.731868 [info ] [MainThread]: 
[0m13:49:26.732677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:26.733459 [info ] [MainThread]: 
[0m13:49:26.734457 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:49:26.736076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:49:26.737019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:27.145074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:49:27.146287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:27.448001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b8d03b0>]}
[0m13:49:27.450133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:27.461362 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m13:49:27.462898 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m13:49:27.464742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m13:49:27.465831 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m13:49:27.473463 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m13:49:27.479148 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m13:49:27.500836 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m13:49:27.504046 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m13:49:27.506241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:28.074032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6eecbcc9-eef2-4ddb-9820-99d79db4ccab&page=queryresults
[0m13:49:28.491634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc759fc7-3316-4966-83b9-5f045adcf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868e07d0>]}
[0m13:49:28.492841 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:49:28.493777 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m13:49:28.495544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:28.497568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:28.498228 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m13:49:28.498898 [info ] [MainThread]: 
[0m13:49:28.499699 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m13:49:28.500655 [debug] [MainThread]: Command end result
[0m13:49:28.582708 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:49:28.586023 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:49:28.591260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:49:28.591962 [info ] [MainThread]: 
[0m13:49:28.592672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:28.593336 [info ] [MainThread]: 
[0m13:49:28.593986 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:49:28.595655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.319852, "process_in_blocks": "0", "process_kernel_time": 1.060207, "process_mem_max_rss": "383124", "process_out_blocks": "0", "process_user_time": 3.794533}
[0m13:49:28.596413 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:28.596305 after 5.32 seconds
[0m13:49:28.597083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8675f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868e25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868e3530>]}
[0m13:49:28.597818 [debug] [MainThread]: Flushing usage events
[0m13:49:29.062382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:34.561621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54bd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5947a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fc5fa0>]}


============================== 13:49:34.564767 | 868b7fba-638c-43f2-a294-2dc19edc2c08 ==============================
[0m13:49:34.564767 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:49:34.565902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:36.020535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7ab0e0>]}
[0m13:49:36.064651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8beba240>]}
[0m13:49:36.075340 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:49:36.245729 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m13:49:36.317582 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:49:36.318671 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m13:49:36.319556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5370fe0>]}
[0m13:49:37.170283 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:49:37.230292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa1e960>]}
[0m13:49:37.350207 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:49:37.353540 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:49:37.367377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a901910>]}
[0m13:49:37.368061 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:49:37.368687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8cf8f0>]}
[0m13:49:37.370502 [info ] [MainThread]: 
[0m13:49:37.371076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:37.371575 [info ] [MainThread]: 
[0m13:49:37.372366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:49:37.373503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:49:37.374111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:37.782110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:49:37.785169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:38.070740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac11940>]}
[0m13:49:38.072064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:38.077565 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:49:38.078659 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m13:49:38.079872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m13:49:38.081138 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:49:38.087375 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:49:38.141519 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m13:49:38.145510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:38.930756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b69e1dd3-8a94-4968-b24d-830253b9716c&page=queryresults
[0m13:49:39.714021 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m13:49:40.556320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:163aef1d-edf9-4a0d-87b7-662abe94d983&page=queryresults
[0m13:49:42.579939 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m13:49:43.033482 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m13:49:43.638235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3aacb738-277c-4e65-980c-7b24613d14fb&page=queryresults
[0m13:49:43.750478 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m13:49:44.046303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d6e6462f-82f3-44d0-b3b5-80049dbb749c&page=queryresults
[0m13:49:44.148573 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m13:49:44.152884 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m13:49:44.551293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c03e79b0-e77c-4f28-a395-3cf9b13f23d1&page=queryresults
[0m13:49:46.894945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '868b7fba-638c-43f2-a294-2dc19edc2c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88454e30>]}
[0m13:49:46.897084 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (2.0 rows, 10.8 KiB processed)[0m in 8.81s]
[0m13:49:46.898669 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:49:46.902097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:46.905247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:46.905861 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m13:49:46.906671 [info ] [MainThread]: 
[0m13:49:46.907507 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m13:49:46.908816 [debug] [MainThread]: Command end result
[0m13:49:47.037164 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:49:47.041682 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:49:47.047106 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:49:47.047692 [info ] [MainThread]: 
[0m13:49:47.048609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:47.049193 [info ] [MainThread]: 
[0m13:49:47.049854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:49:47.051900 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.523963, "process_in_blocks": "0", "process_kernel_time": 0.604249, "process_mem_max_rss": "384032", "process_out_blocks": "0", "process_user_time": 3.843756}
[0m13:49:47.053043 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:49:47.052890 after 12.53 seconds
[0m13:49:47.053920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54bcaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac336e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885ae7e0>]}
[0m13:49:47.054618 [debug] [MainThread]: Flushing usage events
[0m13:49:47.425895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:06.344495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fbaa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3eb3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45c1580>]}


============================== 13:59:06.348825 | b1e858be-1449-4e08-acde-141dea3e25a7 ==============================
[0m13:59:06.348825 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:59:06.350607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging_cities', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:09.814662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a184ef0>]}
[0m13:59:09.848278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4333590>]}
[0m13:59:09.849447 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:59:10.046267 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:59:10.135572 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:59:10.136908 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m13:59:10.137772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99da3230>]}
[0m13:59:11.642568 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:59:11.724645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99277020>]}
[0m13:59:11.864677 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:59:11.881567 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:59:11.908084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99149640>]}
[0m13:59:11.908990 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:59:11.909863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992d0b90>]}
[0m13:59:11.912049 [info ] [MainThread]: 
[0m13:59:11.913011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:11.913695 [info ] [MainThread]: 
[0m13:59:11.914601 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:11.916379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:59:11.917291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:12.356414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:59:12.358002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:12.687069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9941eea0>]}
[0m13:59:12.688433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:12.707165 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m13:59:12.710080 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m13:59:12.712125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m13:59:12.713223 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m13:59:12.722575 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m13:59:12.729011 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m13:59:12.757214 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m13:59:12.761413 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m13:59:12.762571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:13.292934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c619e6e5-3e39-474f-90f9-31374037a4de&page=queryresults
[0m13:59:13.674288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e858be-1449-4e08-acde-141dea3e25a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fb87d0>]}
[0m13:59:13.675790 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m13:59:13.676918 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m13:59:13.679639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:13.683682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:13.685174 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m13:59:13.686893 [info ] [MainThread]: 
[0m13:59:13.688810 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m13:59:13.690784 [debug] [MainThread]: Command end result
[0m13:59:13.784506 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:59:13.789906 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:59:13.798388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m13:59:13.799540 [info ] [MainThread]: 
[0m13:59:13.800687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:13.801449 [info ] [MainThread]: 
[0m13:59:13.802252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:59:13.805494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.501553, "process_in_blocks": "0", "process_kernel_time": 1.460828, "process_mem_max_rss": "382788", "process_out_blocks": "0", "process_user_time": 5.391783}
[0m13:59:13.807176 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:13.806926 after 7.50 seconds
[0m13:59:13.808156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb527cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9945d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9939da00>]}
[0m13:59:13.809430 [debug] [MainThread]: Flushing usage events
[0m13:59:14.385096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:22.682677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b131b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac0aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a815820>]}


============================== 13:59:22.686250 | bb35c847-4d32-4ba7-96e3-4ad33f864ea5 ==============================
[0m13:59:22.686250 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:59:22.687477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:24.528086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71546b40>]}
[0m13:59:24.561374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71273800>]}
[0m13:59:24.562557 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:59:24.718089 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m13:59:24.793449 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:59:24.795029 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m13:59:24.795760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abc1430>]}
[0m13:59:25.908619 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m13:59:26.124747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fc8080>]}
[0m13:59:26.499666 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m13:59:26.506905 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m13:59:26.533332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63e70920>]}
[0m13:59:26.534674 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m13:59:26.535788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70cf9100>]}
[0m13:59:26.538802 [info ] [MainThread]: 
[0m13:59:26.539625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:26.541285 [info ] [MainThread]: 
[0m13:59:26.545017 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:59:26.546931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m13:59:26.547671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:26.966806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m13:59:26.968005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:27.301105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63eb2ea0>]}
[0m13:59:27.303314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:27.314212 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:59:27.317786 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m13:59:27.320880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m13:59:27.322853 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:59:27.334414 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m13:59:27.380822 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m13:59:27.382267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:28.160101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f14488c2-d6cb-49a4-9023-d0c7acdf4138&page=queryresults
[0m13:59:29.015039 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m13:59:29.617806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:66834fe9-7429-4597-a552-d8d9d12a0ae7&page=queryresults
[0m14:00:05.312986 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m14:00:05.856662 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m14:00:06.539910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74db5909-0263-4d2e-8a21-b9ad7d0ad1e5&page=queryresults
[0m14:00:06.661396 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m14:00:07.051570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:914e5500-953e-468a-bfd5-160ef6e5e996&page=queryresults
[0m14:00:07.133456 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m14:00:07.137860 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m14:00:07.447118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d20fbb22-a11b-4f5f-94f9-65945892e2c3&page=queryresults
[0m14:00:10.069688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb35c847-4d32-4ba7-96e3-4ad33f864ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d51520>]}
[0m14:00:10.080700 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (2.0 rows, 10.9 KiB processed)[0m in 42.74s]
[0m14:00:10.087746 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m14:00:10.093605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:10.111117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:10.112344 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m14:00:10.113351 [info ] [MainThread]: 
[0m14:00:10.114605 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 43.57 seconds (43.57s).
[0m14:00:10.119937 [debug] [MainThread]: Command end result
[0m14:00:10.357654 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:00:10.365053 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:00:10.376245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:00:10.377384 [info ] [MainThread]: 
[0m14:00:10.380150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:10.382937 [info ] [MainThread]: 
[0m14:00:10.388431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:00:10.399259 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 47.759525, "process_in_blocks": "0", "process_kernel_time": 0.843908, "process_mem_max_rss": "384016", "process_out_blocks": "0", "process_user_time": 4.675848}
[0m14:00:10.405047 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:00:10.404803 after 47.77 seconds
[0m14:00:10.407879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac98110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63e82060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701eed50>]}
[0m14:00:10.409695 [debug] [MainThread]: Flushing usage events
[0m14:00:10.906872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:04.216445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8364c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80105670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80105730>]}


============================== 14:02:04.223040 | 9823499a-b354-4d38-b0f3-8790f85557eb ==============================
[0m14:02:04.223040 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:02:04.224097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select staging_cities', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:06.392582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f957e90>]}
[0m14:02:06.426147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff666ef6e0>]}
[0m14:02:06.427379 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:02:06.579288 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:02:06.651433 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:02:06.652628 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m14:02:06.653317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80105280>]}
[0m14:02:07.543496 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m14:02:07.611644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658974d0>]}
[0m14:02:07.854260 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:02:07.859087 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:02:07.877754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6568a1e0>]}
[0m14:02:07.878410 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:02:07.879143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658c1c70>]}
[0m14:02:07.880901 [info ] [MainThread]: 
[0m14:02:07.881553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:07.882230 [info ] [MainThread]: 
[0m14:02:07.883193 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:02:07.884406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:02:07.885060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:08.329604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:02:08.333533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:08.654841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8222cfe0>]}
[0m14:02:08.658382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:08.670542 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m14:02:08.672616 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m14:02:08.675307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m14:02:08.676995 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:02:08.686354 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:02:08.690152 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:02:08.711890 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:02:08.714969 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:02:08.715698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:09.233418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b884d1d8-dd9d-4c05-91d1-9e5534345c9b&page=queryresults
[0m14:02:09.597264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9823499a-b354-4d38-b0f3-8790f85557eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8084c9b0>]}
[0m14:02:09.598426 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m14:02:09.599324 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:02:09.600971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:09.603428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:09.604042 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m14:02:09.604725 [info ] [MainThread]: 
[0m14:02:09.605454 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m14:02:09.606417 [debug] [MainThread]: Command end result
[0m14:02:09.697137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:02:09.701017 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:02:09.706246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:02:09.706864 [info ] [MainThread]: 
[0m14:02:09.707594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:09.708234 [info ] [MainThread]: 
[0m14:02:09.708956 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:02:09.710470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.533991, "process_in_blocks": "0", "process_kernel_time": 1.306081, "process_mem_max_rss": "382740", "process_out_blocks": "0", "process_user_time": 3.971345}
[0m14:02:09.711288 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:09.711188 after 5.53 seconds
[0m14:02:09.711971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807eb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8222cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65a008f0>]}
[0m14:02:09.712595 [debug] [MainThread]: Flushing usage events
[0m14:02:10.256141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:30.987408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82676ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805177d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa94bf0>]}


============================== 14:02:30.991246 | 8fae897f-f42d-4fe2-b695-dffeb2eb76b9 ==============================
[0m14:02:30.991246 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:02:30.993086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:02:32.954139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff664b1dc0>]}
[0m14:02:33.003503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff664e0920>]}
[0m14:02:33.004696 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:02:33.263677 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:02:33.348145 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:02:33.349557 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m14:02:33.350839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff41520>]}
[0m14:02:34.402915 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m14:02:34.488628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653f75c0>]}
[0m14:02:34.686004 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:02:34.691112 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:02:34.710780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652c6900>]}
[0m14:02:34.711799 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:02:34.713007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff654ed430>]}
[0m14:02:34.715391 [info ] [MainThread]: 
[0m14:02:34.716247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:34.717059 [info ] [MainThread]: 
[0m14:02:34.718603 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:02:34.724029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:02:34.724988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:35.124696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m14:02:35.125464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:35.455221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff654fec60>]}
[0m14:02:35.456614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:35.462471 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:02:35.462897 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:02:35.463881 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:02:35.465239 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:02:35.466169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:02:35.468534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now model.france_air_pollution.staging_cities)
[0m14:02:35.470404 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:02:35.469223 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:02:35.478884 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:02:35.483410 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:02:35.486549 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:02:35.507082 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:02:35.507490 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:02:35.535487 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:02:35.541805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:02:35.557718 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:02:35.559419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:35.993673 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:29206b6b-fcee-459e-adc8-368b33c81397&page=queryresults
[0m14:02:36.137707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1e82cab3-77c3-4e47-8b12-4237c86e137d&page=queryresults
[0m14:02:36.316872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b0d1160>]}
[0m14:02:36.318226 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:02:36.319557 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:02:36.320718 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:02:36.321643 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:02:36.322713 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:02:36.323569 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:02:36.327808 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:02:36.332872 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:02:36.344226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:02:36.638672 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:02:36.641665 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:02:36.954897 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74e5d53f-dcce-4149-87b6-5d4d75acd64b&page=queryresults
[0m14:02:38.211536 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:02:38.233451 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:02:38.236632 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:02:38.415116 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff651ed2e0>]}
[0m14:02:38.416655 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.8 KiB processed)[0m in 2.09s]
[0m14:02:38.418194 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:02:38.668701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4ddbed3e-269a-4e27-b4b0-7be099fd6ac1&page=queryresults
[0m14:02:40.696363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff4d3b0860>]}
[0m14:02:40.700193 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.23s]
[0m14:02:40.702377 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:02:40.705657 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:02:40.706785 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:02:40.707864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:02:40.708797 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:02:40.716248 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:02:40.721867 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:02:40.727543 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:02:40.729040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:02:41.284245 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:24540f49-e210-4d63-9934-13e32052aa22&page=queryresults
[0m14:02:43.342639 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:02:43.345596 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:02:43.351303 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:02:43.835941 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e05ccc5b-f1fd-48ee-bd7a-a502bcfe3c99&page=queryresults
[0m14:02:45.282777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff4d533b00>]}
[0m14:02:45.285108 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.57s]
[0m14:02:45.289103 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:02:45.292391 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:02:45.293538 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:02:45.298089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:02:45.301621 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:02:45.321796 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:02:45.325953 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:02:45.339878 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

  AND date > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:02:45.341194 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:02:45.987536 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15e25a3b-f8d6-4946-87f3-31c2d74198e7&page=queryresults
[0m14:02:46.070506 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15e25a3b-f8d6-4946-87f3-31c2d74198e7&page=queryresults
[0m14:02:46.090778 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:7]
[0m14:02:46.094006 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fae897f-f42d-4fe2-b695-dffeb2eb76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff4d470d70>]}
[0m14:02:46.096838 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.80s]
[0m14:02:46.098118 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:02:46.099928 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:7].
[0m14:02:46.110094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:46.118106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:46.119388 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:02:46.120552 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:02:46.121566 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:02:46.125571 [info ] [MainThread]: 
[0m14:02:46.126796 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m14:02:46.129475 [debug] [MainThread]: Command end result
[0m14:02:46.227688 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:02:46.232756 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:02:46.240619 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:02:46.241772 [info ] [MainThread]: 
[0m14:02:46.242682 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:02:46.243619 [info ] [MainThread]: 
[0m14:02:46.244289 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:02:46.244951 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:7]
[0m14:02:46.245675 [info ] [MainThread]: 
[0m14:02:46.246629 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:02:46.247307 [info ] [MainThread]: 
[0m14:02:46.248322 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:02:46.252184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.303171, "process_in_blocks": "0", "process_kernel_time": 0.88607, "process_mem_max_rss": "385668", "process_out_blocks": "0", "process_user_time": 4.664178}
[0m14:02:46.253346 [debug] [MainThread]: Command `dbt run` failed at 14:02:46.253253 after 15.30 seconds
[0m14:02:46.254288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e10d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff654c65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff654fdeb0>]}
[0m14:02:46.255503 [debug] [MainThread]: Flushing usage events
[0m14:02:46.731240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:19.345789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cefa270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d640cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cef9b20>]}


============================== 14:05:19.350379 | 872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb ==============================
[0m14:05:19.350379 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:19.351475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.767517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8356a1b0>]}
[0m14:05:21.808213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835fa690>]}
[0m14:05:21.809767 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:05:22.143435 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:05:22.247323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:22.248857 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m14:05:22.657070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d896a0>]}
[0m14:05:22.780526 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:05:22.783953 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:05:22.802741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ef8080>]}
[0m14:05:22.803715 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:05:22.804483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83487590>]}
[0m14:05:22.806781 [info ] [MainThread]: 
[0m14:05:22.807573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:22.808519 [info ] [MainThread]: 
[0m14:05:22.809441 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:22.812426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:05:22.813118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:23.231035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:05:23.233030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.515771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dfd3d0>]}
[0m14:05:23.517486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:23.527763 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:05:23.528328 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:05:23.531106 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:05:23.529465 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:05:23.532758 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:05:23.533972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:05:23.535633 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:05:23.534890 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:05:23.546585 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:05:23.548805 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:05:23.552547 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:05:23.553018 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:05:23.595700 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:05:23.603891 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:05:23.605168 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:05:23.605621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.606833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:24.192846 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64e3ba20-96f8-417b-a711-d7426cf320cd&page=queryresults
[0m14:05:24.239041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5e82792b-eb56-45bf-83c0-d5639b1ab702&page=queryresults
[0m14:05:24.527455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880b1460>]}
[0m14:05:24.528873 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m14:05:24.530032 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:05:24.531215 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:05:24.532090 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:05:24.533059 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:05:24.533678 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:05:24.536273 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:05:24.538750 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:05:24.546859 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:24.830359 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:05:24.835349 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:05:25.153467 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9d2ddd73-d73d-4784-a0cd-60eee0295dfc&page=queryresults
[0m14:05:25.961201 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:05:25.985746 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:05:25.998381 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:05:26.314617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:02c8e781-c54c-40f1-94eb-1fdb86ef4701&page=queryresults
[0m14:05:27.109801 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af133e0>]}
[0m14:05:27.111287 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.8 KiB processed)[0m in 2.58s]
[0m14:05:27.112869 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:05:27.882991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c95010>]}
[0m14:05:27.885038 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.35s]
[0m14:05:27.886483 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:05:27.891690 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:05:27.894581 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:05:27.896841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:05:27.900121 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:05:27.908141 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:05:27.911758 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:05:27.917227 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:05:27.918995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:28.488471 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f93f1990-e522-4f4d-a686-483606f51acf&page=queryresults
[0m14:05:30.192947 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:05:30.197095 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:05:30.200835 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:05:30.544219 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f0c87510-d549-4b30-9fcc-c8a29b5c100c&page=queryresults
[0m14:05:32.206345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af12540>]}
[0m14:05:32.212012 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.31s]
[0m14:05:32.216321 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:05:32.220751 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:05:32.221864 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:05:32.223140 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:05:32.224186 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:05:32.248157 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:05:32.255264 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:05:32.263634 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

  AND Date(dt) > (SELECT MAX(Date(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:05:32.265677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:05:32.892547 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:16de4143-cb83-4a27-a433-8ca3a71fd6c7&page=queryresults
[0m14:10:42.995318 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

  AND Date(dt) > (SELECT MAX(Date(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:10:43.006299 [debug] [Thread-4 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/16de4143-cb83-4a27-a433-8ca3a71fd6c7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: europe-west2
Job ID: 16de4143-cb83-4a27-a433-8ca3a71fd6c7

[0m14:10:43.079082 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/16de4143-cb83-4a27-a433-8ca3a71fd6c7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 16de4143-cb83-4a27-a433-8ca3a71fd6c7
  
[0m14:10:43.113248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872a7d0e-41eb-4379-9ea8-6c3fe21cbaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d5b3b0>]}
[0m14:10:43.129563 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 310.87s]
[0m14:10:43.133497 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:10:43.136299 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/16de4143-cb83-4a27-a433-8ca3a71fd6c7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 16de4143-cb83-4a27-a433-8ca3a71fd6c7
  .
[0m14:10:43.158741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:43.169559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:43.170906 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:10:43.179975 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:10:43.181050 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:10:43.184081 [info ] [MainThread]: 
[0m14:10:43.186541 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 5 minutes and 20.37 seconds (320.37s).
[0m14:10:43.189427 [debug] [MainThread]: Command end result
[0m14:10:43.307380 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:10:43.316122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:10:43.328798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:10:43.329621 [info ] [MainThread]: 
[0m14:10:43.330868 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:43.331720 [info ] [MainThread]: 
[0m14:10:43.332813 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:10:43.333826 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/16de4143-cb83-4a27-a433-8ca3a71fd6c7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 16de4143-cb83-4a27-a433-8ca3a71fd6c7
  
[0m14:10:43.334686 [info ] [MainThread]: 
[0m14:10:43.335684 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:10:43.336596 [info ] [MainThread]: 
[0m14:10:43.337511 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:10:43.343633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 324.03864, "process_in_blocks": "432", "process_kernel_time": 1.52862, "process_mem_max_rss": "380068", "process_out_blocks": "0", "process_user_time": 5.318325}
[0m14:10:43.345858 [debug] [MainThread]: Command `dbt run` failed at 14:10:43.345650 after 324.04 seconds
[0m14:10:43.347723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb25850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e9b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e99c70>]}
[0m14:10:43.348597 [debug] [MainThread]: Flushing usage events
[0m14:10:43.853726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:33.045771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e195e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2495d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e19310>]}


============================== 14:12:33.049799 | 3fb4c878-1511-46f9-8fc8-ceedab3800bf ==============================
[0m14:12:33.049799 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:12:33.050892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:12:35.272650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a32f680>]}
[0m14:12:35.304789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ac7b60>]}
[0m14:12:35.305817 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:12:35.450277 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:12:35.544719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:35.545485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:35.576321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f0e000>]}
[0m14:12:35.896606 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:12:35.901995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:12:35.924159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88793b90>]}
[0m14:12:35.924988 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:12:35.925806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47b4680>]}
[0m14:12:35.927972 [info ] [MainThread]: 
[0m14:12:35.928684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:35.929317 [info ] [MainThread]: 
[0m14:12:35.930421 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:12:35.934355 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:12:35.935192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:37.243283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:12:37.244684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:37.564180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47b5160>]}
[0m14:12:37.565862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:37.573931 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:12:37.574288 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:12:37.575159 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:12:37.576182 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:12:37.578793 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:12:37.579713 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:12:37.577947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:12:37.596260 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:12:37.596714 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:12:37.609914 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:12:37.611266 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:12:37.634415 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:12:37.634877 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:12:37.660148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.661464 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:12:37.662797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:12:38.148079 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:12:38.161687 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m14:12:38.261458 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:61511e83-b01b-45c0-b096-d2f42e599937&page=queryresults
[0m14:12:38.485235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0ec784d1-8d6f-4592-bab4-b0975bddb468&page=queryresults
[0m14:12:38.688151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d821a90>]}
[0m14:12:38.689807 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m14:12:38.691340 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:12:38.693007 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:12:38.693963 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:12:38.695013 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:12:38.695848 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:12:38.699434 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:12:38.702750 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:12:38.715602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:12:39.016865 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:12:39.021415 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:12:39.493387 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:882ec791-7479-42a5-a002-e8b9d28488dc&page=queryresults
[0m14:12:40.818429 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1eecd70>]}
[0m14:12:40.823239 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.8 KiB processed)[0m in 2.12s]
[0m14:12:40.826038 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:12:45.830414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ba5340>]}
[0m14:12:45.844786 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.4 MiB processed)[0m in 8.25s]
[0m14:12:45.848168 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:12:45.876171 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:12:45.880031 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:12:45.882548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:12:45.884508 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:12:45.920985 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:12:45.926595 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:12:45.929944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:46.240373 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:12:46.252566 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:12:46.646849 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fa0f5308-8366-43b4-91bc-7590da47415e&page=queryresults
[0m14:12:55.207208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88615640>]}
[0m14:12:55.212941 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.4 MiB processed)[0m in 9.32s]
[0m14:12:55.217240 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:12:55.221797 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:12:55.223176 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:12:55.228528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:12:55.229753 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:12:55.253734 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:12:55.258392 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:12:55.262459 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:12:55.620219 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:12:55.626103 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:12:55.957178 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13ee7c0a-0c9e-47a3-b536-9927e0ef6767&page=queryresults
[0m14:13:01.907045 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb4c878-1511-46f9-8fc8-ceedab3800bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84939e80>]}
[0m14:13:01.917263 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.6k rows, 401.1 MiB processed)[0m in 6.68s]
[0m14:13:01.920528 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:13:01.932599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:01.939353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:01.949829 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:13:01.952242 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:13:01.953472 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:13:01.957067 [info ] [MainThread]: 
[0m14:13:01.959219 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 26.03 seconds (26.03s).
[0m14:13:01.964394 [debug] [MainThread]: Command end result
[0m14:13:02.096137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:13:02.103722 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:13:02.116897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:13:02.117750 [info ] [MainThread]: 
[0m14:13:02.119041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:02.119872 [info ] [MainThread]: 
[0m14:13:02.121034 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:13:02.126524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.123016, "process_in_blocks": "0", "process_kernel_time": 1.295761, "process_mem_max_rss": "375500", "process_out_blocks": "0", "process_user_time": 3.896403}
[0m14:13:02.133461 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:02.132812 after 29.13 seconds
[0m14:13:02.144576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887d4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887d4230>]}
[0m14:13:02.145720 [debug] [MainThread]: Flushing usage events
[0m14:13:02.623071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:03.368870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991676e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99502360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996264b0>]}


============================== 14:16:03.373976 | 002303a5-901e-4a8c-88bc-8bf6737d41b4 ==============================
[0m14:16:03.373976 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:16:03.375316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging_cities', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:05.737899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9adeb500>]}
[0m14:16:05.776110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f39f950>]}
[0m14:16:05.777498 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:16:05.947440 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:16:06.025556 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:16:06.026598 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m14:16:06.027308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98db1280>]}
[0m14:16:06.966115 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m14:16:07.028219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e22af30>]}
[0m14:16:07.167451 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:16:07.173234 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:16:07.200964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e146840>]}
[0m14:16:07.203820 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:16:07.206043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1a4920>]}
[0m14:16:07.211384 [info ] [MainThread]: 
[0m14:16:07.221347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:07.226384 [info ] [MainThread]: 
[0m14:16:07.233169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:16:07.236471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:16:07.242234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:07.750948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:16:07.752671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:08.051751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4f8170>]}
[0m14:16:08.053473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:08.060211 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m14:16:08.061759 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m14:16:08.062838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m14:16:08.063545 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:16:08.069926 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:16:08.073762 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:16:08.092651 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:16:08.095877 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:16:08.096685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:08.550888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f721831e-19cd-46ba-829c-e2de587fe273&page=queryresults
[0m14:16:08.866719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002303a5-901e-4a8c-88bc-8bf6737d41b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f454c0>]}
[0m14:16:08.868058 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:16:08.869272 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:16:08.871296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:08.873484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:08.874245 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m14:16:08.874905 [info ] [MainThread]: 
[0m14:16:08.875674 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m14:16:08.876739 [debug] [MainThread]: Command end result
[0m14:16:08.962693 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:16:08.966245 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:16:08.971566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:16:08.972230 [info ] [MainThread]: 
[0m14:16:08.972921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:08.973478 [info ] [MainThread]: 
[0m14:16:08.974258 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:16:08.977274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7540526, "process_in_blocks": "0", "process_kernel_time": 1.339355, "process_mem_max_rss": "383096", "process_out_blocks": "0", "process_user_time": 4.113371}
[0m14:16:08.978460 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:08.978332 after 5.76 seconds
[0m14:16:08.979747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f86f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef48b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e22bf80>]}
[0m14:16:08.982447 [debug] [MainThread]: Flushing usage events
[0m14:16:09.485601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:17.146899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0441910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c44770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0442f30>]}


============================== 14:16:17.150691 | ed904581-6ae0-4ffb-929f-1ca1b3c3dad9 ==============================
[0m14:16:17.150691 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:16:17.151645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:19.013427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23e5fa0>]}
[0m14:16:19.045293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c5d250>]}
[0m14:16:19.046957 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:16:19.196840 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:16:19.269986 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:16:19.271132 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m14:16:19.272028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0441490>]}
[0m14:16:20.415098 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m14:16:20.524054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95af2780>]}
[0m14:16:20.689100 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:16:20.696115 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:16:20.716129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957d2fc0>]}
[0m14:16:20.716929 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:16:20.717730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a35340>]}
[0m14:16:20.720113 [info ] [MainThread]: 
[0m14:16:20.720900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:20.721456 [info ] [MainThread]: 
[0m14:16:20.722407 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:16:20.723627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:16:20.724358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:21.115209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:16:21.118915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:21.410297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ace750>]}
[0m14:16:21.411230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:21.416882 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m14:16:21.417864 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m14:16:21.418911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m14:16:21.419609 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m14:16:21.426266 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m14:16:21.469749 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m14:16:21.471260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:22.214384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:49774ec2-e183-49d7-8ab6-41f16de1606e&page=queryresults
[0m14:16:22.998146 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m14:16:23.584461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be66094f-0595-47ce-b00a-781c0c05792f&page=queryresults
[0m14:16:25.524354 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m14:16:25.921107 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m14:16:26.555928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b38717fe-1d36-46dd-8d50-eb2b7328fde3&page=queryresults
[0m14:16:26.687755 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m14:16:26.928954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d2766834-8d72-4b51-8957-dc444a6dad6f&page=queryresults
[0m14:16:27.021896 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m14:16:27.028305 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m14:16:27.518986 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7e5b9727-18c3-4b32-9ef5-9f09ab31b589&page=queryresults
[0m14:16:29.323721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed904581-6ae0-4ffb-929f-1ca1b3c3dad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5d91c0>]}
[0m14:16:29.331051 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (2.0 rows, 11.0 KiB processed)[0m in 7.90s]
[0m14:16:29.334525 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m14:16:29.348508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:29.360074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:29.361942 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m14:16:29.364500 [info ] [MainThread]: 
[0m14:16:29.366480 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m14:16:29.373447 [debug] [MainThread]: Command end result
[0m14:16:29.510162 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:16:29.518855 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:16:29.525905 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:16:29.526524 [info ] [MainThread]: 
[0m14:16:29.527442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:29.528131 [info ] [MainThread]: 
[0m14:16:29.528782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:16:29.534553 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.438728, "process_in_blocks": "0", "process_kernel_time": 0.817458, "process_mem_max_rss": "383996", "process_out_blocks": "0", "process_user_time": 4.299526}
[0m14:16:29.535981 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:16:29.535884 after 12.44 seconds
[0m14:16:29.538900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb066ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95827800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95921700>]}
[0m14:16:29.539876 [debug] [MainThread]: Flushing usage events
[0m14:16:30.044565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:44.452439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc4eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c762ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cadce60>]}


============================== 14:16:44.456947 | d3d45d9a-8675-423a-9d47-4ad375ac1825 ==============================
[0m14:16:44.456947 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:16:44.458369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:46.374687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d88a70>]}
[0m14:16:46.406900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf07b90>]}
[0m14:16:46.408089 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:16:46.551177 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:16:46.642942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:46.643668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:46.673869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72e459d0>]}
[0m14:16:46.895073 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:16:46.898389 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:16:46.917787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730366f0>]}
[0m14:16:46.918587 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:16:46.919376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b0b860>]}
[0m14:16:46.921324 [info ] [MainThread]: 
[0m14:16:46.922088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:46.922734 [info ] [MainThread]: 
[0m14:16:46.923786 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:16:46.927219 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:16:46.927991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:47.515626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:16:47.521341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:47.947919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72e6a8d0>]}
[0m14:16:47.955332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:47.969097 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:16:47.970534 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:16:47.971664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:16:47.969609 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:16:47.973481 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:16:47.972647 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:16:47.974460 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:16:47.987518 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:16:47.991342 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:16:47.994804 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:16:47.998656 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:16:47.999053 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:16:48.034276 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:16:48.055447 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:16:48.055837 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:16:48.056394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:48.057173 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:48.540906 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d534ec64-e4f8-41ea-824f-41945df2894f&page=queryresults
[0m14:16:48.691043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1e940884-9dc4-4e68-b0fe-ac434478e262&page=queryresults
[0m14:16:48.803039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730362d0>]}
[0m14:16:48.804135 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:16:48.804941 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:16:48.806074 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:16:48.806914 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:16:48.807672 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:16:48.808292 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:16:48.811624 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:16:48.814336 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:16:48.821326 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:49.123063 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:16:49.128450 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:16:49.451098 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1512def4-dcde-42e4-8c15-4c9cd18ce0cf&page=queryresults
[0m14:16:50.827731 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:50.862303 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:16:50.866238 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:16:50.975194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706bb2f0>]}
[0m14:16:50.976578 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.17s]
[0m14:16:50.979518 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:16:51.208376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3193619-a3f7-42ea-a7d6-0809a1da1869&page=queryresults
[0m14:16:53.110074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff728aeab0>]}
[0m14:16:53.114056 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.14s]
[0m14:16:53.117193 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:16:53.121239 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:16:53.123813 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:16:53.132958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:16:53.135415 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:16:53.158696 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:16:53.163945 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:16:53.168559 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:16:53.169644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:53.755722 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:207993dd-1f87-41a2-9383-b7ee93ce813d&page=queryresults
[0m14:16:55.815094 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:16:55.827384 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:16:55.837422 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:16:56.170696 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b64e7449-6acb-43b8-8361-ebcef08ede95&page=queryresults
[0m14:16:57.778817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70549580>]}
[0m14:16:57.781067 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.65s]
[0m14:16:57.782496 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:16:57.784983 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:16:57.787241 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:16:57.789821 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:16:57.791163 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:16:57.809204 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:16:57.812434 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:16:57.815292 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

  AND DATE(dt) > (SELECT MAX(DATE(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:16:57.816092 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:58.355567 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:67199768-0a29-4a31-88e7-87d9e1c3e77c&page=queryresults
[0m14:22:18.374477 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

  AND DATE(dt) > (SELECT MAX(DATE(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
ORDER BY 
  date ASC
    );
  
[0m14:22:18.380873 [debug] [Thread-4 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/67199768-0a29-4a31-88e7-87d9e1c3e77c?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: europe-west2
Job ID: 67199768-0a29-4a31-88e7-87d9e1c3e77c

[0m14:22:18.408117 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/67199768-0a29-4a31-88e7-87d9e1c3e77c?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 67199768-0a29-4a31-88e7-87d9e1c3e77c
  
[0m14:22:18.414560 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d45d9a-8675-423a-9d47-4ad375ac1825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72d8ba70>]}
[0m14:22:18.418558 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 320.62s]
[0m14:22:18.420734 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:22:18.423763 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/67199768-0a29-4a31-88e7-87d9e1c3e77c?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 67199768-0a29-4a31-88e7-87d9e1c3e77c
  .
[0m14:22:18.458367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:18.484843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:18.486364 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:22:18.487999 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:22:18.489253 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:22:18.491546 [info ] [MainThread]: 
[0m14:22:18.493348 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 5 minutes and 31.57 seconds (331.57s).
[0m14:22:18.501021 [debug] [MainThread]: Command end result
[0m14:22:18.661598 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:22:18.670280 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:22:18.690401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:22:18.691362 [info ] [MainThread]: 
[0m14:22:18.692463 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:22:18.693431 [info ] [MainThread]: 
[0m14:22:18.694392 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:22:18.695479 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/67199768-0a29-4a31-88e7-87d9e1c3e77c?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 67199768-0a29-4a31-88e7-87d9e1c3e77c
  
[0m14:22:18.696415 [info ] [MainThread]: 
[0m14:22:18.697739 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:22:18.698806 [info ] [MainThread]: 
[0m14:22:18.699958 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:22:18.707375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 334.28778, "process_in_blocks": "0", "process_kernel_time": 0.948501, "process_mem_max_rss": "375600", "process_out_blocks": "0", "process_user_time": 4.466542}
[0m14:22:18.709210 [debug] [MainThread]: Command `dbt run` failed at 14:22:18.709057 after 334.29 seconds
[0m14:22:18.710873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff732b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff731171a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70430290>]}
[0m14:22:18.711694 [debug] [MainThread]: Flushing usage events
[0m14:22:19.345873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:55.374615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98120290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a5bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95655400>]}


============================== 14:24:55.380902 | 3c1f86ab-37da-4416-bf60-dca8aade8d26 ==============================
[0m14:24:55.380902 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:24:55.382252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:24:58.427023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cb30e0>]}
[0m14:24:58.480152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bea4fb0>]}
[0m14:24:58.482450 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:24:58.891264 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:24:59.033826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:59.035580 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m14:24:59.606319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2b9a90>]}
[0m14:24:59.749850 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:24:59.757233 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:24:59.788677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1b2090>]}
[0m14:24:59.789577 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:24:59.790352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2961b0>]}
[0m14:24:59.792522 [info ] [MainThread]: 
[0m14:24:59.793315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:24:59.794281 [info ] [MainThread]: 
[0m14:24:59.795292 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:24:59.799510 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:24:59.800539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:00.251628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:25:00.253042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:00.557553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9be660>]}
[0m14:25:00.558936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:00.564625 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:25:00.564990 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:25:00.565649 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:25:00.566769 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:25:00.567813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:25:00.568613 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:25:00.569324 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:25:00.570041 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:25:00.580027 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:25:00.582973 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:25:00.587066 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:25:00.587407 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:25:00.610838 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:25:00.640270 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:25:00.641322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:00.641792 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:25:00.642728 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:01.183102 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4b83d880-e3f8-4306-909d-32fbbbd87d4e&page=queryresults
[0m14:25:01.199362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c20c11de-05d4-4a9f-8740-03dff8eca649&page=queryresults
[0m14:25:01.531187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80615100>]}
[0m14:25:01.532250 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:25:01.533167 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:25:01.534223 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:25:01.534887 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:25:01.535637 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:25:01.536281 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:25:01.538866 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:25:01.542317 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:25:01.550432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:01.945360 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:25:01.962059 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:25:02.399288 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f615289a-85fe-46b6-bcc3-fd4196549e0a&page=queryresults
[0m14:25:03.358332 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:25:03.394478 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:25:03.400604 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:25:03.837341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1c87f6c-77db-449b-b760-adbf9398ce01&page=queryresults
[0m14:25:04.092478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63529910>]}
[0m14:25:04.094706 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.56s]
[0m14:25:04.096508 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:25:05.370586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7803eea0>]}
[0m14:25:05.379674 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.80s]
[0m14:25:05.382704 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:25:05.389948 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:25:05.393357 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:25:05.397014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:25:05.400096 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:25:05.411318 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:25:05.417739 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:25:05.422665 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:25:05.423806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:25:05.993325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2d8ed364-f990-4759-be80-e62288d9b73a&page=queryresults
[0m14:25:07.987245 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:25:07.993197 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:25:08.005540 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:25:08.359461 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f0bfee66-a7b7-483c-bcac-c2e3c1f03dc8&page=queryresults
[0m14:25:10.225086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63506f00>]}
[0m14:25:10.233539 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.83s]
[0m14:25:10.238502 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:25:10.240557 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:25:10.241557 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:25:10.242631 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:25:10.244044 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:25:10.275475 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:25:10.281686 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:25:10.284963 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
      AND DATE(dt) > (SELECT MAX(DATE(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:25:10.286088 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:25:10.802709 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70589192-00e7-4485-81b4-5ee658faa554&page=queryresults
[0m14:30:24.302766 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
      AND DATE(dt) > (SELECT MAX(DATE(dt)) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:30:24.311735 [debug] [Thread-4 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/70589192-00e7-4485-81b4-5ee658faa554?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: europe-west2
Job ID: 70589192-00e7-4485-81b4-5ee658faa554

[0m14:30:24.344081 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/70589192-00e7-4485-81b4-5ee658faa554?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 70589192-00e7-4485-81b4-5ee658faa554
  
[0m14:30:24.349658 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1f86ab-37da-4416-bf60-dca8aade8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63404350>]}
[0m14:30:24.354436 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 314.10s]
[0m14:30:24.356907 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:30:24.359615 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/70589192-00e7-4485-81b4-5ee658faa554?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 70589192-00e7-4485-81b4-5ee658faa554
  .
[0m14:30:24.381724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:24.387225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:24.388043 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:30:24.388779 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:30:24.389584 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:30:24.391188 [info ] [MainThread]: 
[0m14:30:24.394337 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 5 minutes and 24.60 seconds (324.60s).
[0m14:30:24.396721 [debug] [MainThread]: Command end result
[0m14:30:24.639400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:30:24.646338 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:30:24.655145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:30:24.655737 [info ] [MainThread]: 
[0m14:30:24.656488 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:30:24.658138 [info ] [MainThread]: 
[0m14:30:24.658963 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:30:24.659883 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/70589192-00e7-4485-81b4-5ee658faa554?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 70589192-00e7-4485-81b4-5ee658faa554
  
[0m14:30:24.660512 [info ] [MainThread]: 
[0m14:30:24.661158 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:30:24.661970 [info ] [MainThread]: 
[0m14:30:24.663147 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:30:24.667697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 329.33597, "process_in_blocks": "0", "process_kernel_time": 1.563736, "process_mem_max_rss": "380056", "process_out_blocks": "0", "process_user_time": 5.876854}
[0m14:30:24.669128 [debug] [MainThread]: Command `dbt run` failed at 14:30:24.669001 after 329.34 seconds
[0m14:30:24.670116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ba2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1b2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1b27e0>]}
[0m14:30:24.670833 [debug] [MainThread]: Flushing usage events
[0m14:30:25.150262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:18.373533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27c1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa204f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dafe00>]}


============================== 14:31:18.378256 | 686ae8a9-713c-44f4-b59e-09cf551a7564 ==============================
[0m14:31:18.378256 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:31:18.379162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:31:21.910272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3bb0e0>]}
[0m14:31:21.952470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889e0620>]}
[0m14:31:21.954921 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:31:22.331900 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:31:22.456416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:31:22.458332 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m14:31:23.144677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f06c90>]}
[0m14:31:23.380597 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:31:23.385133 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:31:23.407403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882406b0>]}
[0m14:31:23.409281 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:31:23.411291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fd6600>]}
[0m14:31:23.414232 [info ] [MainThread]: 
[0m14:31:23.415181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:23.416139 [info ] [MainThread]: 
[0m14:31:23.418263 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:31:23.486377 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:31:23.513799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:24.252024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:31:24.253637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:24.537827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8862a8a0>]}
[0m14:31:24.539255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:24.544779 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:31:24.545154 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:31:24.545937 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:31:24.549047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:31:24.548158 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:31:24.549760 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:31:24.550942 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:31:24.563652 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:31:24.565024 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:31:24.567139 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:31:24.570992 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:31:24.571587 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:31:24.619144 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:31:24.632366 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:31:24.633601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:24.634175 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:31:24.669804 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:31:25.189761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b1653e0b-ee4c-43ab-94bd-986c4291e240&page=queryresults
[0m14:31:25.326476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5a6fbc73-19ea-4c85-b0b9-f3b9bd863929&page=queryresults
[0m14:31:25.660984 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d281910>]}
[0m14:31:25.664030 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m14:31:25.666188 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:31:25.668742 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:31:25.670511 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:31:25.673072 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:31:25.674087 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:31:25.680917 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:31:25.684214 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:31:25.693895 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:31:25.976734 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:31:25.983122 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:31:26.408930 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:de9d96aa-3dbc-4036-a4b5-f3ec45369f00&page=queryresults
[0m14:31:27.177119 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:31:27.255807 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:31:27.273423 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:31:27.615418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b85179fb-7fb4-479d-b277-9962ae70ed12&page=queryresults
[0m14:31:28.239899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841b8320>]}
[0m14:31:28.242718 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.57s]
[0m14:31:28.244974 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:31:29.305197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e65220>]}
[0m14:31:29.307019 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.76s]
[0m14:31:29.308624 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:31:29.312625 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:31:29.315835 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:31:29.317839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:31:29.321128 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:31:29.339802 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:31:29.344379 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:31:29.349129 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:31:29.350306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:31:29.934596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ada7bd04-5bf7-4b5d-8398-9e54ce808d6b&page=queryresults
[0m14:31:32.044511 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:31:32.084288 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:31:32.104832 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:31:32.579005 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:264484e3-a37a-401b-8a55-84e931aed384&page=queryresults
[0m14:31:34.321293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841b61b0>]}
[0m14:31:34.325655 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.00s]
[0m14:31:34.329269 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:31:34.333743 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:31:34.336760 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:31:34.339184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:31:34.340344 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:31:34.353161 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:31:34.356830 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:31:34.360677 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 1 = 1
    
      AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:31:34.361676 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:31:34.833370 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:52b220e0-234d-45f5-8a0b-2824fe44230f&page=queryresults
[0m14:36:38.076662 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 1 = 1
    
      AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:36:38.081809 [debug] [Thread-4 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/52b220e0-234d-45f5-8a0b-2824fe44230f?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: europe-west2
Job ID: 52b220e0-234d-45f5-8a0b-2824fe44230f

[0m14:36:38.109188 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/52b220e0-234d-45f5-8a0b-2824fe44230f?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 52b220e0-234d-45f5-8a0b-2824fe44230f
  
[0m14:36:38.114521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '686ae8a9-713c-44f4-b59e-09cf551a7564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8408eab0>]}
[0m14:36:38.119645 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 303.77s]
[0m14:36:38.122194 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:36:38.124684 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/52b220e0-234d-45f5-8a0b-2824fe44230f?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 52b220e0-234d-45f5-8a0b-2824fe44230f
  .
[0m14:36:38.139750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:38.147333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:38.148129 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:36:38.149022 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:36:38.149982 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:36:38.152063 [info ] [MainThread]: 
[0m14:36:38.153120 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 5 minutes and 14.73 seconds (314.73s).
[0m14:36:38.155736 [debug] [MainThread]: Command end result
[0m14:36:38.332715 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:36:38.359759 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:36:38.387862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:36:38.400530 [info ] [MainThread]: 
[0m14:36:38.408613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:38.411863 [info ] [MainThread]: 
[0m14:36:38.414578 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:36:38.417772 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/52b220e0-234d-45f5-8a0b-2824fe44230f?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 52b220e0-234d-45f5-8a0b-2824fe44230f
  
[0m14:36:38.418869 [info ] [MainThread]: 
[0m14:36:38.420833 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:36:38.423265 [info ] [MainThread]: 
[0m14:36:38.425904 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:36:38.435780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 320.09924, "process_in_blocks": "0", "process_kernel_time": 1.852375, "process_mem_max_rss": "380048", "process_out_blocks": "0", "process_user_time": 6.549355}
[0m14:36:38.456977 [debug] [MainThread]: Command `dbt run` failed at 14:36:38.456531 after 320.12 seconds
[0m14:36:38.459263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2507b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e25d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e26450>]}
[0m14:36:38.460720 [debug] [MainThread]: Flushing usage events
[0m14:36:39.204468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:00.531044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9514f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b0a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9514f4a0>]}


============================== 14:42:00.537563 | e6268e0d-f85a-4b41-83e3-c149e793d93d ==============================
[0m14:42:00.537563 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:42:00.557906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:42:04.128119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf0b5f0>]}
[0m14:42:04.168812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aaba40>]}
[0m14:42:04.171791 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:42:04.390572 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m14:42:04.506770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:04.507856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:04.545769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9ab8c0>]}
[0m14:42:04.827751 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:42:04.834007 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:42:04.859818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bace8d0>]}
[0m14:42:04.860792 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m14:42:04.861722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b634350>]}
[0m14:42:04.866240 [info ] [MainThread]: 
[0m14:42:04.867123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:04.867914 [info ] [MainThread]: 
[0m14:42:04.868824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:04.873196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m14:42:04.874229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:05.287620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m14:42:05.289574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:05.609654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954e3e90>]}
[0m14:42:05.611516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:05.617853 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m14:42:05.618358 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m14:42:05.619948 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m14:42:05.621068 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m14:42:05.622160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m14:42:05.623488 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m14:42:05.624545 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m14:42:05.625907 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m14:42:05.641764 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m14:42:05.644748 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m14:42:05.648621 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m14:42:05.649092 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m14:42:05.693426 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m14:42:05.705313 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m14:42:05.706616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:05.707212 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m14:42:05.708992 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:06.305913 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:736a1c2d-89b1-4023-ad50-c6be2b980493&page=queryresults
[0m14:42:06.306968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74416d0b-c7fc-4b7b-8fa7-aa2367705d2c&page=queryresults
[0m14:42:06.667247 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80680da0>]}
[0m14:42:06.668870 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m14:42:06.670160 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m14:42:06.671479 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m14:42:06.672239 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m14:42:06.673247 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m14:42:06.673879 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m14:42:06.678013 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m14:42:06.680702 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m14:42:06.687804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:06.982755 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m14:42:06.988504 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m14:42:07.295329 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9910bce5-57e7-4cf3-8192-b7c0ade9861f&page=queryresults
[0m14:42:08.478657 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:42:08.519334 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m14:42:08.524294 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m14:42:08.868106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc9cca0e-3ba5-4f53-ac9d-0b51859fa521&page=queryresults
[0m14:42:08.945447 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780d3f20>]}
[0m14:42:08.948599 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.27s]
[0m14:42:08.950965 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m14:42:10.759328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4633b0>]}
[0m14:42:10.768442 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (2.5k rows, 213.6 KiB processed)[0m in 5.14s]
[0m14:42:10.776940 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m14:42:10.785143 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m14:42:10.787403 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m14:42:10.789565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m14:42:10.791606 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m14:42:10.804777 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m14:42:10.811087 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m14:42:10.816285 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m14:42:10.817431 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:11.330093 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bf42389d-b33d-44e1-8bd1-ed68d2013776&page=queryresults
[0m14:42:13.417059 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:42:13.421443 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m14:42:13.426189 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m14:42:13.799289 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0241cb3c-fa1f-4e28-8f46-08d176f5ee30&page=queryresults
[0m14:42:15.276062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d12cc0>]}
[0m14:42:15.280954 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (2.5k rows, 324.0 KiB processed)[0m in 4.48s]
[0m14:42:15.283796 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m14:42:15.288739 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m14:42:15.290223 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m14:42:15.291932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m14:42:15.294822 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m14:42:15.305699 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m14:42:15.310263 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m14:42:15.313384 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 1 = 1
    
      AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:42:15.314190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:15.832651 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:07aac927-5c74-4e58-ab79-244ed9645fb7&page=queryresults
[0m14:47:25.494075 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 1 = 1
    
      AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m14:47:25.500901 [debug] [Thread-4 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/07aac927-5c74-4e58-ab79-244ed9645fb7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: europe-west2
Job ID: 07aac927-5c74-4e58-ab79-244ed9645fb7

[0m14:47:25.537723 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/07aac927-5c74-4e58-ab79-244ed9645fb7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 07aac927-5c74-4e58-ab79-244ed9645fb7
  
[0m14:47:25.542109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6268e0d-f85a-4b41-83e3-c149e793d93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63753d40>]}
[0m14:47:25.546731 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 310.25s]
[0m14:47:25.548998 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m14:47:25.553823 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/07aac927-5c74-4e58-ab79-244ed9645fb7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 07aac927-5c74-4e58-ab79-244ed9645fb7
  .
[0m14:47:25.591022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:25.598935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:25.603069 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m14:47:25.608402 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m14:47:25.609504 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m14:47:25.612142 [info ] [MainThread]: 
[0m14:47:25.613852 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 5 minutes and 20.74 seconds (320.74s).
[0m14:47:25.616993 [debug] [MainThread]: Command end result
[0m14:47:25.790874 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:47:25.799800 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:47:25.816792 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:47:25.817757 [info ] [MainThread]: 
[0m14:47:25.821321 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:25.823058 [info ] [MainThread]: 
[0m14:47:25.824364 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m14:47:25.826326 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/paris-air-pollution-quangnc/queries/07aac927-5c74-4e58-ab79-244ed9645fb7?maxResults=0&location=europe-west2&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: europe-west2
  Job ID: 07aac927-5c74-4e58-ab79-244ed9645fb7
  
[0m14:47:25.828334 [info ] [MainThread]: 
[0m14:47:25.829523 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m14:47:25.830758 [info ] [MainThread]: 
[0m14:47:25.831580 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m14:47:25.837352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 325.3811, "process_in_blocks": "0", "process_kernel_time": 1.967727, "process_mem_max_rss": "375576", "process_out_blocks": "0", "process_user_time": 6.242075}
[0m14:47:25.838887 [debug] [MainThread]: Command `dbt run` failed at 14:47:25.838779 after 325.38 seconds
[0m14:47:25.840438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ec72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9d94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bace600>]}
[0m14:47:25.841433 [debug] [MainThread]: Flushing usage events
[0m14:47:26.427657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:51.206852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d028170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd9eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9bff50>]}


============================== 15:09:51.211876 | 7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3 ==============================
[0m15:09:51.211876 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:09:51.212859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging_cities', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:53.650381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b26ab40>]}
[0m15:09:53.685101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff620c15e0>]}
[0m15:09:53.686291 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:09:53.835961 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:09:53.907470 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:09:53.908514 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m15:09:53.909373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba11160>]}
[0m15:09:54.777642 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:09:54.839647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60fbd5e0>]}
[0m15:09:54.984150 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:09:54.988369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:09:55.014198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60db6e70>]}
[0m15:09:55.015016 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:09:55.015637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6105e330>]}
[0m15:09:55.017623 [info ] [MainThread]: 
[0m15:09:55.018383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:55.019384 [info ] [MainThread]: 
[0m15:09:55.020273 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:55.021692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:09:55.022345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:55.431791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:09:55.433026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:55.754844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff620c15e0>]}
[0m15:09:55.756079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:55.763535 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m15:09:55.765439 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m15:09:55.766943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m15:09:55.767609 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:09:55.774268 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:09:55.778127 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:09:55.798064 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:09:55.801847 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:09:55.802561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:56.321930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6dac6f1f-4f88-4e59-8f66-18df3bd30b0e&page=queryresults
[0m15:09:56.638560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d66e355-b34b-4cc5-bdc3-0a54fe1bfaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66bb0f80>]}
[0m15:09:56.640026 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m15:09:56.641221 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:09:56.643221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:56.646242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:56.646834 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m15:09:56.647798 [info ] [MainThread]: 
[0m15:09:56.648600 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m15:09:56.649787 [debug] [MainThread]: Command end result
[0m15:09:56.737243 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:09:56.741398 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:09:56.747689 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:09:56.748378 [info ] [MainThread]: 
[0m15:09:56.749338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:56.750006 [info ] [MainThread]: 
[0m15:09:56.750773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:09:56.752407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.588203, "process_in_blocks": "2664", "process_kernel_time": 1.514072, "process_mem_max_rss": "381832", "process_out_blocks": "0", "process_user_time": 3.962831}
[0m15:09:56.753668 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:56.753308 after 5.59 seconds
[0m15:09:56.754569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b619640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6117d9d0>]}
[0m15:09:56.756054 [debug] [MainThread]: Flushing usage events
[0m15:09:57.237304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:02.512139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16e1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1047a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1143620>]}


============================== 15:10:02.515726 | 7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb ==============================
[0m15:10:02.515726 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:10:02.517062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:04.443192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8774fa10>]}
[0m15:10:04.475099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dfa780>]}
[0m15:10:04.476199 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:10:04.615959 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:10:04.725500 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:10:04.726600 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m15:10:04.728255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a710d0>]}
[0m15:10:05.672771 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:10:05.733869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86022300>]}
[0m15:10:05.986713 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:10:05.990677 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:10:06.010252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85df2a20>]}
[0m15:10:06.011617 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:10:06.012671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ce4740>]}
[0m15:10:06.014611 [info ] [MainThread]: 
[0m15:10:06.015423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:06.016260 [info ] [MainThread]: 
[0m15:10:06.017246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:06.019022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:10:06.020212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:06.410942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:10:06.411806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:06.686058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ee6270>]}
[0m15:10:06.687451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:06.691685 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:10:06.692753 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m15:10:06.693908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m15:10:06.694680 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:10:06.701775 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:10:06.738528 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m15:10:06.739698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:07.588474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04971c4a-f0a2-4ffc-ac3b-1b7f0210cace&page=queryresults
[0m15:10:08.432082 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m15:10:09.081670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:085740ed-9b94-4112-b819-69a5b8733d9a&page=queryresults
[0m15:10:11.125152 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m15:10:11.534909 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:10:12.099533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3929d5d4-4303-4060-9125-ffb8b9023393&page=queryresults
[0m15:10:12.288560 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:10:12.579541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:55d01941-8fe0-4cc2-ab03-6d29b8f4573c&page=queryresults
[0m15:10:12.679720 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m15:10:12.684551 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m15:10:13.029189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70d28191-9098-4e4c-9672-a281cb8178a1&page=queryresults
[0m15:10:14.780149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f4fb41d-47ea-42ba-9c0e-57a4ff7bdebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11c07d0>]}
[0m15:10:14.783856 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (0.0 rows, 10.9 KiB processed)[0m in 8.08s]
[0m15:10:14.786399 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:10:14.791211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:14.796194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:14.796932 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m15:10:14.798295 [info ] [MainThread]: 
[0m15:10:14.799735 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m15:10:14.801920 [debug] [MainThread]: Command end result
[0m15:10:14.928158 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:10:14.934711 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:10:14.944244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:10:14.944996 [info ] [MainThread]: 
[0m15:10:14.946642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:14.947643 [info ] [MainThread]: 
[0m15:10:14.948661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:10:14.952649 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.474983, "process_in_blocks": "8", "process_kernel_time": 0.985779, "process_mem_max_rss": "383100", "process_out_blocks": "0", "process_user_time": 4.028047}
[0m15:10:14.954404 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:10:14.954214 after 12.48 seconds
[0m15:10:14.955902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0675820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85daffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f0cc80>]}
[0m15:10:14.956564 [debug] [MainThread]: Flushing usage events
[0m15:10:15.434733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:22.226459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b033e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8857f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880fa870>]}


============================== 15:10:22.229625 | 15615196-2add-4470-9411-cb94e4622f17 ==============================
[0m15:10:22.229625 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:10:22.230530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m15:10:24.037472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2ccd40>]}
[0m15:10:24.069227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e47e750>]}
[0m15:10:24.070565 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:10:24.221065 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:10:24.311533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:24.312323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:24.343951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e388ec0>]}
[0m15:10:24.599359 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:10:24.603585 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:10:24.621761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e027a40>]}
[0m15:10:24.622815 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:10:24.623672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e3881d0>]}
[0m15:10:24.626117 [info ] [MainThread]: 
[0m15:10:24.626798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:24.627438 [info ] [MainThread]: 
[0m15:10:24.628409 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:24.632059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:10:24.632954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:25.115354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:10:25.116857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:25.372621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fa5100>]}
[0m15:10:25.374009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:25.380936 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:10:25.381272 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:10:25.382103 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:10:25.385064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:10:25.383576 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:10:25.385756 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:10:25.386692 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:10:25.402493 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:10:25.403756 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:10:25.409311 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:10:25.410521 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:10:25.437439 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:10:25.464832 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:10:25.465895 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:10:25.466411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:25.501236 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:10:25.502976 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:25.887051 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13d805eb-5157-4c95-91cb-307b952843a4&page=queryresults
[0m15:10:26.061961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c393724f-03d2-410d-9c75-ff19e9e2318c&page=queryresults
[0m15:10:26.261853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73030d70>]}
[0m15:10:26.263516 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m15:10:26.264616 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:10:26.266005 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:10:26.266902 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:10:26.267883 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:10:26.268627 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:10:26.272037 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:10:26.275951 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:10:26.283646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:10:26.607220 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:10:26.613510 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:10:26.958740 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:57920e71-16e5-42bb-be82-06665c3c60f9&page=queryresults
[0m15:10:28.087878 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:10:28.111688 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:10:28.116764 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:10:28.429549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:43189311-8ca9-4969-a0dc-8dbf737cb638&page=queryresults
[0m15:10:28.457276 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2a34a0>]}
[0m15:10:28.460098 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.19s]
[0m15:10:28.462842 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:10:30.571531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ddfe210>]}
[0m15:10:30.575358 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.19s]
[0m15:10:30.577594 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:10:30.582582 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:10:30.585005 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:10:30.587944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:10:30.589743 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:10:30.598089 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:10:30.603129 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:10:30.607498 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:10:30.609081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:31.140495 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bde4744e-5596-4de2-b784-9acffb9d9a5e&page=queryresults
[0m15:10:33.103368 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:10:33.112099 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:10:33.120915 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:10:33.711389 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d945bf14-638b-487b-893c-cde7430264b4&page=queryresults
[0m15:10:35.209843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2a0500>]}
[0m15:10:35.213700 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (2.5k rows, 324.0 KiB processed)[0m in 4.62s]
[0m15:10:35.216809 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:10:35.222317 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:10:35.225558 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:10:35.228627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:10:35.230146 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:10:35.240691 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:10:35.247657 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:10:35.252128 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 1 = 1
    
      AND dt > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m15:10:35.254060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:10:35.751714 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9b057402-db4c-45c4-99f5-01624a1c5c4a&page=queryresults
[0m15:10:35.847412 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9b057402-db4c-45c4-99f5-01624a1c5c4a&page=queryresults
[0m15:10:35.870182 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  No matching signature for operator > for argument types: TIMESTAMP, DATE
    Signature: T1 > T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {DATE, TIMESTAMP} at [21:11]
[0m15:10:35.871529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15615196-2add-4470-9411-cb94e4622f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1b50a0>]}
[0m15:10:35.872868 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.64s]
[0m15:10:35.874045 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:10:35.875057 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  No matching signature for operator > for argument types: TIMESTAMP, DATE
    Signature: T1 > T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {DATE, TIMESTAMP} at [21:11].
[0m15:10:35.879507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:35.882572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:35.887069 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:10:35.887900 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:10:35.888721 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:10:35.889777 [info ] [MainThread]: 
[0m15:10:35.890675 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 11.26 seconds (11.26s).
[0m15:10:35.893067 [debug] [MainThread]: Command end result
[0m15:10:35.990105 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:10:35.996494 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:10:36.006615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:10:36.007398 [info ] [MainThread]: 
[0m15:10:36.008200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:36.008863 [info ] [MainThread]: 
[0m15:10:36.009694 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m15:10:36.010413 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  No matching signature for operator > for argument types: TIMESTAMP, DATE
    Signature: T1 > T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {DATE, TIMESTAMP} at [21:11]
[0m15:10:36.010983 [info ] [MainThread]: 
[0m15:10:36.011697 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m15:10:36.012378 [info ] [MainThread]: 
[0m15:10:36.013357 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:10:36.016924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.825107, "process_in_blocks": "592", "process_kernel_time": 0.783544, "process_mem_max_rss": "374304", "process_out_blocks": "0", "process_user_time": 3.518368}
[0m15:10:36.018289 [debug] [MainThread]: Command `dbt run` failed at 15:10:36.018182 after 13.83 seconds
[0m15:10:36.019227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880b5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e56bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f13a600>]}
[0m15:10:36.020140 [debug] [MainThread]: Flushing usage events
[0m15:10:36.475279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:02.688326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2c3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4c5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3afe90>]}


============================== 15:13:02.693747 | e6dd268c-d838-4d30-a96c-f74646f708b0 ==============================
[0m15:13:02.693747 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:13:02.694961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:05.245695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bf30e0>]}
[0m15:13:05.282188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bbe240>]}
[0m15:13:05.283382 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:13:05.464468 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:13:05.575768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:05.577420 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m15:13:06.089658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7148af00>]}
[0m15:13:06.282106 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:13:06.287453 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:13:06.311021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7179da90>]}
[0m15:13:06.313135 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:13:06.314887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715370b0>]}
[0m15:13:06.318493 [info ] [MainThread]: 
[0m15:13:06.320308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:06.321866 [info ] [MainThread]: 
[0m15:13:06.323279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:06.328628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:13:06.330038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:06.761031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m15:13:06.772654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:07.175537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b8a7b0>]}
[0m15:13:07.181847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:07.218003 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:13:07.221290 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:13:07.224297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:13:07.225550 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:13:07.219429 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:13:07.257965 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:13:07.266627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now model.france_air_pollution.staging_cities)
[0m15:13:07.283517 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:13:07.273650 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:13:07.288489 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:13:07.294736 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:13:07.320665 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:13:07.416380 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:13:07.439705 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:13:07.443025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:07.445915 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:13:07.448911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:08.018248 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1be0b7af-3192-4772-873b-5f9aed4f0bfb&page=queryresults
[0m15:13:08.114520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:367bd452-fae2-4e85-a9fe-4915b0a9af4c&page=queryresults
[0m15:13:08.277220 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767e9130>]}
[0m15:13:08.279748 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:13:08.281358 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:13:08.283485 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:13:08.284366 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:13:08.285526 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:13:08.286414 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:13:08.292268 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:13:08.295912 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:13:08.308402 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:08.601413 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:13:08.605871 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:13:08.854763 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:094a793e-318f-419b-8fe1-32d8bfa09998&page=queryresults
[0m15:13:10.245946 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:13:10.266271 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:13:10.269894 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:13:10.352494 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7144f290>]}
[0m15:13:10.357550 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.06s]
[0m15:13:10.361563 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:13:10.683810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:be1c4a0a-803f-486a-a3f1-588688c5e002&page=queryresults
[0m15:13:12.251030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715cf710>]}
[0m15:13:12.252833 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.03s]
[0m15:13:12.254860 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:13:12.258503 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:13:12.259517 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:13:12.261233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:13:12.264526 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:13:12.272028 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:13:12.275984 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:13:12.279282 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:13:12.280331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:12.791078 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1b2a5286-da21-45c5-8aba-22d10f9810b0&page=queryresults
[0m15:13:14.805912 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:13:14.818233 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:13:14.830378 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:13:15.146606 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15f04820-01fc-4e6e-bdd1-3f06f5c41ffe&page=queryresults
[0m15:13:16.686112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff695c02f0>]}
[0m15:13:16.690450 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.42s]
[0m15:13:16.693998 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:13:16.702575 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:13:16.704476 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:13:16.706595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:13:16.707881 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:13:16.721615 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:13:16.726078 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:13:16.733914 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT * FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')

 AND date > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)

GROUP BY 
  1, 2, 3
    );
  
[0m15:13:16.735338 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:13:17.338308 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:82a0500c-525f-4930-92d1-117df9d0e1b5&page=queryresults
[0m15:13:17.423872 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:82a0500c-525f-4930-92d1-117df9d0e1b5&page=queryresults
[0m15:13:17.433288 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:6]
[0m15:13:17.439457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6dd268c-d838-4d30-a96c-f74646f708b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7182b9e0>]}
[0m15:13:17.441954 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.73s]
[0m15:13:17.444382 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:13:17.446408 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:6].
[0m15:13:17.479868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:17.485434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:17.489204 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:13:17.495030 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:13:17.499416 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:13:17.502372 [info ] [MainThread]: 
[0m15:13:17.504611 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m15:13:17.508661 [debug] [MainThread]: Command end result
[0m15:13:17.638835 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:13:17.651427 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:13:17.662579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:13:17.663321 [info ] [MainThread]: 
[0m15:13:17.664758 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:13:17.666093 [info ] [MainThread]: 
[0m15:13:17.667257 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m15:13:17.668478 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unrecognized name: date; Did you mean dt? at [47:6]
[0m15:13:17.669346 [info ] [MainThread]: 
[0m15:13:17.670405 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m15:13:17.671675 [info ] [MainThread]: 
[0m15:13:17.673112 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:13:17.684374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.032143, "process_in_blocks": "0", "process_kernel_time": 1.672405, "process_mem_max_rss": "378672", "process_out_blocks": "0", "process_user_time": 4.471821}
[0m15:13:17.686787 [debug] [MainThread]: Command `dbt run` failed at 15:13:17.686572 after 15.04 seconds
[0m15:13:17.688243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3afe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7137e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7137e060>]}
[0m15:13:17.689223 [debug] [MainThread]: Flushing usage events
[0m15:13:18.164279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:02.478842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5482ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58c8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d6f3e0>]}


============================== 15:19:02.483682 | 8ab25d51-0493-4fa1-aab7-0e32ec2f009e ==============================
[0m15:19:02.483682 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:19:02.485154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:04.639524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb8c7a0>]}
[0m15:19:04.683948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c279b0>]}
[0m15:19:04.685339 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:19:04.894024 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:19:05.026430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:05.028597 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m15:19:05.469240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4a2960>]}
[0m15:19:05.774150 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:19:05.782541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:19:05.813274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8fa810>]}
[0m15:19:05.814208 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:19:05.814943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b37cf20>]}
[0m15:19:05.817667 [info ] [MainThread]: 
[0m15:19:05.818673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:05.819710 [info ] [MainThread]: 
[0m15:19:05.821065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:05.825145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:19:05.826054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:06.251607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:19:06.253354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:06.554905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7aca40>]}
[0m15:19:06.556540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:06.562354 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:19:06.562761 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:19:06.563641 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:19:06.564729 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:19:06.566917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:19:06.568390 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:19:06.569416 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:19:06.571019 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:19:06.586100 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:19:06.591993 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:19:06.596245 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:19:06.596971 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:19:06.629911 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:19:06.651363 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:19:06.652462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:06.652965 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:19:06.655275 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:19:07.238405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:add77872-39c8-44ca-b36b-d6588c422812&page=queryresults
[0m15:19:07.258513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:222ff754-6f35-4b05-8b49-0e816003671f&page=queryresults
[0m15:19:07.618424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907ed100>]}
[0m15:19:07.619715 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m15:19:07.620970 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:19:07.622314 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:19:07.623244 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:19:07.624138 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:19:07.624884 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:19:07.627651 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:19:07.631215 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:19:07.641365 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:19:08.011736 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:19:08.015562 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:19:08.364388 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:46d62a0d-9b71-497a-a946-65128e8d9be4&page=queryresults
[0m15:19:09.031557 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:19:09.057798 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:19:09.061265 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:19:09.764239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:99b89588-27af-460c-81c1-97f8e0c4d194&page=queryresults
[0m15:19:09.843700 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff736141d0>]}
[0m15:19:09.849681 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.9 KiB processed)[0m in 2.22s]
[0m15:19:09.852753 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:19:12.627430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b44dee0>]}
[0m15:19:12.640567 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 6.06s]
[0m15:19:12.645930 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:19:12.662245 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:19:12.665406 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:19:12.667993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:19:12.669724 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:19:12.709781 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:19:12.716194 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:19:12.720028 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:19:12.721200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:19:13.199260 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15d6eaf3-1cdc-4726-8b77-482f77e453ea&page=queryresults
[0m15:19:15.276804 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:19:15.283381 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:19:15.289721 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:19:15.632372 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3a6fc6ac-53af-459c-950f-4cb20d6e07f5&page=queryresults
[0m15:19:17.512556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff736ee0c0>]}
[0m15:19:17.518188 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.84s]
[0m15:19:17.522629 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:19:17.533799 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:19:17.536675 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:19:17.538790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:19:17.541457 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:19:17.554487 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:19:17.561411 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:19:17.567331 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
    AND DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')}
GROUP BY 
  1, 2, 3
    );
  
[0m15:19:17.570346 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:19:17.898902 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a7b6b888-f2d5-4f62-8d0d-c226d0db2764&page=queryresults
[0m15:19:17.901661 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a7b6b888-f2d5-4f62-8d0d-c226d0db2764&page=queryresults
[0m15:19:17.928656 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "}" at [50:73]
[0m15:19:17.933465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab25d51-0493-4fa1-aab7-0e32ec2f009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73513e00>]}
[0m15:19:17.936610 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.39s]
[0m15:19:17.940024 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:19:17.944549 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "}" at [50:73].
[0m15:19:17.958440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:17.967209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:17.976142 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:19:17.977212 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:19:17.978684 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:19:17.983150 [info ] [MainThread]: 
[0m15:19:17.989214 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 12.16 seconds (12.16s).
[0m15:19:17.995385 [debug] [MainThread]: Command end result
[0m15:19:18.165913 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:19:18.183385 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:19:18.215173 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:19:18.216233 [info ] [MainThread]: 
[0m15:19:18.219914 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:19:18.223057 [info ] [MainThread]: 
[0m15:19:18.225838 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m15:19:18.226895 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got "}" at [50:73]
[0m15:19:18.228023 [info ] [MainThread]: 
[0m15:19:18.229373 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m15:19:18.230869 [info ] [MainThread]: 
[0m15:19:18.235742 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:19:18.295162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.8600235, "process_in_blocks": "0", "process_kernel_time": 1.196677, "process_mem_max_rss": "378876", "process_out_blocks": "0", "process_user_time": 4.570343}
[0m15:19:18.311551 [debug] [MainThread]: Command `dbt run` failed at 15:19:18.311332 after 15.88 seconds
[0m15:19:18.322327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fcd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5a3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b450b30>]}
[0m15:19:18.351493 [debug] [MainThread]: Flushing usage events
[0m15:19:19.098876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:55.998080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef970e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec15b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0c3ec0>]}


============================== 15:19:56.002158 | f82f9d55-a8d6-4958-a738-16280a092b85 ==============================
[0m15:19:56.002158 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:19:56.003461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select agg_pollution_by_day --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:58.281385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857f8ef0>]}
[0m15:19:58.320630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa10657c0>]}
[0m15:19:58.322012 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:19:58.525383 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:19:58.627153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:58.628373 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m15:19:59.144666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84efbf80>]}
[0m15:19:59.278531 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:19:59.285301 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:19:59.318910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c6bd0>]}
[0m15:19:59.320530 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:19:59.321576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f36090>]}
[0m15:19:59.324050 [info ] [MainThread]: 
[0m15:19:59.325011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:59.325834 [info ] [MainThread]: 
[0m15:19:59.327801 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:59.329504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:19:59.330447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:59.708759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:19:59.711364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:00.024594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84faf7a0>]}
[0m15:20:00.025996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:00.033700 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:20:00.035666 [info ] [Thread-1 (]: 1 of 1 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:20:00.037069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.agg_pollution_by_day)
[0m15:20:00.038267 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:20:00.050402 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:20:00.056083 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:20:00.098204 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
    AND DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
GROUP BY 
  1, 2, 3
    );
  
[0m15:20:00.100076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:00.624194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:71a29ff9-6b4e-48bc-85d4-837d35b66c72&page=queryresults
[0m15:20:02.987388 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:20:03.018063 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:20:03.026711 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m15:20:03.360165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6d15fe06-ee5e-4fcd-b0aa-2b5f52aea71f&page=queryresults
[0m15:20:04.902298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f82f9d55-a8d6-4958-a738-16280a092b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a251580>]}
[0m15:20:04.905233 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (210.0 rows, 23.8 KiB processed)[0m in 4.86s]
[0m15:20:04.907680 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:20:04.931684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:04.938218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:04.939314 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:20:04.940948 [info ] [MainThread]: 
[0m15:20:04.942163 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m15:20:04.944311 [debug] [MainThread]: Command end result
[0m15:20:05.102418 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:20:05.109575 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:20:05.117196 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:20:05.118112 [info ] [MainThread]: 
[0m15:20:05.119842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:05.120732 [info ] [MainThread]: 
[0m15:20:05.121699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:20:05.126804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.167721, "process_in_blocks": "0", "process_kernel_time": 1.255235, "process_mem_max_rss": "376120", "process_out_blocks": "0", "process_user_time": 3.803495}
[0m15:20:05.129236 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:05.129062 after 9.17 seconds
[0m15:20:05.131051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3377080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f812750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f812cc0>]}
[0m15:20:05.131958 [debug] [MainThread]: Flushing usage events
[0m15:20:05.629412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:40.812032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07bf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb063e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0317e00>]}


============================== 15:21:40.818082 | bd854ae6-1cf8-4b60-be04-b1d95f634a5d ==============================
[0m15:21:40.818082 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:21:40.819864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select agg_pollution_by_day --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:43.179582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd854ae6-1cf8-4b60-be04-b1d95f634a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb258b470>]}
[0m15:21:43.216751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd854ae6-1cf8-4b60-be04-b1d95f634a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c4c5f0>]}
[0m15:21:43.218405 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:21:43.427531 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:21:43.574130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:43.577283 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m15:21:43.901287 [error] [MainThread]: Encountered an error:
Compilation Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Encountered unknown tag 'endif'.
    line 12
      {% endif %}
[0m15:21:43.904384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.138223, "process_in_blocks": "0", "process_kernel_time": 1.565836, "process_mem_max_rss": "364892", "process_out_blocks": "0", "process_user_time": 3.584371}
[0m15:21:43.905480 [debug] [MainThread]: Command `dbt run` failed at 15:21:43.905383 after 3.14 seconds
[0m15:21:43.906221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c2e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969f88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969f8a10>]}
[0m15:21:43.907437 [debug] [MainThread]: Flushing usage events
[0m15:21:44.331686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:08.503846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5af9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f33470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cbfe90>]}


============================== 15:22:08.507951 | e7a84fcd-d837-485e-b4a4-6df860b5f7bb ==============================
[0m15:22:08.507951 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:22:08.509122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select agg_pollution_by_day --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:11.487678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9f7d10>]}
[0m15:22:11.528253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6564080>]}
[0m15:22:11.530092 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:22:11.791798 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:22:11.962626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:11.965317 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m15:22:12.801918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bed5190>]}
[0m15:22:12.987938 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:22:12.995103 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:22:13.022543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc91a90>]}
[0m15:22:13.023604 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:22:13.024815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0f5f10>]}
[0m15:22:13.027546 [info ] [MainThread]: 
[0m15:22:13.028627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:13.029382 [info ] [MainThread]: 
[0m15:22:13.030821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:13.037035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:22:13.039680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:13.516726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:22:13.518830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:13.952083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdd6270>]}
[0m15:22:13.954702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:13.962340 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:22:13.963677 [info ] [Thread-1 (]: 1 of 1 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:22:13.964920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.agg_pollution_by_day)
[0m15:22:13.965842 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:22:14.315513 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:22:14.341855 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:22:14.427843 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
  DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
  
GROUP BY 
  1, 2, 3
    );
  
[0m15:22:14.429615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:15.318739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2e99cec1-aeed-4390-9554-17fb97086c16&page=queryresults
[0m15:22:17.701981 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:22:17.735953 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:22:17.745229 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m15:22:18.104166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:54dd8a27-a36a-458b-888f-96f6dbe436df&page=queryresults
[0m15:22:21.393537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a84fcd-d837-485e-b4a4-6df860b5f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff910f90d0>]}
[0m15:22:21.398085 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (0.0 rows, 0 processed)[0m in 7.42s]
[0m15:22:21.400837 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:22:21.409035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:21.416416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:21.417173 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:22:21.418255 [info ] [MainThread]: 
[0m15:22:21.419480 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m15:22:21.421665 [debug] [MainThread]: Command end result
[0m15:22:21.577582 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:22:21.586506 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:22:21.596802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:22:21.597609 [info ] [MainThread]: 
[0m15:22:21.598837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:21.599810 [info ] [MainThread]: 
[0m15:22:21.601249 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:22:21.607884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.1483345, "process_in_blocks": "0", "process_kernel_time": 2.197037, "process_mem_max_rss": "376204", "process_out_blocks": "0", "process_user_time": 5.011337}
[0m15:22:21.612609 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:21.612390 after 13.15 seconds
[0m15:22:21.614482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa217080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bed7260>]}
[0m15:22:21.615487 [debug] [MainThread]: Flushing usage events
[0m15:22:22.115155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:51.081155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f723590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f604c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb8e330>]}


============================== 15:28:51.086770 | 8b7c72e0-48ab-4140-af09-8a5840aca4b2 ==============================
[0m15:28:51.086770 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:28:51.087996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging_cities', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:28:53.309656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86160bc0>]}
[0m15:28:53.342897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bc4e30>]}
[0m15:28:53.344342 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:28:53.779963 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:28:53.859470 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:28:53.860819 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m15:28:53.861778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fab13d0>]}
[0m15:28:54.826811 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:28:54.890463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c65880>]}
[0m15:28:55.051949 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:28:55.059663 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:28:55.092603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8505cbc0>]}
[0m15:28:55.094067 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:28:55.095254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850d1eb0>]}
[0m15:28:55.097636 [info ] [MainThread]: 
[0m15:28:55.098586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:28:55.099805 [info ] [MainThread]: 
[0m15:28:55.101497 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:28:55.103478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:28:55.104147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:55.569089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:28:55.570415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:55.924024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853031d0>]}
[0m15:28:55.926964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:55.939357 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m15:28:55.943210 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m15:28:55.945293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m15:28:55.946619 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:28:55.958599 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:28:55.963246 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:28:55.984411 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:28:55.987676 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:28:55.988568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:57.569865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:99cc50ab-bbef-4e73-ae19-b039b666e54a&page=queryresults
[0m15:28:57.889288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c72e0-48ab-4140-af09-8a5840aca4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac45400>]}
[0m15:28:57.891009 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m15:28:57.892211 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:28:57.895265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:57.897908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:57.898595 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m15:28:57.899761 [info ] [MainThread]: 
[0m15:28:57.901376 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m15:28:57.903119 [debug] [MainThread]: Command end result
[0m15:28:58.008907 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:28:58.013916 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:28:58.020895 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:28:58.021544 [info ] [MainThread]: 
[0m15:28:58.022617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:58.023341 [info ] [MainThread]: 
[0m15:28:58.024255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:28:58.027872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.998002, "process_in_blocks": "0", "process_kernel_time": 1.207289, "process_mem_max_rss": "381460", "process_out_blocks": "0", "process_user_time": 4.097186}
[0m15:28:58.029409 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:58.029259 after 7.00 seconds
[0m15:28:58.030418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe224e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85377aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bc50a0>]}
[0m15:28:58.031157 [debug] [MainThread]: Flushing usage events
[0m15:28:58.512726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:44.412076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c5f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bb91c0>]}


============================== 15:29:44.418329 | b053b3c0-4a47-4200-9202-e24b74fa0e85 ==============================
[0m15:29:44.418329 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:29:44.419512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:29:46.634585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcaefc0>]}
[0m15:29:46.669090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb58af2f0>]}
[0m15:29:46.670882 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:29:46.898408 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:29:46.972647 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:29:46.974175 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m15:29:46.974997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b372e40>]}
[0m15:29:47.876029 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:29:47.949574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a72e990>]}
[0m15:29:48.122499 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:29:48.129474 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:29:48.157190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a527020>]}
[0m15:29:48.158559 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:29:48.160162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a72f950>]}
[0m15:29:48.164237 [info ] [MainThread]: 
[0m15:29:48.165161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:48.166353 [info ] [MainThread]: 
[0m15:29:48.167877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:48.169645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:29:48.170391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:48.595146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:29:48.600373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:48.942473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64e7830>]}
[0m15:29:48.952848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:48.974545 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:29:48.977306 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m15:29:48.978521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m15:29:48.979604 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:29:48.995020 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:29:49.041885 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m15:29:49.043110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:49.788353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dc9ad803-437b-41ab-8346-86b9a901655f&page=queryresults
[0m15:29:50.518755 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m15:29:51.117891 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1864e9cd-3d2a-4329-a9dd-963055362f36&page=queryresults
[0m15:29:53.148446 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m15:29:53.681499 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:29:54.281589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3e7d4137-5b90-4e18-bb1c-2d2b0d4725a5&page=queryresults
[0m15:29:54.422199 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:29:54.643810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e65bbbb2-6a23-4ed4-b1e1-9f72369763a7&page=queryresults
[0m15:29:54.766957 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m15:29:54.779672 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m15:29:55.108023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:15b343e4-ef3f-4ac9-a695-8c523db014a1&page=queryresults
[0m15:29:56.999092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b053b3c0-4a47-4200-9202-e24b74fa0e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0348f80>]}
[0m15:29:57.004806 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (106.0 rows, 17.8 KiB processed)[0m in 8.02s]
[0m15:29:57.007748 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:29:57.045286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:57.056505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:57.057410 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m15:29:57.058654 [info ] [MainThread]: 
[0m15:29:57.059980 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m15:29:57.062193 [debug] [MainThread]: Command end result
[0m15:29:57.193902 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:29:57.203489 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:29:57.211205 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:29:57.211959 [info ] [MainThread]: 
[0m15:29:57.212988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:57.213725 [info ] [MainThread]: 
[0m15:29:57.214579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:57.222889 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.853497, "process_in_blocks": "0", "process_kernel_time": 1.307293, "process_mem_max_rss": "382688", "process_out_blocks": "0", "process_user_time": 4.324435}
[0m15:29:57.227135 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:29:57.226833 after 12.86 seconds
[0m15:29:57.228665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5935460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a969a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a90a660>]}
[0m15:29:57.229524 [debug] [MainThread]: Flushing usage events
[0m15:29:57.789052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:20.877729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f321e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939be1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944562a0>]}


============================== 15:30:20.882378 | 02804a85-13ea-4c4c-a240-71e70b8a452c ==============================
[0m15:30:20.882378 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:30:20.883668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:22.541647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d5b6b0>]}
[0m15:30:22.574793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9156d640>]}
[0m15:30:22.576059 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:30:22.743986 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:30:22.937273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:22.938237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:22.978879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78224950>]}
[0m15:30:23.259964 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:30:23.263214 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:30:23.280068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77e64260>]}
[0m15:30:23.280949 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:30:23.281728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78225b20>]}
[0m15:30:23.283692 [info ] [MainThread]: 
[0m15:30:23.284429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:23.285156 [info ] [MainThread]: 
[0m15:30:23.285940 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:30:23.291089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:30:23.292004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:23.690130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:30:23.693516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:24.010498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e35160>]}
[0m15:30:24.011775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:24.017170 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:30:24.017521 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:30:24.019044 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:30:24.018102 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:30:24.021390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:30:24.019942 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:30:24.022254 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:30:24.022984 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:30:24.034997 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:30:24.038862 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:30:24.042770 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:30:24.043239 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:30:24.092998 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:30:24.100471 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:30:24.101799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:24.103114 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:30:24.104194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:24.539531 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:80cad666-d06b-429b-8f6f-14fe5307f5e0&page=queryresults
[0m15:30:24.648814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fe2ec33c-6da2-4fac-89a5-6fbee2cc9a80&page=queryresults
[0m15:30:24.837459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ceb0e60>]}
[0m15:30:24.838825 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m15:30:24.839859 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:30:24.840971 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:30:24.841804 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:30:24.842876 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:30:24.843690 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:30:24.847298 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:30:24.849957 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:30:24.857463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:30:25.249677 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:30:25.253617 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:30:25.637971 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5082d096-31a3-4a08-ba43-f44418e8dd45&page=queryresults
[0m15:30:27.114307 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:30:27.143679 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:30:27.147925 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff741e5e80>]}
[0m15:30:27.149454 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 11.8 KiB processed)[0m in 2.30s]
[0m15:30:27.150099 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:30:27.151660 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:30:27.470059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f891cab2-99ff-4d02-9c66-c677bb01cecc&page=queryresults
[0m15:30:29.247737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77fbcb30>]}
[0m15:30:29.250670 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 5.23s]
[0m15:30:29.252656 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:30:29.255194 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:30:29.256376 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:30:29.257804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:30:29.259682 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:30:29.265477 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:30:29.268991 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:30:29.271994 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:30:29.272953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:29.837750 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70b565ee-6eb0-471a-b3a0-fb1456592daf&page=queryresults
[0m15:30:31.720698 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:30:31.725113 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:30:31.734374 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:30:32.081792 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2b6c9c68-79a1-499c-b403-aa3218014f9f&page=queryresults
[0m15:30:33.645394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57f09d30>]}
[0m15:30:33.653550 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.39s]
[0m15:30:33.658343 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:30:33.666058 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:30:33.668824 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:30:33.672187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:30:33.673876 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:30:33.685989 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:30:33.692317 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:30:33.696561 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
  DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
  
GROUP BY 
  1, 2, 3
    );
  
[0m15:30:33.697682 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:30:34.217760 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4f47bceb-ee6d-4124-b2c3-3ec30518ed9c&page=queryresults
[0m15:30:36.308598 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:30:36.311944 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:30:36.317198 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m15:30:36.622640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:19b5c81a-005c-47d4-a8be-cad6f976b799&page=queryresults
[0m15:30:38.552579 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02804a85-13ea-4c4c-a240-71e70b8a452c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57f6b3e0>]}
[0m15:30:38.559145 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.88s]
[0m15:30:38.578586 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:30:38.588580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:38.594306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:38.595679 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:30:38.596825 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:30:38.598123 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:30:38.599685 [info ] [MainThread]: 
[0m15:30:38.601100 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m15:30:38.603730 [debug] [MainThread]: Command end result
[0m15:30:38.715844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:30:38.722810 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:30:38.733556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:30:38.734366 [info ] [MainThread]: 
[0m15:30:38.735278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:38.736093 [info ] [MainThread]: 
[0m15:30:38.736927 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:30:38.741177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.905617, "process_in_blocks": "0", "process_kernel_time": 0.886591, "process_mem_max_rss": "373268", "process_out_blocks": "0", "process_user_time": 3.840536}
[0m15:30:38.742483 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:38.742366 after 17.91 seconds
[0m15:30:38.743743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9168d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff781497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce7bf20>]}
[0m15:30:38.744462 [debug] [MainThread]: Flushing usage events
[0m15:30:39.248326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:18.430246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b24aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c81a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b727bf0>]}


============================== 15:33:18.435169 | cd60f0a2-a8fc-4620-a0fa-85b7f0429570 ==============================
[0m15:33:18.435169 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:33:18.436342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m15:33:20.560920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7165f2f0>]}
[0m15:33:20.592634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa33dd0>]}
[0m15:33:20.593774 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:33:20.819735 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:33:20.940102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:20.940960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:20.977664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71719c10>]}
[0m15:33:21.217673 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:33:21.220899 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:33:21.238437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7171a540>]}
[0m15:33:21.239205 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:33:21.239914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713d8170>]}
[0m15:33:21.241837 [info ] [MainThread]: 
[0m15:33:21.242476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:21.243142 [info ] [MainThread]: 
[0m15:33:21.243863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:33:21.246526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:33:21.247064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:21.677560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:33:21.679760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:21.978759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d469c0>]}
[0m15:33:21.980148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:21.985207 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:33:21.985581 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:33:21.986231 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:33:21.987546 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:33:21.989657 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:33:21.988709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:33:21.990402 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:33:21.991056 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:33:21.997881 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:33:22.005103 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:33:22.010322 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:33:22.010636 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:33:22.056884 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:33:22.069738 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:33:22.070843 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:33:22.071318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:22.072452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:33:22.505815 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:52e55aa1-ed24-4278-806c-647d2dc75f5a&page=queryresults
[0m15:33:22.609780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:20c3e23c-4dcf-45f4-9852-ea24e28dbf00&page=queryresults
[0m15:33:22.830255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76391610>]}
[0m15:33:22.831881 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m15:33:22.833167 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:33:22.834408 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:33:22.835125 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:33:22.836078 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:33:22.840811 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:33:22.844041 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:33:22.846869 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:33:22.855669 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:33:23.375950 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:33:23.381137 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:33:23.655503 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9a878b55-4b70-4f9d-acf9-eb8e982b7282&page=queryresults
[0m15:33:24.671980 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:33:24.702289 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:33:24.706343 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:33:25.062531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bc4960c0-d9a6-4334-bbcb-6d4b4be63833&page=queryresults
[0m15:33:25.262338 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff694b8050>]}
[0m15:33:25.267666 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 11.8 KiB processed)[0m in 2.42s]
[0m15:33:25.273673 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:33:26.935700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7118d7f0>]}
[0m15:33:26.952115 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (2.5k rows, 213.6 KiB processed)[0m in 4.95s]
[0m15:33:26.961400 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:33:26.973842 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:33:26.980720 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:33:26.988343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:33:26.991564 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:33:27.003825 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:33:27.008820 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:33:27.013112 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:33:27.014251 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:27.598422 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d68294d-bac7-4ca2-b2f6-60d4e48d5302&page=queryresults
[0m15:33:29.440899 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:33:29.451609 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:33:29.468615 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:33:29.854709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3dc18c0f-79df-4649-a084-eaef18bfe948&page=queryresults
[0m15:33:31.587991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7165e4e0>]}
[0m15:33:31.589863 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (24.0 rows, 3.1 KiB processed)[0m in 4.60s]
[0m15:33:31.591687 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:33:31.593529 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:33:31.594709 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:33:31.595910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:33:31.597049 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:33:31.603201 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:33:31.606526 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:33:31.609443 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
  DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
  
GROUP BY 
  1, 2, 3
    );
  
[0m15:33:31.610718 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:32.097427 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a42450e0-0ea0-4ba4-8e8e-7729d552ad3e&page=queryresults
[0m15:33:34.178043 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:33:34.181128 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:33:34.185552 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m15:33:34.656259 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d95d1292-0814-4b8f-bf4f-d63f574af238&page=queryresults
[0m15:33:36.030899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd60f0a2-a8fc-4620-a0fa-85b7f0429570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff694179e0>]}
[0m15:33:36.034851 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (2.0 rows, 234.0 Bytes processed)[0m in 4.43s]
[0m15:33:36.043331 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:33:36.052377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:36.058874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:36.059679 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:33:36.060545 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:33:36.061233 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:33:36.062578 [info ] [MainThread]: 
[0m15:33:36.063595 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 14.82 seconds (14.82s).
[0m15:33:36.066237 [debug] [MainThread]: Command end result
[0m15:33:36.233930 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:33:36.241199 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:33:36.254660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:33:36.255440 [info ] [MainThread]: 
[0m15:33:36.256357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:36.257121 [info ] [MainThread]: 
[0m15:33:36.258030 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:33:36.263253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.873028, "process_in_blocks": "0", "process_kernel_time": 1.206326, "process_mem_max_rss": "373216", "process_out_blocks": "0", "process_user_time": 3.89048}
[0m15:33:36.264768 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:36.264615 after 17.88 seconds
[0m15:33:36.266421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae052e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716a4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716a4b30>]}
[0m15:33:36.267193 [debug] [MainThread]: Flushing usage events
[0m15:33:36.815485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:26.975817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb787a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb951eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb774b9e0>]}


============================== 15:52:26.980562 | 844c46bf-194e-4d05-bf0b-b384312b2aec ==============================
[0m15:52:26.980562 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:52:26.981839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:52:29.259668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6f3260>]}
[0m15:52:29.291657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba86e4b0>]}
[0m15:52:29.292774 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:52:29.453465 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:52:29.552980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:29.553872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:29.585972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6959d0>]}
[0m15:52:29.932757 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:52:29.938681 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:52:29.961400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d78c410>]}
[0m15:52:29.962786 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:52:29.963586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9da9f0>]}
[0m15:52:29.966363 [info ] [MainThread]: 
[0m15:52:29.967114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:29.967998 [info ] [MainThread]: 
[0m15:52:29.969890 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:29.974173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:52:29.975324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:30.390859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:52:30.393053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:30.730088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92a5010>]}
[0m15:52:30.731849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:30.742102 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:52:30.742763 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:52:30.743804 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:52:30.745522 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:52:30.747337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:52:30.748800 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:52:30.750554 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:52:30.751851 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:52:30.769305 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:52:30.775738 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:52:30.778987 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:52:30.779545 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:52:30.812194 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:52:30.833678 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m15:52:30.834611 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:52:30.835213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:30.836017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:52:31.288708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e24b5ece-056b-4332-8e16-f5ea94ecc2c9&page=queryresults
[0m15:52:31.378162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d6785081-f258-4635-b3c2-b89210877b47&page=queryresults
[0m15:52:31.632801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23150a0>]}
[0m15:52:31.635195 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m15:52:31.636467 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:52:31.639444 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:52:31.641006 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:52:31.643764 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:52:31.644655 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:52:31.647630 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:52:31.650959 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:52:31.659468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:52:32.008829 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:52:32.052480 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:52:32.414446 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a0bafa94-d2d2-4657-aa6c-c06d105336a3&page=queryresults
[0m15:52:33.725618 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:52:33.762201 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:52:33.773998 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m15:52:33.910929 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5dc440>]}
[0m15:52:33.922088 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 11.8 KiB processed)[0m in 2.27s]
[0m15:52:33.927938 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:52:34.165189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7836d8f2-47aa-4c9f-8805-d05c7f7b6f03&page=queryresults
[0m15:52:35.743681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0f44d0>]}
[0m15:52:35.753288 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (24.0 rows, 2.1 KiB processed)[0m in 4.99s]
[0m15:52:35.758834 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:52:35.781305 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:52:35.785176 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:52:35.787506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:52:35.789059 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:52:35.811843 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:52:35.816510 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:52:35.820545 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m15:52:35.822041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:36.413068 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b7cefd38-1140-4d66-9d54-d0ec9f690343&page=queryresults
[0m15:52:38.522692 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:52:38.526136 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:52:38.529707 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m15:52:38.868056 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:191ccd80-e826-4992-be4f-11633d332c9f&page=queryresults
[0m15:52:40.343107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955abb90>]}
[0m15:52:40.344482 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (24.0 rows, 3.1 KiB processed)[0m in 4.56s]
[0m15:52:40.345746 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:52:40.347993 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:52:40.349398 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:52:40.350916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m15:52:40.351816 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:52:40.356445 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:52:40.359022 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:52:40.365815 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
  DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
  
GROUP BY 
  1, 2, 3
    );
  
[0m15:52:40.367999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:40.928770 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:adb2d28c-58ea-4881-ada4-c7eae26e4507&page=queryresults
[0m15:52:43.105266 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:52:43.111407 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:52:43.117951 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m15:52:43.481606 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:38a5ad3b-62d2-4101-a11b-c69b91767a2e&page=queryresults
[0m15:52:44.735908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844c46bf-194e-4d05-bf0b-b384312b2aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953f71a0>]}
[0m15:52:44.744143 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (2.0 rows, 234.0 Bytes processed)[0m in 4.38s]
[0m15:52:44.768894 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:52:44.776008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:44.779710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:44.780608 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:52:44.781375 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:52:44.782106 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:52:44.783389 [info ] [MainThread]: 
[0m15:52:44.784472 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 14.81 seconds (14.81s).
[0m15:52:44.786228 [debug] [MainThread]: Command end result
[0m15:52:44.901693 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:52:44.909009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:52:44.920286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:52:44.920978 [info ] [MainThread]: 
[0m15:52:44.921675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:44.922503 [info ] [MainThread]: 
[0m15:52:44.923451 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:52:44.928758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.008379, "process_in_blocks": "0", "process_kernel_time": 1.579606, "process_mem_max_rss": "373296", "process_out_blocks": "0", "process_user_time": 3.884311}
[0m15:52:44.930692 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:44.930525 after 18.01 seconds
[0m15:52:44.931730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70da930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78cf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78ce6f0>]}
[0m15:52:44.932504 [debug] [MainThread]: Flushing usage events
[0m15:52:45.410152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:29.654242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c933e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e56cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a02e600>]}


============================== 15:59:29.658567 | 21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6 ==============================
[0m15:59:29.658567 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:59:29.659608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging_cities', 'send_anonymous_usage_stats': 'True'}
[0m15:59:31.585938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e758bc0>]}
[0m15:59:31.617741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e83fad0>]}
[0m15:59:31.618892 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:59:31.767282 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:59:31.837612 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:59:31.838734 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m15:59:31.839529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88021100>]}
[0m15:59:32.792759 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:59:32.860587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d58ed50>]}
[0m15:59:33.015176 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:59:33.019227 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:59:33.037610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d39d1c0>]}
[0m15:59:33.038458 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:59:33.039311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d66c590>]}
[0m15:59:33.041187 [info ] [MainThread]: 
[0m15:59:33.041887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:33.042509 [info ] [MainThread]: 
[0m15:59:33.043394 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:33.044637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:59:33.045210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:33.429545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:59:33.433209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:33.759617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d65d370>]}
[0m15:59:33.761399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:33.769643 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m15:59:33.771280 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m15:59:33.774467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m15:59:33.775395 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:59:33.782533 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:59:33.786439 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:59:33.806534 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:59:33.809569 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m15:59:33.810419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:34.257437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f9ea7a8c-dbb8-4b69-967b-ca0eb0f975cb&page=queryresults
[0m15:59:34.516456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c9dfbe-ee89-4fcc-a6e5-f11a6dcaf3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff731bd400>]}
[0m15:59:34.517775 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m15:59:34.519012 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:59:34.520946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:34.523165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:34.524029 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m15:59:34.524690 [info ] [MainThread]: 
[0m15:59:34.525348 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m15:59:34.526294 [debug] [MainThread]: Command end result
[0m15:59:34.617294 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:59:34.621113 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:59:34.626969 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:59:34.627601 [info ] [MainThread]: 
[0m15:59:34.628168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:34.628841 [info ] [MainThread]: 
[0m15:59:34.629522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:34.631112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.011252, "process_in_blocks": "0", "process_kernel_time": 1.010546, "process_mem_max_rss": "381468", "process_out_blocks": "0", "process_user_time": 4.148396}
[0m15:59:34.631754 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:34.631692 after 5.01 seconds
[0m15:59:34.632372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c25790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d369790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88773620>]}
[0m15:59:34.633302 [debug] [MainThread]: Flushing usage events
[0m15:59:35.200160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:41.909775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f8c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805a4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816f83e0>]}


============================== 15:59:41.913585 | 84f99c76-326e-427d-9a40-4b14c1145227 ==============================
[0m15:59:41.913585 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:59:41.915090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:43.752696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f8d760>]}
[0m15:59:43.784073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a55820>]}
[0m15:59:43.785318 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:59:43.935603 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:59:43.999419 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:59:44.000474 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m15:59:44.001202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a55250>]}
[0m15:59:45.003587 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m15:59:45.073382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66097530>]}
[0m15:59:45.314157 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:59:45.319109 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:59:45.340389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65da48f0>]}
[0m15:59:45.341202 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m15:59:45.342367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d910d0>]}
[0m15:59:45.344746 [info ] [MainThread]: 
[0m15:59:45.345488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:45.346173 [info ] [MainThread]: 
[0m15:59:45.347633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:45.349263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:59:45.350207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:45.762393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:59:45.763254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:46.042535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65e00ef0>]}
[0m15:59:46.043742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:46.050698 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:59:46.051788 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m15:59:46.052828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m15:59:46.053710 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:59:46.060812 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:59:46.096838 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m15:59:46.098097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:46.845529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:28f22b2c-88dd-4828-89ac-0ebb49a0c52d&page=queryresults
[0m15:59:47.739608 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m15:59:48.443283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fcb28516-d56a-4d7f-b7c2-04a6f088a98a&page=queryresults
[0m15:59:50.306495 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m15:59:50.807901 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:59:51.532092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4f568f85-f73a-4313-b313-2fb8c14dc967&page=queryresults
[0m15:59:51.662654 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m15:59:51.924171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ebce888c-c228-40c2-ad37-96c54388dc79&page=queryresults
[0m15:59:52.036251 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m15:59:52.043715 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m15:59:52.433636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5e370ae2-bbcf-4a0e-8703-2b0088694946&page=queryresults
[0m15:59:54.356055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f99c76-326e-427d-9a40-4b14c1145227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a0a10>]}
[0m15:59:54.364716 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (2.0 rows, 12.0 KiB processed)[0m in 8.30s]
[0m15:59:54.368601 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m15:59:54.383911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:54.396392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:54.397804 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m15:59:54.399571 [info ] [MainThread]: 
[0m15:59:54.400884 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m15:59:54.403829 [debug] [MainThread]: Command end result
[0m15:59:54.525714 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:59:54.532094 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:59:54.539304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:59:54.539984 [info ] [MainThread]: 
[0m15:59:54.541035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:54.541700 [info ] [MainThread]: 
[0m15:59:54.542388 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:54.546194 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.677466, "process_in_blocks": "0", "process_kernel_time": 0.82485, "process_mem_max_rss": "383048", "process_out_blocks": "0", "process_user_time": 4.383226}
[0m15:59:54.547539 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:59:54.547398 after 12.68 seconds
[0m15:59:54.548555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802cfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66eaf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65d97920>]}
[0m15:59:54.549447 [debug] [MainThread]: Flushing usage events
[0m15:59:55.017284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:05.367181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9985f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99645730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9983f890>]}


============================== 16:00:05.370901 | 35081140-f172-48f9-b99b-1d0ca566cf98 ==============================
[0m16:00:05.370901 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:00:05.372417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:07.389919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99172900>]}
[0m16:00:07.429607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989ce120>]}
[0m16:00:07.431161 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:00:07.600617 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m16:00:07.702626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:07.703483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:07.742066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998f7590>]}
[0m16:00:08.011032 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m16:00:08.016320 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m16:00:08.033461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2f8f50>]}
[0m16:00:08.034365 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m16:00:08.035261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f77c830>]}
[0m16:00:08.037451 [info ] [MainThread]: 
[0m16:00:08.038473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:08.039244 [info ] [MainThread]: 
[0m16:00:08.040087 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:08.044493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m16:00:08.046096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:08.454533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m16:00:08.455618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:08.834352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f77c830>]}
[0m16:00:08.835666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:08.842379 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m16:00:08.842831 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m16:00:08.843488 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m16:00:08.844623 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m16:00:08.845549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m16:00:08.846723 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m16:00:08.847501 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m16:00:08.848124 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m16:00:08.866011 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m16:00:08.869598 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m16:00:08.874216 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m16:00:08.874670 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m16:00:08.918645 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m16:00:08.927665 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m16:00:08.928860 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m16:00:08.929274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:08.930110 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:00:09.381975 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:601b1287-de0e-4fda-82f7-9746dc9bbbe6&page=queryresults
[0m16:00:09.595816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d937e6ba-105d-4ac3-b330-c791f725efb0&page=queryresults
[0m16:00:09.720281 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84305160>]}
[0m16:00:09.721508 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m16:00:09.722443 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m16:00:09.723787 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m16:00:09.724679 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m16:00:09.725586 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m16:00:09.726347 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m16:00:09.729348 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m16:00:09.732208 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m16:00:09.743183 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:10.055079 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m16:00:10.058321 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m16:00:10.450385 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7c1fbcfd-dfe3-4196-a057-c491222a0bd6&page=queryresults
[0m16:00:11.769945 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:00:11.802228 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m16:00:11.806193 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m16:00:12.103699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:44be318f-903e-4b63-82dc-ca53925f1002&page=queryresults
[0m16:00:12.214976 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff675674d0>]}
[0m16:00:12.218253 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 11.9 KiB processed)[0m in 2.49s]
[0m16:00:12.220495 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m16:00:14.062249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2c0350>]}
[0m16:00:14.085912 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (24.0 rows, 2.1 KiB processed)[0m in 5.21s]
[0m16:00:14.088578 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m16:00:14.094077 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m16:00:14.095348 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m16:00:14.097794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m16:00:14.100905 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m16:00:14.118480 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m16:00:14.126820 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m16:00:14.131101 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m16:00:14.132575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:14.754010 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7379f770-0ffe-4e46-9637-e6451d4d807e&page=queryresults
[0m16:00:17.049115 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:00:17.060852 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m16:00:17.069956 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m16:00:17.422643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:95cf0d20-2b11-4776-9dcd-9c1e303b14c0&page=queryresults
[0m16:00:19.039476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67434860>]}
[0m16:00:19.051372 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (24.0 rows, 2.9 KiB processed)[0m in 4.94s]
[0m16:00:19.055262 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m16:00:19.060423 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m16:00:19.063549 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m16:00:19.066169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m16:00:19.067988 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m16:00:19.078774 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m16:00:19.085111 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m16:00:19.089993 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt) as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt)) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
  DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
  
GROUP BY 
  1, 2, 3
    );
  
[0m16:00:19.092162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:00:19.683971 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5ecd8b97-8c18-45e1-b08f-eecb7fc9b91c&page=queryresults
[0m16:00:21.823087 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:00:21.832099 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m16:00:21.841784 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m16:00:22.225607 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:207a4b7e-89fc-48ea-b1ab-b61834bb1df7&page=queryresults
[0m16:00:23.795980 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35081140-f172-48f9-b99b-1d0ca566cf98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67431130>]}
[0m16:00:23.800394 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (2.0 rows, 216.0 Bytes processed)[0m in 4.73s]
[0m16:00:23.812969 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m16:00:23.822637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:23.832097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:23.833349 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m16:00:23.834897 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m16:00:23.836097 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m16:00:23.838087 [info ] [MainThread]: 
[0m16:00:23.839473 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 15.80 seconds (15.80s).
[0m16:00:23.842222 [debug] [MainThread]: Command end result
[0m16:00:23.954260 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m16:00:23.960149 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m16:00:23.970415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m16:00:23.971088 [info ] [MainThread]: 
[0m16:00:23.971834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:23.972417 [info ] [MainThread]: 
[0m16:00:23.973384 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:00:23.977559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.645092, "process_in_blocks": "0", "process_kernel_time": 0.998061, "process_mem_max_rss": "373508", "process_out_blocks": "0", "process_user_time": 3.986059}
[0m16:00:23.978691 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:23.978564 after 18.65 seconds
[0m16:00:23.979756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d75f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f77e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f66a1e0>]}
[0m16:00:23.980373 [debug] [MainThread]: Flushing usage events
[0m16:00:24.445257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:50.562182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c494f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bb3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bb3560>]}


============================== 17:33:50.567736 | 8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6 ==============================
[0m17:33:50.567736 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:33:50.569492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging_cities', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:53.485098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aacf3b0>]}
[0m17:33:53.532327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6baf7470>]}
[0m17:33:53.534407 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:33:53.801353 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:33:53.877799 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:33:53.879123 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m17:33:53.880180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a682bd0>]}
[0m17:33:55.688294 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:33:55.881572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a5c99d0>]}
[0m17:33:56.168934 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:33:56.202873 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:33:56.295779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6984a7e0>]}
[0m17:33:56.297074 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:33:56.298487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69803b00>]}
[0m17:33:56.302191 [info ] [MainThread]: 
[0m17:33:56.304170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:56.311269 [info ] [MainThread]: 
[0m17:33:56.313777 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:56.330044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:33:56.331262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:56.793578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:33:56.797545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:57.092939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b0f470>]}
[0m17:33:57.096440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:57.109679 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m17:33:57.111898 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m17:33:57.113513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m17:33:57.114531 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m17:33:57.125993 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m17:33:57.131428 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m17:33:57.265432 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m17:33:57.303056 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m17:33:57.307822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:58.269338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0c45cdce-4db5-47fe-ab59-6e22c34dd616&page=queryresults
[0m17:33:58.569852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff0a08d-ac8b-4c99-9a42-4b7586bea9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f659010>]}
[0m17:33:58.572181 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m17:33:58.573806 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m17:33:58.581282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:58.587381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:58.589017 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m17:33:58.590991 [info ] [MainThread]: 
[0m17:33:58.593641 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m17:33:58.597771 [debug] [MainThread]: Command end result
[0m17:33:58.709831 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:33:58.716056 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:33:58.727208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:33:58.728213 [info ] [MainThread]: 
[0m17:33:58.729603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:58.730782 [info ] [MainThread]: 
[0m17:33:58.732750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:33:58.742100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.22135, "process_in_blocks": "2552", "process_kernel_time": 1.810241, "process_mem_max_rss": "382748", "process_out_blocks": "0", "process_user_time": 5.429697}
[0m17:33:58.744742 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:58.744503 after 8.22 seconds
[0m17:33:58.746577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a9bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69ab08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582d520>]}
[0m17:33:58.747777 [debug] [MainThread]: Flushing usage events
[0m17:33:59.133998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:10.544007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90357a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90896de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902f1d00>]}


============================== 17:34:10.547794 | 9c8e1c40-f331-42e1-8b2e-a47edd71186b ==============================
[0m17:34:10.547794 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:34:10.548938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --target dev', 'send_anonymous_usage_stats': 'True'}
[0m17:34:12.646842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5fc830>]}
[0m17:34:12.679471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd856d0>]}
[0m17:34:12.680635 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:34:12.860276 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:34:12.935348 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:34:12.936398 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m17:34:12.937111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd85070>]}
[0m17:34:13.836907 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:34:13.917217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75311af0>]}
[0m17:34:14.075342 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:34:14.080194 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:34:14.103206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff750bba10>]}
[0m17:34:14.104275 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:34:14.105266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff750ffb00>]}
[0m17:34:14.107839 [info ] [MainThread]: 
[0m17:34:14.108732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:14.109413 [info ] [MainThread]: 
[0m17:34:14.110741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:14.113635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:34:14.114508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:14.508469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:34:14.509853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:14.772185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75417b90>]}
[0m17:34:14.773527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:14.781151 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:34:14.782186 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m17:34:14.783395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m17:34:14.784437 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:34:14.793023 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:34:14.848956 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m17:34:14.850347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:15.588451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d3d4b741-3ebb-4643-a035-758da15c6fe2&page=queryresults
[0m17:34:15.714557 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m17:34:15.971460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8f3a0a25-cd47-4de2-89ae-3e7136ba279f&page=queryresults
[0m17:34:16.136350 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m17:34:16.145710 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m17:34:16.789547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f3085a73-72ba-4aac-b835-530e643a253d&page=queryresults
[0m17:34:18.393226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c8e1c40-f331-42e1-8b2e-a47edd71186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75310cb0>]}
[0m17:34:18.395455 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mCREATE TABLE (1.0 rows, 47.0 Bytes processed)[0m in 3.61s]
[0m17:34:18.396904 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:34:18.399108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:18.402039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:18.402845 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m17:34:18.404022 [info ] [MainThread]: 
[0m17:34:18.405718 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m17:34:18.407204 [debug] [MainThread]: Command end result
[0m17:34:18.529033 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:34:18.534202 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:34:18.541910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:34:18.542762 [info ] [MainThread]: 
[0m17:34:18.544072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:18.545025 [info ] [MainThread]: 
[0m17:34:18.546670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:34:18.576302 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.0679245, "process_in_blocks": "8", "process_kernel_time": 1.14243, "process_mem_max_rss": "383512", "process_out_blocks": "0", "process_user_time": 4.050713}
[0m17:34:18.589063 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:34:18.588663 after 8.08 seconds
[0m17:34:18.615416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924efb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76015e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff754d5c70>]}
[0m17:34:18.627441 [debug] [MainThread]: Flushing usage events
[0m17:34:19.085513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:38.214714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a4aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808f26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f66ea0>]}


============================== 17:34:38.221278 | a77929e7-7806-448e-8ca5-0dcba1a42bb4 ==============================
[0m17:34:38.221278 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:34:38.223813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m17:34:40.781051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811332f0>]}
[0m17:34:40.832511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff670f38f0>]}
[0m17:34:40.834056 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:34:41.090296 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:34:41.213908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:41.214898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:41.261728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f559d0>]}
[0m17:34:41.551162 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:34:41.555930 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:34:41.576195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b9aa20>]}
[0m17:34:41.577332 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:34:41.578713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66bd26c0>]}
[0m17:34:41.581164 [info ] [MainThread]: 
[0m17:34:41.582010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:41.582728 [info ] [MainThread]: 
[0m17:34:41.583716 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:41.587540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:34:41.588473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:42.016926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:34:42.027374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:42.297515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66c03440>]}
[0m17:34:42.299033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:42.307188 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m17:34:42.308004 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m17:34:42.309030 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m17:34:42.310093 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m17:34:42.311416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m17:34:42.312748 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m17:34:42.314109 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m17:34:42.315044 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m17:34:42.331534 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m17:34:42.335929 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m17:34:42.342296 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m17:34:42.342986 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m17:34:42.369852 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m17:34:42.399286 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m17:34:42.399997 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m17:34:42.401337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:34:42.402422 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m17:34:42.403766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:42.849919 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:17821684-21c9-46ce-b815-1fe86609af46&page=queryresults
[0m17:34:43.019914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5905e8e5-0843-4e7a-8e82-25ee1da24461&page=queryresults
[0m17:34:43.119482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bbe0d70>]}
[0m17:34:43.120773 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m17:34:43.122447 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m17:34:43.123679 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m17:34:43.124994 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m17:34:43.125976 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m17:34:43.126852 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m17:34:43.130224 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m17:34:43.133753 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m17:34:43.143182 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m17:34:43.158108 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m17:34:43.162792 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:43.561064 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7d2a885-8c32-4dee-9283-6388c17ae8ca&page=queryresults
[0m17:34:44.533234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669de630>]}
[0m17:34:44.535388 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (37.2k rows, 2.8 MiB processed)[0m in 2.22s]
[0m17:34:44.536966 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m17:34:44.538751 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m17:34:44.539755 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m17:34:44.540777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m17:34:44.543144 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m17:34:44.548268 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m17:34:44.552250 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m17:34:44.555624 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m17:34:44.559190 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m17:34:44.560377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:45.014235 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1f91ab42-dd42-4f67-8728-216a85ecf8e6&page=queryresults
[0m17:34:45.024388 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dced80>]}
[0m17:34:45.025468 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 97.0 Bytes processed)[0m in 1.90s]
[0m17:34:45.031000 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m17:34:46.780129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669b3bf0>]}
[0m17:34:46.782017 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (37.2k rows, 3.1 MiB processed)[0m in 2.24s]
[0m17:34:46.783763 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m17:34:46.786359 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m17:34:46.787260 [info ] [Thread-1 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m17:34:46.788270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_air_pollution, now model.france_air_pollution.agg_pollution_by_day)
[0m17:34:46.789009 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m17:34:46.793481 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:34:46.799805 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m17:34:46.803298 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:34:46.807314 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
      pollution_quality 
    IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')
    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt, 'Europe/Paris')) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
  pollution
WHERE 
  
GROUP BY 
  1, 2, 3
    );
  
[0m17:34:46.809445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:47.072767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5001db08-1075-42af-9c35-5b7576e67036&page=queryresults
[0m17:34:47.074716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5001db08-1075-42af-9c35-5b7576e67036&page=queryresults
[0m17:34:47.089749 [debug] [Thread-1 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Unexpected keyword GROUP at [49:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m17:34:47.091853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77929e7-7806-448e-8ca5-0dcba1a42bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80296bd0>]}
[0m17:34:47.093762 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.30s]
[0m17:34:47.095014 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m17:34:47.096052 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Unexpected keyword GROUP at [49:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql.
[0m17:34:47.100866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:47.104108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:47.105658 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m17:34:47.107787 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m17:34:47.108839 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m17:34:47.111846 [info ] [MainThread]: 
[0m17:34:47.114284 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m17:34:47.120607 [debug] [MainThread]: Command end result
[0m17:34:47.221474 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:34:47.227349 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:34:47.245134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:34:47.245928 [info ] [MainThread]: 
[0m17:34:47.246904 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:47.247975 [info ] [MainThread]: 
[0m17:34:47.248912 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m17:34:47.249927 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Unexpected keyword GROUP at [49:1]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m17:34:47.250662 [info ] [MainThread]: 
[0m17:34:47.251481 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m17:34:47.256375 [info ] [MainThread]: 
[0m17:34:47.257649 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:34:47.262969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.10078, "process_in_blocks": "640", "process_kernel_time": 1.490078, "process_mem_max_rss": "376160", "process_out_blocks": "0", "process_user_time": 4.068827}
[0m17:34:47.264932 [debug] [MainThread]: Command `dbt run` failed at 17:34:47.264727 after 9.10 seconds
[0m17:34:47.266212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8101bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67722270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67811940>]}
[0m17:34:47.267195 [debug] [MainThread]: Flushing usage events
[0m17:34:47.741482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:15.179284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d752e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6df1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8d54c0>]}


============================== 17:36:15.183824 | 159b7739-4a93-4f20-9331-6ec422492590 ==============================
[0m17:36:15.183824 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:36:15.185046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m17:36:17.482629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '159b7739-4a93-4f20-9331-6ec422492590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9cddf0>]}
[0m17:36:17.519002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '159b7739-4a93-4f20-9331-6ec422492590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d76ff80>]}
[0m17:36:17.520403 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:36:17.696805 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:36:17.891281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:17.893063 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m17:36:18.167254 [error] [MainThread]: Encountered an error:
Compilation Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Encountered unknown tag 'endif'.
    line 12
      {% endif %}
[0m17:36:18.170364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.029771, "process_in_blocks": "16", "process_kernel_time": 1.255319, "process_mem_max_rss": "366184", "process_out_blocks": "0", "process_user_time": 3.064635}
[0m17:36:18.172088 [debug] [MainThread]: Command `dbt run` failed at 17:36:18.171906 after 3.03 seconds
[0m17:36:18.173836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9822a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e107b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878b9b80>]}
[0m17:36:18.174793 [debug] [MainThread]: Flushing usage events
[0m17:36:18.654007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:43.608265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b012e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b256060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3ceed0>]}


============================== 17:36:43.612846 | 0ff793bf-3402-4629-bde4-4860678eb6ce ==============================
[0m17:36:43.612846 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:36:43.614155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:46.248373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff793bf-3402-4629-bde4-4860678eb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f72240>]}
[0m17:36:46.282554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ff793bf-3402-4629-bde4-4860678eb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7fafc0>]}
[0m17:36:46.283810 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:36:46.455631 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:36:46.560477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:46.562304 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m17:36:46.847550 [error] [MainThread]: Encountered an error:
Compilation Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Unexpected end of template. Jinja was looking for the following tags: 'elif' or 'else' or 'endif'. The innermost block that needs to be closed is 'if'.
    line 39
      DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM {{ this }})
[0m17:36:46.856254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3049545, "process_in_blocks": "0", "process_kernel_time": 1.460838, "process_mem_max_rss": "366196", "process_out_blocks": "0", "process_user_time": 3.21425}
[0m17:36:46.898422 [debug] [MainThread]: Command `dbt run` failed at 17:36:46.891450 after 3.34 seconds
[0m17:36:46.913110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4aef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9961bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f62bc20>]}
[0m17:36:46.925088 [debug] [MainThread]: Flushing usage events
[0m17:36:47.401215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:02.285379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89520bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1c0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89939a60>]}


============================== 17:38:02.290083 | c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6 ==============================
[0m17:38:02.290083 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:38:02.291283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:04.882599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fc28050>]}
[0m17:38:04.920342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ffe4ef0>]}
[0m17:38:04.922203 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:38:05.099717 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:38:05.218919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:05.220264 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m17:38:05.744637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f35f500>]}
[0m17:38:05.867307 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:38:05.871488 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:38:05.904912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f3fbb90>]}
[0m17:38:05.906083 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:38:05.907075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f605fd0>]}
[0m17:38:05.909904 [info ] [MainThread]: 
[0m17:38:05.912899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:05.916240 [info ] [MainThread]: 
[0m17:38:05.917789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:05.926883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:38:05.928608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:06.337639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:38:06.338957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:06.621965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f4638f0>]}
[0m17:38:06.623842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:06.631845 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m17:38:06.632324 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m17:38:06.633200 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m17:38:06.634303 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m17:38:06.635594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m17:38:06.637858 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m17:38:06.636781 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m17:38:06.649293 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m17:38:06.649735 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m17:38:06.652959 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m17:38:06.655676 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m17:38:06.669962 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m17:38:06.701602 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m17:38:06.709715 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m17:38:06.710956 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m17:38:06.711482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:06.712252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:07.184663 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8282bbf6-5313-4ea6-a4d1-afe7714a4d2d&page=queryresults
[0m17:38:07.230852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3fcd10c-ca5e-4653-9c2e-5766e3fcadd0&page=queryresults
[0m17:38:07.555012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff746bcf20>]}
[0m17:38:07.556728 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m17:38:07.560537 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m17:38:07.561855 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m17:38:07.562930 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m17:38:07.564295 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m17:38:07.565021 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m17:38:07.568584 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m17:38:07.572006 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m17:38:07.581994 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:07.840395 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m17:38:07.844622 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m17:38:08.206508 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:92d577df-a5dc-4c95-b68c-d34270c0368b&page=queryresults
[0m17:38:08.982410 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:38:09.006009 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m17:38:09.011694 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m17:38:09.640142 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5754ffb0>]}
[0m17:38:09.646647 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 97.0 Bytes processed)[0m in 2.08s]
[0m17:38:09.649882 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m17:38:09.812837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:10752278-fcfc-4d17-a04b-7febd3b2aaa1&page=queryresults
[0m17:38:11.275225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f3369f0>]}
[0m17:38:11.287774 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.64s]
[0m17:38:11.291395 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m17:38:11.296159 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m17:38:11.298846 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m17:38:11.301236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m17:38:11.302589 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m17:38:11.316058 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m17:38:11.323271 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m17:38:11.334730 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m17:38:11.337905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:11.886189 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cd4a4f93-c4f7-4ccf-8aae-d0da1e1988b2&page=queryresults
[0m17:38:14.242852 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:38:14.247167 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m17:38:14.251819 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m17:38:14.571942 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:655552f6-e1f7-4b65-8ef6-ad378dce13f2&page=queryresults
[0m17:38:16.085685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57539100>]}
[0m17:38:16.090545 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.78s]
[0m17:38:16.092531 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m17:38:16.096170 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m17:38:16.097439 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m17:38:16.099250 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m17:38:16.100550 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m17:38:16.110897 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:38:16.115418 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m17:38:16.119652 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:38:16.122883 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DATE(dt, 'Europe/Paris')) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m17:38:16.124211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:16.703022 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d2b2de42-ac76-4435-b8f3-c44f0fcb0285&page=queryresults
[0m17:38:18.283477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ba936f-8b2c-4f76-a40c-bdfc5599f1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57411700>]}
[0m17:38:18.287876 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (1.6k rows, 3.6 MiB processed)[0m in 2.18s]
[0m17:38:18.290555 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m17:38:18.307743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:18.314722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:18.316015 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m17:38:18.317546 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m17:38:18.318422 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m17:38:18.320171 [info ] [MainThread]: 
[0m17:38:18.321615 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 12.40 seconds (12.40s).
[0m17:38:18.329559 [debug] [MainThread]: Command end result
[0m17:38:18.452772 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:38:18.460535 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:38:18.470699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:38:18.471482 [info ] [MainThread]: 
[0m17:38:18.472296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:18.473099 [info ] [MainThread]: 
[0m17:38:18.474010 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:38:18.479342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.23873, "process_in_blocks": "0", "process_kernel_time": 1.961116, "process_mem_max_rss": "379528", "process_out_blocks": "0", "process_user_time": 4.409093}
[0m17:38:18.481083 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:18.480939 after 16.24 seconds
[0m17:38:18.482292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894fee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f6275c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f624860>]}
[0m17:38:18.483332 [debug] [MainThread]: Flushing usage events
[0m17:38:18.941797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:25.442358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ea6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa919e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b16ea0>]}


============================== 17:44:25.447666 | 0ae59688-e37a-4e8c-8363-eba31dd146d2 ==============================
[0m17:44:25.447666 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:44:25.449069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging_cities', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:28.811580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900b7680>]}
[0m17:44:28.868158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2ee600>]}
[0m17:44:28.871899 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:44:29.245152 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m17:44:29.329505 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:44:29.331100 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m17:44:29.332256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec8e900>]}
[0m17:44:30.934307 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:44:31.049062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1298b0>]}
[0m17:44:31.251020 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:44:31.260427 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:44:31.297795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de21af0>]}
[0m17:44:31.299111 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:44:31.300082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed5d910>]}
[0m17:44:31.303885 [info ] [MainThread]: 
[0m17:44:31.304869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:44:31.305875 [info ] [MainThread]: 
[0m17:44:31.307979 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:31.310148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:44:31.311120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:31.732217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:44:31.733445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:32.036649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddf8c80>]}
[0m17:44:32.037834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:32.045931 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m17:44:32.047153 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m17:44:32.048202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m17:44:32.048973 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m17:44:32.056154 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m17:44:32.063059 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m17:44:32.084886 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m17:44:32.088633 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m17:44:32.089621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:32.471670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e4185561-522b-4b38-aaa4-072516ce2eb0&page=queryresults
[0m17:44:32.774784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae59688-e37a-4e8c-8363-eba31dd146d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c70b00>]}
[0m17:44:32.776093 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m17:44:32.777632 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m17:44:32.780129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:32.782688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:32.783748 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m17:44:32.785078 [info ] [MainThread]: 
[0m17:44:32.786110 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m17:44:32.787491 [debug] [MainThread]: Command end result
[0m17:44:32.873116 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:44:32.876675 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:44:32.882122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:44:32.882668 [info ] [MainThread]: 
[0m17:44:32.883472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:32.884074 [info ] [MainThread]: 
[0m17:44:32.885075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:44:32.888151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.501055, "process_in_blocks": "0", "process_kernel_time": 2.154322, "process_mem_max_rss": "383128", "process_out_blocks": "0", "process_user_time": 5.280857}
[0m17:44:32.889500 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:32.889395 after 7.50 seconds
[0m17:44:32.890490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ad55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e11c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ffb3e0>]}
[0m17:44:32.891629 [debug] [MainThread]: Flushing usage events
[0m17:44:33.363208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:40.980640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9973d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99392300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9973fe90>]}


============================== 17:44:40.984724 | a3f7088e-1a41-4a21-a68e-eadaa187db88 ==============================
[0m17:44:40.984724 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:44:40.985809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --target dev', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:44.776889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993af650>]}
[0m17:44:44.816978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9907bec0>]}
[0m17:44:44.819804 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:44:45.139094 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:44:45.241762 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:44:45.243061 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m17:44:45.244939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9973d310>]}
[0m17:44:46.500945 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m17:44:46.573412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebe6360>]}
[0m17:44:46.734967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:44:46.739866 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:44:46.757841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eabbb60>]}
[0m17:44:46.758793 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:44:46.759584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edf6570>]}
[0m17:44:46.761902 [info ] [MainThread]: 
[0m17:44:46.762787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:44:46.763560 [info ] [MainThread]: 
[0m17:44:46.765044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:46.766563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:44:46.767360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:47.173440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:44:47.174819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:47.428998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e50050>]}
[0m17:44:47.430462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:47.438971 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:44:47.440254 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m17:44:47.442268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m17:44:47.443331 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:44:47.450824 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:44:47.538565 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */
select * from (
        select city, region from (
                



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    
[0m17:44:47.541526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:48.383074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6fe97735-e378-4a08-b44a-b2074ac36a40&page=queryresults
[0m17:44:49.375364 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

        
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    );
  
    
[0m17:44:50.111584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0bc53a90-7692-464c-849b-24ef72532dab&page=queryresults
[0m17:44:51.754681 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`".
[0m17:44:52.156516 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`


    ),

    snapshotted_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`city` != source_data.`city`
        or
        (
            ((snapshotted_data.`city` is null) and not (source_data.`city` is null))
            or
            ((not snapshotted_data.`city` is null) and (source_data.`city` is null))
        ) or snapshotted_data.`region` != source_data.`region`
        or
        (
            ((snapshotted_data.`region` is null) and not (source_data.`region` is null))
            or
            ((not snapshotted_data.`region` is null) and (source_data.`region` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m17:44:52.772594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d0fc5932-0169-4db1-936c-39d06770249a&page=queryresults
[0m17:44:52.882737 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m17:44:53.147680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8cf1c993-57d8-4e24-a24f-e3073622c919&page=queryresults
[0m17:44:53.297890 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m17:44:53.304857 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      merge into `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities` as DBT_INTERNAL_DEST
    using `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`city_id`, `city`, `latitude`, `longitude`, `region`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)


  
[0m17:44:53.695285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0d06d8a0-a4c7-4620-b8c6-32fd32024fa3&page=queryresults
[0m17:44:55.444257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3f7088e-1a41-4a21-a68e-eadaa187db88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848dcf80>]}
[0m17:44:55.448764 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mMERGE (2.0 rows, 309.0 Bytes processed)[0m in 8.00s]
[0m17:44:55.451570 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m17:44:55.473549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:55.481702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:55.483521 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m17:44:55.484905 [info ] [MainThread]: 
[0m17:44:55.486130 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.72 seconds (8.72s).
[0m17:44:55.488554 [debug] [MainThread]: Command end result
[0m17:44:55.748834 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:44:55.801867 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:44:55.839150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:44:55.844311 [info ] [MainThread]: 
[0m17:44:55.846596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:55.847925 [info ] [MainThread]: 
[0m17:44:55.850997 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:44:55.867158 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.934208, "process_in_blocks": "0", "process_kernel_time": 1.929641, "process_mem_max_rss": "384444", "process_out_blocks": "0", "process_user_time": 5.544454}
[0m17:44:55.876979 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:44:55.876574 after 14.94 seconds
[0m17:44:55.880381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9933e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9fd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56d48a10>]}
[0m17:44:55.882084 [debug] [MainThread]: Flushing usage events
[0m17:44:56.486370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:22.538500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f323c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b7d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879c39e0>]}


============================== 17:45:22.543085 | 975b2531-3f2f-4248-9b63-6e07e76a30f2 ==============================
[0m17:45:22.543085 [info ] [MainThread]: Running with dbt=1.10.3
[0m17:45:22.544235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:26.020362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8984f3e0>]}
[0m17:45:26.224574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f337800>]}
[0m17:45:26.228650 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:45:26.438943 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m17:45:26.583352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:26.584642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:26.653187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dcda5d0>]}
[0m17:45:27.292253 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:45:27.298411 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:45:27.345717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9d1790>]}
[0m17:45:27.348073 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m17:45:27.350242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8785ed80>]}
[0m17:45:27.354640 [info ] [MainThread]: 
[0m17:45:27.358049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:27.359498 [info ] [MainThread]: 
[0m17:45:27.361059 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:27.366322 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m17:45:27.367442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:27.782922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m17:45:27.784028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:28.049947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f202c0>]}
[0m17:45:28.051180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:28.057185 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m17:45:28.057629 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m17:45:28.058530 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m17:45:28.059633 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m17:45:28.060669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m17:45:28.061844 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m17:45:28.063368 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m17:45:28.062725 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m17:45:28.071155 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m17:45:28.083679 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m17:45:28.087665 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m17:45:28.088526 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m17:45:28.122313 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m17:45:28.144750 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m17:45:28.146612 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m17:45:28.147006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:28.148089 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:28.682219 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:91ef15ee-77eb-4b83-99c8-e5a154794c3e&page=queryresults
[0m17:45:28.750960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7d60d27-f41d-463c-839f-846322d323c8&page=queryresults
[0m17:45:29.079213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729b0c80>]}
[0m17:45:29.082446 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m17:45:29.085345 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m17:45:29.088067 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m17:45:29.089232 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m17:45:29.090470 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m17:45:29.091167 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m17:45:29.095170 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m17:45:29.098583 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m17:45:29.108550 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:29.394885 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m17:45:29.402148 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m17:45:29.660994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:29a0e069-9036-43d0-971c-10a912a6bf0e&page=queryresults
[0m17:45:30.773520 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:45:30.798601 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m17:45:30.802642 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m17:45:31.103353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e3c23f40-de4c-4155-b4cd-8dfaf9e72f01&page=queryresults
[0m17:45:31.108828 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c432e10>]}
[0m17:45:31.111406 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 199.0 Bytes processed)[0m in 2.02s]
[0m17:45:31.112702 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m17:45:32.516097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d79b4d0>]}
[0m17:45:32.580414 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (24.0 rows, 2.0 KiB processed)[0m in 4.46s]
[0m17:45:32.607952 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m17:45:32.629333 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m17:45:32.631487 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m17:45:32.633077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m17:45:32.634010 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m17:45:32.640810 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m17:45:32.644077 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m17:45:32.647311 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m17:45:32.648180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:33.123702 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0acbf3cd-5c87-459d-8a3f-c6f7e4f6690f&page=queryresults
[0m17:45:34.928941 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:45:34.933201 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m17:45:34.938223 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m17:45:35.269873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cfe1581c-1d42-4dd2-8bf8-3b455d8d16f7&page=queryresults
[0m17:45:36.883013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d798710>]}
[0m17:45:36.894318 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (24.0 rows, 2.9 KiB processed)[0m in 4.25s]
[0m17:45:36.896642 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m17:45:36.901568 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m17:45:36.902999 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m17:45:36.906229 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m17:45:36.907646 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m17:45:36.921536 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:45:36.926407 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m17:45:36.931558 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DATE(dt, 'Europe/Paris')) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
    AND DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m17:45:36.932621 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:45:37.394922 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ce1e8f7a-7d37-4244-bda0-2b8339bc8b92&page=queryresults
[0m17:45:39.343345 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:45:39.347165 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m17:45:39.352047 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m17:45:39.650974 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c970ce98-856e-4852-9bad-324e612447e6&page=queryresults
[0m17:45:41.140433 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975b2531-3f2f-4248-9b63-6e07e76a30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dabb770>]}
[0m17:45:41.159243 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (1.0 rows, 110.0 Bytes processed)[0m in 4.23s]
[0m17:45:41.167615 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m17:45:41.176553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:41.181024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:41.181815 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m17:45:41.182997 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m17:45:41.183813 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m17:45:41.185237 [info ] [MainThread]: 
[0m17:45:41.186097 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 13.82 seconds (13.82s).
[0m17:45:41.188338 [debug] [MainThread]: Command end result
[0m17:45:41.324782 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m17:45:41.333651 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m17:45:41.347617 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m17:45:41.348617 [info ] [MainThread]: 
[0m17:45:41.350292 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:41.352092 [info ] [MainThread]: 
[0m17:45:41.353729 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:45:41.367721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.864248, "process_in_blocks": "0", "process_kernel_time": 2.017289, "process_mem_max_rss": "374640", "process_out_blocks": "0", "process_user_time": 5.121644}
[0m17:45:41.369383 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:41.369247 after 18.87 seconds
[0m17:45:41.370592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a94fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c526120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d8cd880>]}
[0m17:45:41.371361 [debug] [MainThread]: Flushing usage events
[0m17:45:41.830347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:30.110590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25e4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25e54f0>]}


============================== 20:07:30.115455 | 8468a857-e4b1-4415-bc61-7ad98618e18d ==============================
[0m20:07:30.115455 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:07:30.116725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging_cities --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m20:07:33.372533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983dd100>]}
[0m20:07:33.407045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986bf140>]}
[0m20:07:33.408302 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:07:33.630358 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m20:07:33.703548 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:07:33.704670 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m20:07:33.706937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9844b530>]}
[0m20:07:34.813992 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m20:07:35.004610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9704a330>]}
[0m20:07:35.169708 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:07:35.174131 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:07:35.221680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970474d0>]}
[0m20:07:35.223424 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m20:07:35.225390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f20c20>]}
[0m20:07:35.229286 [info ] [MainThread]: 
[0m20:07:35.230935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:35.234661 [info ] [MainThread]: 
[0m20:07:35.238071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:07:35.249589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m20:07:35.253496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:36.128684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m20:07:36.131459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:36.492336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9716f890>]}
[0m20:07:36.495183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:36.521880 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_cities
[0m20:07:36.523548 [info ] [Thread-1 (]: 1 of 1 START sql view model development.staging_cities ......................... [RUN]
[0m20:07:36.527315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_cities)
[0m20:07:36.530157 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_cities
[0m20:07:36.569908 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m20:07:36.584374 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_cities
[0m20:07:36.640687 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m20:07:36.660633 [debug] [Thread-1 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m20:07:36.665306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:37.220525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:88c90024-9a08-464d-a3a0-91760cf14916&page=queryresults
[0m20:07:37.568117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8468a857-e4b1-4415-bc61-7ad98618e18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd591f0>]}
[0m20:07:37.570126 [info ] [Thread-1 (]: 1 of 1 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m20:07:37.572132 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_cities
[0m20:07:37.575694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:37.578841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:37.579690 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_cities' was properly closed.
[0m20:07:37.580718 [info ] [MainThread]: 
[0m20:07:37.581678 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m20:07:37.583702 [debug] [MainThread]: Command end result
[0m20:07:37.760471 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:07:37.773020 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:07:37.782287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m20:07:37.783127 [info ] [MainThread]: 
[0m20:07:37.785466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:37.786617 [info ] [MainThread]: 
[0m20:07:37.788509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:37.799566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7326393, "process_in_blocks": "321872", "process_kernel_time": 1.837507, "process_mem_max_rss": "381176", "process_out_blocks": "0", "process_user_time": 4.598416}
[0m20:07:37.801517 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:37.801307 after 7.74 seconds
[0m20:07:37.805157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb43f1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3cd8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971b0c50>]}
[0m20:07:37.809938 [debug] [MainThread]: Flushing usage events
[0m20:07:38.315032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:54.335514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebece30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcc30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2cf620>]}


============================== 20:10:54.341222 | 8d62439b-03e4-40f8-92bd-fba1a730c52c ==============================
[0m20:10:54.341222 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:10:54.342236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m20:10:56.688661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de93d70>]}
[0m20:10:56.737872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec37aa0>]}
[0m20:10:56.739788 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:10:56.948705 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m20:10:57.026741 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:10:57.028018 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m20:10:57.028953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e65d2b0>]}
[0m20:10:58.061852 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.france_air_pollution.relationships_staging_air_pollution_city_id__id__ref_cities_.b4386e7693' (models/schema.yml) depends on a node named 'cities' in package '' which was not found
[0m20:10:58.124433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6faedc70>]}
[0m20:10:58.248133 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:10:58.253376 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:10:58.284004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f96c4a0>]}
[0m20:10:58.285490 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m20:10:58.286332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f987e90>]}
[0m20:10:58.291172 [info ] [MainThread]: 
[0m20:10:58.292607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:58.294965 [info ] [MainThread]: 
[0m20:10:58.297610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:58.306130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m20:10:58.307204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:58.696420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m20:10:58.699899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:59.159380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd702f0>]}
[0m20:10:59.162714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:59.176527 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m20:10:59.177160 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m20:10:59.178457 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m20:10:59.180626 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m20:10:59.182617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m20:10:59.185816 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m20:10:59.187111 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m20:10:59.188609 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m20:10:59.204596 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m20:10:59.209100 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m20:10:59.213080 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m20:10:59.213650 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m20:10:59.246011 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m20:10:59.266267 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

  AND dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`)

    );
  
[0m20:10:59.266660 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m20:10:59.267362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:59.268219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:10:59.664964 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1f53ba3-6121-4d56-90e9-be8015c417e6&page=queryresults
[0m20:10:59.724824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:685bce06-89f4-4c3a-9ee5-1e8443f71196&page=queryresults
[0m20:10:59.956961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f8af050>]}
[0m20:10:59.958471 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m20:10:59.962548 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m20:10:59.964497 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m20:10:59.965812 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m20:10:59.966869 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m20:10:59.967684 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m20:10:59.970596 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m20:10:59.976492 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m20:10:59.984310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:11:00.264640 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m20:11:00.268289 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m20:11:00.690605 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:12420fac-704a-4943-ab18-8cb6af815abc&page=queryresults
[0m20:11:01.439647 [debug] [Thread-1 (]: 
    In `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:11:01.470007 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m20:11:01.474448 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`staging_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)
    values
        (`city_id`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`)


    
[0m20:11:02.003811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:58614031-c332-40b2-89ab-60f24df25420&page=queryresults
[0m20:11:02.317115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f8b0d10>]}
[0m20:11:02.319012 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (1.0 rows, 199.0 Bytes processed)[0m in 2.35s]
[0m20:11:02.320262 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m20:11:03.589147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f80f8c0>]}
[0m20:11:03.597760 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.41s]
[0m20:11:03.604600 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m20:11:03.611346 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m20:11:03.613734 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m20:11:03.616511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m20:11:03.619038 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m20:11:03.643019 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m20:11:03.651394 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m20:11:03.656303 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
    WHERE dt > (SELECT MAX(dt) FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`)
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m20:11:03.657879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:11:04.900788 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:64a554c6-e958-4756-b423-54de31cf688c&page=queryresults
[0m20:11:06.663605 [debug] [Thread-2 (]: 
    In `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:11:06.672533 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m20:11:06.678121 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`fact_air_pollution` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)
    values
        (`city_id`, `city`, `region`, `dt`, `pollution_quality`, `sulfur_dioxide_so2`, `nitrogen_dioxide_no2`, `pm10`, `pm2_5`, `ozone_o3`, `carbon_monoxide_co`, `nh3`, `nitric_oxide_no`, `latitude`, `longitude`)


    
[0m20:11:07.040454 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1392e8b7-bf0c-4c9b-96d3-ac1aa2ad008e&page=queryresults
[0m20:11:08.493383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c57e660>]}
[0m20:11:08.500087 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.87s]
[0m20:11:08.504936 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m20:11:08.509682 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m20:11:08.510795 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m20:11:08.513098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m20:11:08.515049 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m20:11:08.538424 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m20:11:08.543116 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m20:11:08.551586 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DATE(dt, 'Europe/Paris')) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
    AND DATE(dt, 'Europe/Paris') > (SELECT MAX(date) FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`)
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m20:11:08.552630 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:11:09.014269 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a1faf0c3-0677-4fa1-a5f3-93713990934e&page=queryresults
[0m20:11:11.018317 [debug] [Thread-4 (]: 
    In `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:11:11.027059 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m20:11:11.033618 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day` as DBT_INTERNAL_DEST
        using (
        select
        * from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)
    values
        (`date`, `city`, `region`, `pollution_quality`, `count_days`, `avg_SO2`, `avg_NO2`, `avg_PM10`, `avg_PM2_5`, `avg_O3`, `avg_CO`, `avg_NH3`, `avg_NO`)


    
[0m20:11:11.339064 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:87b8f92a-d899-4977-a59a-9a9612a559b1&page=queryresults
[0m20:11:12.857064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d62439b-03e4-40f8-92bd-fba1a730c52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c459910>]}
[0m20:11:12.862910 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mMERGE (0.0 rows, 0 processed)[0m in 4.34s]
[0m20:11:12.865657 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m20:11:12.870154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:12.873976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:12.874670 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m20:11:12.875437 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m20:11:12.876970 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m20:11:12.878682 [info ] [MainThread]: 
[0m20:11:12.879790 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 14.58 seconds (14.58s).
[0m20:11:12.881938 [debug] [MainThread]: Command end result
[0m20:11:13.036463 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:11:13.043838 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:11:13.053850 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m20:11:13.055068 [info ] [MainThread]: 
[0m20:11:13.056019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:13.056734 [info ] [MainThread]: 
[0m20:11:13.057492 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:11:13.073890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.77597, "process_in_blocks": "0", "process_kernel_time": 1.415041, "process_mem_max_rss": "383480", "process_out_blocks": "0", "process_user_time": 4.903588}
[0m20:11:13.076061 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:13.075835 after 18.78 seconds
[0m20:11:13.077445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f172c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fc66cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fcdda30>]}
[0m20:11:13.079636 [debug] [MainThread]: Flushing usage events
[0m20:11:15.582854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:37.016020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b076930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db0efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b91cda0>]}


============================== 20:11:37.021723 | 30210742-cdf2-4561-ab2a-4699c31d8320 ==============================
[0m20:11:37.021723 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:11:37.024778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:40.108148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d5a2a0>]}
[0m20:11:40.148657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afed2e0>]}
[0m20:11:40.150299 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:11:40.342148 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m20:11:40.450316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:11:40.451367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:11:40.487474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61c88b60>]}
[0m20:11:40.744611 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:11:40.748350 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:11:40.769188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61baa990>]}
[0m20:11:40.770139 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m20:11:40.770951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61c8a030>]}
[0m20:11:40.773545 [info ] [MainThread]: 
[0m20:11:40.774473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:40.775255 [info ] [MainThread]: 
[0m20:11:40.776352 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:11:40.777751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m20:11:40.778444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:41.133128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m20:11:41.134664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:41.405519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff619d2570>]}
[0m20:11:41.407152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:41.414819 [debug] [Thread-1 (]: Began running node snapshot.france_air_pollution.snapshot_staging_cities
[0m20:11:41.417694 [info ] [Thread-1 (]: 1 of 1 START snapshot development.snapshot_staging_cities ...................... [RUN]
[0m20:11:41.419258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now snapshot.france_air_pollution.snapshot_staging_cities)
[0m20:11:41.421034 [debug] [Thread-1 (]: Began compiling node snapshot.france_air_pollution.snapshot_staging_cities
[0m20:11:41.432474 [debug] [Thread-1 (]: Began executing node snapshot.france_air_pollution.snapshot_staging_cities
[0m20:11:41.483871 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:11:41.485151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:42.133750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ba0aeb12-bddc-43e6-9c33-f769a0c2e2f1&page=queryresults
[0m20:11:42.247299 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

[0m20:11:42.488539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ed2c0b33-b01a-44b1-81da-6e18e12bab87&page=queryresults
[0m20:11:42.596183 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.france_air_pollution.snapshot_staging_cities"
[0m20:11:42.605400 [debug] [Thread-1 (]: On snapshot.france_air_pollution.snapshot_staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "snapshot.france_air_pollution.snapshot_staging_cities"} */

      
  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
      
    
    

    OPTIONS()
    as (
      
    

    select *,
        to_hex(md5(concat(coalesce(cast(city_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
from (
        



SELECT * FROM `paris-air-pollution-quangnc`.`development`.`staging_cities`

    ) sbq



    );
  
  
[0m20:11:43.187377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:24e4dd7a-016e-45d1-817c-20466cb2c9fc&page=queryresults
[0m20:11:44.718144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30210742-cdf2-4561-ab2a-4699c31d8320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669051c0>]}
[0m20:11:44.721686 [info ] [Thread-1 (]: 1 of 1 OK snapshotted development.snapshot_staging_cities ...................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 3.30s]
[0m20:11:44.724113 [debug] [Thread-1 (]: Finished running node snapshot.france_air_pollution.snapshot_staging_cities
[0m20:11:44.729725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:44.734048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:44.734853 [debug] [MainThread]: Connection 'snapshot.france_air_pollution.snapshot_staging_cities' was properly closed.
[0m20:11:44.735754 [info ] [MainThread]: 
[0m20:11:44.736801 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m20:11:44.738587 [debug] [MainThread]: Command end result
[0m20:11:44.849272 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:11:44.854568 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:11:44.863244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m20:11:44.863988 [info ] [MainThread]: 
[0m20:11:44.864945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:44.865592 [info ] [MainThread]: 
[0m20:11:44.866396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:11:44.872510 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.9335337, "process_in_blocks": "8", "process_kernel_time": 1.626651, "process_mem_max_rss": "371260", "process_out_blocks": "0", "process_user_time": 4.403064}
[0m20:11:44.876592 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:11:44.876387 after 7.94 seconds
[0m20:11:44.878239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0455e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61948620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61dba1b0>]}
[0m20:11:44.879757 [debug] [MainThread]: Flushing usage events
[0m20:11:45.244403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:59.622594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b54fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e7a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81769b20>]}


============================== 20:11:59.626145 | 183cbbbe-45ec-4130-8f40-a79b85179bdc ==============================
[0m20:11:59.626145 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:11:59.627312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target dev --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:01.508660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6817f620>]}
[0m20:12:01.554192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b34ec0>]}
[0m20:12:01.555809 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:12:01.726313 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m20:12:01.825384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:01.826204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:01.859428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f29760>]}
[0m20:12:02.141022 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:12:02.145056 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:12:02.167801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67b6ffb0>]}
[0m20:12:02.169673 [info ] [MainThread]: Found 5 models, 1 snapshot, 54 data tests, 2 sources, 496 macros
[0m20:12:02.171611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a1ed50>]}
[0m20:12:02.174388 [info ] [MainThread]: 
[0m20:12:02.177232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:02.179295 [info ] [MainThread]: 
[0m20:12:02.181771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:12:02.186724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m20:12:02.187957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:02.566700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m20:12:02.567832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:02.829889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67acc770>]}
[0m20:12:02.831226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:02.836956 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m20:12:02.838031 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m20:12:02.837328 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m20:12:02.839006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m20:12:02.839935 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m20:12:02.840886 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m20:12:02.841913 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m20:12:02.856257 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m20:12:02.856606 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m20:12:02.861496 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m20:12:02.862569 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m20:12:02.885805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:02.886168 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m20:12:02.945982 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m20:12:02.950971 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m20:12:02.952146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:12:03.254959 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m20:12:03.276481 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m20:12:03.439684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c5233876-d520-472f-a4b5-202248c169a9&page=queryresults
[0m20:12:03.524660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:30021282-f84b-4994-83a8-27eee13367be&page=queryresults
[0m20:12:03.645738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cba9130>]}
[0m20:12:03.646985 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m20:12:03.648352 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m20:12:03.649740 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m20:12:03.650640 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m20:12:03.652401 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m20:12:03.653217 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m20:12:03.656032 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m20:12:03.659184 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m20:12:03.668203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:12:03.922777 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m20:12:03.928607 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m20:12:04.182720 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d1190ffe-8538-4277-bc9e-e9a3791ef3a5&page=queryresults
[0m20:12:05.714312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6798c770>]}
[0m20:12:05.717798 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.06s]
[0m20:12:05.720015 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m20:12:10.418643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6798cda0>]}
[0m20:12:10.421329 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 298.6 MiB processed)[0m in 7.58s]
[0m20:12:10.424628 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m20:12:10.431756 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m20:12:10.433175 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m20:12:10.434709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m20:12:10.435960 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m20:12:10.455014 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m20:12:10.458886 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m20:12:10.464431 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:10.744051 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m20:12:10.751553 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m20:12:10.972505 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:de1d70eb-ee38-4d50-96e8-ca9854401434&page=queryresults
[0m20:12:17.209683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff47ed1430>]}
[0m20:12:17.219267 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 323.6 MiB processed)[0m in 6.77s]
[0m20:12:17.223263 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m20:12:17.230048 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m20:12:17.232215 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m20:12:17.237480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m20:12:17.240666 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m20:12:17.255482 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m20:12:17.262231 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m20:12:17.265706 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:12:17.543072 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m20:12:17.549206 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DATE(dt, 'Europe/Paris')) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m20:12:17.898836 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6a2bfbd7-79a9-4133-a26b-06ac2eb2f758&page=queryresults
[0m20:12:20.795205 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183cbbbe-45ec-4130-8f40-a79b85179bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff47d6ba70>]}
[0m20:12:20.802701 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.8k rows, 401.4 MiB processed)[0m in 3.56s]
[0m20:12:20.808732 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m20:12:20.822477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:20.831296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:20.833165 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m20:12:20.834640 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m20:12:20.835853 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m20:12:20.838491 [info ] [MainThread]: 
[0m20:12:20.840401 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 18.66 seconds (18.66s).
[0m20:12:20.844254 [debug] [MainThread]: Command end result
[0m20:12:21.049448 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m20:12:21.062875 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m20:12:21.076060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m20:12:21.076857 [info ] [MainThread]: 
[0m20:12:21.078289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:21.079266 [info ] [MainThread]: 
[0m20:12:21.080507 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:12:21.095177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.520086, "process_in_blocks": "0", "process_kernel_time": 0.962238, "process_mem_max_rss": "374140", "process_out_blocks": "0", "process_user_time": 3.701076}
[0m20:12:21.097727 [debug] [MainThread]: Command `dbt run` succeeded at 20:12:21.097496 after 21.52 seconds
[0m20:12:21.099190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82109f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6796f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6796f800>]}
[0m20:12:21.107442 [debug] [MainThread]: Flushing usage events
[0m20:12:21.583239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:40.900913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab25eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab3bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab39100>]}


============================== 22:17:40.966525 | fa18f779-a30d-4974-8fc2-6225aadce0d9 ==============================
[0m22:17:40.966525 [info ] [MainThread]: Running with dbt=1.10.3
[0m22:17:41.002418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:01.658182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa18f779-a30d-4974-8fc2-6225aadce0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9100d850>]}
[0m22:19:02.438782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa18f779-a30d-4974-8fc2-6225aadce0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a554c0>]}
[0m22:19:02.442454 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m22:19:07.291722 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m22:19:10.272004 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:19:10.329526 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m22:19:10.358843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa18f779-a30d-4974-8fc2-6225aadce0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7b0fb0>]}
[0m22:19:53.875393 [error] [MainThread]: Encountered an error:

[0m22:19:54.238840 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 384, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 702, in load_and_parse_macros
    self.macro_depends_on()
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 796, in macro_depends_on
    possible_macro_calls = statically_extract_macro_calls(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/clients/jinja_static.py", line 43, in statically_extract_macro_calls
    parsed = env.parse(source)
             ^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/environment.py", line 614, in parse
    return self._parse(source, name, filename)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 183, in _parse
    return MacroFuzzParser(self, source, name, filename).parse()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 1047, in parse
    result = nodes.Template(self.subparse(), lineno=1)
                            ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 1030, in subparse
    rv = self.parse_statement()
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 177, in parse_statement
    return f()  # type: ignore
           ^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 116, in parse_macro
    node.body = self.parse_statements(("name:endmacro",), drop_needle=True)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 214, in parse_statements
    result = self.subparse(end_tokens)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 1030, in subparse
    rv = self.parse_statement()
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 184, in parse_statement
    return ext(self)
           ^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/ext.py", line 599, in parse
    node.node = parser.parse_tuple()
                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 731, in parse_tuple
    args.append(parse())
                ^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 721, in parse
    return self.parse_expression(with_condexpr=with_condexpr)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 518, in parse_expression
    return self.parse_condexpr()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 523, in parse_condexpr
    expr1 = self.parse_or()
            ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 538, in parse_or
    left = self.parse_and()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 547, in parse_and
    left = self.parse_not()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 558, in parse_not
    return self.parse_compare()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 562, in parse_compare
    expr = self.parse_math1()
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 585, in parse_math1
    left = self.parse_concat()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 596, in parse_concat
    args = [self.parse_math2()]
            ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 606, in parse_math2
    left = self.parse_pow()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 617, in parse_pow
    left = self.parse_unary()
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 638, in parse_unary
    node = self.parse_postfix(node)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 789, in parse_postfix
    node = self.parse_call(node)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 932, in parse_call
    args, kwargs, dyn_args, dyn_kwargs = self.parse_call_args()
                                         ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 921, in parse_call_args
    args.append(self.parse_expression())
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 518, in parse_expression
    return self.parse_condexpr()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 523, in parse_condexpr
    expr1 = self.parse_or()
            ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 538, in parse_or
    left = self.parse_and()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 547, in parse_and
    left = self.parse_not()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 558, in parse_not
    return self.parse_compare()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 562, in parse_compare
    expr = self.parse_math1()
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 585, in parse_math1
    left = self.parse_concat()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 596, in parse_concat
    args = [self.parse_math2()]
            ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 606, in parse_math2
    left = self.parse_pow()
           ^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 617, in parse_pow
    left = self.parse_unary()
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 638, in parse_unary
    node = self.parse_postfix(node)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 789, in parse_postfix
    node = self.parse_call(node)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/jinja2/parser.py", line 933, in parse_call
    return nodes.Call(node, args, kwargs, dyn_args, dyn_kwargs, lineno=token.lineno)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m22:19:54.335364 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 134.093, "process_in_blocks": "19104", "process_kernel_time": 2.938454, "process_mem_max_rss": "364348", "process_out_blocks": "0", "process_user_time": 19.522963}
[0m22:19:54.431974 [debug] [MainThread]: Command `dbt test` failed at 22:19:54.431395 after 134.19 seconds
[0m22:19:54.487994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab25eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa70e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9103d670>]}
[0m22:19:54.516907 [debug] [MainThread]: Flushing usage events
[0m22:19:55.547266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:06.156460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805aae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809761e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804e3380>]}


============================== 22:21:06.227414 | 2053b0cd-ce3d-4111-bc0e-d1035308fae8 ==============================
[0m22:21:06.227414 [info ] [MainThread]: Running with dbt=1.10.3
[0m22:21:06.242571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:11.484590 [error] [MainThread]: Encountered an error:

[0m22:22:11.885381 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 251, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/config/runtime.py", line 78, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/config/profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/config/profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/config/profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/config/profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/adapters/factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/adapters/factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/__init__.py", line 4, in <module>
    from dbt.adapters.bigquery.impl import BigQueryAdapter, GrantTarget, PartitionConfig
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/impl.py", line 59, in <module>
    from dbt.adapters.bigquery.python_submissions import (
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/python_submissions.py", line 25, in <module>
    from google.cloud import aiplatform_v1
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/__init__.py", line 93, in <module>
    from .services.tensorboard_service import TensorboardServiceClient
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/__init__.py", line 16, in <module>
    from .client import TensorboardServiceClient
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/client.py", line 91, in <module>
    from .transports.base import TensorboardServiceTransport, DEFAULT_CLIENT_INFO
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/transports/__init__.py", line 22, in <module>
    from .rest import TensorboardServiceRestTransport
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/transports/rest.py", line 55, in <module>
    from .rest_base import _BaseTensorboardServiceRestTransport
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/transports/rest_base.py", line 45, in <module>
    class _BaseTensorboardServiceRestTransport(TensorboardServiceTransport):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/transports/rest_base.py", line 906, in _BaseTensorboardServiceRestTransport
    class _BaseGetTensorboardTimeSeries:
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1/services/tensorboard_service/transports/rest_base.py", line 936, in _BaseGetTensorboardTimeSeries
    @staticmethod
     ^^^^^^^^^^^^
KeyboardInterrupt

[0m22:22:12.070482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 66.70595, "process_in_blocks": "33168", "process_kernel_time": 1.813188, "process_mem_max_rss": "263356", "process_out_blocks": "0", "process_user_time": 12.253163}
[0m22:22:12.179156 [debug] [MainThread]: Command `dbt test` failed at 22:22:12.178513 after 66.93 seconds
[0m22:22:12.196128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805aae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a169fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6abfd010>]}
[0m22:22:12.255949 [debug] [MainThread]: Flushing usage events
[0m22:22:13.430395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:01.208485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969985c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93633800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9312caa0>]}


============================== 08:12:01.217803 | 78bf111f-3b40-44dd-ad12-dba816667eaf ==============================
[0m08:12:01.217803 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:12:01.219545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:49.343179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79905760>]}
[0m08:12:49.555801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7976f740>]}
[0m08:12:49.567232 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:12:53.709104 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:12:54.561715 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:12:54.570031 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m08:12:54.594925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ee10a0>]}
[0m08:13:11.834306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7844d4c0>]}
[0m08:13:13.141955 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:13:13.205421 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:13:13.629620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7837ec30>]}
[0m08:13:13.637347 [info ] [MainThread]: Found 5 models, 1 snapshot, 52 data tests, 2 sources, 496 macros
[0m08:13:13.640751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78219400>]}
[0m08:13:13.679108 [info ] [MainThread]: 
[0m08:13:13.685386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:13.687559 [info ] [MainThread]: 
[0m08:13:13.693000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:13:13.723775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m08:13:13.725750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:14.341594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf111f-3b40-44dd-ad12-dba816667eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7915cc50>]}
[0m08:13:14.344233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:14.413071 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:13:14.416390 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:13:14.416939 [debug] [Thread-3 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:13:14.417298 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:13:14.418073 [info ] [Thread-1 (]: 1 of 52 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m08:13:14.420443 [info ] [Thread-2 (]: 2 of 52 START test accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m08:13:14.423359 [info ] [Thread-3 (]: 3 of 52 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m08:13:14.434655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m08:13:14.463816 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:13:14.452681 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3'
[0m08:13:14.461232 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m08:13:14.519036 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:13:14.496705 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:13:14.430736 [info ] [Thread-4 (]: 4 of 52 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m08:13:14.522992 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m08:13:14.545203 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m08:13:14.549932 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m08:13:14.567415 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m08:13:14.683925 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:13:14.695518 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:13:14.701276 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:13:14.702722 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:13:14.853797 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m08:13:14.880399 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m08:13:14.883963 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m08:13:14.886510 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m08:13:14.888278 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:13:14.896875 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m08:13:14.898754 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m08:13:14.900400 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m08:13:14.902711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:13:14.901514 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:13:14.902277 [debug] [Thread-3 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m08:13:15.006845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:13:15.108988 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m08:13:15.176729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:15.952579 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1379ae57-e8a7-4576-ba61-10a7901191e7&page=queryresults
[0m08:13:16.068733 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:17701262-ea81-4360-883a-f579e5be65d9&page=queryresults
[0m08:13:16.282016 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aa9ec5dd-e377-4226-b713-7e4b8e659f73&page=queryresults
[0m08:13:16.293937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2f197a2c-f487-4659-a71b-a240beed2c6d&page=queryresults
[0m08:13:17.803636 [info ] [Thread-4 (]: 4 of 52 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 3.24s]
[0m08:13:17.818889 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:13:17.795427 [info ] [Thread-2 (]: 2 of 52 PASS accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 3.35s]
[0m08:13:17.843924 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:13:17.832170 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:13:17.853961 [info ] [Thread-4 (]: 5 of 52 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m08:13:17.860469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885)
[0m08:13:17.806529 [info ] [Thread-3 (]: 3 of 52 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 3.35s]
[0m08:13:17.851288 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:13:17.930129 [info ] [Thread-2 (]: 6 of 52 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m08:13:17.925197 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:13:17.886023 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:13:17.952077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m08:13:17.936275 [error] [Thread-1 (]: 1 of 52 FAIL 7 accepted_values_agg_pollution_by_day_count_days__False__1 ....... [[31mFAIL 7[0m in 3.46s]
[0m08:13:18.217396 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:13:18.304105 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:13:18.094328 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:13:18.329427 [info ] [Thread-3 (]: 7 of 52 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m08:13:18.348087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m08:13:18.360047 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:13:18.168608 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:13:18.304683 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m08:13:18.318195 [info ] [Thread-1 (]: 8 of 52 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m08:13:18.470133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m08:13:18.499257 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:13:18.378303 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m08:13:18.517885 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:13:18.524977 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m08:13:18.715220 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m08:13:18.720001 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:13:18.683020 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m08:13:18.793243 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:13:18.790904 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m08:13:18.766346 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:13:18.800240 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m08:13:18.859484 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:18.867054 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m08:13:18.876822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:18.853491 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m08:13:18.818253 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m08:13:19.886578 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m08:13:19.890203 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m08:13:19.952345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:19.966571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:21.332845 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8b09f208-063e-478b-94af-0085348ef480&page=queryresults
[0m08:13:21.349862 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4a85a454-b1ae-4d89-8c02-f72638af2228&page=queryresults
[0m08:13:21.316640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:747cbf9e-7b09-46f6-8af8-93cfe1fee868&page=queryresults
[0m08:13:21.353142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:24c19567-b4ab-41de-bf27-dba9b0dc9054&page=queryresults
[0m08:13:21.743664 [info ] [Thread-4 (]: 5 of 52 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 3.88s]
[0m08:13:21.752827 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:13:21.745059 [info ] [Thread-1 (]: 8 of 52 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 3.28s]
[0m08:13:21.800936 [info ] [Thread-3 (]: 7 of 52 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 3.45s]
[0m08:13:21.801844 [info ] [Thread-2 (]: 6 of 52 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 3.85s]
[0m08:13:21.811814 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:13:21.813569 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:13:21.810003 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:13:21.817826 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:13:21.820464 [info ] [Thread-3 (]: 11 of 52 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m08:13:21.815776 [info ] [Thread-2 (]: 10 of 52 START test not_null_agg_pollution_by_day_avg_PM2_5 .................... [RUN]
[0m08:13:21.826512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m08:13:21.808191 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:13:21.838515 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:13:21.840799 [info ] [Thread-1 (]: 12 of 52 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m08:13:21.843080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m08:13:21.824542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m08:13:21.802922 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:13:21.834801 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:13:21.847001 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:13:21.849189 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:13:21.856359 [info ] [Thread-4 (]: 9 of 52 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m08:13:21.946269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m08:13:21.974856 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:13:21.981978 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m08:13:21.974351 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m08:13:21.976682 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m08:13:21.976217 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m08:13:22.003989 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:13:22.016981 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:13:22.025921 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:13:22.042244 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m08:13:22.038454 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:13:22.047890 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m08:13:22.050255 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:13:22.052872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:22.039627 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m08:13:22.052020 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m08:13:22.066120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:22.037554 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m08:13:22.295234 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m08:13:22.608037 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:22.602225 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m08:13:22.615620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:23.996950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7b2bf167-3e74-4d24-a010-a6bda9aa19e7&page=queryresults
[0m08:13:24.100564 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:97616b09-2bdf-4d50-8a12-3dd27d730e60&page=queryresults
[0m08:13:24.130108 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d817cb43-1964-488e-bed2-61f149b4fece&page=queryresults
[0m08:13:24.225959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e8ad012f-aa3f-48ca-adfb-10328ef636d8&page=queryresults
[0m08:13:24.457502 [info ] [Thread-1 (]: 12 of 52 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 2.61s]
[0m08:13:24.462426 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:13:24.465660 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:13:24.467092 [info ] [Thread-1 (]: 13 of 52 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m08:13:24.468133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m08:13:24.460335 [info ] [Thread-3 (]: 11 of 52 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 2.64s]
[0m08:13:24.484251 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:13:24.507272 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:13:24.549958 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:13:24.563627 [info ] [Thread-2 (]: 10 of 52 PASS not_null_agg_pollution_by_day_avg_PM2_5 .......................... [[32mPASS[0m in 2.74s]
[0m08:13:24.620071 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:13:24.622494 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:13:24.623723 [info ] [Thread-2 (]: 15 of 52 START test not_null_staging_cities_city ............................... [RUN]
[0m08:13:24.646854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m08:13:24.666241 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:13:24.596688 [info ] [Thread-3 (]: 14 of 52 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m08:13:24.690805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m08:13:24.697859 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:13:24.679545 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m08:13:24.710332 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m08:13:24.698835 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m08:13:24.719329 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:13:24.725581 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m08:13:24.728492 [info ] [Thread-4 (]: 9 of 52 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 2.78s]
[0m08:13:24.733472 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:13:24.735125 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:13:24.737310 [info ] [Thread-4 (]: 16 of 52 START test not_null_staging_cities_city_id ............................ [RUN]
[0m08:13:24.739496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde)
[0m08:13:24.729442 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:13:24.746756 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m08:13:24.742476 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:13:24.743763 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:13:24.731487 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:13:24.769212 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m08:13:24.759477 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m08:13:24.776961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:24.757210 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m08:13:24.760909 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:24.798614 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m08:13:25.164347 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:13:25.453703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:25.856395 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m08:13:25.868783 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m08:13:25.870787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:26.386915 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0d5a96eb-fded-462c-9c55-29dfb7f4d9a4&page=queryresults
[0m08:13:26.528609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:650140d0-864c-41f4-85bf-7ae361c09589&page=queryresults
[0m08:13:26.678181 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fd89cc76-1afb-4d01-ae96-f2401da2d3fe&page=queryresults
[0m08:13:26.691249 [info ] [Thread-3 (]: 14 of 52 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 2.00s]
[0m08:13:26.698247 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:13:26.771746 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:13:26.778627 [info ] [Thread-3 (]: 17 of 52 START test not_null_staging_cities_latitude ........................... [RUN]
[0m08:13:26.791280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m08:13:26.805603 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:13:26.808628 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:501273b0-806a-4885-aaf0-fc18c9253922&page=queryresults
[0m08:13:26.883159 [info ] [Thread-1 (]: 13 of 52 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 2.41s]
[0m08:13:26.892810 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:13:26.895562 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:13:26.903314 [info ] [Thread-1 (]: 18 of 52 START test not_null_staging_cities_longitude .......................... [RUN]
[0m08:13:26.939800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m08:13:26.967526 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:13:27.048972 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m08:13:27.051398 [info ] [Thread-4 (]: 16 of 52 PASS not_null_staging_cities_city_id .................................. [[32mPASS[0m in 2.31s]
[0m08:13:27.070756 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:13:27.072055 [debug] [Thread-4 (]: Began running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220
[0m08:13:27.073948 [info ] [Thread-4 (]: 19 of 52 START test relationships_staging_air_pollution_city_id__city_id__source_sources_cities_  [RUN]
[0m08:13:27.078441 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde, now test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220)
[0m08:13:27.079662 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220
[0m08:13:27.056833 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m08:13:27.080330 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:13:27.125122 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:13:27.140805 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m08:13:27.127059 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220"
[0m08:13:27.126187 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m08:13:27.174183 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220
[0m08:13:27.178726 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m08:13:27.185029 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m08:13:27.207668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:27.197690 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220"
[0m08:13:27.223729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:27.241514 [debug] [Thread-4 (]: On test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    where city_id is not null
),

parent as (
    select city_id as to_field
    from `paris-air-pollution-quangnc`.`raw`.`cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:13:27.249410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:27.239830 [info ] [Thread-2 (]: 15 of 52 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 2.59s]
[0m08:13:27.409475 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:13:27.583892 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:13:27.589787 [info ] [Thread-2 (]: 20 of 52 START test source_not_null_sources_airpollution_carbon_monoxide_co .... [RUN]
[0m08:13:27.595226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31)
[0m08:13:27.602531 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:13:27.648989 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m08:13:27.667971 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:13:27.690151 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m08:13:27.717789 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m08:13:27.719429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:28.198189 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a71c5147-7ef9-499c-afc3-e81518be4c35&page=queryresults
[0m08:13:28.204260 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a71c5147-7ef9-499c-afc3-e81518be4c35&page=queryresults
[0m08:13:28.349534 [debug] [Thread-4 (]: Database Error in test relationships_staging_air_pollution_city_id__city_id__source_sources_cities_ (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [21:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/relationships_staging_air_poll_ad7d7ce2550af29b44fb5df756039333.sql
[0m08:13:28.367853 [error] [Thread-4 (]: 19 of 52 ERROR relationships_staging_air_pollution_city_id__city_id__source_sources_cities_  [[31mERROR[0m in 1.29s]
[0m08:13:28.396729 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220
[0m08:13:28.398479 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:13:28.407041 [debug] [Thread-7 (]: Marking all children of 'test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220' to be skipped because of status 'error'.  Reason: Database Error in test relationships_staging_air_pollution_city_id__city_id__source_sources_cities_ (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [21:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/relationships_staging_air_poll_ad7d7ce2550af29b44fb5df756039333.sql.
[0m08:13:28.409099 [info ] [Thread-4 (]: 21 of 52 START test source_not_null_sources_airpollution_city_index ............ [RUN]
[0m08:13:28.454646 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:19baedf2-ee6f-4fdc-be5c-3d3ae48ed8ab&page=queryresults
[0m08:13:28.549130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:60284072-44bb-4765-96c7-da0b8f4850b7&page=queryresults
[0m08:13:28.466624 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_staging_air_pollution_city_id__city_id__source_sources_cities_.a4def31220, now test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef)
[0m08:13:28.558948 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:13:28.690286 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fbecd71d-8d79-4a05-a70c-cabfbb595600&page=queryresults
[0m08:13:28.721412 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m08:13:28.748567 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:13:28.759422 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m08:13:28.768119 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m08:13:28.772393 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:28.948094 [info ] [Thread-3 (]: 17 of 52 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 2.16s]
[0m08:13:28.957596 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:13:28.967246 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:13:28.966165 [info ] [Thread-1 (]: 18 of 52 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 2.03s]
[0m08:13:28.969923 [info ] [Thread-3 (]: 22 of 52 START test source_not_null_sources_airpollution_nh3 ................... [RUN]
[0m08:13:29.003802 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:13:29.026911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85)
[0m08:13:29.045412 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:13:29.032563 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:13:29.067971 [info ] [Thread-2 (]: 20 of 52 PASS source_not_null_sources_airpollution_carbon_monoxide_co .......... [[32mPASS[0m in 1.47s]
[0m08:13:29.086786 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:13:29.088314 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:13:29.073057 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m08:13:29.077345 [info ] [Thread-1 (]: 23 of 52 START test source_not_null_sources_airpollution_nitric_oxide_no ....... [RUN]
[0m08:13:29.098173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1)
[0m08:13:29.107703 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:13:29.090874 [info ] [Thread-2 (]: 24 of 52 START test source_not_null_sources_airpollution_nitrogen_dioxide_no2 .. [RUN]
[0m08:13:29.120286 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:13:29.119572 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m08:13:29.127048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31, now test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec)
[0m08:13:29.137357 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:13:29.134749 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m08:13:29.164260 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:13:29.182048 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m08:13:29.176108 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m08:13:29.185313 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m08:13:29.186790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:29.190031 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m08:13:29.592106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:29.595079 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:13:29.598723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c9a088ee-32fd-4ade-ade3-2e3401d9e123&page=queryresults
[0m08:13:30.057067 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m08:13:30.075530 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m08:13:30.079133 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:30.544727 [info ] [Thread-4 (]: 21 of 52 PASS source_not_null_sources_airpollution_city_index .................. [[32mPASS[0m in 2.07s]
[0m08:13:30.565569 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:13:30.597260 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:13:30.609311 [info ] [Thread-4 (]: 25 of 52 START test source_not_null_sources_airpollution_ozone_o3 .............. [RUN]
[0m08:13:30.623137 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef, now test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361)
[0m08:13:30.642288 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:13:30.901462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1625a569-cafc-442b-befd-4d462d7e9f34&page=queryresults
[0m08:13:30.906175 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7dc518c-1380-41f5-bc30-3aab561c4120&page=queryresults
[0m08:13:30.923522 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m08:13:30.945201 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:13:30.953751 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m08:13:30.964681 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m08:13:30.966817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:31.243155 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3b319b6b-beed-4399-ad37-366aced7cf16&page=queryresults
[0m08:13:31.449727 [info ] [Thread-1 (]: 23 of 52 PASS source_not_null_sources_airpollution_nitric_oxide_no ............. [[32mPASS[0m in 2.35s]
[0m08:13:31.451510 [info ] [Thread-3 (]: 22 of 52 PASS source_not_null_sources_airpollution_nh3 ......................... [[32mPASS[0m in 2.43s]
[0m08:13:31.455135 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:13:31.465611 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:13:31.485490 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:13:31.498593 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:13:31.503080 [info ] [Thread-1 (]: 26 of 52 START test source_not_null_sources_airpollution_pm10 .................. [RUN]
[0m08:13:31.505949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1, now test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085)
[0m08:13:31.504644 [info ] [Thread-3 (]: 27 of 52 START test source_not_null_sources_airpollution_pm2_5 ................. [RUN]
[0m08:13:31.508418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85, now test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e)
[0m08:13:31.507299 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:13:31.509703 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:13:31.561946 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m08:13:31.575109 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m08:13:31.579445 [info ] [Thread-2 (]: 24 of 52 PASS source_not_null_sources_airpollution_nitrogen_dioxide_no2 ........ [[32mPASS[0m in 2.45s]
[0m08:13:31.587409 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:13:31.589278 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:13:31.590412 [info ] [Thread-2 (]: 28 of 52 START test source_not_null_sources_airpollution_sulfur_dioxide_so2 .... [RUN]
[0m08:13:31.595025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec, now test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c)
[0m08:13:31.600414 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:13:31.597143 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:13:31.626488 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m08:13:31.601382 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:13:31.634730 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m08:13:31.614998 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m08:13:31.637747 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m08:13:31.644438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:31.650016 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m08:13:31.656055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:31.651352 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:13:32.130709 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:01f6e316-8f7c-4664-bd42-abfb7296d1aa&page=queryresults
[0m08:13:32.612555 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m08:13:32.628591 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m08:13:32.640880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:33.103440 [info ] [Thread-4 (]: 25 of 52 PASS source_not_null_sources_airpollution_ozone_o3 .................... [[32mPASS[0m in 2.48s]
[0m08:13:33.143164 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:13:33.160713 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:13:33.185672 [info ] [Thread-4 (]: 29 of 52 START test source_not_null_sources_cities_city ........................ [RUN]
[0m08:13:33.192455 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361, now test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9)
[0m08:13:33.196183 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:13:33.390397 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d0c65e08-32ce-48a8-abe5-d5702e8f3dcc&page=queryresults
[0m08:13:33.372624 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m08:13:33.407619 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:13:33.437654 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m08:13:33.454031 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:13:33.461003 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:33.504257 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:72307137-6296-4e64-8a55-52b7b5ce56c2&page=queryresults
[0m08:13:34.035975 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4dcc181b-3947-41f4-aaa6-89bb8604e015&page=queryresults
[0m08:13:34.054858 [info ] [Thread-1 (]: 26 of 52 PASS source_not_null_sources_airpollution_pm10 ........................ [[32mPASS[0m in 2.55s]
[0m08:13:34.057826 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:13:34.067073 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:13:34.070962 [info ] [Thread-1 (]: 30 of 52 START test source_not_null_sources_cities_city_index .................. [RUN]
[0m08:13:34.080604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085, now test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb)
[0m08:13:34.100211 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:13:34.457795 [info ] [Thread-3 (]: 27 of 52 PASS source_not_null_sources_airpollution_pm2_5 ....................... [[32mPASS[0m in 2.95s]
[0m08:13:34.469592 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:13:34.479339 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:13:34.494207 [info ] [Thread-3 (]: 31 of 52 START test source_not_null_sources_cities_latitude .................... [RUN]
[0m08:13:34.509781 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e, now test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e)
[0m08:13:34.521406 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:13:34.555346 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m08:13:34.556256 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m08:13:34.574716 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:13:34.597213 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:13:34.602570 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m08:13:34.599484 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m08:13:34.630957 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m08:13:34.635258 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m08:13:34.646730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:34.637148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:34.741388 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b1810c10-ff23-4cc9-839c-db09dd307075&page=queryresults
[0m08:13:34.745683 [info ] [Thread-2 (]: 28 of 52 PASS source_not_null_sources_airpollution_sulfur_dioxide_so2 .......... [[32mPASS[0m in 3.15s]
[0m08:13:34.762154 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:13:35.239966 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:13:35.595373 [info ] [Thread-2 (]: 32 of 52 START test source_not_null_sources_cities_longitude ................... [RUN]
[0m08:13:35.613232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c, now test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae)
[0m08:13:35.615083 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:13:35.650644 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m08:13:35.689776 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:13:35.709103 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m08:13:35.723394 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m08:13:35.728065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:36.143206 [info ] [Thread-4 (]: 29 of 52 PASS source_not_null_sources_cities_city .............................. [[32mPASS[0m in 2.95s]
[0m08:13:36.183027 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:13:36.197009 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:13:36.199749 [info ] [Thread-4 (]: 33 of 52 START test source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [RUN]
[0m08:13:36.205114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9, now test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168)
[0m08:13:36.216589 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:13:36.259540 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m08:13:36.278895 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:13:36.318789 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m08:13:36.420918 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:36.426023 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:36.615797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9d5d3080-5bc7-467f-b324-e63159303977&page=queryresults
[0m08:13:36.617794 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:358f9c7f-04c7-48a7-bd4e-44e08624f49b&page=queryresults
[0m08:13:37.128713 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:915e4301-1e83-4129-af2b-3264a6e55073&page=queryresults
[0m08:13:37.768074 [info ] [Thread-3 (]: 31 of 52 PASS source_not_null_sources_cities_latitude .......................... [[32mPASS[0m in 3.25s]
[0m08:13:37.774400 [info ] [Thread-1 (]: 30 of 52 PASS source_not_null_sources_cities_city_index ........................ [[32mPASS[0m in 3.70s]
[0m08:13:37.824743 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:13:37.825588 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:13:37.840290 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:13:37.829516 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:13:37.845507 [info ] [Thread-3 (]: 35 of 52 START test source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [RUN]
[0m08:13:37.847466 [info ] [Thread-1 (]: 34 of 52 START test source_test_is_float_sources_airpollution_nh3__float64 ..... [RUN]
[0m08:13:37.862176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb, now test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081)
[0m08:13:37.867001 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:13:37.875101 [info ] [Thread-2 (]: 32 of 52 PASS source_not_null_sources_cities_longitude ......................... [[32mPASS[0m in 2.27s]
[0m08:13:37.857195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c)
[0m08:13:37.930980 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:13:37.902133 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:13:37.968485 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:13:37.995793 [info ] [Thread-2 (]: 36 of 52 START test source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m08:13:38.046745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55)
[0m08:13:38.070237 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:13:38.243528 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m08:13:38.247340 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:26e6eaa6-fb18-4f41-9507-78fea263883f&page=queryresults
[0m08:13:38.264853 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m08:13:38.288071 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:13:38.293069 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:13:38.267408 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m08:13:38.362163 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m08:13:38.379223 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:13:38.386916 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m08:13:38.362797 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m08:13:38.389823 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:38.394959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:38.398478 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:38.405850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:38.411178 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:38.419491 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:39.668449 [info ] [Thread-4 (]: 33 of 52 PASS source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 3.40s]
[0m08:13:39.722919 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:13:39.746999 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:13:39.766673 [info ] [Thread-4 (]: 37 of 52 START test source_test_is_float_sources_airpollution_ozone_o3__float64  [RUN]
[0m08:13:39.785794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168, now test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a)
[0m08:13:39.795523 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:13:40.112532 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3074ac3a-8061-4005-b385-b31d8a282271&page=queryresults
[0m08:13:40.116434 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ae234fc7-e4f2-4966-a43b-8ec771b9eb8f&page=queryresults
[0m08:13:40.133531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cfcee43a-e421-4c85-a5e3-f8d4a1d4829f&page=queryresults
[0m08:13:40.180884 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m08:13:40.210676 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:13:40.243446 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m08:13:40.284555 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:40.290578 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:41.068159 [info ] [Thread-1 (]: 34 of 52 PASS source_test_is_float_sources_airpollution_nh3__float64 ........... [[32mPASS[0m in 3.21s]
[0m08:13:41.049405 [info ] [Thread-3 (]: 35 of 52 PASS source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 3.17s]
[0m08:13:41.106042 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:13:41.111104 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:13:41.122290 [info ] [Thread-2 (]: 36 of 52 PASS source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 3.08s]
[0m08:13:41.126333 [info ] [Thread-3 (]: 38 of 52 START test source_test_is_float_sources_airpollution_pm10__float64 .... [RUN]
[0m08:13:41.103908 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:13:41.135839 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:13:41.149735 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:13:41.151299 [info ] [Thread-2 (]: 40 of 52 START test source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m08:13:41.138376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281)
[0m08:13:41.154195 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:13:41.152494 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55, now test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6)
[0m08:13:41.148247 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:13:41.221124 [info ] [Thread-1 (]: 39 of 52 START test source_test_is_float_sources_airpollution_pm2_5__float64 ... [RUN]
[0m08:13:41.239490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3)
[0m08:13:41.200406 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:13:41.265620 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:13:41.322333 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m08:13:41.323439 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m08:13:41.306297 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m08:13:41.344168 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:13:41.352785 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m08:13:41.358906 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:13:41.402255 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:13:41.412299 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m08:13:41.414564 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:41.440639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:41.445234 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:41.449089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:41.418923 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m08:13:41.961568 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5f63b4bc-768c-49ed-b78f-0a420b13c360&page=queryresults
[0m08:13:41.962967 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:42.008594 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:42.741425 [info ] [Thread-4 (]: 37 of 52 PASS source_test_is_float_sources_airpollution_ozone_o3__float64 ...... [[32mPASS[0m in 2.93s]
[0m08:13:42.798952 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:13:42.838017 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:13:42.841285 [info ] [Thread-4 (]: 41 of 52 START test source_unique_sources_cities_city_index .................... [RUN]
[0m08:13:42.855258 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a, now test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7)
[0m08:13:42.869836 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:13:42.952551 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ab960c68-87b9-46ca-b009-228981266bc2&page=queryresults
[0m08:13:42.971775 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1b7d7c18-eaac-4c4c-9e1c-0c8fd2332dbd&page=queryresults
[0m08:13:43.205822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7e335e39-dd04-4234-85b1-485aed991164&page=queryresults
[0m08:13:43.294656 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m08:13:43.307915 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:13:43.333538 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m08:13:43.347536 [debug] [Thread-4 (]: On test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:13:43.350412 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:43.419202 [info ] [Thread-3 (]: 38 of 52 PASS source_test_is_float_sources_airpollution_pm10__float64 .......... [[32mPASS[0m in 2.28s]
[0m08:13:43.455379 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:13:43.692451 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:13:43.699040 [info ] [Thread-1 (]: 39 of 52 PASS source_test_is_float_sources_airpollution_pm2_5__float64 ......... [[32mPASS[0m in 2.46s]
[0m08:13:43.700941 [info ] [Thread-3 (]: 42 of 52 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m08:13:43.738508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m08:13:43.722672 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:13:43.753315 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:13:43.750365 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:13:43.711028 [info ] [Thread-2 (]: 40 of 52 PASS source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 2.56s]
[0m08:13:43.778459 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:13:43.759151 [info ] [Thread-1 (]: 43 of 52 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m08:13:43.790552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m08:13:43.794071 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:13:43.782105 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:13:43.811577 [info ] [Thread-2 (]: 44 of 52 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m08:13:43.813479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m08:13:43.815176 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:13:43.791741 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m08:13:43.807921 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m08:13:43.861950 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:13:43.880627 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:13:43.866994 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m08:13:43.894270 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m08:13:43.889052 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m08:13:43.916580 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:13:43.929069 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:43.932694 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:43.932190 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m08:13:43.929935 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:44.304126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:44.310045 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:44.312712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:44.655731 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3e99b12c-0d85-4d38-ac2f-a25cc907f263&page=queryresults
[0m08:13:45.614436 [info ] [Thread-4 (]: 41 of 52 PASS source_unique_sources_cities_city_index .......................... [[32mPASS[0m in 2.74s]
[0m08:13:45.665141 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:13:45.670481 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:13:45.685701 [info ] [Thread-4 (]: 45 of 52 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m08:13:45.688224 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m08:13:45.689966 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:13:45.940160 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3c4a22d2-5385-4add-a0db-45aba75eae56&page=queryresults
[0m08:13:45.941499 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ec26400e-37f9-42fc-a33b-0f067f6de62d&page=queryresults
[0m08:13:45.942944 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c00b4c6b-eda9-492c-9fdf-5d38e86699c3&page=queryresults
[0m08:13:46.064537 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m08:13:46.103702 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:13:46.197882 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m08:13:46.239917 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:46.252838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:46.277466 [info ] [Thread-2 (]: 44 of 52 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 2.46s]
[0m08:13:46.290818 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:13:46.310117 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:13:46.319463 [info ] [Thread-2 (]: 46 of 52 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m08:13:46.328181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m08:13:46.349376 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:13:46.393795 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m08:13:46.396126 [info ] [Thread-3 (]: 42 of 52 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 2.66s]
[0m08:13:46.723763 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:13:46.729917 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:13:46.731343 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:13:46.733272 [info ] [Thread-1 (]: 43 of 52 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 2.94s]
[0m08:13:46.734522 [info ] [Thread-3 (]: 47 of 52 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m08:13:46.755308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m08:13:46.752481 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:13:46.763462 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:13:46.761615 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:13:46.751739 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m08:13:46.767243 [info ] [Thread-1 (]: 48 of 52 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m08:13:46.802541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m08:13:46.804631 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:13:46.805870 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:46.822270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:46.824677 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m08:13:46.817192 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m08:13:47.081224 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:13:47.089799 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m08:13:47.093270 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:13:47.103276 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m08:13:47.106939 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:47.113329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:47.117981 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:47.128193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:48.402031 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9c444d68-24ec-4fc1-94ef-9a3da4514d98&page=queryresults
[0m08:13:48.399199 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:509d496e-f43f-46bf-904f-8306a6667a64&page=queryresults
[0m08:13:48.439658 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:484c432f-6da9-405f-9778-3cbfff84c1c6&page=queryresults
[0m08:13:48.440893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:054a6e7b-e3cd-473b-a0d0-9bca38dd4986&page=queryresults
[0m08:13:48.952071 [info ] [Thread-4 (]: 45 of 52 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 3.10s]
[0m08:13:48.954949 [info ] [Thread-3 (]: 47 of 52 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 2.20s]
[0m08:13:48.966445 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:13:48.963958 [info ] [Thread-1 (]: 48 of 52 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 2.16s]
[0m08:13:48.922663 [info ] [Thread-2 (]: 46 of 52 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 2.45s]
[0m08:13:48.959779 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:13:49.018018 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:13:49.001001 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:13:49.024820 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:13:49.027509 [info ] [Thread-1 (]: 51 of 52 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m08:13:49.033901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m08:13:49.010347 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:13:48.986708 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:13:49.021939 [info ] [Thread-4 (]: 50 of 52 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m08:13:49.068643 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:13:49.100392 [debug] [Thread-2 (]: Began running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:13:49.101143 [info ] [Thread-3 (]: 49 of 52 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m08:13:49.143962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m08:13:49.193264 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:13:49.105847 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m08:13:49.133400 [info ] [Thread-2 (]: 52 of 52 START test unique_staging_cities_city_id .............................. [RUN]
[0m08:13:49.220044 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:13:49.243625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.unique_staging_cities_city_id.051e2d6903)
[0m08:13:49.266557 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:13:49.266078 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m08:13:49.227520 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m08:13:49.277291 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m08:13:49.268908 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m08:13:49.290938 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:13:49.296873 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:13:49.297992 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:13:49.306838 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:13:49.326755 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m08:13:49.311966 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m08:13:49.323026 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m08:13:49.317044 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m08:13:49.332681 [debug] [Thread-1 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m08:13:49.350461 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:13:49.352865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:13:49.355031 [debug] [Thread-2 (]: On test.france_air_pollution.unique_staging_cities_city_id.051e2d6903: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where city_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:13:49.358573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:13:49.346352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:49.339164 [debug] [Thread-4 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m08:13:50.052466 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:13:51.247272 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4c4658b9-ddc2-45d0-ae54-9bf8f9fbc2bc&page=queryresults
[0m08:13:51.382311 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:09f9400f-c31c-4796-8bb2-380cdfdb28f9&page=queryresults
[0m08:13:51.580568 [info ] [Thread-3 (]: 49 of 52 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 2.43s]
[0m08:13:51.607835 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:13:51.673341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:57bf401f-565e-45cd-86fc-a24db5ffc4c8&page=queryresults
[0m08:13:51.696600 [error] [Thread-4 (]: 50 of 52 FAIL 105 test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[31mFAIL 105[0m in 2.59s]
[0m08:13:51.704074 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:13:52.006875 [error] [Thread-1 (]: 51 of 52 FAIL 105 test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[31mFAIL 105[0m in 2.97s]
[0m08:13:52.013548 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:13:56.445441 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2890bdee-5757-4d95-bfd1-7796e7be3c70&page=queryresults
[0m08:13:56.829827 [info ] [Thread-2 (]: 52 of 52 PASS unique_staging_cities_city_id .................................... [[32mPASS[0m in 7.58s]
[0m08:13:56.859082 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:13:56.918399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:13:56.961733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:56.976416 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m08:13:56.979238 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_city_id.051e2d6903' was properly closed.
[0m08:13:56.987600 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m08:13:56.988845 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' was properly closed.
[0m08:13:56.991317 [info ] [MainThread]: 
[0m08:13:56.997959 [info ] [MainThread]: Finished running 52 data tests in 0 hours 0 minutes and 43.30 seconds (43.30s).
[0m08:13:57.131419 [debug] [MainThread]: Command end result
[0m08:13:57.548731 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:13:57.578727 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:13:57.653602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:13:57.654793 [info ] [MainThread]: 
[0m08:13:57.657092 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m08:13:57.658476 [info ] [MainThread]: 
[0m08:13:57.664020 [error] [MainThread]: [31mFailure in test accepted_values_agg_pollution_by_day_count_days__False__1 (models/schema.yml)[0m
[0m08:13:57.669985 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m08:13:57.682362 [info ] [MainThread]: 
[0m08:13:57.694867 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__False__1.sql
[0m08:13:57.696484 [info ] [MainThread]: 
[0m08:13:57.698054 [error] [MainThread]: [31mFailure in test relationships_staging_air_pollution_city_id__city_id__source_sources_cities_ (models/schema.yml)[0m
[0m08:13:57.699253 [error] [MainThread]:   Database Error in test relationships_staging_air_pollution_city_id__city_id__source_sources_cities_ (models/schema.yml)
  Unrecognized name: city_id; Did you mean city? at [21:12]
  compiled code at target/run/france_air_pollution/models/schema.yml/relationships_staging_air_poll_ad7d7ce2550af29b44fb5df756039333.sql
[0m08:13:57.714402 [info ] [MainThread]: 
[0m08:13:57.716359 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/relationships_staging_air_poll_ad7d7ce2550af29b44fb5df756039333.sql
[0m08:13:57.719311 [info ] [MainThread]: 
[0m08:13:57.731387 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)[0m
[0m08:13:57.736305 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m08:13:57.766609 [info ] [MainThread]: 
[0m08:13:57.768258 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m08:13:57.769419 [info ] [MainThread]: 
[0m08:13:57.771080 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)[0m
[0m08:13:57.778558 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m08:13:57.785623 [info ] [MainThread]: 
[0m08:13:57.788333 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql
[0m08:13:57.794601 [info ] [MainThread]: 
[0m08:13:57.821291 [info ] [MainThread]: Done. PASS=48 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=52
[0m08:13:57.910691 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 117.13335, "process_in_blocks": "256296", "process_kernel_time": 4.131392, "process_mem_max_rss": "388644", "process_out_blocks": "0", "process_user_time": 19.20913}
[0m08:13:57.933768 [debug] [MainThread]: Command `dbt test` failed at 08:13:57.933513 after 117.16 seconds
[0m08:13:57.948855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b53080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78219400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68296960>]}
[0m08:13:57.990906 [debug] [MainThread]: Flushing usage events
[0m08:13:58.604378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:43.793182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa397fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d62000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c75460>]}


============================== 08:24:43.797084 | 71e6248a-8a04-4076-b5e6-5ab455d445b5 ==============================
[0m08:24:43.797084 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:24:43.799863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:24:46.496041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fbb260>]}
[0m08:24:46.541720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ce82c0>]}
[0m08:24:46.543284 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:24:46.749101 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:24:46.844155 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:24:46.845438 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m08:24:46.846471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39dd4f0>]}
[0m08:24:48.080613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88db7710>]}
[0m08:24:48.218202 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:24:48.222166 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:24:48.244804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cf0800>]}
[0m08:24:48.245808 [info ] [MainThread]: Found 5 models, 1 snapshot, 52 data tests, 2 sources, 496 macros
[0m08:24:48.246639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d22f30>]}
[0m08:24:48.248911 [info ] [MainThread]: 
[0m08:24:48.249630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:24:48.250631 [info ] [MainThread]: 
[0m08:24:48.252780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:24:48.257625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:24:48.258860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:48.689916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:24:48.691708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:48.983955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ae5160>]}
[0m08:24:48.986145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:24:48.995537 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:24:48.996186 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:24:48.998753 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m08:24:48.997357 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:24:49.000325 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:24:49.001738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:24:49.002743 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:24:49.003775 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:24:49.012311 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:24:49.018579 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:24:49.021924 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:24:49.027954 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:24:49.053531 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:24:49.061226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.062279 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m08:24:49.095076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:24:49.385831 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:24:49.392311 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m08:24:49.486920 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:68799025-0c6b-410b-97bc-40fb17d53c8c&page=queryresults
[0m08:24:49.683791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1fb3ab3e-c0ca-439e-87c1-5e6ba0ed3c01&page=queryresults
[0m08:24:49.776752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb692b0>]}
[0m08:24:49.778000 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m08:24:49.779357 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:24:49.780960 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m08:24:49.781907 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m08:24:49.782942 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m08:24:49.783765 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m08:24:49.788438 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m08:24:49.794054 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m08:24:49.801818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:24:50.076672 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m08:24:50.082201 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m08:24:50.440179 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ee2767f8-c11c-48c0-941a-04069047c912&page=queryresults
[0m08:24:51.924140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b9bb60>]}
[0m08:24:51.926793 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.14s]
[0m08:24:51.928688 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m08:24:57.067553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89012ba0>]}
[0m08:24:57.074434 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 299.0 MiB processed)[0m in 8.06s]
[0m08:24:57.077685 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:24:57.084016 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:24:57.088590 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m08:24:57.090364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m08:24:57.091601 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:24:57.113095 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:24:57.118612 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:24:57.125030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:24:57.408401 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:24:57.412111 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m08:24:57.840772 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fbc333f4-462f-45cc-8f5d-aa7a458dcc55&page=queryresults
[0m08:25:05.158533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f1f6e0>]}
[0m08:25:05.164792 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 324.0 MiB processed)[0m in 8.06s]
[0m08:25:05.169640 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:25:05.173745 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:25:05.174710 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m08:25:05.175845 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:25:05.176789 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:25:05.223539 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:25:05.228381 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:25:05.231833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:05.577888 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:25:05.583815 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(1) as count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m08:25:05.929924 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5c4af1b6-3e8d-4527-9770-a10ef080c6b5&page=queryresults
[0m08:25:09.831371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e6248a-8a04-4076-b5e6-5ab455d445b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f33500>]}
[0m08:25:09.833951 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.9k rows, 401.9 MiB processed)[0m in 4.66s]
[0m08:25:09.835772 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:25:09.845177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:25:09.850740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:09.852338 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:25:09.853447 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:25:09.854310 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:25:09.856473 [info ] [MainThread]: 
[0m08:25:09.858131 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 21.60 seconds (21.60s).
[0m08:25:09.861571 [debug] [MainThread]: Command end result
[0m08:25:10.010206 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:25:10.017260 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:25:10.027825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:25:10.028480 [info ] [MainThread]: 
[0m08:25:10.029336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:25:10.029987 [info ] [MainThread]: 
[0m08:25:10.030936 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:25:10.036109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.284107, "process_in_blocks": "0", "process_kernel_time": 1.689618, "process_mem_max_rss": "384028", "process_out_blocks": "0", "process_user_time": 4.883372}
[0m08:25:10.040559 [debug] [MainThread]: Command `dbt run` succeeded at 08:25:10.039952 after 26.29 seconds
[0m08:25:10.057005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3202420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fba480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8901e960>]}
[0m08:25:10.058780 [debug] [MainThread]: Flushing usage events
[0m08:25:10.534161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:25:34.133077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee265d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3f7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3f7590>]}


============================== 08:25:34.137236 | 032a3dcd-7aa5-4698-b19c-2ac51437ebbd ==============================
[0m08:25:34.137236 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:25:34.138373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:25:36.731667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8540b950>]}
[0m08:25:36.781029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f68fe30>]}
[0m08:25:36.782574 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:25:37.469824 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:25:37.616109 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:25:37.618561 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m08:25:37.635668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fe2ba0>]}
[0m08:25:39.605890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84301c70>]}
[0m08:25:39.839621 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:25:39.844449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:25:39.879849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842a8ce0>]}
[0m08:25:39.880709 [info ] [MainThread]: Found 5 models, 1 snapshot, 52 data tests, 2 sources, 496 macros
[0m08:25:39.882074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77fb0ef0>]}
[0m08:25:39.886470 [info ] [MainThread]: 
[0m08:25:39.887334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:39.892948 [info ] [MainThread]: 
[0m08:25:39.894749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:25:39.899714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m08:25:39.900894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:40.246034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032a3dcd-7aa5-4698-b19c-2ac51437ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841ba6f0>]}
[0m08:25:40.257253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:40.273893 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:25:40.275676 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:25:40.276522 [debug] [Thread-3 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:25:40.277201 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:25:40.281781 [info ] [Thread-1 (]: 1 of 52 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m08:25:40.283370 [info ] [Thread-2 (]: 2 of 52 START test accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m08:25:40.288051 [info ] [Thread-4 (]: 4 of 52 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m08:25:40.285376 [info ] [Thread-3 (]: 3 of 52 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m08:25:40.290003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m08:25:40.292307 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3'
[0m08:25:40.306963 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:25:40.303855 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m08:25:40.305905 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:25:40.299141 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m08:25:40.320010 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:25:40.324494 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m08:25:40.328886 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m08:25:40.329915 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:25:40.336859 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m08:25:40.351335 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:25:40.353879 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m08:25:40.355623 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:25:40.403267 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m08:25:40.403912 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:25:40.408597 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m08:25:40.405834 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:25:40.404564 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m08:25:40.424166 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m08:25:40.432602 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m08:25:40.436742 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m08:25:40.440412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:40.439444 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:25:40.437284 [debug] [Thread-3 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m08:25:40.442906 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m08:25:40.493552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:25:40.488868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:25:41.225271 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a185f1b9-8f48-4f99-a975-f88c26ce1046&page=queryresults
[0m08:25:41.390089 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4f226a12-4bfc-4ef3-8f95-d218d60525d4&page=queryresults
[0m08:25:41.483235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7781925-3adb-4ec8-9d21-e99d42f0e6dc&page=queryresults
[0m08:25:41.635488 [info ] [Thread-4 (]: 4 of 52 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.34s]
[0m08:25:41.638875 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m08:25:41.640201 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:25:41.641511 [info ] [Thread-4 (]: 5 of 52 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m08:25:41.644396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885)
[0m08:25:41.645901 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:25:41.652175 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m08:25:41.661251 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:25:41.664420 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m08:25:41.669667 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m08:25:41.670967 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:41.720380 [info ] [Thread-3 (]: 3 of 52 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.42s]
[0m08:25:41.725508 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m08:25:41.727278 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:25:41.728763 [info ] [Thread-3 (]: 6 of 52 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m08:25:41.730403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m08:25:41.731662 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:25:41.739060 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m08:25:41.747432 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:25:41.755526 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m08:25:41.760298 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m08:25:41.761741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:41.828409 [error] [Thread-1 (]: 1 of 52 FAIL 8 accepted_values_agg_pollution_by_day_count_days__False__1 ....... [[31mFAIL 8[0m in 1.54s]
[0m08:25:41.832219 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m08:25:41.833681 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:25:41.835980 [info ] [Thread-1 (]: 7 of 52 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m08:25:41.839679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m08:25:41.845615 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:25:41.856609 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m08:25:41.870700 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:25:41.884833 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m08:25:41.896056 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m08:25:41.908590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:42.119661 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c8dba584-a8da-431b-a95d-ef6baa9724a8&page=queryresults
[0m08:25:42.400367 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:24fe0884-b6ca-48ba-999c-7636fd199082&page=queryresults
[0m08:25:42.474773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8602e153-1e75-47c6-9e49-39f354ca219e&page=queryresults
[0m08:25:42.538993 [info ] [Thread-2 (]: 2 of 52 PASS accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 2.25s]
[0m08:25:42.541237 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m08:25:42.542500 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:25:42.543550 [info ] [Thread-2 (]: 8 of 52 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m08:25:42.545241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m08:25:42.546821 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:25:42.559773 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m08:25:42.565563 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:25:42.570129 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m08:25:42.576086 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m08:25:42.577625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:42.727543 [info ] [Thread-4 (]: 5 of 52 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 1.08s]
[0m08:25:42.736348 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m08:25:42.739020 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:25:42.743210 [info ] [Thread-4 (]: 9 of 52 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m08:25:42.747926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m08:25:42.751497 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:25:42.762175 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m08:25:42.767193 [info ] [Thread-1 (]: 7 of 52 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.93s]
[0m08:25:42.769707 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m08:25:42.773027 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:25:42.774744 [info ] [Thread-1 (]: 10 of 52 START test not_null_agg_pollution_by_day_avg_PM2_5 .................... [RUN]
[0m08:25:42.775533 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:25:42.776329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m08:25:42.781372 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:25:42.786226 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m08:25:42.779530 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m08:25:42.794024 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:25:42.795162 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m08:25:42.798613 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:42.797121 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m08:25:42.843753 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m08:25:42.845004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:42.880141 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:58d4b488-3fb6-4ddb-808f-e5a5b386f604&page=queryresults
[0m08:25:43.058233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:20a8ba65-67e1-4f57-8d77-35bfd82de27e&page=queryresults
[0m08:25:43.191456 [info ] [Thread-3 (]: 6 of 52 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.46s]
[0m08:25:43.194524 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m08:25:43.196462 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:25:43.197849 [info ] [Thread-3 (]: 11 of 52 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m08:25:43.199205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m08:25:43.201600 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:25:43.207299 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m08:25:43.211827 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:25:43.214925 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m08:25:43.222641 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m08:25:43.224822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:43.373846 [info ] [Thread-2 (]: 8 of 52 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.83s]
[0m08:25:43.375415 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m08:25:43.378474 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:25:43.420300 [info ] [Thread-2 (]: 12 of 52 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m08:25:43.471271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m08:25:43.478809 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:25:43.491786 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m08:25:43.498086 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:25:43.501404 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m08:25:43.508700 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:25:43.511967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:43.554672 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a82df6da-319f-430a-8ecb-ab47fea90fd2&page=queryresults
[0m08:25:43.689335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:448b873b-cddb-4f79-a0ce-4599f914ab9c&page=queryresults
[0m08:25:43.837987 [info ] [Thread-4 (]: 9 of 52 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 1.09s]
[0m08:25:43.839485 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m08:25:43.840631 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:25:43.841345 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:edc6e0d8-ff01-4aa0-91c3-1b0ec821f803&page=queryresults
[0m08:25:43.841988 [info ] [Thread-4 (]: 13 of 52 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m08:25:43.844539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m08:25:43.845277 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:25:43.849380 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m08:25:43.852868 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:25:43.855221 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m08:25:43.858012 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m08:25:43.858806 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:43.975569 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a871e32b-067a-4d8b-8a48-6365b2d6d81f&page=queryresults
[0m08:25:43.994825 [info ] [Thread-1 (]: 10 of 52 PASS not_null_agg_pollution_by_day_avg_PM2_5 .......................... [[32mPASS[0m in 1.22s]
[0m08:25:43.995898 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m08:25:43.996919 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:25:44.000231 [info ] [Thread-1 (]: 14 of 52 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m08:25:44.002144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m08:25:44.003879 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:25:44.010951 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m08:25:44.015208 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:25:44.019003 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m08:25:44.025363 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m08:25:44.026914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:44.149496 [info ] [Thread-3 (]: 11 of 52 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.95s]
[0m08:25:44.151888 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m08:25:44.153599 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:25:44.154712 [info ] [Thread-3 (]: 15 of 52 START test not_null_staging_cities_city ............................... [RUN]
[0m08:25:44.156181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m08:25:44.157212 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:25:44.165068 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m08:25:44.181989 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:25:44.187733 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m08:25:44.202515 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:25:44.206738 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:44.272408 [info ] [Thread-2 (]: 12 of 52 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.80s]
[0m08:25:44.273760 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m08:25:44.275403 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:25:44.276220 [info ] [Thread-2 (]: 16 of 52 START test not_null_staging_cities_city_id ............................ [RUN]
[0m08:25:44.277119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde)
[0m08:25:44.277932 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:25:44.282694 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m08:25:44.285146 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8b8c98b6-2c0e-4be6-8793-22ec041febdc&page=queryresults
[0m08:25:44.286998 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:25:44.289987 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m08:25:44.293339 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m08:25:44.294398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:44.560307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2f5ad304-cc9b-4261-b870-9795e9af3bb1&page=queryresults
[0m08:25:44.581135 [info ] [Thread-4 (]: 13 of 52 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.74s]
[0m08:25:44.582506 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m08:25:44.583670 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:25:44.584641 [info ] [Thread-4 (]: 17 of 52 START test not_null_staging_cities_latitude ........................... [RUN]
[0m08:25:44.585665 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m08:25:44.586489 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:25:44.590587 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m08:25:44.596160 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:25:44.599095 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m08:25:44.601949 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m08:25:44.602890 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:44.929489 [info ] [Thread-1 (]: 14 of 52 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.93s]
[0m08:25:44.931969 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m08:25:44.933168 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:25:44.934499 [info ] [Thread-1 (]: 18 of 52 START test not_null_staging_cities_longitude .......................... [RUN]
[0m08:25:44.935896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m08:25:44.936799 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:25:44.943208 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m08:25:44.944047 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:df2e2203-ca77-4b7d-94ba-5fe3d3aa3dbb&page=queryresults
[0m08:25:44.947419 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:25:44.949625 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m08:25:44.952591 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m08:25:44.953874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:45.032883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ec114ef2-8270-4a9b-8e0a-c24d053c1cee&page=queryresults
[0m08:25:45.261751 [info ] [Thread-3 (]: 15 of 52 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 1.11s]
[0m08:25:45.262921 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m08:25:45.264217 [debug] [Thread-3 (]: Began running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m08:25:45.265060 [info ] [Thread-3 (]: 19 of 52 START test relationships_staging_air_pollution_city_id__city_index__source_sources_cities_  [RUN]
[0m08:25:45.266071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b)
[0m08:25:45.266955 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m08:25:45.271871 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"
[0m08:25:45.276287 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m08:25:45.278909 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"
[0m08:25:45.282229 [debug] [Thread-3 (]: On test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    where city_id is not null
),

parent as (
    select city_index as to_field
    from `paris-air-pollution-quangnc`.`raw`.`cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:25:45.283086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:45.330245 [info ] [Thread-2 (]: 16 of 52 PASS not_null_staging_cities_city_id .................................. [[32mPASS[0m in 1.05s]
[0m08:25:45.331698 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m08:25:45.332727 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:25:45.333648 [info ] [Thread-2 (]: 20 of 52 START test source_not_null_sources_airpollution_carbon_monoxide_co .... [RUN]
[0m08:25:45.334816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde, now test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31)
[0m08:25:45.335719 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:25:45.343115 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m08:25:45.347109 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:25:45.349829 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m08:25:45.352574 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m08:25:45.353506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:45.643970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3869ed85-d3b9-43cb-b891-390748d2afa5&page=queryresults
[0m08:25:45.965847 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5ebe70a3-38be-4339-b7c8-496332961ac2&page=queryresults
[0m08:25:45.968156 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:410efe37-a68e-4bdc-bc3c-6d1aafa74e80&page=queryresults
[0m08:25:46.154362 [info ] [Thread-1 (]: 18 of 52 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 1.22s]
[0m08:25:46.155648 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m08:25:46.156582 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:25:46.158373 [info ] [Thread-1 (]: 21 of 52 START test source_not_null_sources_airpollution_city_index ............ [RUN]
[0m08:25:46.159817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef)
[0m08:25:46.160960 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:25:46.168947 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m08:25:46.173196 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:25:46.176873 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m08:25:46.183809 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m08:25:46.195294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:46.281995 [info ] [Thread-2 (]: 20 of 52 PASS source_not_null_sources_airpollution_carbon_monoxide_co .......... [[32mPASS[0m in 0.95s]
[0m08:25:46.283578 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m08:25:46.284629 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:25:46.285545 [info ] [Thread-2 (]: 22 of 52 START test source_not_null_sources_airpollution_nh3 ................... [RUN]
[0m08:25:46.286769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31, now test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85)
[0m08:25:46.287579 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:25:46.292262 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m08:25:46.296154 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:25:46.299030 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m08:25:46.302173 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m08:25:46.303669 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:46.342481 [info ] [Thread-3 (]: 19 of 52 PASS relationships_staging_air_pollution_city_id__city_index__source_sources_cities_  [[32mPASS[0m in 1.08s]
[0m08:25:46.344764 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m08:25:46.346881 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:25:46.348511 [info ] [Thread-3 (]: 23 of 52 START test source_not_null_sources_airpollution_nitric_oxide_no ....... [RUN]
[0m08:25:46.349697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b, now test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1)
[0m08:25:46.351146 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:25:46.363580 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m08:25:46.370014 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:25:46.377021 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m08:25:46.391862 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m08:25:46.398581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:46.521814 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:31e8fdfd-4f48-4fbd-87d9-063e434323eb&page=queryresults
[0m08:25:46.758828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:503d611b-f181-4bf5-bde4-2a9e908a9153&page=queryresults
[0m08:25:46.841978 [info ] [Thread-4 (]: 17 of 52 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 2.26s]
[0m08:25:46.843439 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m08:25:46.844390 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:25:46.845498 [info ] [Thread-4 (]: 24 of 52 START test source_not_null_sources_airpollution_nitrogen_dioxide_no2 .. [RUN]
[0m08:25:46.846555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec)
[0m08:25:46.847827 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:25:46.854464 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m08:25:46.859265 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:25:46.861824 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m08:25:46.864660 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m08:25:46.866238 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4013d1a2-c529-4de4-ae49-5c1c1bf9e614&page=queryresults
[0m08:25:46.866603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:46.905455 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e0188d9a-317c-4d88-81ad-5f42a91bfd04&page=queryresults
[0m08:25:47.061818 [info ] [Thread-1 (]: 21 of 52 PASS source_not_null_sources_airpollution_city_index .................. [[32mPASS[0m in 0.90s]
[0m08:25:47.063248 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m08:25:47.066985 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:25:47.067865 [info ] [Thread-1 (]: 25 of 52 START test source_not_null_sources_airpollution_ozone_o3 .............. [RUN]
[0m08:25:47.068871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef, now test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361)
[0m08:25:47.071502 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:25:47.081567 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m08:25:47.085423 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:25:47.088007 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m08:25:47.090911 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m08:25:47.091810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:47.156473 [info ] [Thread-3 (]: 23 of 52 PASS source_not_null_sources_airpollution_nitric_oxide_no ............. [[32mPASS[0m in 0.81s]
[0m08:25:47.157992 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m08:25:47.158967 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:25:47.159871 [info ] [Thread-3 (]: 26 of 52 START test source_not_null_sources_airpollution_pm10 .................. [RUN]
[0m08:25:47.160997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1, now test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085)
[0m08:25:47.161799 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:25:47.166439 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m08:25:47.170090 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:25:47.172839 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m08:25:47.175768 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m08:25:47.176810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:47.246117 [info ] [Thread-2 (]: 22 of 52 PASS source_not_null_sources_airpollution_nh3 ......................... [[32mPASS[0m in 0.96s]
[0m08:25:47.252912 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m08:25:47.262064 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:25:47.267196 [info ] [Thread-2 (]: 27 of 52 START test source_not_null_sources_airpollution_pm2_5 ................. [RUN]
[0m08:25:47.271493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85, now test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e)
[0m08:25:47.272842 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:25:47.279781 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m08:25:47.286704 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:25:47.298599 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m08:25:47.319695 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m08:25:47.323445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:47.385104 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c0bfe1e5-a42e-4115-a342-4918b2eaab78&page=queryresults
[0m08:25:47.747905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bfc3aa8d-8ec5-4fe6-94f8-b80cb854bece&page=queryresults
[0m08:25:47.836729 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7dd8b4ee-2ecb-43f5-817e-492a36d313da&page=queryresults
[0m08:25:47.867921 [info ] [Thread-4 (]: 24 of 52 PASS source_not_null_sources_airpollution_nitrogen_dioxide_no2 ........ [[32mPASS[0m in 1.02s]
[0m08:25:47.869759 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m08:25:47.871099 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:25:47.872177 [info ] [Thread-4 (]: 28 of 52 START test source_not_null_sources_airpollution_sulfur_dioxide_so2 .... [RUN]
[0m08:25:47.873459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec, now test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c)
[0m08:25:47.874524 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:25:47.885961 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m08:25:47.889530 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:25:47.892170 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m08:25:47.895120 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m08:25:47.895947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:47.936670 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a84a00b3-35bd-4f24-a4c8-cf6f545fd52d&page=queryresults
[0m08:25:48.066177 [info ] [Thread-1 (]: 25 of 52 PASS source_not_null_sources_airpollution_ozone_o3 .................... [[32mPASS[0m in 1.00s]
[0m08:25:48.067732 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m08:25:48.069070 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:25:48.070221 [info ] [Thread-1 (]: 29 of 52 START test source_not_null_sources_cities_city ........................ [RUN]
[0m08:25:48.071569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361, now test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9)
[0m08:25:48.072488 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:25:48.077861 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m08:25:48.089582 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:25:48.092671 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m08:25:48.098444 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m08:25:48.099418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:48.159668 [info ] [Thread-3 (]: 26 of 52 PASS source_not_null_sources_airpollution_pm10 ........................ [[32mPASS[0m in 1.00s]
[0m08:25:48.161721 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m08:25:48.164797 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:25:48.167539 [info ] [Thread-3 (]: 30 of 52 START test source_not_null_sources_cities_city_index .................. [RUN]
[0m08:25:48.169103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085, now test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb)
[0m08:25:48.170950 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:25:48.177113 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m08:25:48.180579 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:25:48.183593 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m08:25:48.186985 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m08:25:48.188000 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:48.258821 [info ] [Thread-2 (]: 27 of 52 PASS source_not_null_sources_airpollution_pm2_5 ....................... [[32mPASS[0m in 0.99s]
[0m08:25:48.264444 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m08:25:48.266412 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:25:48.267918 [info ] [Thread-2 (]: 31 of 52 START test source_not_null_sources_cities_latitude .................... [RUN]
[0m08:25:48.273385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e, now test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e)
[0m08:25:48.276209 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:25:48.284080 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m08:25:48.289973 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:25:48.294535 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m08:25:48.298392 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m08:25:48.299157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:48.407172 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:39b2009b-76d9-4217-b2b1-99b2ad7daa32&page=queryresults
[0m08:25:48.609202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a6f06d3c-f468-4454-a6e3-bf2cccd37bb5&page=queryresults
[0m08:25:48.645850 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1317dd55-2d50-4673-8a99-db831bc2bab4&page=queryresults
[0m08:25:48.712804 [info ] [Thread-4 (]: 28 of 52 PASS source_not_null_sources_airpollution_sulfur_dioxide_so2 .......... [[32mPASS[0m in 0.84s]
[0m08:25:48.714562 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m08:25:48.716036 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:25:48.716983 [info ] [Thread-4 (]: 32 of 52 START test source_not_null_sources_cities_longitude ................... [RUN]
[0m08:25:48.718280 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c, now test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae)
[0m08:25:48.719285 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:25:48.725730 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m08:25:48.728570 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:25:48.731641 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m08:25:48.733363 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2ab9c77d-0100-4385-b3e4-54749edcc069&page=queryresults
[0m08:25:48.737848 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m08:25:48.739520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:48.890700 [info ] [Thread-1 (]: 29 of 52 PASS source_not_null_sources_cities_city .............................. [[32mPASS[0m in 0.82s]
[0m08:25:48.896882 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m08:25:48.898699 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:25:48.900365 [info ] [Thread-1 (]: 33 of 52 START test source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [RUN]
[0m08:25:48.905701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9, now test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168)
[0m08:25:48.907187 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:25:48.914892 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m08:25:48.920090 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:25:48.925426 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m08:25:48.929219 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:48.930727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:48.985025 [info ] [Thread-3 (]: 30 of 52 PASS source_not_null_sources_cities_city_index ........................ [[32mPASS[0m in 0.82s]
[0m08:25:48.987468 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m08:25:48.988807 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:25:48.989858 [info ] [Thread-3 (]: 34 of 52 START test source_test_is_float_sources_airpollution_nh3__float64 ..... [RUN]
[0m08:25:48.991006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb, now test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081)
[0m08:25:48.992063 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:25:49.004519 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m08:25:49.010368 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:25:49.017578 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m08:25:49.022534 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:49.023522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:49.073630 [info ] [Thread-2 (]: 31 of 52 PASS source_not_null_sources_cities_latitude .......................... [[32mPASS[0m in 0.80s]
[0m08:25:49.080776 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m08:25:49.083800 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:25:49.086690 [info ] [Thread-2 (]: 35 of 52 START test source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [RUN]
[0m08:25:49.088667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c)
[0m08:25:49.090214 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:25:49.107414 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m08:25:49.117763 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:25:49.121279 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m08:25:49.129056 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:49.131617 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:49.232842 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d182ebbc-7a7c-4c7f-ab5b-d8aaf5e82e89&page=queryresults
[0m08:25:49.524884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:50a8fa10-96aa-415e-a7c1-479f5a907d75&page=queryresults
[0m08:25:49.534242 [info ] [Thread-4 (]: 32 of 52 PASS source_not_null_sources_cities_longitude ......................... [[32mPASS[0m in 0.82s]
[0m08:25:49.535332 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m08:25:49.536236 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:25:49.537039 [info ] [Thread-4 (]: 36 of 52 START test source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m08:25:49.537884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55)
[0m08:25:49.538495 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:25:49.542278 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m08:25:49.545876 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:25:49.548660 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m08:25:49.552302 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:49.554214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:49.629157 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:53b0c563-e70c-44d9-af5b-127fd01b6098&page=queryresults
[0m08:25:49.686924 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cdfee123-f769-4224-991c-c1258d0e3739&page=queryresults
[0m08:25:49.970746 [info ] [Thread-3 (]: 34 of 52 PASS source_test_is_float_sources_airpollution_nh3__float64 ........... [[32mPASS[0m in 0.98s]
[0m08:25:49.973134 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m08:25:49.974297 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:25:49.976697 [info ] [Thread-3 (]: 37 of 52 START test source_test_is_float_sources_airpollution_ozone_o3__float64  [RUN]
[0m08:25:49.980072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081, now test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a)
[0m08:25:49.981282 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:25:49.987111 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m08:25:49.988496 [info ] [Thread-1 (]: 33 of 52 PASS source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.08s]
[0m08:25:49.990820 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m08:25:49.991838 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:25:49.992934 [info ] [Thread-1 (]: 38 of 52 START test source_test_is_float_sources_airpollution_pm10__float64 .... [RUN]
[0m08:25:49.993944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281)
[0m08:25:49.995364 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:25:49.992596 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:25:50.005176 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m08:25:50.000945 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m08:25:50.008908 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:25:50.009546 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:50.012275 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:50.011496 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m08:25:50.050367 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:50.052107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:50.090030 [info ] [Thread-2 (]: 35 of 52 PASS source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 1.00s]
[0m08:25:50.102394 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m08:25:50.107401 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:25:50.109769 [info ] [Thread-2 (]: 39 of 52 START test source_test_is_float_sources_airpollution_pm2_5__float64 ... [RUN]
[0m08:25:50.112072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3)
[0m08:25:50.113515 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:25:50.122032 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m08:25:50.126687 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:25:50.133899 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m08:25:50.137562 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:52b8a961-65ba-4106-bfcb-19b6b0ef49bc&page=queryresults
[0m08:25:50.141347 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:50.142976 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:50.468441 [info ] [Thread-4 (]: 36 of 52 PASS source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.93s]
[0m08:25:50.474861 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m08:25:50.476131 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:25:50.478529 [info ] [Thread-4 (]: 40 of 52 START test source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m08:25:50.481720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55, now test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6)
[0m08:25:50.483068 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:25:50.505938 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m08:25:50.520002 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:25:50.523392 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m08:25:50.526670 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:50.528983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:50.633149 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7f3c2925-451d-4bd0-9dde-6e5050b5611a&page=queryresults
[0m08:25:50.703114 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:26573515-2e73-4a4e-895e-324ee86bfaa2&page=queryresults
[0m08:25:50.716489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aa34f325-b2df-4eeb-9238-ee5e1ea88727&page=queryresults
[0m08:25:50.942113 [info ] [Thread-3 (]: 37 of 52 PASS source_test_is_float_sources_airpollution_ozone_o3__float64 ...... [[32mPASS[0m in 0.96s]
[0m08:25:50.943965 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m08:25:50.944863 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:25:50.946569 [info ] [Thread-3 (]: 41 of 52 START test source_unique_sources_cities_city_index .................... [RUN]
[0m08:25:50.948008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a, now test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7)
[0m08:25:50.948968 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:25:50.958266 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m08:25:50.961666 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:25:50.964416 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m08:25:50.967229 [debug] [Thread-3 (]: On test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:25:50.968174 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:51.019681 [info ] [Thread-1 (]: 38 of 52 PASS source_test_is_float_sources_airpollution_pm10__float64 .......... [[32mPASS[0m in 1.03s]
[0m08:25:51.021352 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m08:25:51.022471 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:25:51.023723 [info ] [Thread-1 (]: 42 of 52 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m08:25:51.025171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m08:25:51.026347 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:25:51.035093 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m08:25:51.037574 [info ] [Thread-2 (]: 39 of 52 PASS source_test_is_float_sources_airpollution_pm2_5__float64 ......... [[32mPASS[0m in 0.93s]
[0m08:25:51.040548 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m08:25:51.045981 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:25:51.048204 [info ] [Thread-2 (]: 43 of 52 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m08:25:51.049699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m08:25:51.046769 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:25:51.050812 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:25:51.060897 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m08:25:51.054454 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m08:25:51.065917 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:25:51.070263 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m08:25:51.070797 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:51.074332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:51.090278 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:51.136245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:51.135246 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fe4f2132-c01e-44f4-9854-09e7f91f68f9&page=queryresults
[0m08:25:51.555226 [info ] [Thread-4 (]: 40 of 52 PASS source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 1.07s]
[0m08:25:51.565786 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m08:25:51.571761 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:25:51.574713 [info ] [Thread-4 (]: 44 of 52 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m08:25:51.576605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m08:25:51.578458 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:25:51.587408 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m08:25:51.593117 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:25:51.606031 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m08:25:51.610794 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:51.612153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:51.721981 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:71b8ffcc-e907-4067-838f-3c772706c5f9&page=queryresults
[0m08:25:51.773631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:50ebed80-3df4-4d75-ac1e-58fb2a1ab9f9&page=queryresults
[0m08:25:51.778665 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:73db65e9-82e2-4bd7-a1d3-51a63526b189&page=queryresults
[0m08:25:52.066781 [info ] [Thread-2 (]: 43 of 52 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 1.02s]
[0m08:25:52.070210 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m08:25:52.071537 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:25:52.072381 [info ] [Thread-2 (]: 45 of 52 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m08:25:52.078943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m08:25:52.080152 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:25:52.087725 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m08:25:52.091400 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:25:52.094036 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m08:25:52.096854 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:52.097868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:52.156936 [info ] [Thread-1 (]: 42 of 52 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.13s]
[0m08:25:52.158611 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m08:25:52.159357 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f8b91dd5-ba74-4d3d-b646-e4d84129856e&page=queryresults
[0m08:25:52.159799 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:25:52.162988 [info ] [Thread-3 (]: 41 of 52 PASS source_unique_sources_cities_city_index .......................... [[32mPASS[0m in 1.21s]
[0m08:25:52.169341 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m08:25:52.170467 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:25:52.165457 [info ] [Thread-1 (]: 46 of 52 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m08:25:52.171156 [info ] [Thread-3 (]: 47 of 52 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m08:25:52.172004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m08:25:52.173353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m08:25:52.174490 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:25:52.175428 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:25:52.180239 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m08:25:52.184194 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m08:25:52.188180 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:25:52.188988 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:25:52.192527 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m08:25:52.196281 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m08:25:52.200955 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:52.202548 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:52.203044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:52.203977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:52.482889 [info ] [Thread-4 (]: 44 of 52 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 0.91s]
[0m08:25:52.484306 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m08:25:52.485181 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:25:52.486010 [info ] [Thread-4 (]: 48 of 52 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m08:25:52.486990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m08:25:52.487718 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:25:52.491680 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m08:25:52.495086 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:25:52.497161 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m08:25:52.500211 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:52.501543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:52.716491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:606e9bbc-c901-4164-b976-bd0b498dfce1&page=queryresults
[0m08:25:52.722295 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d044200f-95c8-415b-bed4-bb86343e0586&page=queryresults
[0m08:25:52.734729 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8ed89fff-93a0-442a-bea1-2aa2f24012aa&page=queryresults
[0m08:25:52.979238 [info ] [Thread-2 (]: 45 of 52 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 0.90s]
[0m08:25:52.980932 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m08:25:52.982910 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:25:52.984253 [info ] [Thread-2 (]: 49 of 52 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m08:25:52.985582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m08:25:52.986621 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:25:52.993107 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m08:25:52.997977 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:25:53.003558 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m08:25:53.008781 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m08:25:53.011848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:25:53.014059 [info ] [Thread-3 (]: 47 of 52 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.84s]
[0m08:25:53.017718 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m08:25:53.017146 [info ] [Thread-1 (]: 46 of 52 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 0.85s]
[0m08:25:53.052344 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:25:53.054219 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e7539cce-78fd-4b29-bc5f-8c4805d0efde&page=queryresults
[0m08:25:53.055506 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m08:25:53.056580 [info ] [Thread-3 (]: 50 of 52 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m08:25:53.061147 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:25:53.062547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m08:25:53.065418 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:25:53.063824 [info ] [Thread-1 (]: 51 of 52 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m08:25:53.071077 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m08:25:53.072094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m08:25:53.073818 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:25:53.077818 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m08:25:53.080060 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:25:53.088637 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m08:25:53.089686 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:25:53.091528 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m08:25:53.092342 [debug] [Thread-3 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m08:25:53.095382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:25:53.096963 [debug] [Thread-1 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m08:25:53.141176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:53.384871 [info ] [Thread-4 (]: 48 of 52 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 0.90s]
[0m08:25:53.387288 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m08:25:53.390711 [debug] [Thread-4 (]: Began running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:25:53.395132 [info ] [Thread-4 (]: 52 of 52 START test unique_staging_cities_city_id .............................. [RUN]
[0m08:25:53.396806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.unique_staging_cities_city_id.051e2d6903)
[0m08:25:53.399693 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:25:53.416998 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m08:25:53.423776 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:25:53.428471 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m08:25:53.433012 [debug] [Thread-4 (]: On test.france_air_pollution.unique_staging_cities_city_id.051e2d6903: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where city_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:25:53.435521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:25:53.592235 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8605bffd-b28e-45a3-b264-9c71d20bffe9&page=queryresults
[0m08:25:53.779991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bc1398e2-bdd7-405c-9a46-7340a4675b50&page=queryresults
[0m08:25:53.916458 [info ] [Thread-2 (]: 49 of 52 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.93s]
[0m08:25:53.918866 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m08:25:54.161297 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6e9748b5-e6b9-4595-b693-c5903622edf9&page=queryresults
[0m08:25:54.163250 [info ] [Thread-1 (]: 51 of 52 PASS test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[32mPASS[0m in 1.09s]
[0m08:25:54.167642 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m08:25:54.289958 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70f41307-7625-4dc8-b0be-c7f6f3ca67ae&page=queryresults
[0m08:25:54.483240 [info ] [Thread-3 (]: 50 of 52 PASS test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[32mPASS[0m in 1.42s]
[0m08:25:54.485158 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m08:25:54.633028 [info ] [Thread-4 (]: 52 of 52 PASS unique_staging_cities_city_id .................................... [[32mPASS[0m in 1.24s]
[0m08:25:54.635527 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m08:25:54.654456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:25:54.673958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:54.676586 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m08:25:54.678534 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m08:25:54.679977 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_city_id.051e2d6903' was properly closed.
[0m08:25:54.683051 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd' was properly closed.
[0m08:25:54.686962 [info ] [MainThread]: 
[0m08:25:54.688572 [info ] [MainThread]: Finished running 52 data tests in 0 hours 0 minutes and 14.79 seconds (14.79s).
[0m08:25:54.702376 [debug] [MainThread]: Command end result
[0m08:25:54.971837 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:25:54.985740 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:25:55.013921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:25:55.015512 [info ] [MainThread]: 
[0m08:25:55.017335 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:25:55.018234 [info ] [MainThread]: 
[0m08:25:55.019719 [error] [MainThread]: [31mFailure in test accepted_values_agg_pollution_by_day_count_days__False__1 (models/schema.yml)[0m
[0m08:25:55.020771 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m08:25:55.022692 [info ] [MainThread]: 
[0m08:25:55.024196 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/accepted_values_agg_pollution_by_day_count_days__False__1.sql
[0m08:25:55.025504 [info ] [MainThread]: 
[0m08:25:55.027501 [info ] [MainThread]: Done. PASS=51 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=52
[0m08:25:55.035225 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 20.939411, "process_in_blocks": "0", "process_kernel_time": 1.863968, "process_mem_max_rss": "390012", "process_out_blocks": "0", "process_user_time": 8.958374}
[0m08:25:55.037642 [debug] [MainThread]: Command `dbt test` failed at 08:25:55.037356 after 20.94 seconds
[0m08:25:55.039411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3f7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84157ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842a3860>]}
[0m08:25:55.040958 [debug] [MainThread]: Flushing usage events
[0m08:25:55.577590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:36.102666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8acf440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9235280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab262a20>]}


============================== 08:29:36.107013 | a896b994-41a6-4363-9920-45a17b0c657d ==============================
[0m08:29:36.107013 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:29:36.108070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:29:39.126333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901ea270>]}
[0m08:29:39.163255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f71e300>]}
[0m08:29:39.164645 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:29:39.509848 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:29:39.599391 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:29:39.600813 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m08:29:39.601884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f513530>]}
[0m08:29:40.805611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e413770>]}
[0m08:29:40.953209 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:29:40.958835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:29:40.988943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e311ca0>]}
[0m08:29:40.990879 [info ] [MainThread]: Found 5 models, 1 snapshot, 52 data tests, 2 sources, 496 macros
[0m08:29:40.992416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1cb7a0>]}
[0m08:29:40.995519 [info ] [MainThread]: 
[0m08:29:40.997636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:40.998899 [info ] [MainThread]: 
[0m08:29:41.001167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:29:41.008417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:29:41.011054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:41.458825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:29:41.460538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:41.766750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf88f80>]}
[0m08:29:41.768107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:29:41.775037 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:29:41.775518 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:29:41.776094 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:29:41.777044 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m08:29:41.779111 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:29:41.779821 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:29:41.778135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:29:41.786451 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:29:41.786744 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:29:41.796901 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:29:41.798467 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:29:41.817745 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:29:41.820607 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:29:41.843311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:41.844467 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m08:29:41.876497 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:29:42.219924 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:29:42.224173 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m08:29:42.350186 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f5130567-5c4e-4f7f-8096-dfe05bd3d415&page=queryresults
[0m08:29:42.561919 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:51bcef7d-5356-4218-8159-2813b57aba28&page=queryresults
[0m08:29:42.758679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ff17f0>]}
[0m08:29:42.759946 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m08:29:42.761691 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:29:42.763086 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m08:29:42.764012 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m08:29:42.765098 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m08:29:42.765866 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m08:29:42.771732 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m08:29:42.775401 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m08:29:42.783291 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:29:43.067942 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m08:29:43.072574 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m08:29:43.431245 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5049ac26-e12c-44ef-b166-96815bd90456&page=queryresults
[0m08:29:45.198334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0e1760>]}
[0m08:29:45.208394 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.43s]
[0m08:29:45.212922 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m08:29:50.000647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e058710>]}
[0m08:29:50.005678 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 299.0 MiB processed)[0m in 8.22s]
[0m08:29:50.009736 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:29:50.014744 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:29:50.016411 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m08:29:50.021056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m08:29:50.025115 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:29:50.064000 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:29:50.068651 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:29:50.071800 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:29:50.367619 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:29:50.374320 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m08:29:50.694777 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7841bb8f-90fa-4670-9d85-8449c8fee86a&page=queryresults
[0m08:29:58.162613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0668d0>]}
[0m08:29:58.175293 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 324.0 MiB processed)[0m in 8.14s]
[0m08:29:58.179505 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:29:58.222347 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:29:58.223974 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m08:29:58.227153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:29:58.232185 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:29:58.264396 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:29:58.268734 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:29:58.272134 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:29:58.599636 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:29:58.606082 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt, 'Europe/Paris')) AS count_days
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m08:29:58.837896 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:beea4d72-23f8-46e4-baad-eed207152f1e&page=queryresults
[0m08:29:58.884770 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:beea4d72-23f8-46e4-baad-eed207152f1e&page=queryresults
[0m08:29:59.054954 [debug] [Thread-4 (]: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got identifier "ROUND" at [35:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:29:59.060033 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896b994-41a6-4363-9920-45a17b0c657d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1b12e0>]}
[0m08:29:59.072617 [error] [Thread-4 (]: 5 of 5 ERROR creating sql incremental model development.agg_pollution_by_day ... [[31mERROR[0m in 0.83s]
[0m08:29:59.074644 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:29:59.079505 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.agg_pollution_by_day' to be skipped because of status 'error'.  Reason: Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got identifier "ROUND" at [35:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql.
[0m08:29:59.089046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:29:59.093045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:59.095126 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:29:59.097165 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:29:59.098879 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:29:59.101274 [info ] [MainThread]: 
[0m08:29:59.102575 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 18.10 seconds (18.10s).
[0m08:29:59.112656 [debug] [MainThread]: Command end result
[0m08:29:59.219489 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:29:59.226995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:29:59.237389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:29:59.238172 [info ] [MainThread]: 
[0m08:29:59.238880 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:29:59.243108 [info ] [MainThread]: 
[0m08:29:59.244438 [error] [MainThread]: [31mFailure in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)[0m
[0m08:29:59.245417 [error] [MainThread]:   Database Error in model agg_pollution_by_day (models/mart/agg_pollution_by_day.sql)
  Syntax error: Expected ")" but got identifier "ROUND" at [35:5]
  compiled code at target/run/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:29:59.246253 [info ] [MainThread]: 
[0m08:29:59.247069 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/mart/agg_pollution_by_day.sql
[0m08:29:59.247834 [info ] [MainThread]: 
[0m08:29:59.248666 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m08:29:59.256087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.191006, "process_in_blocks": "88", "process_kernel_time": 1.7805, "process_mem_max_rss": "385180", "process_out_blocks": "0", "process_user_time": 5.556333}
[0m08:29:59.258082 [debug] [MainThread]: Command `dbt run` failed at 08:29:59.257913 after 23.19 seconds
[0m08:29:59.259614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9235280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e45e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e612090>]}
[0m08:29:59.260572 [debug] [MainThread]: Flushing usage events
[0m08:29:59.726296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:14.720883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa14d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa16a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae13b90>]}


============================== 08:30:14.726453 | fbd71132-cad5-4b08-9b18-aab1cb35ca18 ==============================
[0m08:30:14.726453 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:30:14.727725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:30:16.919088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ec3cb0>]}
[0m08:30:16.990171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f5ddf0>]}
[0m08:30:16.993022 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m08:30:17.319395 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m08:30:17.480870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:17.484499 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/mart/agg_pollution_by_day.sql
[0m08:30:18.017993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706a9550>]}
[0m08:30:18.375706 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:30:18.383092 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:30:18.408748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709544d0>]}
[0m08:30:18.410095 [info ] [MainThread]: Found 5 models, 1 snapshot, 52 data tests, 2 sources, 496 macros
[0m08:30:18.411499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70c7ede0>]}
[0m08:30:18.414620 [info ] [MainThread]: 
[0m08:30:18.415873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:18.419109 [info ] [MainThread]: 
[0m08:30:18.423604 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:30:18.433167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m08:30:18.435386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:18.848914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m08:30:18.852402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:19.134646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d7e210>]}
[0m08:30:19.138082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:19.146818 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m08:30:19.148965 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m08:30:19.147325 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m08:30:19.150033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m08:30:19.151433 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m08:30:19.152554 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m08:30:19.153643 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m08:30:19.168119 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m08:30:19.171635 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m08:30:19.174184 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m08:30:19.177810 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m08:30:19.178489 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m08:30:19.232700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:30:19.239729 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m08:30:19.276556 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    cities;


[0m08:30:19.277772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:30:19.555566 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m08:30:19.559472 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY City_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY City_index
)

SELECT 
    City_index AS city_id,
    dt,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no
FROM pollution
WHERE 1=1

    );
  
[0m08:30:19.704234 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e014c199-743d-4a16-8cfb-2b2c28d3f04d&page=queryresults
[0m08:30:19.794560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cd5913f6-9c3b-408d-a605-248fbef40d28&page=queryresults
[0m08:30:20.045476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d7efc0>]}
[0m08:30:20.047604 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m08:30:20.050221 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m08:30:20.052183 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m08:30:20.053138 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m08:30:20.054043 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m08:30:20.054857 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m08:30:20.058079 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m08:30:20.062206 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m08:30:20.073377 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:30:20.355184 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m08:30:20.358613 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    *
FROM 
    cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m08:30:20.904775 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e5889827-2f32-4594-ad5b-27870188ac13&page=queryresults
[0m08:30:22.506136 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ca94560>]}
[0m08:30:22.508220 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 10.5 KiB processed)[0m in 2.45s]
[0m08:30:22.509641 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m08:30:26.354766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7059b380>]}
[0m08:30:26.358121 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (3.9m rows, 299.0 MiB processed)[0m in 7.20s]
[0m08:30:26.360490 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m08:30:26.364398 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m08:30:26.365502 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m08:30:26.366741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m08:30:26.367563 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m08:30:26.390526 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m08:30:26.397774 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m08:30:26.401832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:30:26.736669 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m08:30:26.741946 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH cities_snapshot as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
    WHERE dbt_valid_to IS NULL
),

pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    p.city_id,
    city,
    region, 
    dt,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no,
    latitude,
    longitude
FROM 
    pollution AS p
JOIN 
    cities_snapshot AS c
ON 
    p.city_id = c.city_id
ORDER BY 
    city, dt
    );
  
[0m08:30:27.048323 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f2cd43c2-dd52-4770-ba0e-1f65423f8eb7&page=queryresults
[0m08:30:35.789661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cbdfc50>]}
[0m08:30:35.796271 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (3.9m rows, 324.0 MiB processed)[0m in 9.42s]
[0m08:30:35.803318 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m08:30:35.809055 [debug] [Thread-4 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m08:30:35.810764 [info ] [Thread-4 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m08:30:35.824301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.dim_cities, now model.france_air_pollution.agg_pollution_by_day)
[0m08:30:35.826430 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m08:30:35.862599 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:30:35.870540 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m08:30:35.874720 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:30:36.250885 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m08:30:36.255998 [debug] [Thread-4 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
)

SELECT 
    DATE(dt, 'Europe/Paris') as date,
    city,
    region,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT DATE(dt, 'Europe/Paris')) AS count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m08:30:38.025441 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d6703ec1-d234-4087-8fdc-a3f82e43d78f&page=queryresults
[0m08:30:43.962249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd71132-cad5-4b08-9b18-aab1cb35ca18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c9b9ac0>]}
[0m08:30:43.970169 [info ] [Thread-4 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (164.9k rows, 401.9 MiB processed)[0m in 8.14s]
[0m08:30:43.974099 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m08:30:43.985888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:30:43.993599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:43.994713 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m08:30:43.995883 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m08:30:43.996718 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m08:30:43.998493 [info ] [MainThread]: 
[0m08:30:43.999720 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 25.58 seconds (25.58s).
[0m08:30:44.002873 [debug] [MainThread]: Command end result
[0m08:30:44.135859 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m08:30:44.143934 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m08:30:44.155150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m08:30:44.156055 [info ] [MainThread]: 
[0m08:30:44.157017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:44.157825 [info ] [MainThread]: 
[0m08:30:44.158729 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:30:44.164126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.492321, "process_in_blocks": "0", "process_kernel_time": 1.33725, "process_mem_max_rss": "378212", "process_out_blocks": "0", "process_user_time": 4.594183}
[0m08:30:44.166171 [debug] [MainThread]: Command `dbt run` succeeded at 08:30:44.165988 after 29.49 seconds
[0m08:30:44.167971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a31e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707be6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70c7ede0>]}
[0m08:30:44.173660 [debug] [MainThread]: Flushing usage events
[0m08:30:44.687024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:17.025172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c94b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c97f80>]}


============================== 14:09:17.031868 | e05fd730-1823-4a60-8140-d76f0a1c324c ==============================
[0m14:09:17.031868 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:09:17.033677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:19.471741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7051f680>]}
[0m14:09:19.511012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70279fa0>]}
[0m14:09:19.512645 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:09:19.709523 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:09:19.781991 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:09:19.783162 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m14:09:19.784020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c95310>]}
[0m14:09:20.878177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f33c6e0>]}
[0m14:09:21.039729 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:09:21.045097 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:09:21.082823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f04dfa0>]}
[0m14:09:21.084626 [info ] [MainThread]: Found 5 models, 1 snapshot, 53 data tests, 2 sources, 496 macros
[0m14:09:21.085644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f319cd0>]}
[0m14:09:21.089825 [info ] [MainThread]: 
[0m14:09:21.093028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:21.094053 [info ] [MainThread]: 
[0m14:09:21.099126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:09:21.107664 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m14:09:21.108628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:21.455779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05fd730-1823-4a60-8140-d76f0a1c324c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f068ce0>]}
[0m14:09:21.457742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:21.464711 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m14:09:21.465437 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m14:09:21.465860 [debug] [Thread-3 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m14:09:21.466188 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m14:09:21.466500 [info ] [Thread-1 (]: 1 of 53 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m14:09:21.467492 [info ] [Thread-2 (]: 2 of 53 START test accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m14:09:21.468429 [info ] [Thread-3 (]: 3 of 53 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m14:09:21.469482 [info ] [Thread-4 (]: 4 of 53 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m14:09:21.470406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m14:09:21.471451 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3'
[0m14:09:21.482043 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m14:09:21.478801 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m14:09:21.480348 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m14:09:21.474932 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m14:09:21.492153 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m14:09:21.492601 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m14:09:21.496062 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m14:09:21.497347 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m14:09:21.505326 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m14:09:21.510806 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m14:09:21.507040 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m14:09:21.512656 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m14:09:21.530454 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m14:09:21.542612 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m14:09:21.543023 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m14:09:21.543522 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m14:09:21.545247 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m14:09:21.549867 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m14:09:21.551319 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m14:09:21.552613 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m14:09:21.557312 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:09:21.567740 [debug] [Thread-3 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m14:09:21.568525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:21.570274 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m14:09:21.571787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:09:21.604507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:09:22.137175 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:29c4edc8-4d20-4cfc-b117-3d34474ed251&page=queryresults
[0m14:09:22.158201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7e9710af-8541-4a0e-88a4-ba026264c8da&page=queryresults
[0m14:09:22.159423 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:35eb0de3-a311-4fa8-8d64-f3eac4203120&page=queryresults
[0m14:09:22.171842 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1230d3a-67c9-447b-a9fc-8b505aede6be&page=queryresults
[0m14:09:22.559313 [info ] [Thread-4 (]: 4 of 53 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.08s]
[0m14:09:22.560527 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m14:09:22.561130 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m14:09:22.561843 [info ] [Thread-4 (]: 5 of 53 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m14:09:22.562753 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885)
[0m14:09:22.563594 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m14:09:22.568157 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m14:09:22.572655 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m14:09:22.576893 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m14:09:22.580525 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m14:09:22.581884 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:22.618911 [info ] [Thread-2 (]: 2 of 53 PASS accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.15s]
[0m14:09:22.620500 [info ] [Thread-3 (]: 3 of 53 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.15s]
[0m14:09:22.623173 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m14:09:22.623930 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m14:09:22.624504 [info ] [Thread-3 (]: 6 of 53 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m14:09:22.622245 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m14:09:22.625191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m14:09:22.625908 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m14:09:22.626634 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m14:09:22.627416 [info ] [Thread-2 (]: 7 of 53 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m14:09:22.632853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m14:09:22.633840 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m14:09:22.637902 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m14:09:22.631935 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m14:09:22.647956 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m14:09:22.650519 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m14:09:22.657165 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m14:09:22.653542 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m14:09:22.658925 [info ] [Thread-1 (]: 1 of 53 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.19s]
[0m14:09:22.661759 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m14:09:22.665308 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m14:09:22.662330 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m14:09:22.685416 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:22.671292 [info ] [Thread-1 (]: 8 of 53 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m14:09:22.670603 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m14:09:22.688638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m14:09:22.738253 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m14:09:22.733353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:22.749361 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m14:09:22.792010 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m14:09:22.795018 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m14:09:22.799172 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m14:09:22.800365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:23.162318 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f25e95e5-2498-490b-bb8f-a7ca1e84f175&page=queryresults
[0m14:09:23.198351 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:65cdfb08-f2f2-4f85-930e-26b2898a8e98&page=queryresults
[0m14:09:23.207541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:bf07211a-d112-4dfa-9046-6da09ece0c75&page=queryresults
[0m14:09:23.215785 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a9ab20b-1827-4bad-9d01-968ec2d71e01&page=queryresults
[0m14:09:23.527569 [info ] [Thread-4 (]: 5 of 53 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 0.96s]
[0m14:09:23.539890 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m14:09:23.545747 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m14:09:23.549411 [info ] [Thread-4 (]: 9 of 53 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m14:09:23.551323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m14:09:23.552339 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m14:09:23.579955 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m14:09:23.584283 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m14:09:23.590617 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m14:09:23.595938 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m14:09:23.597627 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:23.638446 [info ] [Thread-3 (]: 6 of 53 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.01s]
[0m14:09:23.641907 [info ] [Thread-1 (]: 8 of 53 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.95s]
[0m14:09:23.645203 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m14:09:23.646992 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m14:09:23.648034 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m14:09:23.649040 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m14:09:23.652012 [info ] [Thread-1 (]: 11 of 53 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m14:09:23.656088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m14:09:23.655289 [info ] [Thread-2 (]: 7 of 53 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 1.02s]
[0m14:09:23.659020 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m14:09:23.657971 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m14:09:23.649900 [info ] [Thread-3 (]: 10 of 53 START test not_null_agg_pollution_by_day_avg_PM2_5 .................... [RUN]
[0m14:09:23.660218 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m14:09:23.666385 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m14:09:23.667854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m14:09:23.668881 [info ] [Thread-2 (]: 12 of 53 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m14:09:23.674461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m14:09:23.671138 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m14:09:23.675597 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m14:09:23.677532 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m14:09:23.685290 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m14:09:23.688607 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m14:09:23.691350 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m14:09:23.698456 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m14:09:23.699340 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m14:09:23.704398 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m14:09:23.708401 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m14:09:23.710673 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m14:09:23.711528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:23.748906 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m14:09:23.750198 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:23.751821 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m14:09:23.754318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:24.113379 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:16a10ee8-b4ee-4746-95b1-3ff33e0dc2e0&page=queryresults
[0m14:09:24.151183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4ffdced0-d21a-470f-8e7a-1ec52ebb621e&page=queryresults
[0m14:09:24.266023 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2fdad827-df70-45e2-822b-e8519e0f0bf8&page=queryresults
[0m14:09:24.327479 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aaa47094-e984-41c0-99b2-9e17d704335e&page=queryresults
[0m14:09:24.488344 [info ] [Thread-4 (]: 9 of 53 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.94s]
[0m14:09:24.489969 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m14:09:24.490969 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m14:09:24.492147 [info ] [Thread-4 (]: 13 of 53 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m14:09:24.493428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m14:09:24.494756 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m14:09:24.496932 [info ] [Thread-1 (]: 11 of 53 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.84s]
[0m14:09:24.502272 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m14:09:24.501027 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m14:09:24.503392 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m14:09:24.505304 [info ] [Thread-1 (]: 14 of 53 START test not_null_agg_pollution_by_day_region ....................... [RUN]
[0m14:09:24.506348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315)
[0m14:09:24.507497 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m14:09:24.511503 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"
[0m14:09:24.507992 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m14:09:24.515303 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m14:09:24.516900 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m14:09:24.519965 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"
[0m14:09:24.521076 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m14:09:24.521882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:24.523525 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where region is null



  
  
      
    ) dbt_internal_test
[0m14:09:24.524573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:24.607298 [info ] [Thread-3 (]: 10 of 53 PASS not_null_agg_pollution_by_day_avg_PM2_5 .......................... [[32mPASS[0m in 0.94s]
[0m14:09:24.609930 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m14:09:24.612011 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m14:09:24.612746 [info ] [Thread-3 (]: 15 of 53 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m14:09:24.613659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m14:09:24.614906 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m14:09:24.620807 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m14:09:24.625642 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m14:09:24.628111 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m14:09:24.631921 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m14:09:24.632922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:24.705136 [info ] [Thread-2 (]: 12 of 53 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 1.03s]
[0m14:09:24.719327 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m14:09:24.721025 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m14:09:24.723721 [info ] [Thread-2 (]: 16 of 53 START test not_null_staging_cities_city ............................... [RUN]
[0m14:09:24.726188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m14:09:24.730418 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m14:09:24.746368 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m14:09:24.750185 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m14:09:24.752699 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m14:09:24.757218 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m14:09:24.758102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:25.055042 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:88e37dc0-a1cd-40ab-b852-6890258d8b35&page=queryresults
[0m14:09:25.074527 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3705e7a3-cb1a-4461-ac9b-6cdf87bcbe0f&page=queryresults
[0m14:09:25.151339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e86f958b-bc5c-4454-b339-e1fbea313d9a&page=queryresults
[0m14:09:25.408205 [info ] [Thread-4 (]: 13 of 53 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.91s]
[0m14:09:25.410142 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m14:09:25.411187 [info ] [Thread-3 (]: 15 of 53 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.80s]
[0m14:09:25.412021 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m14:09:25.413820 [info ] [Thread-4 (]: 17 of 53 START test not_null_staging_cities_city_id ............................ [RUN]
[0m14:09:25.413092 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m14:09:25.414777 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde)
[0m14:09:25.416721 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m14:09:25.417823 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m14:09:25.418582 [info ] [Thread-3 (]: 18 of 53 START test not_null_staging_cities_latitude ........................... [RUN]
[0m14:09:25.425511 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m14:09:25.426173 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:98870654-9435-4fa8-b64f-a53cad065b41&page=queryresults
[0m14:09:25.426605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m14:09:25.430075 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m14:09:25.433937 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m14:09:25.434452 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m14:09:25.442610 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m14:09:25.450925 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m14:09:25.457679 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m14:09:25.461103 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m14:09:25.463648 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:25.504842 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m14:09:25.504252 [info ] [Thread-1 (]: 14 of 53 PASS not_null_agg_pollution_by_day_region ............................. [[32mPASS[0m in 1.00s]
[0m14:09:25.508034 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m14:09:25.509763 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m14:09:25.511137 [info ] [Thread-1 (]: 19 of 53 START test not_null_staging_cities_longitude .......................... [RUN]
[0m14:09:25.505836 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:25.512395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m14:09:25.546423 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m14:09:25.550565 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m14:09:25.555348 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m14:09:25.557479 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m14:09:25.559714 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m14:09:25.560390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:25.772449 [info ] [Thread-2 (]: 16 of 53 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 1.05s]
[0m14:09:25.773625 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m14:09:25.774471 [debug] [Thread-2 (]: Began running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m14:09:25.775321 [info ] [Thread-2 (]: 20 of 53 START test relationships_staging_air_pollution_city_id__city_index__source_sources_cities_  [RUN]
[0m14:09:25.776294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b)
[0m14:09:25.777120 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m14:09:25.782594 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"
[0m14:09:25.790236 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m14:09:25.794170 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"
[0m14:09:25.798033 [debug] [Thread-2 (]: On test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    where city_id is not null
),

parent as (
    select city_index as to_field
    from `paris-air-pollution-quangnc`.`raw`.`cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:09:25.798826 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:26.115808 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4b8a9b68-fd80-45e4-ac5f-59c9c0b82ec6&page=queryresults
[0m14:09:26.189509 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a1267251-3fa3-49c3-9a0f-4fb0d928f95e&page=queryresults
[0m14:09:26.239089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:822fcacf-6c47-489f-bf3f-12e22c840ad8&page=queryresults
[0m14:09:26.246424 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d5cb4ebb-6e65-47a3-b5c8-e6e73311c2da&page=queryresults
[0m14:09:26.474533 [info ] [Thread-4 (]: 17 of 53 PASS not_null_staging_cities_city_id .................................. [[32mPASS[0m in 1.06s]
[0m14:09:26.478561 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m14:09:26.480810 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m14:09:26.484749 [info ] [Thread-4 (]: 21 of 53 START test source_not_null_sources_airpollution_carbon_monoxide_co .... [RUN]
[0m14:09:26.485669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde, now test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31)
[0m14:09:26.486485 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m14:09:26.493321 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m14:09:26.497894 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m14:09:26.500664 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"
[0m14:09:26.503694 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m14:09:26.504554 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:26.606985 [info ] [Thread-3 (]: 18 of 53 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 1.18s]
[0m14:09:26.608466 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m14:09:26.609867 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m14:09:26.610667 [info ] [Thread-3 (]: 22 of 53 START test source_not_null_sources_airpollution_city_index ............ [RUN]
[0m14:09:26.611732 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef)
[0m14:09:26.612670 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m14:09:26.617446 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m14:09:26.620417 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m14:09:26.622842 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"
[0m14:09:26.626177 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m14:09:26.627173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:26.673111 [info ] [Thread-1 (]: 19 of 53 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 1.16s]
[0m14:09:26.674758 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m14:09:26.677064 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m14:09:26.678856 [info ] [Thread-1 (]: 23 of 53 START test source_not_null_sources_airpollution_nh3 ................... [RUN]
[0m14:09:26.681700 [error] [Thread-2 (]: 20 of 53 FAIL 3886928 relationships_staging_air_pollution_city_id__city_index__source_sources_cities_  [[31mFAIL 3886928[0m in 0.91s]
[0m14:09:26.683301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85)
[0m14:09:26.685408 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b
[0m14:09:26.686643 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m14:09:26.687480 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m14:09:26.697990 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m14:09:26.701178 [info ] [Thread-2 (]: 24 of 53 START test source_not_null_sources_airpollution_nitric_oxide_no ....... [RUN]
[0m14:09:26.704748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_sources_cities_.b22e8e517b, now test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1)
[0m14:09:26.706786 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m14:09:26.710711 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"
[0m14:09:26.707550 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m14:09:26.724603 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m14:09:26.727991 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m14:09:26.729569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:26.729890 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m14:09:26.766548 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"
[0m14:09:26.771175 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m14:09:26.772086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:27.173694 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cfe00f30-6aaa-40c7-be78-d75c30a53d5e&page=queryresults
[0m14:09:27.218768 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:eaffde4b-2a23-4191-b914-f85fb6f4f828&page=queryresults
[0m14:09:27.283771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b2205015-f5b8-48c3-a9a5-7706d03dd494&page=queryresults
[0m14:09:27.308730 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1a7ec221-16fb-4359-a2d3-f8bd740f8c6b&page=queryresults
[0m14:09:27.556534 [info ] [Thread-3 (]: 22 of 53 PASS source_not_null_sources_airpollution_city_index .................. [[32mPASS[0m in 0.94s]
[0m14:09:27.558162 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef
[0m14:09:27.558933 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m14:09:27.559553 [info ] [Thread-3 (]: 25 of 53 START test source_not_null_sources_airpollution_nitrogen_dioxide_no2 .. [RUN]
[0m14:09:27.560397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_city_index.59230158ef, now test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec)
[0m14:09:27.561349 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m14:09:27.566796 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m14:09:27.570751 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m14:09:27.573241 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"
[0m14:09:27.577103 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m14:09:27.577903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:27.765246 [info ] [Thread-2 (]: 24 of 53 PASS source_not_null_sources_airpollution_nitric_oxide_no ............. [[32mPASS[0m in 1.06s]
[0m14:09:27.766544 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1
[0m14:09:27.767330 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m14:09:27.766070 [info ] [Thread-4 (]: 21 of 53 PASS source_not_null_sources_airpollution_carbon_monoxide_co .......... [[32mPASS[0m in 1.28s]
[0m14:09:27.769111 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31
[0m14:09:27.767962 [info ] [Thread-2 (]: 26 of 53 START test source_not_null_sources_airpollution_ozone_o3 .............. [RUN]
[0m14:09:27.770135 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m14:09:27.771258 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitric_oxide_no.cb825bcfd1, now test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361)
[0m14:09:27.772983 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m14:09:27.772100 [info ] [Thread-4 (]: 27 of 53 START test source_not_null_sources_airpollution_pm10 .................. [RUN]
[0m14:09:27.779417 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m14:09:27.780507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_carbon_monoxide_co.37f04f3d31, now test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085)
[0m14:09:27.781782 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m14:09:27.785756 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m14:09:27.787364 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m14:09:27.789520 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"
[0m14:09:27.790261 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m14:09:27.792951 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"
[0m14:09:27.794397 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m14:09:27.795420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:27.796555 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m14:09:27.797838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:27.871505 [info ] [Thread-1 (]: 23 of 53 PASS source_not_null_sources_airpollution_nh3 ......................... [[32mPASS[0m in 1.19s]
[0m14:09:27.873338 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85
[0m14:09:27.874462 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m14:09:27.875407 [info ] [Thread-1 (]: 28 of 53 START test source_not_null_sources_airpollution_pm2_5 ................. [RUN]
[0m14:09:27.876138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nh3.c9efaf0f85, now test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e)
[0m14:09:27.876949 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m14:09:27.880943 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m14:09:27.885111 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m14:09:27.889667 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"
[0m14:09:27.893065 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m14:09:27.894044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:28.145714 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:218d603e-f5f0-459c-b023-c7b5fd56e2cc&page=queryresults
[0m14:09:28.353252 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b684bc09-43c9-41eb-826e-5a83a89f78a1&page=queryresults
[0m14:09:28.364750 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0373ab24-075b-42de-a30a-a6f6462b0725&page=queryresults
[0m14:09:28.474028 [info ] [Thread-3 (]: 25 of 53 PASS source_not_null_sources_airpollution_nitrogen_dioxide_no2 ........ [[32mPASS[0m in 0.91s]
[0m14:09:28.485055 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec
[0m14:09:28.480648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:51335ebf-fcbb-45e0-9c45-1bd1b9c72b05&page=queryresults
[0m14:09:28.497174 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m14:09:28.507109 [info ] [Thread-3 (]: 29 of 53 START test source_not_null_sources_airpollution_sulfur_dioxide_so2 .... [RUN]
[0m14:09:28.511375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_nitrogen_dioxide_no2.410ae409ec, now test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c)
[0m14:09:28.512420 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m14:09:28.524933 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m14:09:28.529163 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m14:09:28.535623 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"
[0m14:09:28.543367 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m14:09:28.544720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:28.706413 [info ] [Thread-4 (]: 27 of 53 PASS source_not_null_sources_airpollution_pm10 ........................ [[32mPASS[0m in 0.93s]
[0m14:09:28.707881 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085
[0m14:09:28.708941 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m14:09:28.709812 [info ] [Thread-4 (]: 30 of 53 START test source_not_null_sources_cities_city ........................ [RUN]
[0m14:09:28.711500 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm10.a9cca12085, now test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9)
[0m14:09:28.714031 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m14:09:28.720742 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m14:09:28.732673 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m14:09:28.736503 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"
[0m14:09:28.747640 [info ] [Thread-2 (]: 26 of 53 PASS source_not_null_sources_airpollution_ozone_o3 .................... [[32mPASS[0m in 0.98s]
[0m14:09:28.758589 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361
[0m14:09:28.762500 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m14:09:28.764427 [info ] [Thread-2 (]: 31 of 53 START test source_not_null_sources_cities_city_index .................. [RUN]
[0m14:09:28.763082 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m14:09:28.767510 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_ozone_o3.3c1cc90361, now test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb)
[0m14:09:28.776572 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m14:09:28.774000 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:28.783984 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m14:09:28.838982 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m14:09:28.842971 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"
[0m14:09:28.850316 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m14:09:28.852130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:28.861572 [info ] [Thread-1 (]: 28 of 53 PASS source_not_null_sources_airpollution_pm2_5 ....................... [[32mPASS[0m in 0.99s]
[0m14:09:28.909798 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e
[0m14:09:28.911883 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m14:09:28.913933 [info ] [Thread-1 (]: 32 of 53 START test source_not_null_sources_cities_latitude .................... [RUN]
[0m14:09:28.915291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_pm2_5.ed6348046e, now test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e)
[0m14:09:28.917464 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m14:09:28.923166 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m14:09:28.929996 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m14:09:28.933630 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"
[0m14:09:28.938063 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m14:09:28.939135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:29.162024 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8c296bb8-76ef-4ad4-8629-bf44ab452747&page=queryresults
[0m14:09:29.347240 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:937e121c-f492-4c22-ab27-30a7959fcaac&page=queryresults
[0m14:09:29.428268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47284c49-c3ed-4c1c-99f0-11a5a5ff3b18&page=queryresults
[0m14:09:29.483871 [info ] [Thread-3 (]: 29 of 53 PASS source_not_null_sources_airpollution_sulfur_dioxide_so2 .......... [[32mPASS[0m in 0.97s]
[0m14:09:29.485782 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c
[0m14:09:29.486789 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m14:09:29.491999 [info ] [Thread-3 (]: 33 of 53 START test source_not_null_sources_cities_longitude ................... [RUN]
[0m14:09:29.494435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_airpollution_sulfur_dioxide_so2.79ede0ab5c, now test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae)
[0m14:09:29.495794 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m14:09:29.507517 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m14:09:29.517829 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m14:09:29.523128 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"
[0m14:09:29.526854 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m14:09:29.528139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:29.614399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3f94b162-9093-4803-9bdd-731b8f02d2aa&page=queryresults
[0m14:09:29.709281 [info ] [Thread-4 (]: 30 of 53 PASS source_not_null_sources_cities_city .............................. [[32mPASS[0m in 1.00s]
[0m14:09:29.711733 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9
[0m14:09:29.716581 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m14:09:29.718475 [info ] [Thread-4 (]: 34 of 53 START test source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [RUN]
[0m14:09:29.719949 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city.9c146c05a9, now test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168)
[0m14:09:29.723195 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m14:09:29.740857 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m14:09:29.747376 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m14:09:29.751878 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"
[0m14:09:29.756278 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:29.757584 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:29.906634 [info ] [Thread-1 (]: 32 of 53 PASS source_not_null_sources_cities_latitude .......................... [[32mPASS[0m in 0.99s]
[0m14:09:29.908199 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e
[0m14:09:29.909422 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m14:09:29.911065 [info ] [Thread-1 (]: 35 of 53 START test source_test_is_float_sources_airpollution_nh3__float64 ..... [RUN]
[0m14:09:29.912513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_latitude.4deb7ed15e, now test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081)
[0m14:09:29.913505 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m14:09:29.918835 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m14:09:29.922432 [info ] [Thread-2 (]: 31 of 53 PASS source_not_null_sources_cities_city_index ........................ [[32mPASS[0m in 1.16s]
[0m14:09:29.924653 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m14:09:29.925450 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb
[0m14:09:29.929415 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"
[0m14:09:29.931476 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m14:09:29.934810 [info ] [Thread-2 (]: 36 of 53 START test source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [RUN]
[0m14:09:29.936675 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:29.937204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_city_index.d6d01053eb, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c)
[0m14:09:29.942075 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m14:09:29.940831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:29.947807 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m14:09:29.988838 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m14:09:29.994891 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"
[0m14:09:30.002203 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:30.006449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:30.082364 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ce1018e6-a7b2-4476-9136-44396fa121e7&page=queryresults
[0m14:09:30.351795 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5f0638fd-678a-4cc3-ae7a-b343fe7db993&page=queryresults
[0m14:09:30.643508 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:235582d6-f251-4fec-8c78-46fad82b0723&page=queryresults
[0m14:09:30.647370 [info ] [Thread-3 (]: 33 of 53 PASS source_not_null_sources_cities_longitude ......................... [[32mPASS[0m in 1.15s]
[0m14:09:30.664083 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae
[0m14:09:30.668755 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m14:09:30.670357 [info ] [Thread-3 (]: 37 of 53 START test source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m14:09:30.674039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_sources_cities_longitude.801b9258ae, now test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55)
[0m14:09:30.654745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:55d71b04-06c3-430d-9ba9-12301b4de238&page=queryresults
[0m14:09:30.677771 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m14:09:30.696616 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m14:09:30.702836 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m14:09:30.706773 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"
[0m14:09:30.710577 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:30.713119 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:30.773269 [info ] [Thread-4 (]: 34 of 53 PASS source_test_is_float_sources_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.05s]
[0m14:09:30.774484 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168
[0m14:09:30.775538 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m14:09:30.776383 [info ] [Thread-4 (]: 38 of 53 START test source_test_is_float_sources_airpollution_ozone_o3__float64  [RUN]
[0m14:09:30.779169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_carbon_monoxide_co__float64.4a41d9b168, now test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a)
[0m14:09:30.781660 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m14:09:30.785756 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m14:09:30.788861 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m14:09:30.791443 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"
[0m14:09:30.793946 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:30.795031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:30.963824 [info ] [Thread-2 (]: 36 of 53 PASS source_test_is_float_sources_airpollution_nitric_oxide_no__float64  [[32mPASS[0m in 1.03s]
[0m14:09:30.965313 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c
[0m14:09:30.966210 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m14:09:30.967041 [info ] [Thread-2 (]: 39 of 53 START test source_test_is_float_sources_airpollution_pm10__float64 .... [RUN]
[0m14:09:30.967979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitric_oxide_no__float64.2fcbbfd11c, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281)
[0m14:09:30.968733 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m14:09:30.973051 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m14:09:30.976048 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m14:09:30.981010 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"
[0m14:09:30.986747 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:30.987783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:31.026334 [info ] [Thread-1 (]: 35 of 53 PASS source_test_is_float_sources_airpollution_nh3__float64 ........... [[32mPASS[0m in 1.11s]
[0m14:09:31.028567 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081
[0m14:09:31.029439 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m14:09:31.030351 [info ] [Thread-1 (]: 40 of 53 START test source_test_is_float_sources_airpollution_pm2_5__float64 ... [RUN]
[0m14:09:31.031376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nh3__float64.9339ebe081, now test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3)
[0m14:09:31.032123 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m14:09:31.037525 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m14:09:31.041607 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m14:09:31.044014 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"
[0m14:09:31.046538 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:31.047363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:31.332095 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:795b8b99-8e22-476e-b925-54cb66c2044e&page=queryresults
[0m14:09:31.398587 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0df6028f-c2e7-4b77-b0aa-1a6f1db13693&page=queryresults
[0m14:09:31.606468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:05b714e4-e4ac-4747-96af-cc81159a45e4&page=queryresults
[0m14:09:31.671200 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:020bf496-fa6b-4bd7-b860-370de9a6c0ed&page=queryresults
[0m14:09:31.735866 [info ] [Thread-3 (]: 37 of 53 PASS source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 1.06s]
[0m14:09:31.738270 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55
[0m14:09:31.739442 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m14:09:31.740972 [info ] [Thread-3 (]: 41 of 53 START test source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m14:09:31.744367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_nitrogen_dioxide_no2__float64.69c320ee55, now test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6)
[0m14:09:31.752921 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m14:09:31.752387 [info ] [Thread-4 (]: 38 of 53 PASS source_test_is_float_sources_airpollution_ozone_o3__float64 ...... [[32mPASS[0m in 0.97s]
[0m14:09:31.765918 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m14:09:31.767051 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a
[0m14:09:31.770019 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m14:09:31.771663 [info ] [Thread-4 (]: 42 of 53 START test source_unique_sources_cities_city_index .................... [RUN]
[0m14:09:31.773025 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_ozone_o3__float64.dc0acc751a, now test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7)
[0m14:09:31.774124 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m14:09:31.773767 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m14:09:31.782256 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m14:09:31.788852 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"
[0m14:09:31.805358 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m14:09:31.821257 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"
[0m14:09:31.823468 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:31.849846 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:31.855653 [debug] [Thread-4 (]: On test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:09:31.860152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:32.031941 [info ] [Thread-1 (]: 40 of 53 PASS source_test_is_float_sources_airpollution_pm2_5__float64 ......... [[32mPASS[0m in 1.00s]
[0m14:09:32.033404 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3
[0m14:09:32.034467 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m14:09:32.035461 [info ] [Thread-1 (]: 43 of 53 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m14:09:32.036632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm2_5__float64.d259deabd3, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m14:09:32.037344 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m14:09:32.047023 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m14:09:32.051701 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m14:09:32.056810 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m14:09:32.068498 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:32.069511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:32.108692 [info ] [Thread-2 (]: 39 of 53 PASS source_test_is_float_sources_airpollution_pm10__float64 .......... [[32mPASS[0m in 1.14s]
[0m14:09:32.112651 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281
[0m14:09:32.115744 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m14:09:32.116768 [info ] [Thread-2 (]: 44 of 53 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m14:09:32.117978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_pm10__float64.0e53bbb281, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m14:09:32.118912 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m14:09:32.123730 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m14:09:32.128273 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m14:09:32.132620 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m14:09:32.136694 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:32.137637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:32.545817 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc24cb16-402c-4b9e-84d2-9c2fbc238b1b&page=queryresults
[0m14:09:32.603428 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:050d687e-32b1-4e47-8cfb-34268d3568b0&page=queryresults
[0m14:09:32.778659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:610dbfe3-26ab-41a9-b74a-5fcc8c77aeef&page=queryresults
[0m14:09:32.782198 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:43cb34dc-b8a3-42ca-bd90-b4dec741c123&page=queryresults
[0m14:09:32.965088 [info ] [Thread-3 (]: 41 of 53 PASS source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 1.22s]
[0m14:09:32.966505 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6
[0m14:09:32.967327 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m14:09:32.968154 [info ] [Thread-3 (]: 45 of 53 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m14:09:32.969667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_sources_airpollution_sulfur_dioxide_so2__float64.c7ddd184f6, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m14:09:32.972142 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m14:09:32.973597 [info ] [Thread-4 (]: 42 of 53 PASS source_unique_sources_cities_city_index .......................... [[32mPASS[0m in 1.20s]
[0m14:09:32.981553 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7
[0m14:09:32.982676 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m14:09:32.979421 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m14:09:32.983602 [info ] [Thread-4 (]: 46 of 53 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m14:09:32.985427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_sources_cities_city_index.a509506ef7, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m14:09:32.986593 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m14:09:32.990265 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m14:09:32.992068 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m14:09:32.997011 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m14:09:32.999894 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m14:09:33.002729 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m14:09:33.003314 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:33.004347 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:33.005617 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:33.007085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:33.085783 [info ] [Thread-1 (]: 43 of 53 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 1.05s]
[0m14:09:33.087520 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m14:09:33.088597 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m14:09:33.089961 [info ] [Thread-1 (]: 47 of 53 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m14:09:33.091630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m14:09:33.092794 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m14:09:33.095598 [info ] [Thread-2 (]: 44 of 53 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 0.98s]
[0m14:09:33.101065 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m14:09:33.106132 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m14:09:33.108960 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m14:09:33.110792 [info ] [Thread-2 (]: 48 of 53 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m14:09:33.112353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m14:09:33.113683 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m14:09:33.114593 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m14:09:33.117598 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m14:09:33.123253 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m14:09:33.128736 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:33.134763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:33.136660 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m14:09:33.148180 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m14:09:33.211781 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:33.213119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:33.764361 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c81d91f7-015f-4026-acae-4cb91419df03&page=queryresults
[0m14:09:33.765477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6f541655-2108-4b84-9815-a7f02d02d033&page=queryresults
[0m14:09:33.767621 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:51af0cb5-7397-466f-8bc1-b8e7f8701aed&page=queryresults
[0m14:09:33.781325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1f09b3b6-0f4d-439b-9ef7-f586199ef060&page=queryresults
[0m14:09:34.093408 [info ] [Thread-4 (]: 46 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 1.11s]
[0m14:09:34.095097 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m14:09:34.094446 [info ] [Thread-2 (]: 48 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 0.98s]
[0m14:09:34.095872 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m14:09:34.096827 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m14:09:34.098492 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m14:09:34.097555 [info ] [Thread-4 (]: 49 of 53 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m14:09:34.099335 [info ] [Thread-2 (]: 50 of 53 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m14:09:34.100112 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m14:09:34.100979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m14:09:34.102415 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m14:09:34.101706 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m14:09:34.113805 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m14:09:34.107833 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m14:09:34.121472 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m14:09:34.124260 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m14:09:34.124632 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m14:09:34.128507 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m14:09:34.129791 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:34.131335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:34.133325 [info ] [Thread-1 (]: 47 of 53 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.04s]
[0m14:09:34.134064 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m14:09:34.134758 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m14:09:34.136359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:34.169077 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m14:09:34.189501 [info ] [Thread-3 (]: 45 of 53 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 1.22s]
[0m14:09:34.195510 [info ] [Thread-1 (]: 51 of 53 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m14:09:34.233346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m14:09:34.197427 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m14:09:34.235102 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m14:09:34.236326 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m14:09:34.243723 [info ] [Thread-3 (]: 52 of 53 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m14:09:34.245370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m14:09:34.243099 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m14:09:34.246280 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m14:09:34.250752 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m14:09:34.252394 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m14:09:34.258331 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m14:09:34.262301 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m14:09:34.268593 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m14:09:34.272001 [debug] [Thread-1 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m14:09:34.273803 [debug] [Thread-3 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m14:09:34.274509 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:34.274142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:34.887736 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e1e6a996-2028-44c2-a3e7-77a8c9966b23&page=queryresults
[0m14:09:34.889810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1592d267-5dd8-48c6-828d-cc6c621287ee&page=queryresults
[0m14:09:34.890480 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9ed3c4b8-a7a6-4a79-a99a-6d5d4d6ed3a9&page=queryresults
[0m14:09:35.017964 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70d785af-42bd-41bc-8308-b97e053bb87d&page=queryresults
[0m14:09:35.187328 [info ] [Thread-1 (]: 51 of 53 PASS test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[32mPASS[0m in 0.95s]
[0m14:09:35.188857 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m14:09:35.189708 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m14:09:35.190538 [info ] [Thread-1 (]: 53 of 53 START test unique_staging_cities_city_id .............................. [RUN]
[0m14:09:35.191414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd, now test.france_air_pollution.unique_staging_cities_city_id.051e2d6903)
[0m14:09:35.192356 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m14:09:35.201714 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m14:09:35.203556 [info ] [Thread-4 (]: 49 of 53 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.10s]
[0m14:09:35.204734 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m14:09:35.205711 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m14:09:35.208388 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m14:09:35.211176 [debug] [Thread-1 (]: On test.france_air_pollution.unique_staging_cities_city_id.051e2d6903: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where city_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:09:35.212051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:35.250063 [info ] [Thread-2 (]: 50 of 53 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 1.15s]
[0m14:09:35.251967 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m14:09:35.343270 [info ] [Thread-3 (]: 52 of 53 PASS test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[32mPASS[0m in 1.10s]
[0m14:09:35.344586 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m14:09:35.912835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a01a41f6-36c4-4172-97d6-94053d4d49f9&page=queryresults
[0m14:09:36.228472 [info ] [Thread-1 (]: 53 of 53 PASS unique_staging_cities_city_id .................................... [[32mPASS[0m in 1.04s]
[0m14:09:36.229740 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m14:09:36.235145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:36.238694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:36.239527 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_city_id.051e2d6903' was properly closed.
[0m14:09:36.240302 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714' was properly closed.
[0m14:09:36.241117 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m14:09:36.241886 [debug] [MainThread]: Connection 'test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2' was properly closed.
[0m14:09:36.243118 [info ] [MainThread]: 
[0m14:09:36.244598 [info ] [MainThread]: Finished running 53 data tests in 0 hours 0 minutes and 15.15 seconds (15.15s).
[0m14:09:36.250747 [debug] [MainThread]: Command end result
[0m14:09:36.403325 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m14:09:36.413067 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m14:09:36.449952 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m14:09:36.450682 [info ] [MainThread]: 
[0m14:09:36.452212 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:09:36.453957 [info ] [MainThread]: 
[0m14:09:36.455197 [error] [MainThread]: [31mFailure in test relationships_staging_air_pollution_city_id__city_index__source_sources_cities_ (models/schema.yml)[0m
[0m14:09:36.456203 [error] [MainThread]:   Got 3886928 results, configured to fail if != 0
[0m14:09:36.458511 [info ] [MainThread]: 
[0m14:09:36.460204 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/relationships_staging_air_poll_3754913883e9b1965e1d62bd76f672cf.sql
[0m14:09:36.461421 [info ] [MainThread]: 
[0m14:09:36.462443 [info ] [MainThread]: Done. PASS=52 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=53
[0m14:09:36.469730 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 19.487125, "process_in_blocks": "0", "process_kernel_time": 1.998929, "process_mem_max_rss": "388604", "process_out_blocks": "0", "process_user_time": 7.654386}
[0m14:09:36.474290 [debug] [MainThread]: Command `dbt test` failed at 14:09:36.474022 after 19.49 seconds
[0m14:09:36.476517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8982a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eefd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c0fd9a0>]}
[0m14:09:36.477693 [debug] [MainThread]: Flushing usage events
[0m14:09:36.966863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:03.970742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecb9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9107b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eceaff0>]}


============================== 15:35:03.979879 | ea2af4d2-08b8-4546-962c-c5535f64902c ==============================
[0m15:35:03.979879 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:35:03.981354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m15:35:06.192609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d2b830>]}
[0m15:35:06.226487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e57e900>]}
[0m15:35:06.227854 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:35:06.383252 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:35:06.462725 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:35:06.464020 [debug] [MainThread]: previous checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, current checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b
[0m15:35:06.464902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ece94c0>]}
[0m15:35:07.595567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff740e1cd0>]}
[0m15:35:07.729461 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:35:07.733687 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:35:07.757068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67fb6c90>]}
[0m15:35:07.757977 [info ] [MainThread]: Found 5 models, 1 snapshot, 77 data tests, 2 sources, 496 macros
[0m15:35:07.758876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff742cc6e0>]}
[0m15:35:07.761831 [info ] [MainThread]: 
[0m15:35:07.762749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:07.763693 [info ] [MainThread]: 
[0m15:35:07.765334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:07.769250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:35:07.770224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:08.175211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:35:08.177438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:08.533871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec8ba10>]}
[0m15:35:08.537075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:08.549838 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:35:08.550556 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:35:08.551899 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:35:08.553941 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:35:08.555379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:35:08.559635 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:35:08.557046 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:35:08.572811 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:35:08.574091 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:35:08.577198 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:35:08.581512 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:35:08.581950 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:35:08.617983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:08.623490 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:35:08.656780 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH raw_cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    raw_cities;


[0m15:35:08.658458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:35:08.962092 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:35:08.967513 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH raw_pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY city_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no,
    dt,
    DATE(dt, 'Europe/Paris') as date,
FROM 
    raw_pollution
WHERE 1=1

    );
  
[0m15:35:09.156178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:08965ca2-8ba9-4cf2-9a9e-5b9fd3135caf&page=queryresults
[0m15:35:09.312997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:95f23631-a0f3-47e8-ad39-a54292977f27&page=queryresults
[0m15:35:09.504986 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e71850>]}
[0m15:35:09.506443 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:35:09.507881 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:35:09.510037 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:35:09.510973 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:35:09.512034 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:35:09.512707 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:35:09.516614 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:35:09.519729 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:35:09.527059 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:35:09.878640 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:35:09.900631 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH staging_cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    city_id, 
    city, 
    latitude, 
    longitude, 
    region
FROM 
    staging_cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:35:10.255599 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:04eaab5d-d0c7-41e8-b5b0-6869f593c7e7&page=queryresults
[0m15:35:11.562149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64195b20>]}
[0m15:35:11.571926 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (149.1k rows, 11.4 MiB processed)[0m in 3.01s]
[0m15:35:11.577889 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:35:11.580758 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:35:11.582174 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:35:11.585896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:35:11.587457 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:35:11.593666 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:35:11.597431 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:35:11.600465 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:35:11.603439 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

staging_pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    city_id,
    dt,
    date,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no
FROM 
    staging_pollution AS p
ORDER BY 
    dt
    );
  
[0m15:35:11.604516 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:11.736585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6426dbe0>]}
[0m15:35:11.737754 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.22s]
[0m15:35:11.739590 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:35:11.857837 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:817ca1bc-3448-4e0f-ac01-a0f75456533e&page=queryresults
[0m15:35:11.859318 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:817ca1bc-3448-4e0f-ac01-a0f75456533e&page=queryresults
[0m15:35:11.866253 [debug] [Thread-2 (]: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Unexpected identifier "staging_pollution" at [15:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m15:35:11.867644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2af4d2-08b8-4546-962c-c5535f64902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f090d0>]}
[0m15:35:11.869050 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model development.fact_air_pollution ..... [[31mERROR[0m in 0.28s]
[0m15:35:11.871653 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:35:11.873224 [debug] [Thread-7 (]: Marking all children of 'model.france_air_pollution.fact_air_pollution' to be skipped because of status 'error'.  Reason: Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Unexpected identifier "staging_pollution" at [15:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql.
[0m15:35:11.877925 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:35:11.879219 [info ] [Thread-1 (]: 5 of 5 SKIP relation development.agg_pollution_by_day .......................... [[33mSKIP[0m]
[0m15:35:11.881364 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:35:11.886418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:11.892300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:11.893893 [debug] [MainThread]: Connection 'model.france_air_pollution.staging_air_pollution' was properly closed.
[0m15:35:11.897147 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:35:11.898683 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m15:35:11.900695 [info ] [MainThread]: 
[0m15:35:11.902545 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m15:35:11.904692 [debug] [MainThread]: Command end result
[0m15:35:12.012884 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:35:12.018254 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:35:12.025859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:35:12.026558 [info ] [MainThread]: 
[0m15:35:12.027241 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:12.028010 [info ] [MainThread]: 
[0m15:35:12.029018 [error] [MainThread]: [31mFailure in model fact_air_pollution (models/fact/fact_air_pollution.sql)[0m
[0m15:35:12.029790 [error] [MainThread]:   Database Error in model fact_air_pollution (models/fact/fact_air_pollution.sql)
  Syntax error: Unexpected identifier "staging_pollution" at [15:1]
  compiled code at target/run/france_air_pollution/models/fact/fact_air_pollution.sql
[0m15:35:12.030666 [info ] [MainThread]: 
[0m15:35:12.031528 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/fact/fact_air_pollution.sql
[0m15:35:12.032410 [info ] [MainThread]: 
[0m15:35:12.033537 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m15:35:12.037586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.103025, "process_in_blocks": "0", "process_kernel_time": 1.325624, "process_mem_max_rss": "385092", "process_out_blocks": "0", "process_user_time": 4.398379}
[0m15:35:12.039074 [debug] [MainThread]: Command `dbt run` failed at 15:35:12.038916 after 8.10 seconds
[0m15:35:12.040431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecb9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f4cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff740f92e0>]}
[0m15:35:12.041083 [debug] [MainThread]: Flushing usage events
[0m15:35:12.527756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:01.479863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5c7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f29aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5c7200>]}


============================== 15:54:01.484580 | 1c8a7d4a-4207-4a66-aefd-865c5d002a5a ==============================
[0m15:54:01.484580 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:54:01.485567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:04.049266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73638470>]}
[0m15:54:04.089816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7366fd10>]}
[0m15:54:04.091388 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:54:04.285112 [debug] [MainThread]: checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba, vars: {}, profile: , target: dev, version: 1.10.3
[0m15:54:04.399597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:04.401006 [debug] [MainThread]: Partial parsing: updated file: france_air_pollution://models/fact/fact_air_pollution.sql
[0m15:54:04.899699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ed39e0>]}
[0m15:54:05.070606 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:54:05.076865 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:54:05.112494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730cbce0>]}
[0m15:54:05.113268 [info ] [MainThread]: Found 5 models, 1 snapshot, 77 data tests, 2 sources, 496 macros
[0m15:54:05.114156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c23cb0>]}
[0m15:54:05.116999 [info ] [MainThread]: 
[0m15:54:05.117927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:05.118667 [info ] [MainThread]: 
[0m15:54:05.120276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:54:05.124052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc'
[0m15:54:05.124801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:05.579002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc, now list_paris-air-pollution-quangnc_development)
[0m15:54:05.581046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:05.877346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dd15e0>]}
[0m15:54:05.878623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:05.884658 [debug] [Thread-1 (]: Began running node model.france_air_pollution.staging_air_pollution
[0m15:54:05.885853 [info ] [Thread-1 (]: 1 of 5 START sql incremental model development.staging_air_pollution ........... [RUN]
[0m15:54:05.887216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now model.france_air_pollution.staging_air_pollution)
[0m15:54:05.888814 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.staging_air_pollution
[0m15:54:05.885161 [debug] [Thread-2 (]: Began running node model.france_air_pollution.staging_cities
[0m15:54:05.898275 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.staging_air_pollution"
[0m15:54:05.898894 [info ] [Thread-2 (]: 2 of 5 START sql view model development.staging_cities ......................... [RUN]
[0m15:54:05.901270 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.france_air_pollution.staging_cities'
[0m15:54:05.902054 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.staging_cities
[0m15:54:05.906391 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.staging_cities"
[0m15:54:05.907458 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.staging_air_pollution
[0m15:54:05.933784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:05.934241 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.staging_cities
[0m15:54:05.987923 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.staging_cities"
[0m15:54:05.991411 [debug] [Thread-2 (]: On model.france_air_pollution.staging_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_cities"} */


  create or replace view `paris-air-pollution-quangnc`.`development`.`staging_cities`
  OPTIONS()
  as WITH raw_cities AS (
    SELECT *,
    row_number() over(partition by city_index) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`cities`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    city, 
    latitude, 
    longitude, 
    region
FROM 
    raw_cities;


[0m15:54:05.992480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:54:06.270650 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.staging_air_pollution"
[0m15:54:06.273947 [debug] [Thread-1 (]: On model.france_air_pollution.staging_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.staging_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH raw_pollution AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY city_index, dt) AS rn
    FROM `paris-air-pollution-quangnc`.`raw`.`airpollution`
    ORDER BY city_index
)

SELECT 
    city_index AS city_id,
    CASE 
        WHEN Sulfur_Dioxide_SO2 > 350 
            OR Nitrogen_Dioxide_NO2 > 200 
            OR PM10 > 200 OR PM2_5 > 75 
            OR Ozone_O3 > 180 
            OR Carbon_Monoxide_CO > 15400 
            THEN 'Very_Poor'
        WHEN 
            Sulfur_Dioxide_SO2 > 250 
            OR Nitrogen_Dioxide_NO2 > 150 
            OR PM10 > 100 OR PM2_5 > 50 
            OR Ozone_O3 > 140 
            OR Carbon_Monoxide_CO > 12400 
            THEN 'Poor'
        WHEN Sulfur_Dioxide_SO2 > 80
             OR Nitrogen_Dioxide_NO2 > 70 
             OR PM10 > 50 OR PM2_5 > 25 
             OR Ozone_O3 > 100 
             OR Carbon_Monoxide_CO > 9400 
             THEN 'Moderate'
        WHEN Sulfur_Dioxide_SO2 > 20 
            OR Nitrogen_Dioxide_NO2 > 40 
            OR PM10 > 20 OR PM2_5 > 10 
            OR Ozone_O3 > 60 
            OR Carbon_Monoxide_CO > 4400 
            THEN 'Fair'
        ELSE 'Good'
    END AS pollution_quality,
    Sulfur_Dioxide_SO2 AS sulfur_dioxide_so2,
    Nitrogen_Dioxide_NO2 AS nitrogen_dioxide_no2,
    PM10 AS pm10,
    PM2_5 AS pm2_5,
    Ozone_O3 AS ozone_o3,
    Carbon_Monoxide_CO AS carbon_monoxide_co,
    NH3 AS nh3,
    Nitric_oxide_NO AS nitric_oxide_no,
    dt,
    DATE(dt, 'Europe/Paris') as date,
FROM 
    raw_pollution
WHERE 1=1

    );
  
[0m15:54:06.533749 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:832969e3-bfe2-476d-b07d-7775debc18f9&page=queryresults
[0m15:54:06.829701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73046960>]}
[0m15:54:06.830279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2e0aa302-7bc3-4c28-bd24-35333cb71470&page=queryresults
[0m15:54:06.831073 [info ] [Thread-2 (]: 2 of 5 OK created sql view model development.staging_cities .................... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m15:54:06.834342 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.staging_cities
[0m15:54:06.835665 [debug] [Thread-4 (]: Began running node model.france_air_pollution.dim_cities
[0m15:54:06.836517 [info ] [Thread-4 (]: 3 of 5 START sql table model development.dim_cities ............................ [RUN]
[0m15:54:06.837624 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.france_air_pollution.dim_cities'
[0m15:54:06.838976 [debug] [Thread-4 (]: Began compiling node model.france_air_pollution.dim_cities
[0m15:54:06.842075 [debug] [Thread-4 (]: Writing injected SQL for node "model.france_air_pollution.dim_cities"
[0m15:54:06.845911 [debug] [Thread-4 (]: Began executing node model.france_air_pollution.dim_cities
[0m15:54:06.855034 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:54:07.211948 [debug] [Thread-4 (]: Writing runtime sql for node "model.france_air_pollution.dim_cities"
[0m15:54:07.216388 [debug] [Thread-4 (]: On model.france_air_pollution.dim_cities: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.dim_cities"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`dim_cities`
      
    
    

    OPTIONS()
    as (
      WITH staging_cities AS (
    SELECT * 
    FROM `paris-air-pollution-quangnc`.`development`.`snapshot_staging_cities`
)

SELECT 
    city_id, 
    city, 
    latitude, 
    longitude, 
    region
FROM 
    staging_cities 
WHERE 
    dbt_valid_to IS NULL
    );
  
[0m15:54:07.578022 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:472912d5-d80e-4af1-9392-82fac0562375&page=queryresults
[0m15:54:08.719741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af8cfe0>]}
[0m15:54:08.721569 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model development.staging_air_pollution ...... [[32mCREATE TABLE (149.1k rows, 11.4 MiB processed)[0m in 2.83s]
[0m15:54:08.723096 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.staging_air_pollution
[0m15:54:08.724475 [debug] [Thread-2 (]: Began running node model.france_air_pollution.fact_air_pollution
[0m15:54:08.725635 [info ] [Thread-2 (]: 4 of 5 START sql incremental model development.fact_air_pollution .............. [RUN]
[0m15:54:08.727683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_cities, now model.france_air_pollution.fact_air_pollution)
[0m15:54:08.730094 [debug] [Thread-2 (]: Began compiling node model.france_air_pollution.fact_air_pollution
[0m15:54:08.741777 [debug] [Thread-2 (]: Writing injected SQL for node "model.france_air_pollution.fact_air_pollution"
[0m15:54:08.747156 [debug] [Thread-2 (]: Began executing node model.france_air_pollution.fact_air_pollution
[0m15:54:08.751154 [debug] [Thread-2 (]: Writing runtime sql for node "model.france_air_pollution.fact_air_pollution"
[0m15:54:08.754911 [debug] [Thread-2 (]: On model.france_air_pollution.fact_air_pollution: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.fact_air_pollution"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
      
    
    

    OPTIONS()
    as (
      

WITH staging_pollution AS (
    SELECT 
        *
    FROM 
        `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    
)

SELECT 
    city_id,
    dt,
    date,
    pollution_quality,
    sulfur_dioxide_so2,
    nitrogen_dioxide_no2,
    pm10,
    pm2_5,
    ozone_o3,
    carbon_monoxide_co,
    nh3,
    nitric_oxide_no
FROM 
    staging_pollution AS p
ORDER BY 
    dt
    );
  
[0m15:54:08.755973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:54:09.134058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af17d40>]}
[0m15:54:09.136516 [info ] [Thread-4 (]: 3 of 5 OK created sql table model development.dim_cities ....................... [[32mCREATE TABLE (105.0 rows, 5.4 KiB processed)[0m in 2.30s]
[0m15:54:09.139537 [debug] [Thread-4 (]: Finished running node model.france_air_pollution.dim_cities
[0m15:54:09.260440 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:aa925b98-4b0d-4426-821b-9bb08a56b80c&page=queryresults
[0m15:54:11.045888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af8c860>]}
[0m15:54:11.047397 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model development.fact_air_pollution ......... [[32mCREATE TABLE (149.1k rows, 13.5 MiB processed)[0m in 2.32s]
[0m15:54:11.048766 [debug] [Thread-2 (]: Finished running node model.france_air_pollution.fact_air_pollution
[0m15:54:11.051616 [debug] [Thread-1 (]: Began running node model.france_air_pollution.agg_pollution_by_day
[0m15:54:11.052623 [info ] [Thread-1 (]: 5 of 5 START sql incremental model development.agg_pollution_by_day ............ [RUN]
[0m15:54:11.053492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.france_air_pollution.staging_air_pollution, now model.france_air_pollution.agg_pollution_by_day)
[0m15:54:11.054408 [debug] [Thread-1 (]: Began compiling node model.france_air_pollution.agg_pollution_by_day
[0m15:54:11.071892 [debug] [Thread-1 (]: Writing injected SQL for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:54:11.080316 [debug] [Thread-1 (]: Began executing node model.france_air_pollution.agg_pollution_by_day
[0m15:54:11.083709 [debug] [Thread-1 (]: Writing runtime sql for node "model.france_air_pollution.agg_pollution_by_day"
[0m15:54:11.087163 [debug] [Thread-1 (]: On model.france_air_pollution.agg_pollution_by_day: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "model.france_air_pollution.agg_pollution_by_day"} */

  
    

    create or replace table `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
      
    
    

    OPTIONS()
    as (
      

WITH pollution AS (
    SELECT *
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    WHERE 
        pollution_quality IN ('Very_Poor', 'Poor', 'Moderate', 'Fair', 'Good')    
), 

dim_cities as (
    SELECT  
        *
    FROM 
    `paris-air-pollution-quangnc`.`development`.`dim_cities`
)


SELECT 
    city,
    region,
    date,
    CASE 
        WHEN COUNTIF(pollution_quality = 'Very_Poor') > 0 THEN 'Very_Poor'
        WHEN COUNTIF(pollution_quality = 'Poor') > 0 THEN 'Poor'
        WHEN COUNTIF(pollution_quality = 'Moderate') > 0 THEN 'Moderate'
        WHEN COUNTIF(pollution_quality = 'Fair') > 0 THEN 'Fair'
        WHEN COUNTIF(pollution_quality = 'Good') > 0 THEN 'Good'
        ELSE 'Unknown'
    END AS pollution_quality,
    COUNT(DISTINCT date) AS count_days,
    ROUND(AVG(sulfur_dioxide_so2),2) as avg_SO2,
    ROUND(AVG(nitrogen_dioxide_no2),2) as avg_NO2,
    ROUND(AVG(pm10),2) as avg_PM10,
    ROUND(AVG(pm2_5),2) as avg_PM2_5,
    ROUND(AVG(ozone_o3),2) as avg_O3,
    ROUND(AVG(carbon_monoxide_co),2) as avg_CO,
    ROUND(AVG(nh3),2) as avg_NH3,
    ROUND(AVG(nitric_oxide_no),2) as avg_NO
FROM 
    pollution p 
LEFT JOIN 
    dim_cities c 
ON 
  p.city_id = c.city_id
WHERE 1=1
    
GROUP BY 
    1, 2, 3
ORDER BY 
    city,
    date
    );
  
[0m15:54:11.088576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:11.758789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ae172700-f9bf-4280-b613-74f9807e31a1&page=queryresults
[0m15:54:13.522411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8a7d4a-4207-4a66-aefd-865c5d002a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72caf6b0>]}
[0m15:54:13.524390 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model development.agg_pollution_by_day ....... [[32mCREATE TABLE (6.3k rows, 12.4 MiB processed)[0m in 2.47s]
[0m15:54:13.526411 [debug] [Thread-1 (]: Finished running node model.france_air_pollution.agg_pollution_by_day
[0m15:54:13.531462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:13.535798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:13.537309 [debug] [MainThread]: Connection 'model.france_air_pollution.agg_pollution_by_day' was properly closed.
[0m15:54:13.538781 [debug] [MainThread]: Connection 'model.france_air_pollution.fact_air_pollution' was properly closed.
[0m15:54:13.539829 [debug] [MainThread]: Connection 'model.france_air_pollution.dim_cities' was properly closed.
[0m15:54:13.541159 [info ] [MainThread]: 
[0m15:54:13.542232 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m15:54:13.544243 [debug] [MainThread]: Command end result
[0m15:54:13.689224 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:54:13.702779 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:54:13.713842 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:54:13.714646 [info ] [MainThread]: 
[0m15:54:13.715694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:13.716654 [info ] [MainThread]: 
[0m15:54:13.717687 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:54:13.722001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.284797, "process_in_blocks": "0", "process_kernel_time": 1.752992, "process_mem_max_rss": "378652", "process_out_blocks": "0", "process_user_time": 4.106747}
[0m15:54:13.724280 [debug] [MainThread]: Command `dbt run` succeeded at 15:54:13.724120 after 12.29 seconds
[0m15:54:13.725558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ced6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d64f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d64ea20>]}
[0m15:54:13.726427 [debug] [MainThread]: Flushing usage events
[0m15:54:14.184329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:36.232290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8147c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8144e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8290d8b0>]}


============================== 15:56:36.236746 | 1a56ce09-3e75-4193-b1e2-ac5f1186c6b0 ==============================
[0m15:56:36.236746 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:56:36.237704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/france_air_pollution', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/france_air_pollution/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:38.233139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a09dc0>]}
[0m15:56:38.264553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f8e480>]}
[0m15:56:38.265611 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:56:38.444512 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:56:38.520660 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:56:38.521799 [debug] [MainThread]: previous checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, current checksum: 40b6193cafdb5a34789a2b6835d6fff85a96c316c4111bbba605a0642b6e79ba
[0m15:56:38.522605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814a1250>]}
[0m15:56:39.591236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b50f80>]}
[0m15:56:39.720759 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:56:39.724001 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:56:39.754608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b6b080>]}
[0m15:56:39.755536 [info ] [MainThread]: Found 5 models, 1 snapshot, 77 data tests, 2 sources, 496 macros
[0m15:56:39.756397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6688f980>]}
[0m15:56:39.760060 [info ] [MainThread]: 
[0m15:56:39.760786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:39.763230 [info ] [MainThread]: 
[0m15:56:39.764259 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:56:39.767806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_paris-air-pollution-quangnc_development'
[0m15:56:39.768632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:40.093441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a56ce09-3e75-4193-b1e2-ac5f1186c6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff679daab0>]}
[0m15:56:40.094822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:40.107888 [debug] [Thread-1 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m15:56:40.109498 [info ] [Thread-1 (]: 1 of 77 START test accepted_values_agg_pollution_by_day_count_days__False__1 ... [RUN]
[0m15:56:40.109003 [debug] [Thread-3 (]: Began running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m15:56:40.112880 [info ] [Thread-3 (]: 3 of 77 START test accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m15:56:40.108365 [debug] [Thread-2 (]: Began running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m15:56:40.115611 [info ] [Thread-2 (]: 2 of 77 START test accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [RUN]
[0m15:56:40.109904 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m15:56:40.114797 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6'
[0m15:56:40.111811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_paris-air-pollution-quangnc_development, now test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac)
[0m15:56:40.116926 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3'
[0m15:56:40.124404 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m15:56:40.122687 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m15:56:40.123605 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m15:56:40.121546 [info ] [Thread-4 (]: 4 of 77 START test not_null_agg_pollution_by_day_avg_CO ........................ [RUN]
[0m15:56:40.132781 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m15:56:40.136739 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m15:56:40.140307 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m15:56:40.141443 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3'
[0m15:56:40.144824 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m15:56:40.151505 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m15:56:40.152063 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m15:56:40.153158 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m15:56:40.158862 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m15:56:40.168970 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"
[0m15:56:40.171163 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"
[0m15:56:40.171552 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m15:56:40.173275 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"
[0m15:56:40.177379 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"
[0m15:56:40.179392 [debug] [Thread-2 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m15:56:40.179869 [debug] [Thread-1 (]: On test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        count_days as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    group by count_days

)

select *
from all_values
where value_field not in (
    1
)



  
  
      
    ) dbt_internal_test
[0m15:56:40.181065 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:56:40.182730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:40.183828 [debug] [Thread-3 (]: On test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        pollution_quality as value_field,
        count(*) as n_records

    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    group by pollution_quality

)

select *
from all_values
where value_field not in (
    'Very_Poor','Poor','Moderate','Fair','Good'
)



  
  
      
    ) dbt_internal_test
[0m15:56:40.184200 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_CO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_CO is null



  
  
      
    ) dbt_internal_test
[0m15:56:40.252755 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:56:40.254259 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:56:40.867838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ecda8dc1-f329-4080-9355-13005225b2f9&page=queryresults
[0m15:56:41.213447 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:544b0944-dfee-4933-8b80-c78712ceea3b&page=queryresults
[0m15:56:41.352839 [info ] [Thread-4 (]: 4 of 77 PASS not_null_agg_pollution_by_day_avg_CO .............................. [[32mPASS[0m in 1.21s]
[0m15:56:41.356509 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3
[0m15:56:41.357810 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m15:56:41.359428 [info ] [Thread-4 (]: 5 of 77 START test not_null_agg_pollution_by_day_avg_NH3 ....................... [RUN]
[0m15:56:41.362267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_CO.a05b5067c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885)
[0m15:56:41.363894 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m15:56:41.369296 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m15:56:41.375835 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m15:56:41.381673 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"
[0m15:56:41.387345 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NH3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NH3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:41.389129 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:41.620134 [info ] [Thread-2 (]: 2 of 77 PASS accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.50s]
[0m15:56:41.621874 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3
[0m15:56:41.623190 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m15:56:41.624138 [info ] [Thread-2 (]: 6 of 77 START test not_null_agg_pollution_by_day_avg_NO ........................ [RUN]
[0m15:56:41.625499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.c98d4d34c3, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9)
[0m15:56:41.626331 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m15:56:41.631001 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m15:56:41.633793 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m15:56:41.636387 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"
[0m15:56:41.638960 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO is null



  
  
      
    ) dbt_internal_test
[0m15:56:41.640139 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:41.684804 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c47d6e33-72b1-4cf0-9b3e-f92fca67b808&page=queryresults
[0m15:56:41.715905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dcd191cf-64f4-4b4a-8f54-4b412275351b&page=queryresults
[0m15:56:41.891252 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:677ea16e-cb05-4880-b069-b13f1641825c&page=queryresults
[0m15:56:41.998550 [info ] [Thread-3 (]: 3 of 77 PASS accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good  [[32mPASS[0m in 1.88s]
[0m15:56:41.999930 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6
[0m15:56:42.001056 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m15:56:42.002000 [info ] [Thread-3 (]: 7 of 77 START test not_null_agg_pollution_by_day_avg_NO2 ....................... [RUN]
[0m15:56:42.003162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_staging_air_pollution_pollution_quality__Very_Poor__Poor__Moderate__Fair__Good.a8fcb1dab6, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401)
[0m15:56:42.004126 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m15:56:42.008616 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m15:56:42.012052 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m15:56:42.014805 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"
[0m15:56:42.017746 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_NO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_NO2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.019206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:42.063221 [info ] [Thread-1 (]: 1 of 77 PASS accepted_values_agg_pollution_by_day_count_days__False__1 ......... [[32mPASS[0m in 1.95s]
[0m15:56:42.064497 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac
[0m15:56:42.065906 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m15:56:42.066781 [info ] [Thread-1 (]: 8 of 77 START test not_null_agg_pollution_by_day_avg_O3 ........................ [RUN]
[0m15:56:42.067983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.accepted_values_agg_pollution_by_day_count_days__False__1.5ca2a8d9ac, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8)
[0m15:56:42.068880 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m15:56:42.073410 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m15:56:42.076318 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m15:56:42.079159 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"
[0m15:56:42.081836 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_O3
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_O3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.082664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:42.264845 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5ea548ba-4ded-4377-983b-42f47dd6395a&page=queryresults
[0m15:56:42.266484 [info ] [Thread-4 (]: 5 of 77 PASS not_null_agg_pollution_by_day_avg_NH3 ............................. [[32mPASS[0m in 0.90s]
[0m15:56:42.268102 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885
[0m15:56:42.268799 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m15:56:42.269537 [info ] [Thread-4 (]: 9 of 77 START test not_null_agg_pollution_by_day_avg_PM10 ...................... [RUN]
[0m15:56:42.270247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NH3.3e74fcb885, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08)
[0m15:56:42.270917 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m15:56:42.274513 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m15:56:42.276935 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m15:56:42.280576 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"
[0m15:56:42.284354 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM10
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM10 is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.285162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:42.563079 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fffda378-d4e0-404f-b6e4-68e30ed5ecfe&page=queryresults
[0m15:56:42.595921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:30d4f6bb-989e-497d-8ab1-a5a9165cc5fa&page=queryresults
[0m15:56:42.644500 [info ] [Thread-2 (]: 6 of 77 PASS not_null_agg_pollution_by_day_avg_NO .............................. [[32mPASS[0m in 1.02s]
[0m15:56:42.646470 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9
[0m15:56:42.648479 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m15:56:42.649924 [info ] [Thread-2 (]: 10 of 77 START test not_null_agg_pollution_by_day_avg_PM2_5 .................... [RUN]
[0m15:56:42.651149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO.58c87141d9, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb)
[0m15:56:42.652432 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m15:56:42.658481 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m15:56:42.663098 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m15:56:42.666278 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"
[0m15:56:42.669168 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_PM2_5
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_PM2_5 is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.670084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:42.759504 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fbae3bde-7187-488f-8006-5051b1d3e220&page=queryresults
[0m15:56:42.907466 [info ] [Thread-1 (]: 8 of 77 PASS not_null_agg_pollution_by_day_avg_O3 .............................. [[32mPASS[0m in 0.84s]
[0m15:56:42.908797 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8
[0m15:56:42.909990 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m15:56:42.910862 [info ] [Thread-1 (]: 11 of 77 START test not_null_agg_pollution_by_day_avg_SO2 ...................... [RUN]
[0m15:56:42.912254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_O3.b75f758ad8, now test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b)
[0m15:56:42.916778 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m15:56:42.920968 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m15:56:42.923776 [info ] [Thread-3 (]: 7 of 77 PASS not_null_agg_pollution_by_day_avg_NO2 ............................. [[32mPASS[0m in 0.92s]
[0m15:56:42.925238 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401
[0m15:56:42.926291 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m15:56:42.926685 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m15:56:42.930490 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"
[0m15:56:42.932263 [info ] [Thread-3 (]: 12 of 77 START test not_null_agg_pollution_by_day_city ......................... [RUN]
[0m15:56:42.936022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_NO2.a8224ae401, now test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d)
[0m15:56:42.936890 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m15:56:42.943645 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m15:56:42.944352 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_SO2
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where avg_SO2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.947210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:42.949079 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m15:56:42.951838 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"
[0m15:56:42.990046 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where city is null



  
  
      
    ) dbt_internal_test
[0m15:56:42.991141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:43.084904 [info ] [Thread-4 (]: 9 of 77 PASS not_null_agg_pollution_by_day_avg_PM10 ............................ [[32mPASS[0m in 0.81s]
[0m15:56:43.086017 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08
[0m15:56:43.086799 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m15:56:43.087528 [info ] [Thread-4 (]: 13 of 77 START test not_null_agg_pollution_by_day_count_days ................... [RUN]
[0m15:56:43.088533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM10.8f18692b08, now test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9)
[0m15:56:43.089742 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m15:56:43.092972 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m15:56:43.095922 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m15:56:43.098463 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"
[0m15:56:43.102281 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select count_days
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where count_days is null



  
  
      
    ) dbt_internal_test
[0m15:56:43.102995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:43.208993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5d75ae5d-7e57-4a3f-b82b-220bdcd07f1a&page=queryresults
[0m15:56:43.531185 [info ] [Thread-2 (]: 10 of 77 PASS not_null_agg_pollution_by_day_avg_PM2_5 .......................... [[32mPASS[0m in 0.88s]
[0m15:56:43.534414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:09c5d8b4-b253-4617-a26f-148938b25ed3&page=queryresults
[0m15:56:43.535547 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb
[0m15:56:43.542306 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m15:56:43.544391 [info ] [Thread-2 (]: 14 of 77 START test not_null_agg_pollution_by_day_region ....................... [RUN]
[0m15:56:43.546156 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8b7a54d9-3c26-4191-bcc5-4dc3cdb9af13&page=queryresults
[0m15:56:43.547746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_PM2_5.f9ec1045cb, now test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315)
[0m15:56:43.551826 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m15:56:43.559949 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"
[0m15:56:43.564753 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m15:56:43.568299 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"
[0m15:56:43.572865 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
where region is null



  
  
      
    ) dbt_internal_test
[0m15:56:43.574270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:43.660030 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b87e5a41-a8c9-4e28-9f43-42b69a97854f&page=queryresults
[0m15:56:43.852334 [info ] [Thread-1 (]: 11 of 77 PASS not_null_agg_pollution_by_day_avg_SO2 ............................ [[32mPASS[0m in 0.94s]
[0m15:56:43.853636 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b
[0m15:56:43.854522 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135
[0m15:56:43.855355 [info ] [Thread-1 (]: 15 of 77 START test not_null_dim_cities_city ................................... [RUN]
[0m15:56:43.856304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_avg_SO2.b10a4ef95b, now test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135)
[0m15:56:43.858302 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135
[0m15:56:43.862507 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135"
[0m15:56:43.863270 [info ] [Thread-3 (]: 12 of 77 PASS not_null_agg_pollution_by_day_city ............................... [[32mPASS[0m in 0.93s]
[0m15:56:43.864427 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d
[0m15:56:43.868230 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8
[0m15:56:43.869207 [info ] [Thread-3 (]: 16 of 77 START test not_null_dim_cities_city_id ................................ [RUN]
[0m15:56:43.869742 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135
[0m15:56:43.870163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_city.65934caf6d, now test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8)
[0m15:56:43.873707 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135"
[0m15:56:43.874856 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8
[0m15:56:43.879664 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8"
[0m15:56:43.880708 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`dim_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m15:56:43.881462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:43.916469 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8
[0m15:56:43.918959 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8"
[0m15:56:43.922593 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`dim_cities`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m15:56:43.923592 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:43.961413 [info ] [Thread-4 (]: 13 of 77 PASS not_null_agg_pollution_by_day_count_days ......................... [[32mPASS[0m in 0.87s]
[0m15:56:43.962399 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9
[0m15:56:43.963205 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8
[0m15:56:43.963889 [info ] [Thread-4 (]: 17 of 77 START test not_null_dim_cities_latitude ............................... [RUN]
[0m15:56:43.964685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_count_days.0c1c94aec9, now test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8)
[0m15:56:43.965430 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8
[0m15:56:43.969096 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8"
[0m15:56:43.973104 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8
[0m15:56:43.976513 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8"
[0m15:56:43.980000 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`dim_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:43.980881 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:44.026214 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c4832518-0591-44fe-9ce2-747e04185ed8&page=queryresults
[0m15:56:44.343407 [info ] [Thread-2 (]: 14 of 77 PASS not_null_agg_pollution_by_day_region ............................. [[32mPASS[0m in 0.80s]
[0m15:56:44.344701 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315
[0m15:56:44.345554 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe
[0m15:56:44.346374 [info ] [Thread-2 (]: 18 of 77 START test not_null_dim_cities_longitude .............................. [RUN]
[0m15:56:44.347340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_agg_pollution_by_day_region.b209ca0315, now test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe)
[0m15:56:44.348185 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe
[0m15:56:44.353303 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe"
[0m15:56:44.357810 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe
[0m15:56:44.360311 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe"
[0m15:56:44.361543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e88aaa90-9962-4d2f-98ac-f361f4e0ae34&page=queryresults
[0m15:56:44.366807 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`dim_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:44.368960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:44.416798 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:5436db7d-fd02-4aa9-aeb7-02a50746d240&page=queryresults
[0m15:56:44.426580 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:36b6e11f-1cf7-4ed9-910f-01fa983fc8e9&page=queryresults
[0m15:56:44.681894 [info ] [Thread-1 (]: 15 of 77 PASS not_null_dim_cities_city ......................................... [[32mPASS[0m in 0.82s]
[0m15:56:44.684792 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135
[0m15:56:44.686301 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_dim_cities_region.e2e1addd85
[0m15:56:44.688224 [info ] [Thread-1 (]: 19 of 77 START test not_null_dim_cities_region ................................. [RUN]
[0m15:56:44.689818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_dim_cities_city.2bf4ccd135, now test.france_air_pollution.not_null_dim_cities_region.e2e1addd85)
[0m15:56:44.690778 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_dim_cities_region.e2e1addd85
[0m15:56:44.699053 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_dim_cities_region.e2e1addd85"
[0m15:56:44.703697 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_dim_cities_region.e2e1addd85
[0m15:56:44.706687 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_dim_cities_region.e2e1addd85"
[0m15:56:44.710028 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_dim_cities_region.e2e1addd85: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_dim_cities_region.e2e1addd85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from `paris-air-pollution-quangnc`.`development`.`dim_cities`
where region is null



  
  
      
    ) dbt_internal_test
[0m15:56:44.710861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:44.750759 [info ] [Thread-4 (]: 17 of 77 PASS not_null_dim_cities_latitude ..................................... [[32mPASS[0m in 0.79s]
[0m15:56:44.752544 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8
[0m15:56:44.756361 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8
[0m15:56:44.757674 [info ] [Thread-4 (]: 20 of 77 START test not_null_fact_air_pollution_date ........................... [RUN]
[0m15:56:44.760302 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_dim_cities_latitude.79d0974ff8, now test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8)
[0m15:56:44.760953 [info ] [Thread-3 (]: 16 of 77 PASS not_null_dim_cities_city_id ...................................... [[32mPASS[0m in 0.89s]
[0m15:56:44.761576 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8
[0m15:56:44.762759 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8
[0m15:56:44.767683 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8"
[0m15:56:44.769742 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b
[0m15:56:44.771607 [info ] [Thread-3 (]: 21 of 77 START test not_null_staging_air_pollution_carbon_monoxide_co .......... [RUN]
[0m15:56:44.772879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_dim_cities_city_id.805f7885d8, now test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b)
[0m15:56:44.773888 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b
[0m15:56:44.777743 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b"
[0m15:56:44.778209 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8
[0m15:56:44.781132 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8"
[0m15:56:44.784814 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
where date is null



  
  
      
    ) dbt_internal_test
[0m15:56:44.786136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:44.785300 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b
[0m15:56:44.790630 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b"
[0m15:56:44.827413 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m15:56:44.828224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:44.939545 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8a5331d2-7d3b-4b59-ab31-59899c60e074&page=queryresults
[0m15:56:45.211504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:47e2152c-43ef-4d02-9818-23b3dc26f5f4&page=queryresults
[0m15:56:45.278985 [info ] [Thread-2 (]: 18 of 77 PASS not_null_dim_cities_longitude .................................... [[32mPASS[0m in 0.93s]
[0m15:56:45.292047 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe
[0m15:56:45.302859 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m15:56:45.308617 [info ] [Thread-2 (]: 22 of 77 START test not_null_staging_air_pollution_city_id ..................... [RUN]
[0m15:56:45.313008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_dim_cities_longitude.3cdb71dfbe, now test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e)
[0m15:56:45.314342 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m15:56:45.321307 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m15:56:45.325069 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m15:56:45.327249 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"
[0m15:56:45.331443 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m15:56:45.332231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:45.378464 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e99b29ee-21d3-44bd-815e-fa2f161fc7a0&page=queryresults
[0m15:56:45.410592 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e07a3c61-e782-4e7d-9c19-0a2c391cf886&page=queryresults
[0m15:56:45.542035 [info ] [Thread-1 (]: 19 of 77 PASS not_null_dim_cities_region ....................................... [[32mPASS[0m in 0.85s]
[0m15:56:45.543546 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_dim_cities_region.e2e1addd85
[0m15:56:45.544408 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc
[0m15:56:45.545528 [info ] [Thread-1 (]: 23 of 77 START test not_null_staging_air_pollution_nh3 ......................... [RUN]
[0m15:56:45.546467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_dim_cities_region.e2e1addd85, now test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc)
[0m15:56:45.547999 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc
[0m15:56:45.555941 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc"
[0m15:56:45.562074 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc
[0m15:56:45.564759 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc"
[0m15:56:45.570782 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:45.573857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:45.715598 [info ] [Thread-4 (]: 20 of 77 PASS not_null_fact_air_pollution_date ................................. [[32mPASS[0m in 0.96s]
[0m15:56:45.717689 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8
[0m15:56:45.721333 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830
[0m15:56:45.720757 [info ] [Thread-3 (]: 21 of 77 PASS not_null_staging_air_pollution_carbon_monoxide_co ................ [[32mPASS[0m in 0.95s]
[0m15:56:45.724282 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b
[0m15:56:45.725275 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271
[0m15:56:45.722483 [info ] [Thread-4 (]: 24 of 77 START test not_null_staging_air_pollution_nitric_oxide_no ............. [RUN]
[0m15:56:45.730526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_fact_air_pollution_date.f6081a3df8, now test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830)
[0m15:56:45.726347 [info ] [Thread-3 (]: 25 of 77 START test not_null_staging_air_pollution_nitrogen_dioxide_no2 ........ [RUN]
[0m15:56:45.734423 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830
[0m15:56:45.736242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_carbon_monoxide_co.cfcb4ee66b, now test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271)
[0m15:56:45.745149 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271
[0m15:56:45.743942 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830"
[0m15:56:45.748863 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271"
[0m15:56:45.753934 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830
[0m15:56:45.758290 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830"
[0m15:56:45.759641 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271
[0m15:56:45.762025 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271"
[0m15:56:45.764879 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m15:56:45.765682 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:45.768264 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:45.800291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:45.845487 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:74667135-e46d-473f-9294-61ba18f1ad06&page=queryresults
[0m15:56:46.053303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4488f056-453e-4749-9bbd-b2a99d4c4bd5&page=queryresults
[0m15:56:46.160001 [info ] [Thread-2 (]: 22 of 77 PASS not_null_staging_air_pollution_city_id ........................... [[32mPASS[0m in 0.85s]
[0m15:56:46.161513 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e
[0m15:56:46.162595 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe
[0m15:56:46.163435 [info ] [Thread-2 (]: 26 of 77 START test not_null_staging_air_pollution_ozone_o3 .................... [RUN]
[0m15:56:46.164535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_city_id.eee2a4807e, now test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe)
[0m15:56:46.165373 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe
[0m15:56:46.170994 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe"
[0m15:56:46.174882 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe
[0m15:56:46.177387 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe"
[0m15:56:46.180467 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:46.181281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:46.265320 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2cda1654-f37f-4a4c-a129-b6a94146c868&page=queryresults
[0m15:56:46.322551 [info ] [Thread-1 (]: 23 of 77 PASS not_null_staging_air_pollution_nh3 ............................... [[32mPASS[0m in 0.78s]
[0m15:56:46.323280 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:43ff56b5-4508-427d-8c54-1c5374906128&page=queryresults
[0m15:56:46.323667 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc
[0m15:56:46.327046 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99
[0m15:56:46.329380 [info ] [Thread-1 (]: 27 of 77 START test not_null_staging_air_pollution_pm10 ........................ [RUN]
[0m15:56:46.331750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_nh3.2e4b20e8fc, now test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99)
[0m15:56:46.333870 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99
[0m15:56:46.346974 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99"
[0m15:56:46.353763 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99
[0m15:56:46.358163 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99"
[0m15:56:46.362466 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m15:56:46.363147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:46.701656 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d382dd6-59f7-45aa-afb3-595284f7d970&page=queryresults
[0m15:56:46.750315 [info ] [Thread-3 (]: 25 of 77 PASS not_null_staging_air_pollution_nitrogen_dioxide_no2 .............. [[32mPASS[0m in 1.01s]
[0m15:56:46.752642 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271
[0m15:56:46.754270 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177
[0m15:56:46.756371 [info ] [Thread-3 (]: 28 of 77 START test not_null_staging_air_pollution_pm2_5 ....................... [RUN]
[0m15:56:46.755853 [info ] [Thread-4 (]: 24 of 77 PASS not_null_staging_air_pollution_nitric_oxide_no ................... [[32mPASS[0m in 1.03s]
[0m15:56:46.760273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_nitrogen_dioxide_no2.5f3b056271, now test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177)
[0m15:56:46.761611 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830
[0m15:56:46.762895 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177
[0m15:56:46.764788 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae
[0m15:56:46.772476 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177"
[0m15:56:46.773381 [info ] [Thread-4 (]: 29 of 77 START test not_null_staging_air_pollution_sulfur_dioxide_so2 .......... [RUN]
[0m15:56:46.777197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_nitric_oxide_no.57b459f830, now test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae)
[0m15:56:46.778646 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae
[0m15:56:46.783671 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae"
[0m15:56:46.786066 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177
[0m15:56:46.796816 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177"
[0m15:56:46.799292 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae
[0m15:56:46.807295 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae"
[0m15:56:46.809555 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m15:56:46.811233 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:46.813995 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:46.815961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:46.976184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:4a595114-cde2-4783-891c-fa8fd6f445b6&page=queryresults
[0m15:56:47.023331 [info ] [Thread-2 (]: 26 of 77 PASS not_null_staging_air_pollution_ozone_o3 .......................... [[32mPASS[0m in 0.86s]
[0m15:56:47.024907 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe
[0m15:56:47.025778 [debug] [Thread-2 (]: Began running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m15:56:47.026737 [info ] [Thread-2 (]: 30 of 77 START test not_null_staging_cities_city ............................... [RUN]
[0m15:56:47.027690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_ozone_o3.24c95872fe, now test.france_air_pollution.not_null_staging_cities_city.37b5133f95)
[0m15:56:47.028528 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m15:56:47.033425 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m15:56:47.038504 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m15:56:47.041244 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"
[0m15:56:47.044048 [debug] [Thread-2 (]: On test.france_air_pollution.not_null_staging_cities_city.37b5133f95: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city.37b5133f95"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m15:56:47.044748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:47.286873 [info ] [Thread-1 (]: 27 of 77 PASS not_null_staging_air_pollution_pm10 .............................. [[32mPASS[0m in 0.96s]
[0m15:56:47.288658 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99
[0m15:56:47.289808 [debug] [Thread-1 (]: Began running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m15:56:47.290702 [info ] [Thread-1 (]: 31 of 77 START test not_null_staging_cities_city_id ............................ [RUN]
[0m15:56:47.291599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_pm10.01d722dc99, now test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde)
[0m15:56:47.292524 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m15:56:47.297678 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m15:56:47.301179 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m15:56:47.303524 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"
[0m15:56:47.306134 [debug] [Thread-1 (]: On test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_id
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where city_id is null



  
  
      
    ) dbt_internal_test
[0m15:56:47.306885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:47.413817 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:13971d20-785f-4622-8b3c-5177652948aa&page=queryresults
[0m15:56:47.420095 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b32b0172-2ef9-4fe4-ae81-44d44c0b9852&page=queryresults
[0m15:56:47.745241 [info ] [Thread-3 (]: 28 of 77 PASS not_null_staging_air_pollution_pm2_5 ............................. [[32mPASS[0m in 0.98s]
[0m15:56:47.747649 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177
[0m15:56:47.749576 [debug] [Thread-3 (]: Began running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m15:56:47.751059 [info ] [Thread-3 (]: 32 of 77 START test not_null_staging_cities_latitude ........................... [RUN]
[0m15:56:47.752820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_pm2_5.c00d1a2177, now test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16)
[0m15:56:47.754241 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m15:56:47.761379 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m15:56:47.766195 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m15:56:47.768918 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"
[0m15:56:47.771773 [debug] [Thread-3 (]: On test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:47.773034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:47.808916 [info ] [Thread-4 (]: 29 of 77 PASS not_null_staging_air_pollution_sulfur_dioxide_so2 ................ [[32mPASS[0m in 1.03s]
[0m15:56:47.810061 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae
[0m15:56:47.810837 [debug] [Thread-4 (]: Began running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m15:56:47.811788 [info ] [Thread-4 (]: 33 of 77 START test not_null_staging_cities_longitude .......................... [RUN]
[0m15:56:47.813213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_air_pollution_sulfur_dioxide_so2.de73a094ae, now test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74)
[0m15:56:47.814105 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m15:56:47.817587 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m15:56:47.821225 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m15:56:47.824142 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"
[0m15:56:47.826599 [debug] [Thread-4 (]: On test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`development`.`staging_cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:47.827459 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:47.864486 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:205557c2-f6d2-4bc5-9fc3-b7e958586b87&page=queryresults
[0m15:56:48.082391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8960784d-9180-4653-835d-6eaf8cf7aadf&page=queryresults
[0m15:56:48.158452 [info ] [Thread-2 (]: 30 of 77 PASS not_null_staging_cities_city ..................................... [[32mPASS[0m in 1.13s]
[0m15:56:48.159874 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city.37b5133f95
[0m15:56:48.161017 [debug] [Thread-2 (]: Began running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88
[0m15:56:48.162020 [info ] [Thread-2 (]: 34 of 77 START test relationships_staging_air_pollution_city_id__city_index__source_raw_cities_  [RUN]
[0m15:56:48.163232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city.37b5133f95, now test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88)
[0m15:56:48.164517 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88
[0m15:56:48.170743 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88"
[0m15:56:48.174609 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88
[0m15:56:48.177127 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88"
[0m15:56:48.179759 [debug] [Thread-2 (]: On test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select city_id as from_field
    from `paris-air-pollution-quangnc`.`development`.`staging_air_pollution`
    where city_id is not null
),

parent as (
    select city_index as to_field
    from `paris-air-pollution-quangnc`.`raw`.`cities`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:56:48.180394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:48.408707 [info ] [Thread-1 (]: 31 of 77 PASS not_null_staging_cities_city_id .................................. [[32mPASS[0m in 1.12s]
[0m15:56:48.410401 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde
[0m15:56:48.411446 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3
[0m15:56:48.412479 [info ] [Thread-1 (]: 35 of 77 START test source_not_null_raw_airpollution_carbon_monoxide_co ........ [RUN]
[0m15:56:48.414118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_city_id.2fc6828fde, now test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3)
[0m15:56:48.415815 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3
[0m15:56:48.421443 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3"
[0m15:56:48.425417 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3
[0m15:56:48.427890 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3"
[0m15:56:48.431054 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select carbon_monoxide_co
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where carbon_monoxide_co is null



  
  
      
    ) dbt_internal_test
[0m15:56:48.431900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:48.519827 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:9f089d6c-fc2c-4bd8-b5c3-327230fc82a5&page=queryresults
[0m15:56:48.606502 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3aafbd67-75da-4003-a527-c747a50310ab&page=queryresults
[0m15:56:48.795664 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d7b26b18-8bf7-4480-b3f7-7a1a92e26283&page=queryresults
[0m15:56:48.848477 [info ] [Thread-3 (]: 32 of 77 PASS not_null_staging_cities_latitude ................................. [[32mPASS[0m in 1.10s]
[0m15:56:48.850195 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16
[0m15:56:48.851155 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230
[0m15:56:48.852184 [info ] [Thread-3 (]: 36 of 77 START test source_not_null_raw_airpollution_city_index ................ [RUN]
[0m15:56:48.853419 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_latitude.1bce70ab16, now test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230)
[0m15:56:48.854307 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230
[0m15:56:48.859027 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230"
[0m15:56:48.863463 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230
[0m15:56:48.867018 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230"
[0m15:56:48.870025 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m15:56:48.870798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:48.926532 [info ] [Thread-4 (]: 33 of 77 PASS not_null_staging_cities_longitude ................................ [[32mPASS[0m in 1.11s]
[0m15:56:48.928529 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74
[0m15:56:48.929824 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b
[0m15:56:48.930503 [info ] [Thread-4 (]: 37 of 77 START test source_not_null_raw_airpollution_nh3 ....................... [RUN]
[0m15:56:48.932081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.not_null_staging_cities_longitude.a56b7f2f74, now test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b)
[0m15:56:48.933481 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b
[0m15:56:48.939796 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b"
[0m15:56:48.946503 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b
[0m15:56:48.951102 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b"
[0m15:56:48.957449 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nh3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nh3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:48.958879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:48.997080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:25b1e94d-fd27-45ba-bd50-4517880b542f&page=queryresults
[0m15:56:49.102988 [info ] [Thread-2 (]: 34 of 77 PASS relationships_staging_air_pollution_city_id__city_index__source_raw_cities_  [[32mPASS[0m in 0.94s]
[0m15:56:49.104524 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88
[0m15:56:49.105472 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25
[0m15:56:49.106218 [info ] [Thread-2 (]: 38 of 77 START test source_not_null_raw_airpollution_nitric_oxide_no ........... [RUN]
[0m15:56:49.107098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.relationships_staging_air_pollution_city_id__city_index__source_raw_cities_.2342e4ed88, now test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25)
[0m15:56:49.108294 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25
[0m15:56:49.112196 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25"
[0m15:56:49.116808 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25
[0m15:56:49.119125 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25"
[0m15:56:49.122778 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitric_oxide_no
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitric_oxide_no is null



  
  
      
    ) dbt_internal_test
[0m15:56:49.123846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:49.300840 [info ] [Thread-1 (]: 35 of 77 PASS source_not_null_raw_airpollution_carbon_monoxide_co .............. [[32mPASS[0m in 0.89s]
[0m15:56:49.302633 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3
[0m15:56:49.303582 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4
[0m15:56:49.304545 [info ] [Thread-1 (]: 39 of 77 START test source_not_null_raw_airpollution_nitrogen_dioxide_no2 ...... [RUN]
[0m15:56:49.305388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_carbon_monoxide_co.3f44c569e3, now test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4)
[0m15:56:49.306140 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4
[0m15:56:49.311415 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4"
[0m15:56:49.315225 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4
[0m15:56:49.317582 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4"
[0m15:56:49.320685 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nitrogen_dioxide_no2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where nitrogen_dioxide_no2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:49.322167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:49.367065 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:1de105d3-6bd0-4e2f-8b61-e41cbf3535c6&page=queryresults
[0m15:56:49.536487 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:900a6c0d-f491-4377-87a6-fbbd66a1d109&page=queryresults
[0m15:56:49.572311 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ba4ffb63-d9d4-4158-88fd-9224e7f8b942&page=queryresults
[0m15:56:49.737184 [info ] [Thread-3 (]: 36 of 77 PASS source_not_null_raw_airpollution_city_index ...................... [[32mPASS[0m in 0.88s]
[0m15:56:49.739667 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230
[0m15:56:49.740645 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925
[0m15:56:49.741799 [info ] [Thread-3 (]: 40 of 77 START test source_not_null_raw_airpollution_ozone_o3 .................. [RUN]
[0m15:56:49.743435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_city_index.63e30e0230, now test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925)
[0m15:56:49.745390 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925
[0m15:56:49.753600 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925"
[0m15:56:49.757392 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925
[0m15:56:49.759669 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925"
[0m15:56:49.762786 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ozone_o3
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where ozone_o3 is null



  
  
      
    ) dbt_internal_test
[0m15:56:49.763625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:49.884157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:0c457f3f-9ae8-44f2-82c3-01877f873e36&page=queryresults
[0m15:56:49.906511 [info ] [Thread-2 (]: 38 of 77 PASS source_not_null_raw_airpollution_nitric_oxide_no ................. [[32mPASS[0m in 0.80s]
[0m15:56:49.907377 [info ] [Thread-4 (]: 37 of 77 PASS source_not_null_raw_airpollution_nh3 ............................. [[32mPASS[0m in 0.98s]
[0m15:56:49.907972 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25
[0m15:56:49.910009 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b
[0m15:56:49.914826 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435
[0m15:56:49.917022 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf
[0m15:56:49.918996 [info ] [Thread-2 (]: 41 of 77 START test source_not_null_raw_airpollution_pm10 ...................... [RUN]
[0m15:56:49.920858 [info ] [Thread-4 (]: 42 of 77 START test source_not_null_raw_airpollution_pm2_5 ..................... [RUN]
[0m15:56:49.923384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_nitric_oxide_no.526a915d25, now test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435)
[0m15:56:49.924375 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_nh3.e42e231e2b, now test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf)
[0m15:56:49.926305 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435
[0m15:56:49.927483 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf
[0m15:56:49.934603 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435"
[0m15:56:49.942052 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf"
[0m15:56:49.949545 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435
[0m15:56:49.953810 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435"
[0m15:56:49.955187 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf
[0m15:56:49.957401 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf"
[0m15:56:49.958452 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm10
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm10 is null



  
  
      
    ) dbt_internal_test
[0m15:56:49.959297 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:49.993678 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pm2_5
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where pm2_5 is null



  
  
      
    ) dbt_internal_test
[0m15:56:49.995268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:50.217234 [info ] [Thread-1 (]: 39 of 77 PASS source_not_null_raw_airpollution_nitrogen_dioxide_no2 ............ [[32mPASS[0m in 0.91s]
[0m15:56:50.218649 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4
[0m15:56:50.219533 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610
[0m15:56:50.220322 [info ] [Thread-1 (]: 43 of 77 START test source_not_null_raw_airpollution_sulfur_dioxide_so2 ........ [RUN]
[0m15:56:50.221301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_nitrogen_dioxide_no2.54acd53cb4, now test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610)
[0m15:56:50.222114 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610
[0m15:56:50.227047 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610"
[0m15:56:50.231294 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610
[0m15:56:50.233795 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610"
[0m15:56:50.236798 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sulfur_dioxide_so2
from `paris-air-pollution-quangnc`.`raw`.`airpollution`
where sulfur_dioxide_so2 is null



  
  
      
    ) dbt_internal_test
[0m15:56:50.237637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:50.271635 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:07554511-c653-4fe4-a427-48b4bad927b0&page=queryresults
[0m15:56:50.429492 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dfef9f8a-087b-4be7-9ee3-94d8340b4944&page=queryresults
[0m15:56:50.464267 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:14159192-ac8e-4a4e-a4e6-91d92179ab7e&page=queryresults
[0m15:56:50.581201 [info ] [Thread-3 (]: 40 of 77 PASS source_not_null_raw_airpollution_ozone_o3 ........................ [[32mPASS[0m in 0.84s]
[0m15:56:50.582466 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925
[0m15:56:50.583203 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53
[0m15:56:50.583971 [info ] [Thread-3 (]: 44 of 77 START test source_not_null_raw_cities_city ............................ [RUN]
[0m15:56:50.584854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_ozone_o3.5492505925, now test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53)
[0m15:56:50.585664 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53
[0m15:56:50.589520 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53"
[0m15:56:50.592514 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53
[0m15:56:50.594969 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53"
[0m15:56:50.598256 [debug] [Thread-3 (]: On test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city is null



  
  
      
    ) dbt_internal_test
[0m15:56:50.599319 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:50.718720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:639e1640-1a0c-494d-9858-ed73dc76251b&page=queryresults
[0m15:56:50.766200 [info ] [Thread-2 (]: 41 of 77 PASS source_not_null_raw_airpollution_pm10 ............................ [[32mPASS[0m in 0.84s]
[0m15:56:50.768866 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435
[0m15:56:50.770256 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78
[0m15:56:50.772264 [info ] [Thread-2 (]: 45 of 77 START test source_not_null_raw_cities_city_index ...................... [RUN]
[0m15:56:50.773576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_pm10.195fc96435, now test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78)
[0m15:56:50.775221 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78
[0m15:56:50.779875 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78"
[0m15:56:50.785290 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78
[0m15:56:50.788649 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78"
[0m15:56:50.792221 [debug] [Thread-2 (]: On test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select city_index
from `paris-air-pollution-quangnc`.`raw`.`cities`
where city_index is null



  
  
      
    ) dbt_internal_test
[0m15:56:50.792951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:50.830022 [info ] [Thread-4 (]: 42 of 77 PASS source_not_null_raw_airpollution_pm2_5 ........................... [[32mPASS[0m in 0.91s]
[0m15:56:50.831254 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf
[0m15:56:50.832559 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec
[0m15:56:50.833357 [info ] [Thread-4 (]: 46 of 77 START test source_not_null_raw_cities_latitude ........................ [RUN]
[0m15:56:50.834281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_pm2_5.06fe508bdf, now test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec)
[0m15:56:50.835024 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec
[0m15:56:50.841467 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec"
[0m15:56:50.845332 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec
[0m15:56:50.847670 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec"
[0m15:56:50.850833 [debug] [Thread-4 (]: On test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where latitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:50.851576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:51.040534 [info ] [Thread-1 (]: 43 of 77 PASS source_not_null_raw_airpollution_sulfur_dioxide_so2 .............. [[32mPASS[0m in 0.82s]
[0m15:56:51.041712 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610
[0m15:56:51.042998 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee
[0m15:56:51.043781 [info ] [Thread-1 (]: 47 of 77 START test source_not_null_raw_cities_longitude ....................... [RUN]
[0m15:56:51.044617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_airpollution_sulfur_dioxide_so2.358ae90610, now test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee)
[0m15:56:51.045262 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee
[0m15:56:51.048608 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee"
[0m15:56:51.051529 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee
[0m15:56:51.054117 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee"
[0m15:56:51.057232 [debug] [Thread-1 (]: On test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select longitude
from `paris-air-pollution-quangnc`.`raw`.`cities`
where longitude is null



  
  
      
    ) dbt_internal_test
[0m15:56:51.058099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:51.199594 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:73d9736c-6240-4406-8b5f-6f0c87d6912e&page=queryresults
[0m15:56:51.300360 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cf385bf5-6651-432b-98c8-f7423261c53c&page=queryresults
[0m15:56:51.309310 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:2ec9a2ee-1dce-44d2-abe9-fa8f401f2e31&page=queryresults
[0m15:56:51.506264 [info ] [Thread-3 (]: 44 of 77 PASS source_not_null_raw_cities_city .................................. [[32mPASS[0m in 0.92s]
[0m15:56:51.507752 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53
[0m15:56:51.508590 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680
[0m15:56:51.509314 [info ] [Thread-3 (]: 48 of 77 START test source_test_is_float_raw_airpollution_carbon_monoxide_co__float64  [RUN]
[0m15:56:51.510211 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_cities_city.8293b3ec53, now test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680)
[0m15:56:51.511543 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680
[0m15:56:51.516154 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680"
[0m15:56:51.521642 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680
[0m15:56:51.524129 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680"
[0m15:56:51.527257 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:51.528090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:51.666999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a4c876a0-a4e7-4511-8698-ceac7059e6db&page=queryresults
[0m15:56:51.764287 [info ] [Thread-4 (]: 46 of 77 PASS source_not_null_raw_cities_latitude .............................. [[32mPASS[0m in 0.93s]
[0m15:56:51.765873 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec
[0m15:56:51.767236 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478
[0m15:56:51.768056 [info ] [Thread-4 (]: 49 of 77 START test source_test_is_float_raw_airpollution_nh3__float64 ......... [RUN]
[0m15:56:51.769310 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_cities_latitude.aa5a4910ec, now test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478)
[0m15:56:51.770053 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478
[0m15:56:51.776051 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478"
[0m15:56:51.777984 [info ] [Thread-2 (]: 45 of 77 PASS source_not_null_raw_cities_city_index ............................ [[32mPASS[0m in 1.00s]
[0m15:56:51.779564 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78
[0m15:56:51.780636 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c
[0m15:56:51.781525 [info ] [Thread-2 (]: 50 of 77 START test source_test_is_float_raw_airpollution_nitric_oxide_no__float64  [RUN]
[0m15:56:51.782676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_cities_city_index.bb54f9fe78, now test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c)
[0m15:56:51.781988 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478
[0m15:56:51.784011 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c
[0m15:56:51.787524 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478"
[0m15:56:51.791591 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c"
[0m15:56:51.796770 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:51.797955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:51.798701 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c
[0m15:56:51.845116 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c"
[0m15:56:51.858189 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:51.859903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:52.004809 [info ] [Thread-1 (]: 47 of 77 PASS source_not_null_raw_cities_longitude ............................. [[32mPASS[0m in 0.96s]
[0m15:56:52.006183 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee
[0m15:56:52.007625 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0
[0m15:56:52.008570 [info ] [Thread-1 (]: 51 of 77 START test source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64  [RUN]
[0m15:56:52.010181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_not_null_raw_cities_longitude.f7596233ee, now test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0)
[0m15:56:52.011540 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0
[0m15:56:52.017806 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0"
[0m15:56:52.023083 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0
[0m15:56:52.025489 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0"
[0m15:56:52.028489 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:52.029513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:52.231614 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c33d8296-4476-44de-bbb4-9cd53b4cf127&page=queryresults
[0m15:56:52.375885 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dcfd6ded-d943-42dc-b76e-60ad0a7bb274&page=queryresults
[0m15:56:52.387106 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6287aad5-e259-40db-9316-4708261c1794&page=queryresults
[0m15:56:52.544236 [info ] [Thread-3 (]: 48 of 77 PASS source_test_is_float_raw_airpollution_carbon_monoxide_co__float64  [[32mPASS[0m in 1.03s]
[0m15:56:52.545600 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680
[0m15:56:52.546458 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b
[0m15:56:52.547254 [info ] [Thread-3 (]: 52 of 77 START test source_test_is_float_raw_airpollution_ozone_o3__float64 .... [RUN]
[0m15:56:52.548746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_carbon_monoxide_co__float64.b2c41e8680, now test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b)
[0m15:56:52.549450 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b
[0m15:56:52.553580 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b"
[0m15:56:52.556853 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b
[0m15:56:52.559157 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b"
[0m15:56:52.562214 [debug] [Thread-3 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:52.563281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:52.688132 [info ] [Thread-2 (]: 50 of 77 PASS source_test_is_float_raw_airpollution_nitric_oxide_no__float64 ... [[32mPASS[0m in 0.91s]
[0m15:56:52.689523 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c
[0m15:56:52.690294 [debug] [Thread-2 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a
[0m15:56:52.691052 [info ] [Thread-2 (]: 53 of 77 START test source_test_is_float_raw_airpollution_pm10__float64 ........ [RUN]
[0m15:56:52.691912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_nitric_oxide_no__float64.e45047606c, now test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a)
[0m15:56:52.692576 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a
[0m15:56:52.695997 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a"
[0m15:56:52.699772 [info ] [Thread-4 (]: 49 of 77 PASS source_test_is_float_raw_airpollution_nh3__float64 ............... [[32mPASS[0m in 0.93s]
[0m15:56:52.701049 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478
[0m15:56:52.701670 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a
[0m15:56:52.702633 [debug] [Thread-4 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b
[0m15:56:52.709944 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a"
[0m15:56:52.711800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b866af93-c426-4a0d-9994-af97daab13b5&page=queryresults
[0m15:56:52.714088 [info ] [Thread-4 (]: 54 of 77 START test source_test_is_float_raw_airpollution_pm2_5__float64 ....... [RUN]
[0m15:56:52.723545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_nh3__float64.d9a753c478, now test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b)
[0m15:56:52.726457 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b
[0m15:56:52.730854 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b"
[0m15:56:52.725958 [debug] [Thread-2 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:52.733917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:52.771036 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b
[0m15:56:52.774265 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b"
[0m15:56:52.778317 [debug] [Thread-4 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:52.779103 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:53.058744 [info ] [Thread-1 (]: 51 of 77 PASS source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 1.05s]
[0m15:56:53.060420 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0
[0m15:56:53.061663 [debug] [Thread-1 (]: Began running node test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3
[0m15:56:53.064479 [info ] [Thread-1 (]: 55 of 77 START test source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64  [RUN]
[0m15:56:53.071277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_nitrogen_dioxide_no2__float64.57b7f17af0, now test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3)
[0m15:56:53.073044 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3
[0m15:56:53.079536 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3"
[0m15:56:53.083524 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3
[0m15:56:53.086157 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3"
[0m15:56:53.089879 [debug] [Thread-1 (]: On test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('airpollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:53.091393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:53.222230 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:45b238a5-15b2-4819-b2c7-a319cdd839a5&page=queryresults
[0m15:56:53.303593 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:07100c6b-c1a1-44a9-a8ae-f5c5a3097885&page=queryresults
[0m15:56:53.314475 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:86366220-db88-4a3a-8e4d-0e5aa7bd8d0d&page=queryresults
[0m15:56:53.535931 [info ] [Thread-3 (]: 52 of 77 PASS source_test_is_float_raw_airpollution_ozone_o3__float64 .......... [[32mPASS[0m in 0.99s]
[0m15:56:53.538122 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b
[0m15:56:53.538949 [debug] [Thread-3 (]: Began running node test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830
[0m15:56:53.539949 [info ] [Thread-3 (]: 56 of 77 START test source_unique_raw_cities_city_index ........................ [RUN]
[0m15:56:53.540989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_ozone_o3__float64.3898ba6b2b, now test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830)
[0m15:56:53.541914 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830
[0m15:56:53.559420 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830"
[0m15:56:53.563418 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830
[0m15:56:53.566200 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830"
[0m15:56:53.570230 [debug] [Thread-3 (]: On test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_index as unique_field
  from `paris-air-pollution-quangnc`.`raw`.`cities`
  where city_index is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:56:53.571949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:53.692129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:590e3168-90cd-4bcb-a3c6-627df03e6b27&page=queryresults
[0m15:56:53.744423 [info ] [Thread-4 (]: 54 of 77 PASS source_test_is_float_raw_airpollution_pm2_5__float64 ............. [[32mPASS[0m in 1.02s]
[0m15:56:53.775415 [info ] [Thread-2 (]: 53 of 77 PASS source_test_is_float_raw_airpollution_pm10__float64 .............. [[32mPASS[0m in 1.08s]
[0m15:56:53.798200 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a
[0m15:56:53.805331 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m15:56:53.788042 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b
[0m15:56:53.808915 [info ] [Thread-2 (]: 57 of 77 START test test_is_float_agg_pollution_by_day_avg_CO__float64 ......... [RUN]
[0m15:56:53.813759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_pm10__float64.69ace7944a, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92)
[0m15:56:53.815687 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m15:56:53.811734 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m15:56:53.823403 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m15:56:53.824910 [info ] [Thread-4 (]: 58 of 77 START test test_is_float_agg_pollution_by_day_avg_NH3__float64 ........ [RUN]
[0m15:56:53.826942 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_pm2_5__float64.c269096c2b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b)
[0m15:56:53.828894 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m15:56:53.834556 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m15:56:53.836224 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m15:56:53.841333 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"
[0m15:56:53.847014 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m15:56:53.850962 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"
[0m15:56:53.852167 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_CO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:53.854370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:53.895195 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NH3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:53.897797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:54.102872 [info ] [Thread-1 (]: 55 of 77 PASS source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64  [[32mPASS[0m in 1.03s]
[0m15:56:54.104290 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3
[0m15:56:54.105553 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m15:56:54.110840 [info ] [Thread-1 (]: 59 of 77 START test test_is_float_agg_pollution_by_day_avg_NO2__float64 ........ [RUN]
[0m15:56:54.120570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_test_is_float_raw_airpollution_sulfur_dioxide_so2__float64.b94aad86d3, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203)
[0m15:56:54.136038 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m15:56:54.183956 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m15:56:54.195037 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m15:56:54.199895 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"
[0m15:56:54.202980 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:54.203889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:54.279360 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:c392f381-5cf1-4a65-8e9e-7cf4e97f6927&page=queryresults
[0m15:56:54.361966 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:a0d78d32-3e52-4f48-a9fb-eac4bc806a36&page=queryresults
[0m15:56:54.410880 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:cc2f0e8b-cc57-4eb8-b8be-80ff44d9cdf7&page=queryresults
[0m15:56:54.586563 [info ] [Thread-3 (]: 56 of 77 PASS source_unique_raw_cities_city_index .............................. [[32mPASS[0m in 1.05s]
[0m15:56:54.587901 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830
[0m15:56:54.588828 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m15:56:54.589742 [info ] [Thread-3 (]: 60 of 77 START test test_is_float_agg_pollution_by_day_avg_NO__float64 ......... [RUN]
[0m15:56:54.590619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.source_unique_raw_cities_city_index.9c2c135830, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf)
[0m15:56:54.591296 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m15:56:54.595348 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m15:56:54.600257 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m15:56:54.602886 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"
[0m15:56:54.605766 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_NO')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:54.606554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:54.677512 [info ] [Thread-2 (]: 57 of 77 PASS test_is_float_agg_pollution_by_day_avg_CO__float64 ............... [[32mPASS[0m in 0.86s]
[0m15:56:54.678799 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92
[0m15:56:54.679510 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m15:56:54.680523 [info ] [Thread-2 (]: 61 of 77 START test test_is_float_agg_pollution_by_day_avg_O3__float64 ......... [RUN]
[0m15:56:54.681801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_CO__float64.d476009a92, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650)
[0m15:56:54.682825 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m15:56:55.257324 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m15:56:55.262453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:7675ef31-2976-4130-86de-6b0b88d78d98&page=queryresults
[0m15:56:55.264626 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m15:56:55.267135 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"
[0m15:56:55.269706 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_O3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:55.270684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:55.378420 [info ] [Thread-4 (]: 58 of 77 PASS test_is_float_agg_pollution_by_day_avg_NH3__float64 .............. [[32mPASS[0m in 1.55s]
[0m15:56:55.380130 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b
[0m15:56:55.380989 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m15:56:55.381845 [info ] [Thread-4 (]: 62 of 77 START test test_is_float_agg_pollution_by_day_avg_PM10__float64 ....... [RUN]
[0m15:56:55.382763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NH3__float64.bfad126f6b, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db)
[0m15:56:55.383553 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m15:56:55.388784 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m15:56:55.393495 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m15:56:55.396322 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"
[0m15:56:55.398972 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:55.399808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:55.656605 [info ] [Thread-1 (]: 59 of 77 PASS test_is_float_agg_pollution_by_day_avg_NO2__float64 .............. [[32mPASS[0m in 1.54s]
[0m15:56:55.658045 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203
[0m15:56:55.658989 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m15:56:55.659903 [info ] [Thread-1 (]: 63 of 77 START test test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ...... [RUN]
[0m15:56:55.662223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO2__float64.63f4021203, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2)
[0m15:56:55.663072 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m15:56:55.667796 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m15:56:55.671959 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m15:56:55.674402 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"
[0m15:56:55.677069 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_PM2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:55.677793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:55.760541 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:fa59bc53-44f9-425f-bf57-845ad66a7484&page=queryresults
[0m15:56:56.119705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:328ad4a8-d2c2-401b-b264-e19551a9559c&page=queryresults
[0m15:56:56.085291 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:ab7e249e-b324-437d-b498-abfdbb78f3d9&page=queryresults
[0m15:56:56.341570 [info ] [Thread-3 (]: 60 of 77 PASS test_is_float_agg_pollution_by_day_avg_NO__float64 ............... [[32mPASS[0m in 1.75s]
[0m15:56:56.343301 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf
[0m15:56:56.344427 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m15:56:56.345843 [info ] [Thread-3 (]: 64 of 77 START test test_is_float_agg_pollution_by_day_avg_SO2__float64 ........ [RUN]
[0m15:56:56.346863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_NO__float64.40afabd0cf, now test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714)
[0m15:56:56.348798 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m15:56:56.363162 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m15:56:56.368062 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m15:56:56.371245 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"
[0m15:56:56.374322 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('agg_pollution_by_day')
        AND column_name = LOWER('avg_SO2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:56.376886 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:56.464129 [info ] [Thread-2 (]: 61 of 77 PASS test_is_float_agg_pollution_by_day_avg_O3__float64 ............... [[32mPASS[0m in 1.78s]
[0m15:56:56.465225 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650
[0m15:56:56.465990 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d
[0m15:56:56.466688 [info ] [Thread-2 (]: 65 of 77 START test test_is_float_staging_air_pollution_carbon_monoxide_co__float64  [RUN]
[0m15:56:56.467474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_O3__float64.82610b1650, now test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d)
[0m15:56:56.468265 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d
[0m15:56:56.472859 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d"
[0m15:56:56.476033 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d
[0m15:56:56.478339 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d"
[0m15:56:56.480037 [info ] [Thread-4 (]: 62 of 77 PASS test_is_float_agg_pollution_by_day_avg_PM10__float64 ............. [[32mPASS[0m in 1.10s]
[0m15:56:56.481326 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db
[0m15:56:56.482413 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69
[0m15:56:56.483714 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('carbon_monoxide_co')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:56.485838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:56.484260 [info ] [Thread-4 (]: 66 of 77 START test test_is_float_staging_air_pollution_nh3__float64 ........... [RUN]
[0m15:56:56.488104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM10__float64.a8285358db, now test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69)
[0m15:56:56.529553 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69
[0m15:56:56.539785 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69"
[0m15:56:56.548140 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69
[0m15:56:56.550679 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69"
[0m15:56:56.553420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:8d6d67e7-d4f7-4990-a3a2-6f7d03593f94&page=queryresults
[0m15:56:56.558263 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('nh3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:56.560193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:56.906703 [info ] [Thread-1 (]: 63 of 77 PASS test_is_float_agg_pollution_by_day_avg_PM2_5__float64 ............ [[32mPASS[0m in 1.24s]
[0m15:56:56.909366 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2
[0m15:56:56.911195 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690
[0m15:56:56.912662 [info ] [Thread-1 (]: 67 of 77 START test test_is_float_staging_air_pollution_nitric_oxide_no__float64  [RUN]
[0m15:56:56.913995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_PM2_5__float64.db514b26d2, now test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690)
[0m15:56:56.915195 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690
[0m15:56:56.921934 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690"
[0m15:56:56.927398 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690
[0m15:56:56.931453 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690"
[0m15:56:56.936996 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('nitric_oxide_no')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:56.938663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:56.981998 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b37a863a-4641-4302-85e1-1cf41af5fb16&page=queryresults
[0m15:56:57.061922 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:50f8d35d-3803-4592-9bf7-a902b04177f6&page=queryresults
[0m15:56:57.208731 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:6ddb78c0-f9e7-4ca9-a3cb-b2dad97f5922&page=queryresults
[0m15:56:57.296414 [info ] [Thread-3 (]: 64 of 77 PASS test_is_float_agg_pollution_by_day_avg_SO2__float64 .............. [[32mPASS[0m in 0.95s]
[0m15:56:57.297862 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714
[0m15:56:57.299153 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9
[0m15:56:57.300239 [info ] [Thread-3 (]: 68 of 77 START test test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64  [RUN]
[0m15:56:57.301264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_agg_pollution_by_day_avg_SO2__float64.b89bba1714, now test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9)
[0m15:56:57.302249 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9
[0m15:56:57.308418 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9"
[0m15:56:57.313957 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9
[0m15:56:57.316360 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9"
[0m15:56:57.320727 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('nitrogen_dioxide_no2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:57.323499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:57.490307 [info ] [Thread-2 (]: 65 of 77 PASS test_is_float_staging_air_pollution_carbon_monoxide_co__float64 .. [[32mPASS[0m in 1.02s]
[0m15:56:57.491386 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d
[0m15:56:57.492923 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec
[0m15:56:57.495327 [info ] [Thread-2 (]: 69 of 77 START test test_is_float_staging_air_pollution_ozone_o3__float64 ...... [RUN]
[0m15:56:57.496798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_carbon_monoxide_co__float64.07f8c3707d, now test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec)
[0m15:56:57.497939 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec
[0m15:56:57.501349 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec"
[0m15:56:57.506838 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec
[0m15:56:57.509372 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec"
[0m15:56:57.512914 [debug] [Thread-2 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('ozone_o3')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:57.514323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:57.553181 [info ] [Thread-4 (]: 66 of 77 PASS test_is_float_staging_air_pollution_nh3__float64 ................. [[32mPASS[0m in 1.07s]
[0m15:56:57.554631 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69
[0m15:56:57.555496 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c
[0m15:56:57.556332 [info ] [Thread-4 (]: 70 of 77 START test test_is_float_staging_air_pollution_pm10__float64 .......... [RUN]
[0m15:56:57.557841 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_nh3__float64.80808bff69, now test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c)
[0m15:56:57.558652 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c
[0m15:56:57.561943 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c"
[0m15:56:57.565847 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c
[0m15:56:57.568165 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c"
[0m15:56:57.572531 [debug] [Thread-4 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('pm10')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:57.573646 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:57.673153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:83b80fdb-1aa2-47bc-9b12-ea7311d96a61&page=queryresults
[0m15:56:57.866256 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:e47ef192-2add-4ae3-a021-da9a6957fcad&page=queryresults
[0m15:56:57.950064 [info ] [Thread-1 (]: 67 of 77 PASS test_is_float_staging_air_pollution_nitric_oxide_no__float64 ..... [[32mPASS[0m in 1.04s]
[0m15:56:57.951502 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690
[0m15:56:57.952301 [debug] [Thread-1 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767
[0m15:56:57.953018 [info ] [Thread-1 (]: 71 of 77 START test test_is_float_staging_air_pollution_pm2_5__float64 ......... [RUN]
[0m15:56:57.953950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_nitric_oxide_no__float64.ff15780690, now test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767)
[0m15:56:57.955122 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767
[0m15:56:57.960130 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767"
[0m15:56:57.963293 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767
[0m15:56:57.965279 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767"
[0m15:56:57.969529 [debug] [Thread-1 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('pm2_5')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:57.970392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:58.290458 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:d4912f2e-2a1b-4083-aa58-8fb36f964c7a&page=queryresults
[0m15:56:58.292900 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:dbe70bf1-a698-468e-97b8-136bed664b8c&page=queryresults
[0m15:56:58.294619 [info ] [Thread-3 (]: 68 of 77 PASS test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64  [[32mPASS[0m in 0.99s]
[0m15:56:58.381709 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9
[0m15:56:58.386219 [debug] [Thread-3 (]: Began running node test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037
[0m15:56:58.390178 [info ] [Thread-3 (]: 72 of 77 START test test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64  [RUN]
[0m15:56:58.391670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_nitrogen_dioxide_no2__float64.13523835a9, now test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037)
[0m15:56:58.392686 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037
[0m15:56:58.398406 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037"
[0m15:56:58.404129 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037
[0m15:56:58.409382 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037"
[0m15:56:58.416106 [debug] [Thread-3 (]: On test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH actual_column AS (
    SELECT
        column_name,
        data_type
    FROM `paris-air-pollution-quangnc.development.INFORMATION_SCHEMA.COLUMNS`
    WHERE
        table_name = LOWER('staging_air_pollution')
        AND column_name = LOWER('sulfur_dioxide_so2')
),

validation_errors AS (
    SELECT *
    FROM actual_column
    WHERE LOWER(data_type) != LOWER('float64')
)

SELECT *
FROM validation_errors


  
  
      
    ) dbt_internal_test
[0m15:56:58.416948 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:58.504646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b4f8c3e9-ed75-424f-a971-3ae5f25c30e8&page=queryresults
[0m15:56:58.614132 [info ] [Thread-4 (]: 70 of 77 PASS test_is_float_staging_air_pollution_pm10__float64 ................ [[32mPASS[0m in 1.06s]
[0m15:56:58.615398 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c
[0m15:56:58.616311 [debug] [Thread-4 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m15:56:58.617616 [info ] [Thread-4 (]: 73 of 77 START test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [RUN]
[0m15:56:58.618593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_pm10__float64.711aca825c, now test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd)
[0m15:56:58.619340 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m15:56:58.624628 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m15:56:58.628679 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m15:56:58.633268 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"
[0m15:56:58.638542 [debug] [Thread-4 (]: On test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city AS city, 
        MAX(date) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`agg_pollution_by_day`
    GROUP BY city
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        max_date_time < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m15:56:58.639509 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:58.741653 [info ] [Thread-2 (]: 69 of 77 PASS test_is_float_staging_air_pollution_ozone_o3__float64 ............ [[32mPASS[0m in 1.24s]
[0m15:56:58.742844 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec
[0m15:56:58.743568 [debug] [Thread-2 (]: Began running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m15:56:58.744304 [info ] [Thread-2 (]: 74 of 77 START test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [RUN]
[0m15:56:58.745254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_ozone_o3__float64.45213a7bec, now test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7)
[0m15:56:58.746490 [debug] [Thread-2 (]: Began compiling node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m15:56:58.751225 [debug] [Thread-2 (]: Writing injected SQL for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m15:56:58.756546 [debug] [Thread-2 (]: Began executing node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m15:56:58.759120 [debug] [Thread-2 (]: Writing runtime sql for node "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"
[0m15:56:58.762065 [debug] [Thread-2 (]: On test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

WITH max_date_time_cte AS (
    SELECT 
        city_id AS city, 
        MAX(dt) AS max_date_time
    FROM `paris-air-pollution-quangnc`.`development`.`fact_air_pollution`
    GROUP BY city_id
)

SELECT 
    city,
    max_date_time
FROM max_date_time_cte
WHERE 
    
        DATE(max_date_time, "Europe/Paris") < DATE_SUB(CURRENT_DATE("Europe/Paris"), INTERVAL 1 DAY)
    

  
  
      
    ) dbt_internal_test
[0m15:56:58.762959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:56:58.820173 [info ] [Thread-1 (]: 71 of 77 PASS test_is_float_staging_air_pollution_pm2_5__float64 ............... [[32mPASS[0m in 0.87s]
[0m15:56:58.822422 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767
[0m15:56:58.824030 [debug] [Thread-1 (]: Began running node test.france_air_pollution.unique_dim_cities_city.a8e7985319
[0m15:56:58.825379 [info ] [Thread-1 (]: 75 of 77 START test unique_dim_cities_city ..................................... [RUN]
[0m15:56:58.826611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_pm2_5__float64.fab0942767, now test.france_air_pollution.unique_dim_cities_city.a8e7985319)
[0m15:56:58.827560 [debug] [Thread-1 (]: Began compiling node test.france_air_pollution.unique_dim_cities_city.a8e7985319
[0m15:56:58.834472 [debug] [Thread-1 (]: Writing injected SQL for node "test.france_air_pollution.unique_dim_cities_city.a8e7985319"
[0m15:56:58.838932 [debug] [Thread-1 (]: Began executing node test.france_air_pollution.unique_dim_cities_city.a8e7985319
[0m15:56:58.841507 [debug] [Thread-1 (]: Writing runtime sql for node "test.france_air_pollution.unique_dim_cities_city.a8e7985319"
[0m15:56:58.844636 [debug] [Thread-1 (]: On test.france_air_pollution.unique_dim_cities_city.a8e7985319: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_dim_cities_city.a8e7985319"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city as unique_field
  from `paris-air-pollution-quangnc`.`development`.`dim_cities`
  where city is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:56:58.845431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:58.998865 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:54ed76de-dd72-44ff-beda-90292a951b4d&page=queryresults
[0m15:56:59.250843 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:70cccfd5-a6cd-41a4-bcb8-22f65847756a&page=queryresults
[0m15:56:59.373788 [info ] [Thread-3 (]: 72 of 77 PASS test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64 .. [[32mPASS[0m in 0.98s]
[0m15:56:59.374982 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:b3567aa6-5175-45cd-88b6-0a2119acae1e&page=queryresults
[0m15:56:59.375690 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037
[0m15:56:59.377890 [debug] [Thread-3 (]: Began running node test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7
[0m15:56:59.378677 [info ] [Thread-3 (]: 76 of 77 START test unique_dim_cities_city_id .................................. [RUN]
[0m15:56:59.380351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_is_float_staging_air_pollution_sulfur_dioxide_so2__float64.2b10833037, now test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7)
[0m15:56:59.381670 [debug] [Thread-3 (]: Began compiling node test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7
[0m15:56:59.395026 [debug] [Thread-3 (]: Writing injected SQL for node "test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7"
[0m15:56:59.403732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:902ab015-aeab-4588-bd5a-cd309cc35b19&page=queryresults
[0m15:56:59.407409 [debug] [Thread-3 (]: Began executing node test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7
[0m15:56:59.411697 [debug] [Thread-3 (]: Writing runtime sql for node "test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7"
[0m15:56:59.429713 [debug] [Thread-3 (]: On test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`dim_cities`
  where city_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:56:59.432931 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:56:59.626424 [error] [Thread-4 (]: 73 of 77 FAIL 4 test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris  [[31mFAIL 4[0m in 1.01s]
[0m15:56:59.627637 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd
[0m15:56:59.628578 [debug] [Thread-4 (]: Began running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m15:56:59.629265 [info ] [Thread-4 (]: 77 of 77 START test unique_staging_cities_city_id .............................. [RUN]
[0m15:56:59.630599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.france_air_pollution.test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris.44feac0acd, now test.france_air_pollution.unique_staging_cities_city_id.051e2d6903)
[0m15:56:59.631482 [debug] [Thread-4 (]: Began compiling node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m15:56:59.635878 [debug] [Thread-4 (]: Writing injected SQL for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m15:56:59.640321 [debug] [Thread-4 (]: Began executing node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m15:56:59.643724 [debug] [Thread-4 (]: Writing runtime sql for node "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"
[0m15:56:59.647340 [debug] [Thread-4 (]: On test.france_air_pollution.unique_staging_cities_city_id.051e2d6903: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "france_air_pollution", "target_name": "dev", "node_id": "test.france_air_pollution.unique_staging_cities_city_id.051e2d6903"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select city_id as unique_field
  from `paris-air-pollution-quangnc`.`development`.`staging_cities`
  where city_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:56:59.648331 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:56:59.705001 [info ] [Thread-1 (]: 75 of 77 PASS unique_dim_cities_city ........................................... [[32mPASS[0m in 0.88s]
[0m15:56:59.706339 [debug] [Thread-1 (]: Finished running node test.france_air_pollution.unique_dim_cities_city.a8e7985319
[0m15:56:59.712616 [error] [Thread-2 (]: 74 of 77 FAIL 4 test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris  [[31mFAIL 4[0m in 0.97s]
[0m15:56:59.713611 [debug] [Thread-2 (]: Finished running node test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7
[0m15:57:00.030571 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:f3789afe-91ba-4730-90eb-9b6d5f4dc67b&page=queryresults
[0m15:57:00.336599 [info ] [Thread-3 (]: 76 of 77 PASS unique_dim_cities_city_id ........................................ [[32mPASS[0m in 0.96s]
[0m15:57:00.338215 [debug] [Thread-3 (]: Finished running node test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7
[0m15:57:00.625475 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=paris-air-pollution-quangnc&j=bq:europe-west2:3295cd82-c981-4689-b077-9df3ccd2410e&page=queryresults
[0m15:57:00.994066 [info ] [Thread-4 (]: 77 of 77 PASS unique_staging_cities_city_id .................................... [[32mPASS[0m in 1.36s]
[0m15:57:00.995877 [debug] [Thread-4 (]: Finished running node test.france_air_pollution.unique_staging_cities_city_id.051e2d6903
[0m15:57:01.021140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:01.024831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:01.025617 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_dim_cities_city.a8e7985319' was properly closed.
[0m15:57:01.026460 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_dim_cities_city_id.1f84b1e3d7' was properly closed.
[0m15:57:01.027234 [debug] [MainThread]: Connection 'test.france_air_pollution.test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris.ff5a87abb7' was properly closed.
[0m15:57:01.028048 [debug] [MainThread]: Connection 'test.france_air_pollution.unique_staging_cities_city_id.051e2d6903' was properly closed.
[0m15:57:01.029225 [info ] [MainThread]: 
[0m15:57:01.030323 [info ] [MainThread]: Finished running 77 data tests in 0 hours 0 minutes and 21.26 seconds (21.26s).
[0m15:57:01.040413 [debug] [MainThread]: Command end result
[0m15:57:01.193808 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/manifest.json
[0m15:57:01.201646 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/france_air_pollution/target/semantic_manifest.json
[0m15:57:01.232457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/france_air_pollution/target/run_results.json
[0m15:57:01.233592 [info ] [MainThread]: 
[0m15:57:01.234968 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:57:01.235954 [info ] [MainThread]: 
[0m15:57:01.237024 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_agg_pollution_by_day_date__city__Europe_Paris (models/schema.yml)[0m
[0m15:57:01.237981 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m15:57:01.238809 [info ] [MainThread]: 
[0m15:57:01.239864 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_a_d7b97c5f320ecf7a4dc092439bfeee00.sql
[0m15:57:01.241066 [info ] [MainThread]: 
[0m15:57:01.242167 [error] [MainThread]: [31mFailure in test test_latest_datetime_by_city_fact_air_pollution_dt__city_id__Europe_Paris (models/schema.yml)[0m
[0m15:57:01.243059 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m15:57:01.244121 [info ] [MainThread]: 
[0m15:57:01.245504 [info ] [MainThread]:   compiled code at target/compiled/france_air_pollution/models/schema.yml/test_latest_datetime_by_city_f_22a358fe4a72a8750ec157b1f0d61d26.sql
[0m15:57:01.246707 [info ] [MainThread]: 
[0m15:57:01.247621 [info ] [MainThread]: Done. PASS=75 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=77
[0m15:57:01.252974 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 25.056427, "process_in_blocks": "0", "process_kernel_time": 1.285157, "process_mem_max_rss": "388888", "process_out_blocks": "0", "process_user_time": 9.558553}
[0m15:57:01.259331 [debug] [MainThread]: Command `dbt test` failed at 15:57:01.258814 after 25.06 seconds
[0m15:57:01.266884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8147c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66cc1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f5f66c0>]}
[0m15:57:01.269404 [debug] [MainThread]: Flushing usage events
[0m15:57:01.864642 [debug] [MainThread]: An error was encountered while trying to flush usage events
